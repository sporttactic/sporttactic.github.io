var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},f=Object.create(new $jscomp.global.Proxy(a,{get:function(h,g,e){return h==a&&"q"==g&&e==f}}));return!0===f.q}catch(h){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var f=0;return function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,h){a!=Array.prototype&&a!=Object.prototype&&(a[f]=h.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,f){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(h){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(h||"")+"_"+f++,h)}var f=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return f?f.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,f){return Object.prototype.hasOwnProperty.call(a,f)};$jscomp.polyfill=function(a,f,h,g){if(f){h=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var e=a[g];e in h||(h[e]={});h=h[e]}a=a[a.length-1];g=h[a];f=f(g);f!=g&&null!=f&&$jscomp.defineProperty(h,a,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("WeakMap",function(a){function f(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(k){return!1}}function h(){}function g(b){if(!$jscomp.owns(b,d)){var a=new h;$jscomp.defineProperty(b,d,{value:a})}}function e(b){var a=Object[b];a&&(Object[b]=function(b){if(b instanceof h)return b;g(b);return a(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(f())return a;var d="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var c=0,b=function(b){this.id_=(c+=Math.random()+1).toString();if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};b.prototype.set=function(b,a){g(b);if(!$jscomp.owns(b,d))throw Error("WeakMap key fail: "+b);b[d][this.id_]=a;return this};b.prototype.get=function(b){return $jscomp.owns(b,d)?b[d][this.id_]:void 0};b.prototype.has=
function(b){return $jscomp.owns(b,d)&&$jscomp.owns(b[d],this.id_)};b.prototype.delete=function(b){return $jscomp.owns(b,d)&&$jscomp.owns(b[d],this.id_)?delete b[d][this.id_]:!1};return b},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function f(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var d=c.entries(),k=d.next();if(k.done||k.value[0]!=b||"s"!=k.value[1])return!1;k=d.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!d.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(f())return a;$jscomp.initSymbolIterator();var h=new WeakMap,g=function(b){this.data_={};this.head_=c();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};g.prototype.set=function(b,a){b=0===b?0:b;var c=e(this,b);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=a:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:b,
value:a},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};g.prototype.delete=function(b){b=e(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};g.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=c();this.size=0};g.prototype.has=function(b){return!!e(this,b).entry};
g.prototype.get=function(b){return(b=e(this,b).entry)&&b.value};g.prototype.entries=function(){return d(this,function(b){return[b.key,b.value]})};g.prototype.keys=function(){return d(this,function(b){return b.key})};g.prototype.values=function(){return d(this,function(b){return b.value})};g.prototype.forEach=function(b,a){for(var c=this.entries(),k;!(k=c.next()).done;)k=k.value,b.call(a,k[1],k[0],this)};g.prototype[Symbol.iterator]=g.prototype.entries;var e=function(a,c){var d=c&&typeof c;"object"==
d||"function"==d?h.has(c)?d=h.get(c):(d=""+ ++b,h.set(c,d)):d="p_"+c;var k=a.data_[d];if(k&&$jscomp.owns(a.data_,d))for(a=0;a<k.length;a++){var e=k[a];if(c!==c&&e.key!==e.key||c===e.key)return{id:d,list:k,index:a,entry:e}}return{id:d,list:k,index:-1,entry:void 0}},d=function(b,a){var c=b.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=b.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:a(c)};c=null}return{done:!0,value:void 0}})},c=function(){var b={};return b.previous=
b.next=b.head=b},b=0;return g},"es6","es3");
$jscomp.polyfill("Set",function(a){function f(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var f=Object.seal({x:4}),e=new a($jscomp.makeIterator([f]));if(!e.has(f)||1!=e.size||e.add(f)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var d=e.entries(),c=d.next();if(c.done||c.value[0]!=f||c.value[1]!=f)return!1;c=d.next();return c.done||c.value[0]==f||4!=c.value[0].x||c.value[1]!=c.value[0]?!1:d.next().done}catch(b){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(f())return a;$jscomp.initSymbolIterator();var h=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var e;!(e=a.next()).done;)this.add(e.value)}this.size=this.map_.size};h.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};h.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};h.prototype.clear=function(){this.map_.clear();
this.size=0};h.prototype.has=function(a){return this.map_.has(a)};h.prototype.entries=function(){return this.map_.entries()};h.prototype.values=function(){return this.map_.values()};h.prototype.keys=h.prototype.values;h.prototype[Symbol.iterator]=h.prototype.values;h.prototype.forEach=function(a,e){var d=this;this.map_.forEach(function(c){return a.call(e,c,c,d)})};return h},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,h){return a===h?0!==a||1/a===1/h:a!==a&&h!==h}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,h){var f=this;f instanceof String&&(f=String(f));var e=f.length;h=h||0;for(0>h&&(h=Math.max(h+e,0));h<e;h++){var d=f[h];if(d===a||Object.is(d,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,f,h){if(null==a)throw new TypeError("The 'this' value for String.prototype."+h+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+h+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,h){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,h||0)}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function f(){this.batch_=null}function h(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;f.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var g=$jscomp.global.setTimeout;f.prototype.asyncExecuteFunction=function(a){g(a,0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var d=a[b];a[b]=null;try{d()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};f.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(c){d||(d=!0,a.call(b,c))}}var b=this,d=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(l){this.reject_(l);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)d.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var d=new f;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(p){c.reject(p)}};e.prototype.then=function(a,b){function c(b,a){return"function"==typeof b?function(a){try{d(b(a))}catch(u){f(u)}}:a}var d,f,k=new e(function(b,a){d=b;f=a});this.callWhenSettled_(c(a,d),c(b,f));return k};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error("Unexpected state: "+e.state_);}}var e=this;null==this.onSettledCallbacks_?d.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=h;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,c){for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())h(e.value).callWhenSettled_(b,
c)})};e.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?h([]):new e(function(a,d){function k(b){return function(k){e[b]=k;f--;0==f&&a(e)}}var e=[],f=0;do e.push(void 0),f++,h(c.value).callWhenSettled_(k(e.length-1),d),c=b.next();while(!c.done)})};return e},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,h,g){var e=this.length||0;0>h&&(h=Math.max(0,e+h));if(null==g||g>e)g=e;g=Number(g);0>g&&(g=Math.max(0,e+g));for(h=Number(h||0);h<g;h++)this[h]=a;return this}},"es6","es3");var cr={plugins_:{},behaviors:{}};"function"!==typeof Object.getPrototypeOf&&(Object.getPrototypeOf="object"===typeof"test".__proto__?function(a){return a.__proto__}:function(a){return a.constructor.prototype});
(function(){function a(b,a){this.x=b;this.y=a;cr.seal(this)}function f(b,a,k,c){this.set(b,a,k,c);cr.seal(this)}function h(){this.bly=this.blx=this.bry=this.brx=this.try_=this.trx=this.tly=this.tlx=0;cr.seal(this)}function g(b,a,k,c){b<a?k<c?(u=b<k?b:k,y=a>c?a:c):(u=b<c?b:c,y=a>k?a:k):k<c?(u=a<k?a:k,y=b>c?b:c):(u=a<c?a:c,y=b>k?b:k)}function e(){this.items=this.s=null;this.item_count=0;D&&(this.s=new Set);this.values_cache=[];this.cache_valid=!0;cr.seal(this)}function d(b){G[r++]=b}function c(){this.sum=
this.t=this.y=this.c=0;cr.seal(this)}function b(b){this.pts_cache=[];this.bboxBottom=this.bboxRight=this.bboxTop=this.bboxLeft=0;this.convexpolys=null;this.set_pts(b);cr.seal(this)}function l(b,a){this.cellwidth=b;this.cellheight=a;this.cells={}}function p(b,a){this.cellwidth=b;this.cellheight=a;this.cells={}}function n(b,a,k){l.prototype.totalCellCount++;if(O.length){var c=O.pop();c.grid=b;c.x=a;c.y=k;return c}return new cr.GridCell(b,a,k)}function k(b,a,k){this.grid=b;this.x=a;this.y=k;this.objects=
new cr.ObjectSet}function m(b,a,k){p.prototype.totalCellCount++;if(P.length){var c=P.pop();c.grid=b;c.x=a;c.y=k;return c}return new cr.RenderCell(b,a,k)}function q(b,a,k){this.grid=b;this.x=a;this.y=k;this.objects=[];this.is_sorted=!0;this.pending_removal=new cr.ObjectSet;this.any_pending_removal=!1}function v(b,a){return b.zindex-a.zindex}cr.logexport=function(b){window.console&&window.console.log&&window.console.log(b)};cr.logerror=function(b){window.console&&window.console.error&&window.console.error(b)};
cr.seal=function(b){return b};cr.freeze=function(b){return b};cr.is_undefined=function(b){return"undefined"===typeof b};cr.is_number=function(b){return"number"===typeof b};cr.is_string=function(b){return"string"===typeof b};cr.isPOT=function(b){return 0<b&&0===(b-1&b)};cr.nextHighestPowerOfTwo=function(b){--b;for(var a=1;32>a;a<<=1)b|=b>>a;return b+1};cr.abs=function(b){return 0>b?-b:b};cr.max=function(b,a){return b>a?b:a};cr.min=function(b,a){return b<a?b:a};cr.PI=Math.PI;cr.round=function(b){return b+
.5|0};cr.floor=function(b){return 0<=b?b|0:(b|0)-1};cr.ceil=function(b){var a=b|0;return a===b?a:a+1};a.prototype.offset=function(b,a){this.x+=b;this.y+=a;return this};a.prototype.mul=function(b,a){this.x*=b;this.y*=a;return this};cr.vector2=a;cr.segments_intersect=function(b,a,k,c,d,e,f,l){if(b<k){var m=b;var g=k}else m=k,g=b;if(d<f){var h=d;var r=f}else h=f,r=d;if(g<h||m>r)return!1;a<c?(m=a,g=c):(m=c,g=a);e<l?(h=e,r=l):(h=l,r=e);if(g<h||m>r)return!1;g=d-b+f-k;m=e-a+l-c;b=k-b;a=c-a;d=f-d;e=l-e;l=
cr.abs(a*d-e*b);return cr.abs(d*m-e*g)>l?!1:cr.abs(b*m-a*g)<=l};f.prototype.set=function(b,a,k,c){this.left=b;this.top=a;this.right=k;this.bottom=c};f.prototype.copy=function(b){this.left=b.left;this.top=b.top;this.right=b.right;this.bottom=b.bottom};f.prototype.width=function(){return this.right-this.left};f.prototype.height=function(){return this.bottom-this.top};f.prototype.offset=function(b,a){this.left+=b;this.top+=a;this.right+=b;this.bottom+=a;return this};f.prototype.normalize=function(){if(this.left>
this.right){var b=this.left;this.left=this.right;this.right=b}this.top>this.bottom&&(b=this.top,this.top=this.bottom,this.bottom=b)};f.prototype.intersects_rect=function(b){return!(b.right<this.left||b.bottom<this.top||b.left>this.right||b.top>this.bottom)};f.prototype.intersects_rect_off=function(b,a,k){return!(b.right+a<this.left||b.bottom+k<this.top||b.left+a>this.right||b.top+k>this.bottom)};f.prototype.contains_pt=function(b,a){return b>=this.left&&b<=this.right&&a>=this.top&&a<=this.bottom};
f.prototype.equals=function(b){return this.left===b.left&&this.top===b.top&&this.right===b.right&&this.bottom===b.bottom};cr.rect=f;h.prototype.set_from_rect=function(b){this.tlx=b.left;this.tly=b.top;this.trx=b.right;this.try_=b.top;this.brx=b.right;this.bry=b.bottom;this.blx=b.left;this.bly=b.bottom};h.prototype.set_from_rotated_rect=function(b,a){if(0===a)this.set_from_rect(b);else{var k=Math.sin(a),c=Math.cos(a);a=b.left*k;var d=b.top*k,e=b.right*k;k*=b.bottom;var f=b.left*c,l=b.top*c,m=b.right*
c;b=b.bottom*c;this.tlx=f-d;this.tly=l+a;this.trx=m-d;this.try_=l+e;this.brx=m-k;this.bry=b+e;this.blx=f-k;this.bly=b+a}};h.prototype.offset=function(b,a){this.tlx+=b;this.tly+=a;this.trx+=b;this.try_+=a;this.brx+=b;this.bry+=a;this.blx+=b;this.bly+=a;return this};var u=0,y=0;h.prototype.bounding_box=function(b){g(this.tlx,this.trx,this.brx,this.blx);b.left=u;b.right=y;g(this.tly,this.try_,this.bry,this.bly);b.top=u;b.bottom=y};h.prototype.contains_pt=function(b,a){var k=this.tlx,c=this.tly,d=this.trx-
k,e=this.try_-c,f=this.brx-k,l=this.bry-c;b-=k;a-=c;var m=d*d+e*e,g=d*f+e*l;e=d*b+e*a;var h=f*f+l*l,r=f*b+l*a,t=1/(m*h-g*g);d=(h*e-g*r)*t;m=(m*r-g*e)*t;if(0<=d&&0<m&&1>d+m)return!0;d=this.blx-k;e=this.bly-c;m=d*d+e*e;g=d*f+e*l;e=d*b+e*a;t=1/(m*h-g*g);d=(h*e-g*r)*t;m=(m*r-g*e)*t;return 0<=d&&0<m&&1>d+m};h.prototype.at=function(b,a){if(a)switch(b){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(b){case 0:return this.tly;
case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}};h.prototype.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4};h.prototype.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4};h.prototype.intersects_segment=function(b,a,k,c){if(this.contains_pt(b,a)||this.contains_pt(k,c))return!0;var d;for(d=0;4>d;d++){var e=this.at(d,!0);var f=this.at(d,!1);var l=this.at(d+1,!0);var m=this.at(d+1,!1);if(cr.segments_intersect(b,
a,k,c,e,f,l,m))return!0}return!1};h.prototype.intersects_quad=function(b){var a=b.midX(),k=b.midY();if(this.contains_pt(a,k))return!0;a=this.midX();k=this.midY();if(b.contains_pt(a,k))return!0;var c,d;for(c=0;4>c;c++)for(d=0;4>d;d++){a=this.at(c,!0);k=this.at(c,!1);var e=this.at(c+1,!0);var f=this.at(c+1,!1);var l=b.at(d,!0);var m=b.at(d,!1);var g=b.at(d+1,!0);var h=b.at(d+1,!1);if(cr.segments_intersect(a,k,e,f,l,m,g,h))return!0}return!1};cr.quad=h;cr.RGB=function(b,a,k){return Math.max(Math.min(b,
255),0)|Math.max(Math.min(a,255),0)<<8|Math.max(Math.min(k,255),0)<<16};cr.GetRValue=function(b){return b&255};cr.GetGValue=function(b){return(b&65280)>>8};cr.GetBValue=function(b){return(b&16711680)>>16};cr.shallowCopy=function(b,a,k){for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b};cr.arrayRemove=function(b,a){var k;a=cr.floor(a);if(!(0>a||a>=b.length)){for(k=b.length-1;a<k;a++)b[a]=b[a+1];cr.truncateArray(b,k)}};cr.truncateArray=function(b,a){b.length=a};cr.clearArray=function(b){cr.truncateArray(b,
0)};cr.shallowAssignArray=function(b,a){cr.clearArray(b);var k;var c=0;for(k=a.length;c<k;++c)b[c]=a[c]};cr.appendArray=function(b,a){b.push.apply(b,a)};cr.fastIndexOf=function(b,a){var k;var c=0;for(k=b.length;c<k;++c)if(b[c]===a)return c;return-1};cr.arrayFindRemove=function(b,a){a=cr.fastIndexOf(b,a);-1!==a&&cr.arrayRemove(b,a)};cr.clamp=function(b,a,k){return b<a?a:b>k?k:b};cr.to_radians=function(b){return b/(180/cr.PI)};cr.to_degrees=function(b){return 180/cr.PI*b};cr.clamp_angle_degrees=function(b){b%=
360;0>b&&(b+=360);return b};cr.clamp_angle=function(b){b%=2*cr.PI;0>b&&(b+=2*cr.PI);return b};cr.to_clamped_degrees=function(b){return cr.clamp_angle_degrees(cr.to_degrees(b))};cr.to_clamped_radians=function(b){return cr.clamp_angle(cr.to_radians(b))};cr.angleTo=function(b,a,k,c){return Math.atan2(c-a,k-b)};cr.angleDiff=function(b,a){if(b===a)return 0;b=Math.sin(b)*Math.sin(a)+Math.cos(b)*Math.cos(a);return 1<=b?0:-1>=b?cr.PI:Math.acos(b)};cr.angleRotate=function(b,a,k){var c=Math.sin(b),d=Math.cos(b),
e=Math.sin(a),f=Math.cos(a);return Math.acos(c*e+d*f)>k?0<d*e-c*f?cr.clamp_angle(b+k):cr.clamp_angle(b-k):cr.clamp_angle(a)};cr.angleClockwise=function(b,a){return 0>=Math.cos(b)*Math.sin(a)-Math.sin(b)*Math.cos(a)};cr.rotatePtAround=function(b,a,k,c,d,e){if(0===k)return e?b:a;var f=Math.sin(k);k=Math.cos(k);b-=c;a-=d;var l=b*f;b=b*k-a*f;return e?b+c:a*k+l+d};cr.distanceTo=function(b,a,k,c){b=k-b;a=c-a;return Math.sqrt(b*b+a*a)};cr.xor=function(b,a){return!b!==!a};cr.lerp=function(b,a,k){return b+
(a-b)*k};cr.unlerp=function(b,a,k){return b===a?0:(k-b)/(a-b)};cr.anglelerp=function(b,a,k){var c=cr.angleDiff(b,a);return cr.angleClockwise(a,b)?b+c*k:b-c*k};cr.qarp=function(b,a,k,c){return cr.lerp(cr.lerp(b,a,c),cr.lerp(a,k,c),c)};cr.cubic=function(b,a,k,c,d){return cr.lerp(cr.qarp(b,a,k,d),cr.qarp(a,k,c,d),d)};cr.cosp=function(b,a,k){return(b+a+(b-a)*Math.cos(k*Math.PI))/2};cr.hasAnyOwnProperty=function(b){for(var a in b)if(b.hasOwnProperty(a))return!0;return!1};cr.wipe=function(b){for(var a in b)b.hasOwnProperty(a)&&
delete b[a]};var B=+new Date;cr.performance_now=function(){if("undefined"!==typeof window.performance){var b=window.performance;if("undefined"!==typeof b.now)return b.now();if("undefined"!==typeof b.webkitNow)return b.webkitNow();if("undefined"!==typeof b.mozNow)return b.mozNow();if("undefined"!==typeof b.msNow)return b.msNow()}return Date.now()-B};var x=!1,w=x=!1,A=!1;"undefined"!==typeof window&&(x=/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent),x=!x&&/safari/i.test(navigator.userAgent),
w=/(iphone|ipod|ipad)/i.test(navigator.userAgent),A=window.c2ejecta);var D=!x&&!A&&!w&&"undefined"!==typeof Set&&"undefined"!==typeof Set.prototype.forEach;e.prototype.contains=function(b){return this.isEmpty()?!1:D?this.s.has(b):this.items&&this.items.hasOwnProperty(b)};e.prototype.add=function(b){if(D)this.s.has(b)||(this.s.add(b),this.cache_valid=!1);else{var a=b.toString(),k=this.items;k?k.hasOwnProperty(a)||(k[a]=b,this.item_count++,this.cache_valid=!1):(this.items={},this.items[a]=b,this.item_count=
1,this.cache_valid=!1)}};e.prototype.remove=function(b){if(!this.isEmpty())if(D)this.s.has(b)&&(this.s["delete"](b),this.cache_valid=!1);else if(this.items){b=b.toString();var a=this.items;a.hasOwnProperty(b)&&(delete a[b],this.item_count--,this.cache_valid=!1)}};e.prototype.clear=function(){this.isEmpty()||(D?this.s.clear():(this.items=null,this.item_count=0),cr.clearArray(this.values_cache),this.cache_valid=!0)};e.prototype.isEmpty=function(){return 0===this.count()};e.prototype.count=function(){return D?
this.s.size:this.item_count};var G=null,r=0;e.prototype.update_cache=function(){if(!this.cache_valid){if(D)cr.clearArray(this.values_cache),G=this.values_cache,r=0,this.s.forEach(d),G=null,r=0;else{var b=this.values_cache;cr.clearArray(b);var a,k=0,c=this.items;if(c)for(a in c)c.hasOwnProperty(a)&&(b[k++]=c[a])}this.cache_valid=!0}};e.prototype.valuesRef=function(){this.update_cache();return this.values_cache};cr.ObjectSet=e;var t=new cr.ObjectSet;cr.removeArrayDuplicates=function(b){var a;var k=
0;for(a=b.length;k<a;++k)t.add(b[k]);cr.shallowAssignArray(b,t.valuesRef());t.clear()};cr.arrayRemoveAllFromObjectSet=function(b,a){D?cr.arrayRemoveAll_set(b,a.s):cr.arrayRemoveAll_arr(b,a.valuesRef())};cr.arrayRemoveAll_set=function(b,a){var k,c;var d=k=0;for(c=b.length;k<c;++k){var e=b[k];a.has(e)||(b[d++]=e)}cr.truncateArray(b,d)};cr.arrayRemoveAll_arr=function(b,a){var k,c;var d=k=0;for(c=b.length;k<c;++k){var e=b[k];-1===cr.fastIndexOf(a,e)&&(b[d++]=e)}cr.truncateArray(b,d)};c.prototype.add=
function(b){this.y=b-this.c;this.t=this.sum+this.y;this.c=this.t-this.sum-this.y;this.sum=this.t};c.prototype.reset=function(){this.sum=this.t=this.y=this.c=0};cr.KahanAdder=c;cr.regexp_escape=function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};b.prototype.set_pts=function(b){this.pts_array=b;this.pts_count=b.length/2;this.pts_cache.length=b.length;this.cache_height=this.cache_width=-1;this.cache_angle=0};b.prototype.is_empty=function(){return!this.pts_array.length};b.prototype.update_bbox=
function(){for(var b=this.pts_cache,a=b[0],k=a,c=b[1],d=c,e,f,l=1,m=this.pts_count;l<m;++l)f=2*l,e=b[f],f=b[f+1],e<a&&(a=e),e>k&&(k=e),f<c&&(c=f),f>d&&(d=f);this.bboxLeft=a;this.bboxRight=k;this.bboxTop=c;this.bboxBottom=d};b.prototype.set_from_rect=function(b,a,k){this.pts_cache.length=8;this.pts_count=4;var c=this.pts_cache;c[0]=b.left-a;c[1]=b.top-k;c[2]=b.right-a;c[3]=b.top-k;c[4]=b.right-a;c[5]=b.bottom-k;c[6]=b.left-a;c[7]=b.bottom-k;this.cache_width=b.right-b.left;this.cache_height=b.bottom-
b.top;this.update_bbox()};b.prototype.set_from_quad=function(b,a,k,c,d){this.pts_cache.length=8;this.pts_count=4;var e=this.pts_cache;e[0]=b.tlx-a;e[1]=b.tly-k;e[2]=b.trx-a;e[3]=b.try_-k;e[4]=b.brx-a;e[5]=b.bry-k;e[6]=b.blx-a;e[7]=b.bly-k;this.cache_width=c;this.cache_height=d;this.update_bbox()};b.prototype.set_from_poly=function(b){this.pts_count=b.pts_count;cr.shallowAssignArray(this.pts_cache,b.pts_cache);this.bboxLeft=b.bboxLeft;this.bboxTop=b.bboxTop;this.bboxRight=b.bboxRight;this.bboxBottom=
b.bboxBottom};b.prototype.cache_poly=function(b,a,k){if(this.cache_width!==b||this.cache_height!==a||this.cache_angle!==k){this.cache_width=b;this.cache_height=a;this.cache_angle=k;var c,d=0,e=1,f=this.pts_array,l=this.pts_cache;0!==k&&(d=Math.sin(k),e=Math.cos(k));k=0;for(c=this.pts_count;k<c;k++){var m=2*k;var g=m+1;var h=f[m]*b;var r=f[g]*a;l[m]=h*e-r*d;l[g]=r*e+h*d}this.update_bbox()}};b.prototype.contains_pt=function(b,a){var k=this.pts_cache;if(b===k[0]&&a===k[1])return!0;var c,d=this.pts_count,
e=this.bboxLeft-110,f=this.bboxTop-101,l=this.bboxRight+131,m=this.bboxBottom+120,g=0,h=0;for(c=0;c<d;c++){var r=2*c;var t=(c+1)%d*2;var n=k[r];r=k[r+1];var w=k[t];t=k[t+1];cr.segments_intersect(e,f,b,a,n,r,w,t)&&g++;cr.segments_intersect(l,m,b,a,n,r,w,t)&&h++}return 1===g%2||1===h%2};b.prototype.intersects_poly=function(b,a,k){var c=b.pts_cache,d=this.pts_cache;if(this.contains_pt(c[0]+a,c[1]+k)||b.contains_pt(d[0]-a,d[1]-k))return!0;var e,f;var l=0;for(e=this.pts_count;l<e;l++){var m=2*l;var g=
(l+1)%e*2;var h=d[m];m=d[m+1];var r=d[g];var t=d[g+1];g=0;for(f=b.pts_count;g<f;g++){var n=2*g;var w=(g+1)%f*2;var q=c[n]+a;n=c[n+1]+k;var p=c[w]+a;w=c[w+1]+k;if(cr.segments_intersect(h,m,r,t,q,n,p,w))return!0}}return!1};b.prototype.intersects_segment=function(b,a,k,c,d,e){var f=this.pts_cache;if(this.contains_pt(k-b,c-a))return!0;var l;var m=0;for(l=this.pts_count;m<l;m++){var g=2*m;var h=(m+1)%l*2;var r=f[g]+b;g=f[g+1]+a;var t=f[h]+b;h=f[h+1]+a;if(cr.segments_intersect(k,c,d,e,r,g,t,h))return!0}return!1};
b.prototype.mirror=function(b){var a;var k=0;for(a=this.pts_count;k<a;++k){var c=2*k;this.pts_cache[c]=2*b-this.pts_cache[c]}};b.prototype.flip=function(b){var a;var k=0;for(a=this.pts_count;k<a;++k){var c=2*k+1;this.pts_cache[c]=2*b-this.pts_cache[c]}};b.prototype.diag=function(){var b;var a=0;for(b=this.pts_count;a<b;++a){var k=2*a;var c=k+1;var d=this.pts_cache[k];this.pts_cache[k]=this.pts_cache[c];this.pts_cache[c]=d}};cr.CollisionPoly=b;l.prototype.totalCellCount=0;l.prototype.getCell=function(b,
a,k){var c=this.cells[b];return c?(c=c[a])?c:k?(c=n(this,b,a),this.cells[b][a]=c):null:k?(c=n(this,b,a),this.cells[b]={},this.cells[b][a]=c):null};l.prototype.XToCell=function(b){return cr.floor(b/this.cellwidth)};l.prototype.YToCell=function(b){return cr.floor(b/this.cellheight)};l.prototype.update=function(b,a,k){var c,d,e;if(a){var f=a.left;for(c=a.right;f<=c;++f){var m=a.top;for(d=a.bottom;m<=d;++m)if(!k||!k.contains_pt(f,m))if(e=this.getCell(f,m,!1))e.remove(b),e.isEmpty()&&(l.prototype.totalCellCount--,
e.objects.clear(),1E3>O.length&&O.push(e),this.cells[f][m]=null)}}if(k)for(f=k.left,c=k.right;f<=c;++f)for(m=k.top,d=k.bottom;m<=d;++m)a&&a.contains_pt(f,m)||this.getCell(f,m,!0).insert(b)};l.prototype.queryRange=function(b,a){var k,c;var d=this.XToCell(b.left);var e=this.YToCell(b.top);var f=this.XToCell(b.right);for(k=this.YToCell(b.bottom);d<=f;++d)for(b=e;b<=k;++b)(c=this.getCell(d,b,!1))&&c.dump(a)};cr.SparseGrid=l;p.prototype.totalCellCount=0;p.prototype.getCell=function(b,a,k){var c=this.cells[b];
return c?(c=c[a])?c:k?(c=m(this,b,a),this.cells[b][a]=c):null:k?(c=m(this,b,a),this.cells[b]={},this.cells[b][a]=c):null};p.prototype.XToCell=function(b){return cr.floor(b/this.cellwidth)};p.prototype.YToCell=function(b){return cr.floor(b/this.cellheight)};p.prototype.update=function(b,a,k){var c,d,e;if(a){var f=a.left;for(c=a.right;f<=c;++f){var l=a.top;for(d=a.bottom;l<=d;++l)if(!k||!k.contains_pt(f,l))if(e=this.getCell(f,l,!1))e.remove(b),e.isEmpty()&&(p.prototype.totalCellCount--,e.reset(),1E3>
P.length&&P.push(e),this.cells[f][l]=null)}}if(k)for(f=k.left,c=k.right;f<=c;++f)for(l=k.top,d=k.bottom;l<=d;++l)a&&a.contains_pt(f,l)||this.getCell(f,l,!0).insert(b)};p.prototype.queryRange=function(b,a,k,c,d){var e,f;b=this.XToCell(b);a=this.YToCell(a);k=this.XToCell(k);for(e=this.YToCell(c);b<=k;++b)for(c=a;c<=e;++c)(f=this.getCell(b,c,!1))&&f.dump(d)};p.prototype.markRangeChanged=function(b){var a,k;var c=b.left;var d=b.top;var e=b.right;for(a=b.bottom;c<=e;++c)for(b=d;b<=a;++b)if(k=this.getCell(c,
b,!1))k.is_sorted=!1};cr.RenderGrid=p;var O=[];k.prototype.isEmpty=function(){return this.objects.isEmpty()};k.prototype.insert=function(b){this.objects.add(b)};k.prototype.remove=function(b){this.objects.remove(b)};k.prototype.dump=function(b){cr.appendArray(b,this.objects.valuesRef())};cr.GridCell=k;var P=[];q.prototype.isEmpty=function(){if(!this.objects.length)return!0;if(this.objects.length>this.pending_removal.count())return!1;this.flush_pending();return!0};q.prototype.insert=function(b){this.pending_removal.contains(b)?
(this.pending_removal.remove(b),this.pending_removal.isEmpty()&&(this.any_pending_removal=!1)):this.objects.length?(this.objects[this.objects.length-1].get_zindex()>b.get_zindex()&&(this.is_sorted=!1),this.objects.push(b)):(this.objects.push(b),this.is_sorted=!0)};q.prototype.remove=function(b){this.pending_removal.add(b);this.any_pending_removal=!0;30<=this.pending_removal.count()&&this.flush_pending()};q.prototype.flush_pending=function(){this.any_pending_removal&&(this.pending_removal.count()===
this.objects.length?this.reset():(cr.arrayRemoveAllFromObjectSet(this.objects,this.pending_removal),this.pending_removal.clear(),this.any_pending_removal=!1))};q.prototype.ensure_sorted=function(){this.is_sorted||(this.objects.sort(v),this.is_sorted=!0)};q.prototype.reset=function(){cr.clearArray(this.objects);this.is_sorted=!0;this.pending_removal.clear();this.any_pending_removal=!1};q.prototype.dump=function(b){this.flush_pending();this.ensure_sorted();this.objects.length&&b.push(this.objects)};
cr.RenderCell=q;var Q="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");cr.effectToCompositeOp=function(b){return 0>=b||11<=b?"source-over":Q[b-1]};cr.setGLBlend=function(b,a,k){if(k)switch(b.srcBlend=k.ONE,b.destBlend=k.ONE_MINUS_SRC_ALPHA,a){case 1:b.srcBlend=k.ONE;b.destBlend=k.ONE;break;case 3:b.srcBlend=k.ONE;b.destBlend=k.ZERO;break;case 4:b.srcBlend=k.ONE_MINUS_DST_ALPHA;b.destBlend=k.ONE;break;case 5:b.srcBlend=
k.DST_ALPHA;b.destBlend=k.ZERO;break;case 6:b.srcBlend=k.ZERO;b.destBlend=k.SRC_ALPHA;break;case 7:b.srcBlend=k.ONE_MINUS_DST_ALPHA;b.destBlend=k.ZERO;break;case 8:b.srcBlend=k.ZERO;b.destBlend=k.ONE_MINUS_SRC_ALPHA;break;case 9:b.srcBlend=k.DST_ALPHA;b.destBlend=k.ONE_MINUS_SRC_ALPHA;break;case 10:b.srcBlend=k.ONE_MINUS_DST_ALPHA,b.destBlend=k.SRC_ALPHA}};cr.round6dp=function(b){return Math.round(1E6*b)/1E6};cr.equals_nocase=function(b,a){return"string"!==typeof b||"string"!==typeof a||b.length!==
a.length?!1:b===a?!0:b.toLowerCase()===a.toLowerCase()};cr.isCanvasInputEvent=function(b){b=b.target;return!b||b===document||b===window||document&&document.body&&b===document.body||cr.equals_nocase(b.tagName,"canvas")?!0:!1}})();var MatrixArray="undefined"!==typeof Float32Array?Float32Array:Array,glMatrixArrayType=MatrixArray,vec3={},mat3={},mat4={},quat4={};vec3.create=function(a){var f=new MatrixArray(3);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2]);return f};
vec3.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];return f};vec3.add=function(a,f,h){if(!h||a===h)return a[0]+=f[0],a[1]+=f[1],a[2]+=f[2],a;h[0]=a[0]+f[0];h[1]=a[1]+f[1];h[2]=a[2]+f[2];return h};vec3.subtract=function(a,f,h){if(!h||a===h)return a[0]-=f[0],a[1]-=f[1],a[2]-=f[2],a;h[0]=a[0]-f[0];h[1]=a[1]-f[1];h[2]=a[2]-f[2];return h};vec3.negate=function(a,f){f||(f=a);f[0]=-a[0];f[1]=-a[1];f[2]=-a[2];return f};
vec3.scale=function(a,f,h){if(!h||a===h)return a[0]*=f,a[1]*=f,a[2]*=f,a;h[0]=a[0]*f;h[1]=a[1]*f;h[2]=a[2]*f;return h};vec3.normalize=function(a,f){f||(f=a);var h=a[0],g=a[1];a=a[2];var e=Math.sqrt(h*h+g*g+a*a);if(e){if(1===e)return f[0]=h,f[1]=g,f[2]=a,f}else return f[0]=0,f[1]=0,f[2]=0,f;e=1/e;f[0]=h*e;f[1]=g*e;f[2]=a*e;return f};vec3.cross=function(a,f,h){h||(h=a);var g=a[0],e=a[1];a=a[2];var d=f[0],c=f[1];f=f[2];h[0]=e*f-a*c;h[1]=a*d-g*f;h[2]=g*c-e*d;return h};
vec3.length=function(a){var f=a[0],h=a[1];a=a[2];return Math.sqrt(f*f+h*h+a*a)};vec3.dot=function(a,f){return a[0]*f[0]+a[1]*f[1]+a[2]*f[2]};vec3.direction=function(a,f,h){h||(h=a);var g=a[0]-f[0],e=a[1]-f[1];a=a[2]-f[2];f=Math.sqrt(g*g+e*e+a*a);if(!f)return h[0]=0,h[1]=0,h[2]=0,h;f=1/f;h[0]=g*f;h[1]=e*f;h[2]=a*f;return h};vec3.lerp=function(a,f,h,g){g||(g=a);g[0]=a[0]+h*(f[0]-a[0]);g[1]=a[1]+h*(f[1]-a[1]);g[2]=a[2]+h*(f[2]-a[2]);return g};vec3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+"]"};
mat3.create=function(a){var f=new MatrixArray(9);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8]);return f};mat3.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];return f};mat3.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};
mat3.transpose=function(a,f){if(!f||a===f){f=a[1];var h=a[2],g=a[5];a[1]=a[3];a[2]=a[6];a[3]=f;a[5]=a[7];a[6]=h;a[7]=g;return a}f[0]=a[0];f[1]=a[3];f[2]=a[6];f[3]=a[1];f[4]=a[4];f[5]=a[7];f[6]=a[2];f[7]=a[5];f[8]=a[8];return f};mat3.toMat4=function(a,f){f||(f=mat4.create());f[15]=1;f[14]=0;f[13]=0;f[12]=0;f[11]=0;f[10]=a[8];f[9]=a[7];f[8]=a[6];f[7]=0;f[6]=a[5];f[5]=a[4];f[4]=a[3];f[3]=0;f[2]=a[2];f[1]=a[1];f[0]=a[0];return f};
mat3.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+"]"};mat4.create=function(a){var f=new MatrixArray(16);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3],f[4]=a[4],f[5]=a[5],f[6]=a[6],f[7]=a[7],f[8]=a[8],f[9]=a[9],f[10]=a[10],f[11]=a[11],f[12]=a[12],f[13]=a[13],f[14]=a[14],f[15]=a[15]);return f};
mat4.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];f[9]=a[9];f[10]=a[10];f[11]=a[11];f[12]=a[12];f[13]=a[13];f[14]=a[14];f[15]=a[15];return f};mat4.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
mat4.transpose=function(a,f){if(!f||a===f){f=a[1];var h=a[2],g=a[3],e=a[6],d=a[7],c=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=f;a[6]=a[9];a[7]=a[13];a[8]=h;a[9]=e;a[11]=a[14];a[12]=g;a[13]=d;a[14]=c;return a}f[0]=a[0];f[1]=a[4];f[2]=a[8];f[3]=a[12];f[4]=a[1];f[5]=a[5];f[6]=a[9];f[7]=a[13];f[8]=a[2];f[9]=a[6];f[10]=a[10];f[11]=a[14];f[12]=a[3];f[13]=a[7];f[14]=a[11];f[15]=a[15];return f};
mat4.determinant=function(a){var f=a[0],h=a[1],g=a[2],e=a[3],d=a[4],c=a[5],b=a[6],l=a[7],p=a[8],n=a[9],k=a[10],m=a[11],q=a[12],v=a[13],u=a[14];a=a[15];return q*n*b*e-p*v*b*e-q*c*k*e+d*v*k*e+p*c*u*e-d*n*u*e-q*n*g*l+p*v*g*l+q*h*k*l-f*v*k*l-p*h*u*l+f*n*u*l+q*c*g*m-d*v*g*m-q*h*b*m+f*v*b*m+d*h*u*m-f*c*u*m-p*c*g*a+d*n*g*a+p*h*b*a-f*n*b*a-d*h*k*a+f*c*k*a};
mat4.inverse=function(a,f){f||(f=a);var h=a[0],g=a[1],e=a[2],d=a[3],c=a[4],b=a[5],l=a[6],p=a[7],n=a[8],k=a[9],m=a[10],q=a[11],v=a[12],u=a[13],y=a[14];a=a[15];var B=h*b-g*c,x=h*l-e*c,w=h*p-d*c,A=g*l-e*b,D=g*p-d*b,G=e*p-d*l,r=n*u-k*v,t=n*y-m*v,O=n*a-q*v,P=k*y-m*u,Q=k*a-q*u,z=m*a-q*y,J=1/(B*z-x*Q+w*P+A*O-D*t+G*r);f[0]=(b*z-l*Q+p*P)*J;f[1]=(-g*z+e*Q-d*P)*J;f[2]=(u*G-y*D+a*A)*J;f[3]=(-k*G+m*D-q*A)*J;f[4]=(-c*z+l*O-p*t)*J;f[5]=(h*z-e*O+d*t)*J;f[6]=(-v*G+y*w-a*x)*J;f[7]=(n*G-m*w+q*x)*J;f[8]=(c*Q-b*O+p*r)*
J;f[9]=(-h*Q+g*O-d*r)*J;f[10]=(v*D-u*w+a*B)*J;f[11]=(-n*D+k*w-q*B)*J;f[12]=(-c*P+b*t-l*r)*J;f[13]=(h*P-g*t+e*r)*J;f[14]=(-v*A+u*x-y*B)*J;f[15]=(n*A-k*x+m*B)*J;return f};mat4.toRotationMat=function(a,f){f||(f=mat4.create());f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];f[4]=a[4];f[5]=a[5];f[6]=a[6];f[7]=a[7];f[8]=a[8];f[9]=a[9];f[10]=a[10];f[11]=a[11];f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};
mat4.toMat3=function(a,f){f||(f=mat3.create());f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[4];f[4]=a[5];f[5]=a[6];f[6]=a[8];f[7]=a[9];f[8]=a[10];return f};mat4.toInverseMat3=function(a,f){var h=a[0],g=a[1],e=a[2],d=a[4],c=a[5],b=a[6],l=a[8],p=a[9];a=a[10];var n=a*c-b*p,k=-a*d+b*l,m=p*d-c*l,q=h*n+g*k+e*m;if(!q)return null;q=1/q;f||(f=mat3.create());f[0]=n*q;f[1]=(-a*g+e*p)*q;f[2]=(b*g-e*c)*q;f[3]=k*q;f[4]=(a*h-e*l)*q;f[5]=(-b*h+e*d)*q;f[6]=m*q;f[7]=(-p*h+g*l)*q;f[8]=(c*h-g*d)*q;return f};
mat4.multiply=function(a,f,h){h||(h=a);var g=a[0],e=a[1],d=a[2],c=a[3],b=a[4],l=a[5],p=a[6],n=a[7],k=a[8],m=a[9],q=a[10],v=a[11],u=a[12],y=a[13],B=a[14];a=a[15];var x=f[0],w=f[1],A=f[2],D=f[3],G=f[4],r=f[5],t=f[6],O=f[7],P=f[8],Q=f[9],z=f[10],J=f[11],I=f[12],M=f[13],N=f[14];f=f[15];h[0]=x*g+w*b+A*k+D*u;h[1]=x*e+w*l+A*m+D*y;h[2]=x*d+w*p+A*q+D*B;h[3]=x*c+w*n+A*v+D*a;h[4]=G*g+r*b+t*k+O*u;h[5]=G*e+r*l+t*m+O*y;h[6]=G*d+r*p+t*q+O*B;h[7]=G*c+r*n+t*v+O*a;h[8]=P*g+Q*b+z*k+J*u;h[9]=P*e+Q*l+z*m+J*y;h[10]=P*
d+Q*p+z*q+J*B;h[11]=P*c+Q*n+z*v+J*a;h[12]=I*g+M*b+N*k+f*u;h[13]=I*e+M*l+N*m+f*y;h[14]=I*d+M*p+N*q+f*B;h[15]=I*c+M*n+N*v+f*a;return h};mat4.multiplyVec3=function(a,f,h){h||(h=f);var g=f[0],e=f[1];f=f[2];h[0]=a[0]*g+a[4]*e+a[8]*f+a[12];h[1]=a[1]*g+a[5]*e+a[9]*f+a[13];h[2]=a[2]*g+a[6]*e+a[10]*f+a[14];return h};
mat4.multiplyVec4=function(a,f,h){h||(h=f);var g=f[0],e=f[1],d=f[2];f=f[3];h[0]=a[0]*g+a[4]*e+a[8]*d+a[12]*f;h[1]=a[1]*g+a[5]*e+a[9]*d+a[13]*f;h[2]=a[2]*g+a[6]*e+a[10]*d+a[14]*f;h[3]=a[3]*g+a[7]*e+a[11]*d+a[15]*f;return h};
mat4.translate=function(a,f,h){var g=f[0],e=f[1];f=f[2];if(!h||a===h)return a[12]=a[0]*g+a[4]*e+a[8]*f+a[12],a[13]=a[1]*g+a[5]*e+a[9]*f+a[13],a[14]=a[2]*g+a[6]*e+a[10]*f+a[14],a[15]=a[3]*g+a[7]*e+a[11]*f+a[15],a;var d=a[0];var c=a[1];var b=a[2];var l=a[3];var p=a[4];var n=a[5];var k=a[6];var m=a[7];var q=a[8];var v=a[9];var u=a[10];var y=a[11];h[0]=d;h[1]=c;h[2]=b;h[3]=l;h[4]=p;h[5]=n;h[6]=k;h[7]=m;h[8]=q;h[9]=v;h[10]=u;h[11]=y;h[12]=d*g+p*e+q*f+a[12];h[13]=c*g+n*e+v*f+a[13];h[14]=b*g+k*e+u*f+a[14];
h[15]=l*g+m*e+y*f+a[15];return h};mat4.scale=function(a,f,h){var g=f[0],e=f[1];f=f[2];if(!h||a===h)return a[0]*=g,a[1]*=g,a[2]*=g,a[3]*=g,a[4]*=e,a[5]*=e,a[6]*=e,a[7]*=e,a[8]*=f,a[9]*=f,a[10]*=f,a[11]*=f,a;h[0]=a[0]*g;h[1]=a[1]*g;h[2]=a[2]*g;h[3]=a[3]*g;h[4]=a[4]*e;h[5]=a[5]*e;h[6]=a[6]*e;h[7]=a[7]*e;h[8]=a[8]*f;h[9]=a[9]*f;h[10]=a[10]*f;h[11]=a[11]*f;h[12]=a[12];h[13]=a[13];h[14]=a[14];h[15]=a[15];return h};
mat4.rotate=function(a,f,h,g){var e=h[0],d=h[1];h=h[2];var c=Math.sqrt(e*e+d*d+h*h);if(!c)return null;1!==c&&(c=1/c,e*=c,d*=c,h*=c);var b=Math.sin(f);var l=Math.cos(f);var p=1-l;f=a[0];c=a[1];var n=a[2];var k=a[3];var m=a[4];var q=a[5];var v=a[6];var u=a[7];var y=a[8];var B=a[9];var x=a[10];var w=a[11];var A=e*e*p+l;var D=d*e*p+h*b;var G=h*e*p-d*b;var r=e*d*p-h*b;var t=d*d*p+l;var O=h*d*p+e*b;var P=e*h*p+d*b;e=d*h*p-e*b;d=h*h*p+l;g?a!==g&&(g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]):g=a;g[0]=
f*A+m*D+y*G;g[1]=c*A+q*D+B*G;g[2]=n*A+v*D+x*G;g[3]=k*A+u*D+w*G;g[4]=f*r+m*t+y*O;g[5]=c*r+q*t+B*O;g[6]=n*r+v*t+x*O;g[7]=k*r+u*t+w*O;g[8]=f*P+m*e+y*d;g[9]=c*P+q*e+B*d;g[10]=n*P+v*e+x*d;g[11]=k*P+u*e+w*d;return g};
mat4.rotateX=function(a,f,h){var g=Math.sin(f);f=Math.cos(f);var e=a[4],d=a[5],c=a[6],b=a[7],l=a[8],p=a[9],n=a[10],k=a[11];h?a!==h&&(h[0]=a[0],h[1]=a[1],h[2]=a[2],h[3]=a[3],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]):h=a;h[4]=e*f+l*g;h[5]=d*f+p*g;h[6]=c*f+n*g;h[7]=b*f+k*g;h[8]=e*-g+l*f;h[9]=d*-g+p*f;h[10]=c*-g+n*f;h[11]=b*-g+k*f;return h};
mat4.rotateY=function(a,f,h){var g=Math.sin(f);f=Math.cos(f);var e=a[0],d=a[1],c=a[2],b=a[3],l=a[8],p=a[9],n=a[10],k=a[11];h?a!==h&&(h[4]=a[4],h[5]=a[5],h[6]=a[6],h[7]=a[7],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]):h=a;h[0]=e*f+l*-g;h[1]=d*f+p*-g;h[2]=c*f+n*-g;h[3]=b*f+k*-g;h[8]=e*g+l*f;h[9]=d*g+p*f;h[10]=c*g+n*f;h[11]=b*g+k*f;return h};
mat4.rotateZ=function(a,f,h){var g=Math.sin(f);f=Math.cos(f);var e=a[0],d=a[1],c=a[2],b=a[3],l=a[4],p=a[5],n=a[6],k=a[7];h?a!==h&&(h[8]=a[8],h[9]=a[9],h[10]=a[10],h[11]=a[11],h[12]=a[12],h[13]=a[13],h[14]=a[14],h[15]=a[15]):h=a;h[0]=e*f+l*g;h[1]=d*f+p*g;h[2]=c*f+n*g;h[3]=b*f+k*g;h[4]=e*-g+l*f;h[5]=d*-g+p*f;h[6]=c*-g+n*f;h[7]=b*-g+k*f;return h};
mat4.frustum=function(a,f,h,g,e,d,c){c||(c=mat4.create());var b=f-a,l=g-h,p=d-e;c[0]=2*e/b;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2*e/l;c[6]=0;c[7]=0;c[8]=(f+a)/b;c[9]=(g+h)/l;c[10]=-(d+e)/p;c[11]=-1;c[12]=0;c[13]=0;c[14]=-(d*e*2)/p;c[15]=0;return c};mat4.perspective=function(a,f,h,g,e){a=h*Math.tan(a*Math.PI/360);f*=a;return mat4.frustum(-f,f,-a,a,h,g,e)};
mat4.ortho=function(a,f,h,g,e,d,c){c||(c=mat4.create());var b=f-a,l=g-h,p=d-e;c[0]=2/b;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=2/l;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=-2/p;c[11]=0;c[12]=-(a+f)/b;c[13]=-(g+h)/l;c[14]=-(d+e)/p;c[15]=1;return c};
mat4.lookAt=function(a,f,h,g){g||(g=mat4.create());var e=a[0],d=a[1];a=a[2];var c=h[0];var b=h[1];var l=h[2];h=f[1];var p=f[2];if(e===f[0]&&d===h&&a===p)return mat4.identity(g);h=e-f[0];p=d-f[1];var n=a-f[2];var k=1/Math.sqrt(h*h+p*p+n*n);h*=k;p*=k;n*=k;f=b*n-l*p;l=l*h-c*n;c=c*p-b*h;(k=Math.sqrt(f*f+l*l+c*c))?(k=1/k,f*=k,l*=k,c*=k):c=l=f=0;b=p*c-n*l;var m=n*f-h*c;var q=h*l-p*f;(k=Math.sqrt(b*b+m*m+q*q))?(k=1/k,b*=k,m*=k,q*=k):q=m=b=0;g[0]=f;g[1]=b;g[2]=h;g[3]=0;g[4]=l;g[5]=m;g[6]=p;g[7]=0;g[8]=c;
g[9]=q;g[10]=n;g[11]=0;g[12]=-(f*e+l*d+c*a);g[13]=-(b*e+m*d+q*a);g[14]=-(h*e+p*d+n*a);g[15]=1;return g};mat4.fromRotationTranslation=function(a,f,h){h||(h=mat4.create());var g=a[0],e=a[1],d=a[2],c=a[3],b=g+g,l=e+e,p=d+d;a=g*b;var n=g*l;g*=p;var k=e*l;e*=p;d*=p;b*=c;l*=c;c*=p;h[0]=1-(k+d);h[1]=n+c;h[2]=g-l;h[3]=0;h[4]=n-c;h[5]=1-(a+d);h[6]=e+b;h[7]=0;h[8]=g+l;h[9]=e-b;h[10]=1-(a+k);h[11]=0;h[12]=f[0];h[13]=f[1];h[14]=f[2];h[15]=1;return h};
mat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+"]"};quat4.create=function(a){var f=new MatrixArray(4);a&&(f[0]=a[0],f[1]=a[1],f[2]=a[2],f[3]=a[3]);return f};quat4.set=function(a,f){f[0]=a[0];f[1]=a[1];f[2]=a[2];f[3]=a[3];return f};
quat4.calculateW=function(a,f){var h=a[0],g=a[1],e=a[2];if(!f||a===f)return a[3]=-Math.sqrt(Math.abs(1-h*h-g*g-e*e)),a;f[0]=h;f[1]=g;f[2]=e;f[3]=-Math.sqrt(Math.abs(1-h*h-g*g-e*e));return f};quat4.inverse=function(a,f){if(!f||a===f)return a[0]*=-1,a[1]*=-1,a[2]*=-1,a;f[0]=-a[0];f[1]=-a[1];f[2]=-a[2];f[3]=a[3];return f};quat4.length=function(a){var f=a[0],h=a[1],g=a[2];a=a[3];return Math.sqrt(f*f+h*h+g*g+a*a)};
quat4.normalize=function(a,f){f||(f=a);var h=a[0],g=a[1],e=a[2];a=a[3];var d=Math.sqrt(h*h+g*g+e*e+a*a);if(0===d)return f[0]=0,f[1]=0,f[2]=0,f[3]=0,f;d=1/d;f[0]=h*d;f[1]=g*d;f[2]=e*d;f[3]=a*d;return f};quat4.multiply=function(a,f,h){h||(h=a);var g=a[0],e=a[1],d=a[2];a=a[3];var c=f[0],b=f[1],l=f[2];f=f[3];h[0]=g*f+a*c+e*l-d*b;h[1]=e*f+a*b+d*c-g*l;h[2]=d*f+a*l+g*b-e*c;h[3]=a*f-g*c-e*b-d*l;return h};
quat4.multiplyVec3=function(a,f,h){h||(h=f);var g=f[0],e=f[1],d=f[2];f=a[0];var c=a[1],b=a[2];a=a[3];var l=a*g+c*d-b*e,p=a*e+b*g-f*d,n=a*d+f*e-c*g;g=-f*g-c*e-b*d;h[0]=l*a+g*-f+p*-b-n*-c;h[1]=p*a+g*-c+n*-f-l*-b;h[2]=n*a+g*-b+l*-c-p*-f;return h};quat4.toMat3=function(a,f){f||(f=mat3.create());var h=a[0],g=a[1],e=a[2];a=a[3];var d=h+h,c=g+g,b=e+e,l=h*d,p=h*c;h*=b;var n=g*c;g*=b;e*=b;d*=a;c*=a;a*=b;f[0]=1-(n+e);f[1]=p+a;f[2]=h-c;f[3]=p-a;f[4]=1-(l+e);f[5]=g+d;f[6]=h+c;f[7]=g-d;f[8]=1-(l+n);return f};
quat4.toMat4=function(a,f){f||(f=mat4.create());var h=a[0],g=a[1],e=a[2];a=a[3];var d=h+h,c=g+g,b=e+e,l=h*d,p=h*c;h*=b;var n=g*c;g*=b;e*=b;d*=a;c*=a;a*=b;f[0]=1-(n+e);f[1]=p+a;f[2]=h-c;f[3]=0;f[4]=p-a;f[5]=1-(l+e);f[6]=g+d;f[7]=0;f[8]=h+c;f[9]=g-d;f[10]=1-(l+n);f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};
quat4.slerp=function(a,f,h,g){g||(g=a);var e=a[0]*f[0]+a[1]*f[1]+a[2]*f[2]+a[3]*f[3];if(1<=Math.abs(e))return g!==a&&(g[0]=a[0],g[1]=a[1],g[2]=a[2],g[3]=a[3]),g;var d=Math.acos(e);var c=Math.sqrt(1-e*e);if(.001>Math.abs(c))return g[0]=.5*a[0]+.5*f[0],g[1]=.5*a[1]+.5*f[1],g[2]=.5*a[2]+.5*f[2],g[3]=.5*a[3]+.5*f[3],g;e=Math.sin((1-h)*d)/c;h=Math.sin(h*d)/c;g[0]=a[0]*e+f[0]*h;g[1]=a[1]*e+f[1]*h;g[2]=a[2]*e+f[2]*h;g[3]=a[3]*e+f[3]*h;return g};
quat4.str=function(a){return"["+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+"]"};
(function(){function a(b,a,c){this.isIE=/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent);this.height=this.width=0;this.enableFrontToBack=!!c;this.isBatchInEarlyZPass=this.isEarlyZPass=!1;this.currentZ=0;this.zNear=1;this.zFar=1E3;this.zIncrement=(this.zFar-this.zNear)/32768;this.zA=this.zFar/(this.zFar-this.zNear);this.zB=this.zFar*this.zNear/(this.zNear-this.zFar);this.kzA=65536*this.zA;this.kzB=65536*this.zB;this.cam=vec3.create([0,0,100]);this.look=vec3.create([0,0,0]);this.up=
vec3.create([0,1,0]);this.worldScale=vec3.create([1,1,1]);this.enable_mipmaps=!0;this.matP=mat4.create();this.matMV=mat4.create();this.lastMV=mat4.create();this.currentMV=mat4.create();this.gl=b;this.version=0===this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2")?2:1;this.initState()}function f(b,a,c){this.gl=b;this.shaderProgram=a;this.name=c;this.locAPos=b.getAttribLocation(a,"aPos");this.locATex=b.getAttribLocation(a,"aTex");this.locMatP=b.getUniformLocation(a,"matP");this.locMatMV=b.getUniformLocation(a,
"matMV");this.locOpacity=b.getUniformLocation(a,"opacity");this.locColorFill=b.getUniformLocation(a,"colorFill");this.locSamplerFront=b.getUniformLocation(a,"samplerFront");this.locSamplerBack=b.getUniformLocation(a,"samplerBack");this.locDestStart=b.getUniformLocation(a,"destStart");this.locDestEnd=b.getUniformLocation(a,"destEnd");this.locSeconds=b.getUniformLocation(a,"seconds");this.locPixelWidth=b.getUniformLocation(a,"pixelWidth");this.locPixelHeight=b.getUniformLocation(a,"pixelHeight");this.locLayerScale=
b.getUniformLocation(a,"layerScale");this.locLayerAngle=b.getUniformLocation(a,"layerAngle");this.locViewOrigin=b.getUniformLocation(a,"viewOrigin");this.locScrollPos=b.getUniformLocation(a,"scrollPos");this.hasAnyOptionalUniforms=!!(this.locPixelWidth||this.locPixelHeight||this.locSeconds||this.locSamplerBack||this.locDestStart||this.locDestEnd||this.locLayerScale||this.locLayerAngle||this.locViewOrigin||this.locScrollPos);this.lpPixelHeight=this.lpPixelWidth=-999;this.lpOpacity=1;this.lpDestStartY=
this.lpDestStartX=0;this.lpLayerScale=this.lpDestEndY=this.lpDestEndX=1;this.lpSeconds=this.lpScrollPosY=this.lpScrollPosX=this.lpViewOriginY=this.lpViewOriginX=this.lpLayerAngle=0;this.lastCustomParams=[];this.lpMatMV=mat4.create();this.locOpacity&&b.uniform1f(this.locOpacity,1);this.locColorFill&&b.uniform4f(this.locColorFill,1,1,1,1);this.locSamplerFront&&b.uniform1i(this.locSamplerFront,0);this.locSamplerBack&&b.uniform1i(this.locSamplerBack,1);this.locDestStart&&b.uniform2f(this.locDestStart,
0,0);this.locDestEnd&&b.uniform2f(this.locDestEnd,1,1);this.locLayerScale&&b.uniform1f(this.locLayerScale,1);this.locLayerAngle&&b.uniform1f(this.locLayerAngle,0);this.locViewOrigin&&b.uniform2f(this.locViewOrigin,0,0);this.locScrollPos&&b.uniform2f(this.locScrollPos,0,0);this.locSeconds&&b.uniform1f(this.locSeconds,0);this.hasCurrentMatMV=!1}function h(b,a){return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===a[8]&&b[9]===a[9]&&b[10]===
a[10]&&b[11]===a[11]&&b[12]===a[12]&&b[13]===a[13]&&b[14]===a[14]&&b[15]===a[15]}function g(b,a){this.type=b;this.glwrap=a;this.gl=a.gl;this.indexCount=this.startIndex=this.opacityParam=0;this.mat4param=this.texParam=null;this.shaderParams=[];cr.seal(this)}var e=mat4.create();a.prototype.initState=function(){var b=this.gl,a;this.lastOpacity=1;this.lastTexture1=this.lastTexture0=null;this.currentOpacity=1;b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT);b.enable(b.BLEND);b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA);
b.disable(b.CULL_FACE);b.disable(b.STENCIL_TEST);b.disable(b.DITHER);this.enableFrontToBack?(b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL)):b.disable(b.DEPTH_TEST);this.maxTextureSize=b.getParameter(b.MAX_TEXTURE_SIZE);this.lastSrcBlend=b.ONE;this.lastDestBlend=b.ONE_MINUS_SRC_ALPHA;this.vertexData=new Float32Array(8E3*(this.enableFrontToBack?3:2));this.texcoordData=new Float32Array(16E3);this.pointData=new Float32Array(32E3);this.pointBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this.pointBuffer);
b.bufferData(b.ARRAY_BUFFER,this.pointData.byteLength,b.DYNAMIC_DRAW);this.vertexBuffers=Array(4);this.texcoordBuffers=Array(4);for(a=0;4>a;a++)this.vertexBuffers[a]=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffers[a]),b.bufferData(b.ARRAY_BUFFER,this.vertexData.byteLength,b.DYNAMIC_DRAW),this.texcoordBuffers[a]=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this.texcoordBuffers[a]),b.bufferData(b.ARRAY_BUFFER,this.texcoordData.byteLength,b.DYNAMIC_DRAW);this.curBuffer=0;this.indexBuffer=
b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);for(var c=new Uint16Array(12E3),d=a=0;12E3>a;)c[a++]=d,c[a++]=d+1,c[a++]=d+2,c[a++]=d,c[a++]=d+2,c[a++]=d+3,d+=4;b.bufferData(b.ELEMENT_ARRAY_BUFFER,c,b.STATIC_DRAW);this.pointPtr=this.texPtr=this.vertexPtr=0;this.shaderPrograms=[];a=this.enableFrontToBack?"attribute highp vec3 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, aPos.z, 1.0);\n\tvTex = aTex;\n}":
"attribute highp vec2 aPos;\nattribute mediump vec2 aTex;\nvarying mediump vec2 vTex;\nuniform highp mat4 matP;\nuniform highp mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tvTex = aTex;\n}";c=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp float opacity;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, vTex);\n\tgl_FragColor *= opacity;\n}"},a,"<default>");this.shaderPrograms.push(c);
c=this.createShaderProgram({src:"uniform mediump sampler2D samplerFront;\nvarying lowp float opacity;\nvoid main(void) {\n\tgl_FragColor = texture2D(samplerFront, gl_PointCoord);\n\tgl_FragColor *= opacity;\n}"},"attribute vec4 aPos;\nvarying float opacity;\nuniform mat4 matP;\nuniform mat4 matMV;\nvoid main(void) {\n\tgl_Position = matP * matMV * vec4(aPos.x, aPos.y, 0.0, 1.0);\n\tgl_PointSize = aPos.z;\n\topacity = aPos.w;\n}","<point>");this.shaderPrograms.push(c);c=this.createShaderProgram({src:"varying mediump vec2 vTex;\nuniform lowp sampler2D samplerFront;\nvoid main(void) {\n\tif (texture2D(samplerFront, vTex).a < 1.0)\n\t\tdiscard;\n}"},
a,"<earlyz>");this.shaderPrograms.push(c);c=this.createShaderProgram({src:"uniform lowp vec4 colorFill;\nvoid main(void) {\n\tgl_FragColor = colorFill;\n}"},a,"<fill>");this.shaderPrograms.push(c);for(var k in cr.shaders)cr.shaders.hasOwnProperty(k)&&this.shaderPrograms.push(this.createShaderProgram(cr.shaders[k],a,k));b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,null);this.batch=[];this.batchPtr=0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.currentProgram=this.lastProgram=-1;this.currentShader=
null;this.fbo=b.createFramebuffer();this.depthBuffer=this.renderToTex=null;this.attachedDepthBuffer=!1;this.enableFrontToBack&&(this.depthBuffer=b.createRenderbuffer());this.tmpVec3=vec3.create([0,0,0]);b=b.getParameter(b.ALIASED_POINT_SIZE_RANGE);this.minPointSize=b[0];this.maxPointSize=b[1];2048<this.maxPointSize&&(this.maxPointSize=2048);this.switchProgram(0);cr.seal(this)};f.prototype.updateMatMV=function(b){h(this.lpMatMV,b)||(mat4.set(b,this.lpMatMV),this.gl.uniformMatrix4fv(this.locMatMV,!1,
b))};a.prototype.createShaderProgram=function(b,a,c){var d=this.gl,k=d.createShader(d.FRAGMENT_SHADER);d.shaderSource(k,b.src);d.compileShader(k);if(!d.getShaderParameter(k,d.COMPILE_STATUS))throw b=d.getShaderInfoLog(k),d.deleteShader(k),Error("error compiling fragment shader: "+b);var e=d.createShader(d.VERTEX_SHADER);d.shaderSource(e,a);d.compileShader(e);if(!d.getShaderParameter(e,d.COMPILE_STATUS))throw b=d.getShaderInfoLog(e),d.deleteShader(k),d.deleteShader(e),Error("error compiling vertex shader: "+
b);a=d.createProgram();d.attachShader(a,k);d.attachShader(a,e);d.linkProgram(a);if(!d.getProgramParameter(a,d.LINK_STATUS))throw b=d.getProgramInfoLog(a),d.deleteShader(k),d.deleteShader(e),d.deleteProgram(a),Error("error linking shader program: "+b);d.useProgram(a);d.deleteShader(k);d.deleteShader(e);k=new f(d,a,c);k.extendBoxHorizontal=b.extendBoxHorizontal||0;k.extendBoxVertical=b.extendBoxVertical||0;k.crossSampling=!!b.crossSampling;k.preservesOpaqueness=!!b.preservesOpaqueness;k.animated=!!b.animated;
k.parameters=b.parameters||[];b=0;for(e=k.parameters.length;b<e;b++)k.parameters[b][1]=d.getUniformLocation(a,k.parameters[b][0]),k.lastCustomParams.push(0),d.uniform1f(k.parameters[b][1],0);cr.seal(k);return k};a.prototype.getShaderIndex=function(b){var a;var c=0;for(a=this.shaderPrograms.length;c<a;c++)if(this.shaderPrograms[c].name===b)return c;return-1};a.prototype.project=function(b,a,c){var d=this.matMV,k=this.matP,e=[0,0,0,0,0,0,0,0];e[0]=d[0]*b+d[4]*a+d[12];e[1]=d[1]*b+d[5]*a+d[13];e[2]=d[2]*
b+d[6]*a+d[14];e[3]=d[3]*b+d[7]*a+d[15];e[4]=k[0]*e[0]+k[4]*e[1]+k[8]*e[2]+k[12]*e[3];e[5]=k[1]*e[0]+k[5]*e[1]+k[9]*e[2]+k[13]*e[3];e[6]=k[2]*e[0]+k[6]*e[1]+k[10]*e[2]+k[14]*e[3];e[7]=-e[2];0!==e[7]&&(e[7]=1/e[7],e[4]*=e[7],e[5]*=e[7],e[6]*=e[7],c[0]=(.5*e[4]+.5)*this.width,c[1]=(.5*e[5]+.5)*this.height)};a.prototype.setSize=function(b,a,c){if(this.width!==b||this.height!==a||c){this.endBatch();c=this.gl;this.width=b;this.height=a;c.viewport(0,0,b,a);mat4.lookAt(this.cam,this.look,this.up,this.matMV);
this.enableFrontToBack?(mat4.ortho(-b/2,b/2,a/2,-a/2,this.zNear,this.zFar,this.matP),this.worldScale[0]=1,this.worldScale[1]=1):(mat4.perspective(45,b/a,this.zNear,this.zFar,this.matP),b=[0,0],a=[0,0],this.project(0,0,b),this.project(1,1,a),this.worldScale[0]=1/(a[0]-b[0]),this.worldScale[1]=-1/(a[1]-b[1]));b=0;for(a=this.shaderPrograms.length;b<a;b++){var d=this.shaderPrograms[b];d.hasCurrentMatMV=!1;d.locMatP&&(c.useProgram(d.shaderProgram),c.uniformMatrix4fv(d.locMatP,!1,this.matP))}c.useProgram(this.shaderPrograms[this.lastProgram].shaderProgram);
c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,null);c.activeTexture(c.TEXTURE0);this.lastTexture1=this.lastTexture0=null;this.depthBuffer&&(c.bindFramebuffer(c.FRAMEBUFFER,this.fbo),c.bindRenderbuffer(c.RENDERBUFFER,this.depthBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,this.width,this.height),this.attachedDepthBuffer||(c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,this.depthBuffer),this.attachedDepthBuffer=
!0),c.bindRenderbuffer(c.RENDERBUFFER,null),c.bindFramebuffer(c.FRAMEBUFFER,null),this.renderToTex=null)}};a.prototype.resetModelView=function(){mat4.lookAt(this.cam,this.look,this.up,this.matMV);mat4.scale(this.matMV,this.worldScale)};a.prototype.translate=function(b,a){if(0!==b||0!==a)this.tmpVec3[0]=b,this.tmpVec3[1]=a,this.tmpVec3[2]=0,mat4.translate(this.matMV,this.tmpVec3)};a.prototype.scale=function(b,a){if(1!==b||1!==a)this.tmpVec3[0]=b,this.tmpVec3[1]=a,this.tmpVec3[2]=1,mat4.scale(this.matMV,
this.tmpVec3)};a.prototype.rotateZ=function(b){0!==b&&mat4.rotateZ(this.matMV,b)};a.prototype.updateModelView=function(){if(!h(this.lastMV,this.matMV)){var b=this.pushBatch();b.type=5;b.mat4param?mat4.set(this.matMV,b.mat4param):b.mat4param=mat4.create(this.matMV);mat4.set(this.matMV,this.lastMV);this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setEarlyZIndex=function(b){this.enableFrontToBack&&(32760<b&&(b=32760),this.currentZ=this.cam[2]-this.zNear-b*this.zIncrement)};g.prototype.doSetEarlyZPass=
function(){var b=this.gl,a=this.glwrap;0!==this.startIndex?(b.depthMask(!0),b.colorMask(!1,!1,!1,!1),b.disable(b.BLEND),b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),b.clear(b.DEPTH_BUFFER_BIT),b.bindFramebuffer(b.FRAMEBUFFER,null),a.isBatchInEarlyZPass=!0):(b.depthMask(!1),b.colorMask(!0,!0,!0,!0),b.enable(b.BLEND),a.isBatchInEarlyZPass=!1)};g.prototype.doSetTexture=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.texParam)};
g.prototype.doSetTexture1=function(){var b=this.gl;b.activeTexture(b.TEXTURE1);b.bindTexture(b.TEXTURE_2D,this.texParam);b.activeTexture(b.TEXTURE0)};g.prototype.doSetOpacity=function(){var b=this.opacityParam,a=this.glwrap;a.currentOpacity=b;a=a.currentShader;a.locOpacity&&a.lpOpacity!==b&&(a.lpOpacity=b,this.gl.uniform1f(a.locOpacity,b))};g.prototype.doQuad=function(){this.gl.drawElements(this.gl.TRIANGLES,this.indexCount,this.gl.UNSIGNED_SHORT,this.startIndex)};g.prototype.doSetBlend=function(){this.gl.blendFunc(this.startIndex,
this.indexCount)};g.prototype.doUpdateModelView=function(){var b,a=this.glwrap.shaderPrograms,c=this.glwrap.currentProgram;var d=0;for(b=a.length;d<b;d++){var k=a[d];d===c&&k.locMatMV?(k.updateMatMV(this.mat4param),k.hasCurrentMatMV=!0):k.hasCurrentMatMV=!1}mat4.set(this.mat4param,this.glwrap.currentMV)};g.prototype.doRenderToTexture=function(){var b=this.gl,a=this.glwrap;this.texParam?(a.lastTexture1===this.texParam&&(b.activeTexture(b.TEXTURE1),b.bindTexture(b.TEXTURE_2D,null),a.lastTexture1=null,
b.activeTexture(b.TEXTURE0)),b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),a.isBatchInEarlyZPass||b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this.texParam,0)):(a.enableFrontToBack||b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,null,0),b.bindFramebuffer(b.FRAMEBUFFER,null))};g.prototype.doClear=function(){var b=this.gl,a=this.startIndex;0===a?(b.clearColor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),b.clear(b.COLOR_BUFFER_BIT)):
1===a?(b.enable(b.SCISSOR_TEST),b.scissor(this.mat4param[0],this.mat4param[1],this.mat4param[2],this.mat4param[3]),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),b.disable(b.SCISSOR_TEST)):b.clear(b.DEPTH_BUFFER_BIT)};g.prototype.doSetDepthTestEnabled=function(){var b=this.gl;0!==this.startIndex?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST)};g.prototype.doPoints=function(){var b=this.gl,a=this.glwrap;a.enableFrontToBack&&b.disable(b.DEPTH_TEST);var c=a.shaderPrograms[1];b.useProgram(c.shaderProgram);
!c.hasCurrentMatMV&&c.locMatMV&&(c.updateMatMV(a.currentMV),c.hasCurrentMatMV=!0);b.enableVertexAttribArray(c.locAPos);b.bindBuffer(b.ARRAY_BUFFER,a.pointBuffer);b.vertexAttribPointer(c.locAPos,4,b.FLOAT,!1,0,0);b.drawArrays(b.POINTS,this.startIndex/4,this.indexCount);c=a.currentShader;b.useProgram(c.shaderProgram);0<=c.locAPos&&(b.enableVertexAttribArray(c.locAPos),b.bindBuffer(b.ARRAY_BUFFER,a.vertexBuffers[a.curBuffer]),b.vertexAttribPointer(c.locAPos,a.enableFrontToBack?3:2,b.FLOAT,!1,0,0));0<=
c.locATex&&(b.enableVertexAttribArray(c.locATex),b.bindBuffer(b.ARRAY_BUFFER,a.texcoordBuffers[a.curBuffer]),b.vertexAttribPointer(c.locATex,2,b.FLOAT,!1,0,0));a.enableFrontToBack&&b.enable(b.DEPTH_TEST)};g.prototype.doSetProgram=function(){var b=this.gl,a=this.glwrap,c=a.shaderPrograms[this.startIndex];a.currentProgram=this.startIndex;a.currentShader=c;b.useProgram(c.shaderProgram);!c.hasCurrentMatMV&&c.locMatMV&&(c.updateMatMV(a.currentMV),c.hasCurrentMatMV=!0);c.locOpacity&&c.lpOpacity!==a.currentOpacity&&
(c.lpOpacity=a.currentOpacity,b.uniform1f(c.locOpacity,a.currentOpacity));0<=c.locAPos&&(b.enableVertexAttribArray(c.locAPos),b.bindBuffer(b.ARRAY_BUFFER,a.vertexBuffers[a.curBuffer]),b.vertexAttribPointer(c.locAPos,a.enableFrontToBack?3:2,b.FLOAT,!1,0,0));0<=c.locATex&&(b.enableVertexAttribArray(c.locATex),b.bindBuffer(b.ARRAY_BUFFER,a.texcoordBuffers[a.curBuffer]),b.vertexAttribPointer(c.locATex,2,b.FLOAT,!1,0,0))};g.prototype.doSetColor=function(){var b=this.mat4param;this.gl.uniform4f(this.glwrap.currentShader.locColorFill,
b[0],b[1],b[2],b[3])};g.prototype.doSetProgramParameters=function(){var b=this.glwrap.currentShader,a=this.gl;var c=this.mat4param;b.locSamplerBack&&this.glwrap.lastTexture1!==this.texParam&&(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this.texParam),this.glwrap.lastTexture1=this.texParam,a.activeTexture(a.TEXTURE0));var d=c[0];b.locPixelWidth&&d!==b.lpPixelWidth&&(b.lpPixelWidth=d,a.uniform1f(b.locPixelWidth,d));d=c[1];b.locPixelHeight&&d!==b.lpPixelHeight&&(b.lpPixelHeight=d,a.uniform1f(b.locPixelHeight,
d));d=c[2];var k=c[3];!b.locDestStart||d===b.lpDestStartX&&k===b.lpDestStartY||(b.lpDestStartX=d,b.lpDestStartY=k,a.uniform2f(b.locDestStart,d,k));d=c[4];k=c[5];!b.locDestEnd||d===b.lpDestEndX&&k===b.lpDestEndY||(b.lpDestEndX=d,b.lpDestEndY=k,a.uniform2f(b.locDestEnd,d,k));d=c[6];b.locLayerScale&&d!==b.lpLayerScale&&(b.lpLayerScale=d,a.uniform1f(b.locLayerScale,d));d=c[7];b.locLayerAngle&&d!==b.lpLayerAngle&&(b.lpLayerAngle=d,a.uniform1f(b.locLayerAngle,d));d=c[8];k=c[9];!b.locViewOrigin||d===b.lpViewOriginX&&
k===b.lpViewOriginY||(b.lpViewOriginX=d,b.lpViewOriginY=k,a.uniform2f(b.locViewOrigin,d,k));d=c[10];k=c[11];!b.locScrollPos||d===b.lpScrollPosX&&k===b.lpScrollPosY||(b.lpScrollPosX=d,b.lpScrollPosY=k,a.uniform2f(b.locScrollPos,d,k));d=c[12];b.locSeconds&&d!==b.lpSeconds&&(b.lpSeconds=d,a.uniform1f(b.locSeconds,d));if(b.parameters.length)for(c=0,k=b.parameters.length;c<k;c++)d=this.shaderParams[c],d!==b.lastCustomParams[c]&&(b.lastCustomParams[c]=d,a.uniform1f(b.parameters[c][1],d))};a.prototype.pushBatch=
function(){this.batchPtr===this.batch.length&&this.batch.push(new g(0,this));return this.batch[this.batchPtr++]};a.prototype.endBatch=function(){if(0!==this.batchPtr&&!this.gl.isContextLost()){var b=this.gl;0<this.pointPtr&&(b.bindBuffer(b.ARRAY_BUFFER,this.pointBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.pointData.subarray(0,this.pointPtr)),a&&0<=a.locAPos&&"<point>"===a.name&&b.vertexAttribPointer(a.locAPos,4,b.FLOAT,!1,0,0));if(0<this.vertexPtr){var a=this.currentShader;b.bindBuffer(b.ARRAY_BUFFER,
this.vertexBuffers[this.curBuffer]);b.bufferSubData(b.ARRAY_BUFFER,0,this.vertexData.subarray(0,this.vertexPtr));a&&0<=a.locAPos&&"<point>"!==a.name&&b.vertexAttribPointer(a.locAPos,this.enableFrontToBack?3:2,b.FLOAT,!1,0,0);b.bindBuffer(b.ARRAY_BUFFER,this.texcoordBuffers[this.curBuffer]);b.bufferSubData(b.ARRAY_BUFFER,0,this.texcoordData.subarray(0,this.texPtr));a&&0<=a.locATex&&"<point>"!==a.name&&b.vertexAttribPointer(a.locATex,2,b.FLOAT,!1,0,0)}b=0;for(a=this.batchPtr;b<a;b++){var c=this.batch[b];
switch(c.type){case 1:c.doQuad();break;case 2:c.doSetTexture();break;case 3:c.doSetOpacity();break;case 4:c.doSetBlend();break;case 5:c.doUpdateModelView();break;case 6:c.doRenderToTexture();break;case 7:c.doClear();break;case 8:c.doPoints();break;case 9:c.doSetProgram();break;case 10:c.doSetProgramParameters();break;case 11:c.doSetTexture1();break;case 12:c.doSetColor();break;case 13:c.doSetDepthTestEnabled();break;case 14:c.doSetEarlyZPass()}}this.pointPtr=this.texPtr=this.vertexPtr=this.batchPtr=
0;this.isBatchInEarlyZPass=this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.curBuffer++;4<=this.curBuffer&&(this.curBuffer=0)}};a.prototype.setOpacity=function(b){if(b!==this.lastOpacity&&!this.isEarlyZPass){var a=this.pushBatch();a.type=3;this.lastOpacity=a.opacityParam=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setTexture=function(b){if(b!==this.lastTexture0){var a=this.pushBatch();a.type=2;this.lastTexture0=a.texParam=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.setBlend=
function(b,a){if((b!==this.lastSrcBlend||a!==this.lastDestBlend)&&!this.isEarlyZPass){var c=this.pushBatch();c.type=4;c.startIndex=b;c.indexCount=a;this.lastSrcBlend=b;this.lastDestBlend=a;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.isPremultipliedAlphaBlend=function(){return this.lastSrcBlend===this.gl.ONE&&this.lastDestBlend===this.gl.ONE_MINUS_SRC_ALPHA};a.prototype.setAlphaBlend=function(){this.setBlend(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA)};a.prototype.setNoPremultiplyAlphaBlend=
function(){this.setBlend(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)};a.prototype.quad=function(b,a,c,d,k,e,f,g){15992<=this.vertexPtr&&this.endBatch();var m=this.vertexPtr,h=this.texPtr,l=this.vertexData,q=this.texcoordData,w=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var n=this.pushBatch();n.type=1;n.startIndex=this.enableFrontToBack?m:m/2*3;n.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(l[m++]=b,l[m++]=a,l[m++]=
w,l[m++]=c,l[m++]=d,l[m++]=w,l[m++]=k,l[m++]=e,l[m++]=w,l[m++]=f,l[m++]=g,l[m++]=w):(l[m++]=b,l[m++]=a,l[m++]=c,l[m++]=d,l[m++]=k,l[m++]=e,l[m++]=f,l[m++]=g);q[h++]=0;q[h++]=0;q[h++]=1;q[h++]=0;q[h++]=1;q[h++]=1;q[h++]=0;q[h++]=1;this.vertexPtr=m;this.texPtr=h};a.prototype.quadTex=function(b,a,c,d,k,e,f,g,h){15992<=this.vertexPtr&&this.endBatch();var m=this.vertexPtr,l=this.texPtr,q=this.vertexData,w=this.texcoordData,n=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=
6;else{var p=this.pushBatch();p.type=1;p.startIndex=this.enableFrontToBack?m:m/2*3;p.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}p=h.left;var v=h.top,r=h.right;h=h.bottom;this.enableFrontToBack?(q[m++]=b,q[m++]=a,q[m++]=n,q[m++]=c,q[m++]=d,q[m++]=n,q[m++]=k,q[m++]=e,q[m++]=n,q[m++]=f,q[m++]=g,q[m++]=n):(q[m++]=b,q[m++]=a,q[m++]=c,q[m++]=d,q[m++]=k,q[m++]=e,q[m++]=f,q[m++]=g);w[l++]=p;w[l++]=v;w[l++]=r;w[l++]=v;w[l++]=r;w[l++]=h;w[l++]=p;w[l++]=h;this.vertexPtr=m;this.texPtr=l};a.prototype.quadTexUV=
function(b,a,c,d,k,e,f,g,h,y,B,x,w,A,D,G){15992<=this.vertexPtr&&this.endBatch();var m=this.vertexPtr,l=this.texPtr,q=this.vertexData,n=this.texcoordData,p=this.currentZ;if(this.hasQuadBatchTop)this.batch[this.batchPtr-1].indexCount+=6;else{var v=this.pushBatch();v.type=1;v.startIndex=this.enableFrontToBack?m:m/2*3;v.indexCount=6;this.hasQuadBatchTop=!0;this.hasPointBatchTop=!1}this.enableFrontToBack?(q[m++]=b,q[m++]=a,q[m++]=p,q[m++]=c,q[m++]=d,q[m++]=p,q[m++]=k,q[m++]=e,q[m++]=p,q[m++]=f,q[m++]=
g,q[m++]=p):(q[m++]=b,q[m++]=a,q[m++]=c,q[m++]=d,q[m++]=k,q[m++]=e,q[m++]=f,q[m++]=g);n[l++]=h;n[l++]=y;n[l++]=B;n[l++]=x;n[l++]=w;n[l++]=A;n[l++]=D;n[l++]=G;this.vertexPtr=m;this.texPtr=l};a.prototype.convexPoly=function(b){var a=b.length/2-2,c=a-1,d=b[0],k=b[1],e;for(e=0;e<a;e+=2){var f=2*e;var g=b[f+2];var h=b[f+3];var y=b[f+4];var B=b[f+5];if(e===c)this.quad(d,k,g,h,y,B,y,B);else{var x=b[f+6];f=b[f+7];this.quad(d,k,g,h,y,B,x,f)}}};a.prototype.point=function(b,a,c,d){7996<=this.pointPtr&&this.endBatch();
var k=this.pointPtr,e=this.pointData;if(this.hasPointBatchTop)this.batch[this.batchPtr-1].indexCount++;else{var f=this.pushBatch();f.type=8;f.startIndex=k;f.indexCount=1;this.hasPointBatchTop=!0;this.hasQuadBatchTop=!1}e[k++]=b;e[k++]=a;e[k++]=c;e[k++]=d;this.pointPtr=k};a.prototype.switchProgram=function(b){if(this.lastProgram!==b){if(!this.shaderPrograms[b]){if(0===this.lastProgram)return;b=0}var a=this.pushBatch();a.type=9;this.lastProgram=a.startIndex=b;this.hasPointBatchTop=this.hasQuadBatchTop=
!1}};a.prototype.programUsesDest=function(b){b=this.shaderPrograms[b];return!(!b.locDestStart&&!b.locDestEnd)};a.prototype.programUsesCrossSampling=function(b){b=this.shaderPrograms[b];return!!(b.locDestStart||b.locDestEnd||b.crossSampling)};a.prototype.programPreservesOpaqueness=function(b){return this.shaderPrograms[b].preservesOpaqueness};a.prototype.programExtendsBox=function(b){b=this.shaderPrograms[b];return 0!==b.extendBoxHorizontal||0!==b.extendBoxVertical};a.prototype.getProgramBoxExtendHorizontal=
function(b){return this.shaderPrograms[b].extendBoxHorizontal};a.prototype.getProgramBoxExtendVertical=function(b){return this.shaderPrograms[b].extendBoxVertical};a.prototype.getProgramParameterType=function(b,a){return this.shaderPrograms[b].parameters[a][2]};a.prototype.programIsAnimated=function(b){return this.shaderPrograms[b].animated};a.prototype.setProgramParameters=function(b,a,c,d,k,e,f,g,h,y,B,x,w,A,D){var m=this.shaderPrograms[this.lastProgram];if(m.hasAnyOptionalUniforms||D.length){var l=
this.pushBatch();l.type=10;l.mat4param?mat4.set(this.matMV,l.mat4param):l.mat4param=mat4.create();var t=l.mat4param;t[0]=a;t[1]=c;t[2]=d;t[3]=k;t[4]=e;t[5]=f;t[6]=g;t[7]=h;t[8]=y;t[9]=B;t[10]=x;t[11]=w;t[12]=A;l.texParam=m.locSamplerBack?b:null;if(D.length)for(c=l.shaderParams,c.length=D.length,b=0,a=D.length;b<a;b++)c[b]=D[b];this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.clear=function(b,a,c,d){var k=this.pushBatch();k.type=7;k.startIndex=0;k.mat4param||(k.mat4param=mat4.create());
k.mat4param[0]=b;k.mat4param[1]=a;k.mat4param[2]=c;k.mat4param[3]=d;this.hasPointBatchTop=this.hasQuadBatchTop=!1};a.prototype.clearRect=function(b,a,c,d){if(!(0>c||0>d)){var k=this.pushBatch();k.type=7;k.startIndex=1;k.mat4param||(k.mat4param=mat4.create());k.mat4param[0]=b;k.mat4param[1]=a;k.mat4param[2]=c;k.mat4param[3]=d;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.clearDepth=function(){var b=this.pushBatch();b.type=7;b.startIndex=2;this.hasPointBatchTop=this.hasQuadBatchTop=!1};
a.prototype.setEarlyZPass=function(b){if(this.enableFrontToBack&&(b=!!b,this.isEarlyZPass!==b)){var a=this.pushBatch();a.type=14;a.startIndex=b?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1;this.isEarlyZPass=b;this.renderToTex=null;this.isEarlyZPass?this.switchProgram(2):this.switchProgram(0)}};a.prototype.setDepthTestEnabled=function(b){if(this.enableFrontToBack){var a=this.pushBatch();a.type=13;a.startIndex=b?1:0;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};a.prototype.fullscreenQuad=function(){mat4.set(this.lastMV,
e);this.resetModelView();this.updateModelView();var b=this.width/2,a=this.height/2;this.quad(-b,a,b,a,b,-a,-b,-a);mat4.set(e,this.matMV);this.updateModelView()};a.prototype.setColorFillMode=function(b,a,c,d){this.switchProgram(3);var k=this.pushBatch();k.type=12;k.mat4param||(k.mat4param=mat4.create());k.mat4param[0]=b;k.mat4param[1]=a;k.mat4param[2]=c;k.mat4param[3]=d;this.hasPointBatchTop=this.hasQuadBatchTop=!1};a.prototype.setTextureFillMode=function(){this.switchProgram(0)};a.prototype.restoreEarlyZMode=
function(){this.switchProgram(2)};a.prototype.present=function(){this.endBatch();this.gl.flush()};var d=[],c={};a.prototype.contextLost=function(){cr.clearArray(d);c={}};a.prototype.loadTexture=function(b,a,e,f,k,m){a=!!a;e=!!e;var g=b.src+","+a+","+e+(a?","+k:"");if("undefined"!==typeof b.src&&c.hasOwnProperty(g)){var h=c[g];h.c2refcount++;return h}this.endBatch();var l=this.gl,n=cr.isPOT(b.width)&&cr.isPOT(b.height);h=l.createTexture();l.bindTexture(l.TEXTURE_2D,h);l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);var p=l.RGBA,x=l.RGBA,w=l.UNSIGNED_BYTE;if(f&&!this.isIE)switch(f){case 1:x=p=l.RGB;break;case 2:w=l.UNSIGNED_SHORT_4_4_4_4;break;case 3:w=l.UNSIGNED_SHORT_5_5_5_1;break;case 4:x=p=l.RGB,w=l.UNSIGNED_SHORT_5_6_5}if(1===this.version&&!n&&a){f=document.createElement("canvas");f.width=cr.nextHighestPowerOfTwo(b.width);f.height=cr.nextHighestPowerOfTwo(b.height);var A=f.getContext("2d");"undefined"!==typeof A.imageSmoothingEnabled?A.imageSmoothingEnabled=e:(A.webkitImageSmoothingEnabled=e,A.mozImageSmoothingEnabled=
e,A.msImageSmoothingEnabled=e);A.drawImage(b,0,0,b.width,b.height,0,0,f.width,f.height);l.texImage2D(l.TEXTURE_2D,0,p,x,w,f)}else l.texImage2D(l.TEXTURE_2D,0,p,x,w,b);a?"repeat-x"===k?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)):("repeat-y"===k?l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE):l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.REPEAT),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.REPEAT)):(l.texParameteri(l.TEXTURE_2D,
l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE));e?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),(n||2<=this.version)&&this.enable_mipmaps&&!m?(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR_MIPMAP_LINEAR),l.generateMipmap(l.TEXTURE_2D)):l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR)):(l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST));l.bindTexture(l.TEXTURE_2D,
null);this.lastTexture0=null;h.c2width=b.width;h.c2height=b.height;h.c2refcount=1;h.c2texkey=g;d.push(h);return c[g]=h};a.prototype.createEmptyTexture=function(b,a,c,e,k){this.endBatch();var f=this.gl;this.isIE&&(e=!1);var g=f.createTexture();f.bindTexture(f.TEXTURE_2D,g);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b,a,0,f.RGBA,e?f.UNSIGNED_SHORT_4_4_4_4:f.UNSIGNED_BYTE,null);k?(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT)):(f.texParameteri(f.TEXTURE_2D,
f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE));f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,c?f.LINEAR:f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,c?f.LINEAR:f.NEAREST);f.bindTexture(f.TEXTURE_2D,null);this.lastTexture0=null;g.c2width=b;g.c2height=a;d.push(g);return g};a.prototype.videoToTexture=function(b,a,c){this.endBatch();var d=this.gl;this.isIE&&(c=!1);d.bindTexture(d.TEXTURE_2D,a);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,
!0);try{d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,c?d.UNSIGNED_SHORT_4_4_4_4:d.UNSIGNED_BYTE,b)}catch(k){console&&console.error&&console.error("Error updating WebGL texture: ",k)}d.bindTexture(d.TEXTURE_2D,null);this.lastTexture0=null};a.prototype.deleteTexture=function(b){b&&("undefined"!==typeof b.c2refcount&&1<b.c2refcount?b.c2refcount--:(this.endBatch(),b===this.lastTexture0&&(this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.lastTexture0=null),b===this.lastTexture1&&(this.gl.activeTexture(this.gl.TEXTURE1),
this.gl.bindTexture(this.gl.TEXTURE_2D,null),this.gl.activeTexture(this.gl.TEXTURE0),this.lastTexture1=null),cr.arrayFindRemove(d,b),"undefined"!==typeof b.c2texkey&&delete c[b.c2texkey],this.gl.deleteTexture(b)))};a.prototype.estimateVRAM=function(){var b=this.width*this.height*8,a;var c=0;for(a=d.length;c<a;c++){var e=d[c];b+=e.c2width*e.c2height*4}return b};a.prototype.textureCount=function(){return d.length};a.prototype.setRenderingToTexture=function(b){if(b!==this.renderToTex){var a=this.pushBatch();
a.type=6;this.renderToTex=a.texParam=b;this.hasPointBatchTop=this.hasQuadBatchTop=!1}};cr.GLWrap=a})();
(function(){function a(b){if(b&&(b.getContext||b.dc)&&!b.c2runtime){b.c2runtime=this;var a=this;this.isPhoneGap=this.isCordova=(this.isCrosswalk=/crosswalk/i.test(navigator.userAgent)||/xwalk/i.test(navigator.userAgent)||!("undefined"===typeof window.c2isCrosswalk||!window.c2isCrosswalk))||"undefined"!==typeof window.device&&("undefined"!==typeof window.device.cordova||"undefined"!==typeof window.device.phonegap)||"undefined"!==typeof window.c2iscordova&&window.c2iscordova;this.isDirectCanvas=!!b.dc;
this.isAppMobi="undefined"!==typeof window.AppMobi||this.isDirectCanvas;this.isCocoonJs=!!window.c2cocoonjs;this.isEjecta=!!window.c2ejecta;this.isCocoonJs&&(CocoonJS.App.onSuspended.addEventListener(function(){a.setSuspended(!0)}),CocoonJS.App.onActivated.addEventListener(function(){a.setSuspended(!1)}));this.isEjecta&&(document.addEventListener("pagehide",function(){a.setSuspended(!0)}),document.addEventListener("pageshow",function(){a.setSuspended(!1)}),document.addEventListener("resize",function(){a.setSize(window.innerWidth,
window.innerHeight)}));this.isDomFree=this.isDirectCanvas||this.isCocoonJs||this.isEjecta;this.isMicrosoftEdge=/edge\//i.test(navigator.userAgent);this.isIE=(/msie/i.test(navigator.userAgent)||/trident/i.test(navigator.userAgent)||/iemobile/i.test(navigator.userAgent))&&!this.isMicrosoftEdge;this.isTizen=/tizen/i.test(navigator.userAgent);this.isAndroid=/android/i.test(navigator.userAgent)&&!this.isTizen&&!this.isIE&&!this.isMicrosoftEdge;this.isiPhone=(/iphone/i.test(navigator.userAgent)||/ipod/i.test(navigator.userAgent))&&
!this.isIE&&!this.isMicrosoftEdge;this.isiPad=/ipad/i.test(navigator.userAgent);this.isiOS=this.isiPhone||this.isiPad||this.isEjecta;this.isiPhoneiOS6=this.isiPhone&&/os\s6/i.test(navigator.userAgent);this.isChrome=(/chrome/i.test(navigator.userAgent)||/chromium/i.test(navigator.userAgent))&&!this.isIE&&!this.isMicrosoftEdge;this.isAmazonWebApp=/amazonwebappplatform/i.test(navigator.userAgent);this.isFirefox=/firefox/i.test(navigator.userAgent);this.isSafari=/safari/i.test(navigator.userAgent)&&!this.isChrome&&
!this.isIE&&!this.isMicrosoftEdge;this.isWindows=/windows/i.test(navigator.userAgent);this.isNodeWebkit=this.isNWjs="undefined"!==typeof window.c2nodewebkit||"undefined"!==typeof window.c2nwjs||/nodewebkit/i.test(navigator.userAgent)||/nwjs/i.test(navigator.userAgent);this.isArcade="undefined"!==typeof window.is_scirra_arcade;this.isWindows8App=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.isWindows8Capable=!("undefined"===typeof window.c2isWindows8Capable||!window.c2isWindows8Capable);
this.isWindowsPhone8=!("undefined"===typeof window.c2isWindowsPhone8||!window.c2isWindowsPhone8);this.isWindowsPhone81=!("undefined"===typeof window.c2isWindowsPhone81||!window.c2isWindowsPhone81);this.isWindows10=!!window.cr_windows10;this.isWinJS=this.isWindows8App||this.isWindows8Capable||this.isWindowsPhone81||this.isWindows10;this.isBlackberry10=!("undefined"===typeof window.c2isBlackberry10||!window.c2isBlackberry10);this.isAndroidStockBrowser=this.isAndroid&&!this.isChrome&&!this.isCrosswalk&&
!this.isFirefox&&!this.isAmazonWebApp&&!this.isDomFree;this.devicePixelRatio=1;this.isMobile=this.isCordova||this.isCrosswalk||this.isAppMobi||this.isCocoonJs||this.isAndroid||this.isiOS||this.isWindowsPhone8||this.isWindowsPhone81||this.isBlackberry10||this.isTizen||this.isEjecta;this.isMobile||(this.isMobile=/(blackberry|bb10|playbook|palm|symbian|nokia|windows\s+ce|phone|mobile|tablet|kindle|silk)/i.test(navigator.userAgent));this.isWKWebView=!!(this.isiOS&&this.isCordova&&window.webkit);"undefined"===
typeof cr_is_preview||this.isNWjs||"?nw"!==window.location.search&&!/nodewebkit/i.test(navigator.userAgent)&&!/nwjs/i.test(navigator.userAgent)||(this.isNWjs=!0);this.isDebug="undefined"!==typeof cr_is_preview&&-1<window.location.search.indexOf("debug");this.canvas=b;this.canvasdiv=document.getElementById("c2canvasdiv");this.glwrap=this.gl=null;this.glUnmaskedRenderer="(unavailable)";this.enableFrontToBack=!1;this.earlyz_index=0;this.ctx=null;this.firstInFullscreen=!1;this.oldHeight=this.oldWidth=
0;this.canvas.oncontextmenu=function(b){b.preventDefault&&b.preventDefault();return!1};this.canvas.onselectstart=function(b){b.preventDefault&&b.preventDefault();return!1};this.canvas.ontouchstart=function(b){b.preventDefault&&b.preventDefault();return!1};this.isDirectCanvas&&(window.c2runtime=this);this.isNWjs&&(window.ondragover=function(b){b.preventDefault();return!1},window.ondrop=function(b){b.preventDefault();return!1},window.nwgui&&window.nwgui.App.clearCache&&window.nwgui.App.clearCache());
this.isAndroidStockBrowser&&"undefined"!==typeof jQuery&&jQuery("canvas").parents("*").css("overflow","visible");this.width=b.width;this.height=b.height;this.draw_width=this.width;this.draw_height=this.height;this.cssWidth=this.width;this.cssHeight=this.height;this.lastWindowWidth=window.innerWidth;this.lastWindowHeight=window.innerHeight;this.forceCanvasAlpha=!1;this.redraw=!0;this.isSuspended=!1;Date.now||(Date.now=function(){return+new Date});this.plugins=[];this.types={};this.types_by_index=[];
this.behaviors=[];this.layouts={};this.layouts_by_index=[];this.eventsheets={};this.eventsheets_by_index=[];this.wait_for_textures=[];this.triggers_to_postinit=[];this.all_global_vars=[];this.all_local_vars=[];this.shadowcasterBehavior=this.jumpthruBehavior=this.solidBehavior=null;this.deathRow={};this.isInClearDeathRow=this.hasPendingInstances=!1;this.isInOnDestroy=0;this.isEndingLayout=this.isRunningEvents=!1;this.createRow=[];this.isLoadingState=!1;this.loadFromSlot=this.saveToSlot="";this.loadFromJson=
null;this.lastSaveJson="";this.suspendDrawing=this.signalledContinuousPreview=!1;this.fireOnCreateAfterLoad=[];this.dt1=this.dt=0;this.minimumFramerate=30;this.cpuutilisation=this.logictime=0;this.timescale=1;this.kahanTime=new cr.KahanAdder;this.wallTime=new cr.KahanAdder;this.objectcount=this.framecount=this.execcount=this.tickcount_nosave=this.tickcount=this.last_fps_time=this.fps=this.last_tick_time=0;this.changelayout=null;this.destroycallbacks=[];this.event_stack=[];this.event_stack_index=-1;
this.localvar_stack=[[]];this.trigger_depth=this.localvar_stack_index=0;this.pushEventStack(null);this.loop_stack=[];this.loop_stack_index=-1;this.next_puid=this.next_uid=0;this.layout_first_tick=!0;this.family_count=0;this.suspend_events=[];this.timeout_id=this.raf_id=-1;this.isloading=!0;this.loadingprogress=0;this.isNodeFullscreen=!1;this.stackLocalCount=0;this.audioInstance=null;this.isInUserInputEvent=this.had_a_click=!1;this.objects_to_pretick=new cr.ObjectSet;this.objects_to_tick=new cr.ObjectSet;
this.objects_to_tick2=new cr.ObjectSet;this.registered_collisions=[];this.temp_poly=new cr.CollisionPoly([]);this.temp_poly2=new cr.CollisionPoly([]);this.allGroups=[];this.groups_by_name={};this.cndsBySid={};this.actsBySid={};this.varsBySid={};this.blocksBySid={};this.layout_ctx=this.layout_canvas=this.layout_tex=this.layer_tex=this.layer_ctx=this.layer_canvas=this.running_layout=null;this.uses_background_blending=this.is_WebGL_context_lost=!1;this.fx_tex=[null,null];this.fullscreen_scaling=0;this.files_subfolder=
"";this.objectsByUid={};this.snapshotCanvas=this.loaderlogos=null;this.snapshotData="";this.objectRefTable=[];this.requestProjectData()}}function f(b,a){return 128>=a?b[3]:256>=a?b[2]:512>=a?b[1]:b[0]}function h(){try{return!!window.indexedDB}catch(E){return!1}}function g(b){b.target.result.createObjectStore("saves",{keyPath:"slot"})}function e(b,a,c,k){try{var d=indexedDB.open("_C2SaveStates");d.onupgradeneeded=g;d.onerror=k;d.onsuccess=function(d){d=d.target.result;d.onerror=k;d.transaction(["saves"],
"readwrite").objectStore("saves").put({slot:b,data:a}).onsuccess=c}}catch(U){k(U)}}function d(b,a,c){try{var k=indexedDB.open("_C2SaveStates");k.onupgradeneeded=g;k.onerror=c;k.onsuccess=function(k){k=k.target.result;k.onerror=c;var d=k.transaction(["saves"]).objectStore("saves").get(b);d.onsuccess=function(b){d.result?a(d.result.data):a(null)}}}catch(F){c(F)}}function c(){cr.logexport("Reloading for continuous preview");window.c2cocoonjs?CocoonJS.App.reload():-1<window.location.search.indexOf("continuous")?
window.location.reload(!0):window.location+="?continuous"}function b(b){var a,c={};for(a in b)!b.hasOwnProperty(a)||b[a]instanceof cr.ObjectSet||b[a]&&"undefined"!==typeof b[a].c2userdata||"spriteCreatedDestroyCallback"!==a&&(c[a]=b[a]);return c}var l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;a.prototype.requestProjectData=function(){var b=this;if(this.isWKWebView)this.fetchLocalFileViaCordovaAsText("data.js",
function(a){b.loadProject(JSON.parse(a))},function(b){alert("Error fetching data.js")});else{var a=this.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;var c="data.js";if(this.isWindows8App||this.isWindowsPhone8||this.isWindowsPhone81||this.isWindows10)c="data.json";a.open("GET",c,!0);var k=!1;if(!this.isDomFree&&"response"in a&&"responseType"in a)try{a.responseType="json",k="json"===a.responseType}catch(F){k=!1}if(!k&&"responseType"in a)try{a.responseType="text"}catch(F){}if("overrideMimeType"in
a)try{a.overrideMimeType("application/json; charset=utf-8")}catch(F){}this.isWindowsPhone8?a.onreadystatechange=function(){4===a.readyState&&b.loadProject(JSON.parse(a.responseText))}:(a.onload=function(){if(k)b.loadProject(a.response);else if(b.isEjecta){var c=a.responseText;c=c.substr(c.indexOf("{"));b.loadProject(JSON.parse(c))}else b.loadProject(JSON.parse(a.responseText))},a.onerror=function(b){cr.logerror("Error requesting "+c+":");cr.logerror(b)});a.send()}};a.prototype.initRendererAndLoader=
function(){var b=this,a,c;this.isRetina=(!this.isDomFree||this.isEjecta||this.isCordova)&&this.useHighDpi&&!this.isAndroidStockBrowser;0===this.fullscreen_mode&&this.isiOS&&(this.isRetina=!1);this.devicePixelRatio=this.isRetina?window.devicePixelRatio||window.webkitDevicePixelRatio||window.mozDevicePixelRatio||window.msDevicePixelRatio||1:1;"object"===typeof window.StatusBar&&window.StatusBar.hide();this.ClearDeathRow();0<this.fullscreen_mode&&this.setSize(window.innerWidth,window.innerHeight,!0);
this.canvas.addEventListener("webglcontextlost",function(a){a.preventDefault();b.onContextLost();cr.logexport("[Construct 2] WebGL context lost");window.cr_setSuspended(!0)},!1);this.canvas.addEventListener("webglcontextrestored",function(a){b.glwrap.initState();b.glwrap.setSize(b.glwrap.width,b.glwrap.height,!0);b.layer_tex=null;b.layout_tex=null;b.fx_tex[0]=null;b.fx_tex[1]=null;b.onContextRestored();b.redraw=!0;cr.logexport("[Construct 2] WebGL context restored");window.cr_setSuspended(!1)},!1);
try{if(this.enableWebGL&&(this.isCocoonJs||this.isEjecta||!this.isDomFree)){var k={alpha:!0,depth:!1,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0};this.isAndroid||(this.gl=this.canvas.getContext("webgl2",k));this.gl||(this.gl=this.canvas.getContext("webgl",k)||this.canvas.getContext("experimental-webgl",k))}}catch(W){}if(this.gl){this.gl.getParameter(this.gl.VERSION).indexOf("WebGL 2");if(k=this.gl.getExtension("WEBGL_debug_renderer_info")){var d=this.gl.getParameter(k.UNMASKED_VENDOR_WEBGL);
this.glUnmaskedRenderer=this.gl.getParameter(k.UNMASKED_RENDERER_WEBGL)+" ["+d+"]"}this.enableFrontToBack&&(this.glUnmaskedRenderer+=" [front-to-back enabled]");this.isDomFree||(this.overlay_canvas=document.createElement("canvas"),jQuery(this.overlay_canvas).appendTo(this.canvas.parentNode),this.overlay_canvas.oncontextmenu=function(b){return!1},this.overlay_canvas.onselectstart=function(b){return!1},this.overlay_canvas.width=Math.round(this.cssWidth*this.devicePixelRatio),this.overlay_canvas.height=
Math.round(this.cssHeight*this.devicePixelRatio),jQuery(this.overlay_canvas).css({width:this.cssWidth+"px",height:this.cssHeight+"px"}),this.positionOverlayCanvas(),this.overlay_ctx=this.overlay_canvas.getContext("2d"));this.glwrap=new cr.GLWrap(this.gl,this.isMobile,this.enableFrontToBack);this.glwrap.setSize(this.canvas.width,this.canvas.height);this.glwrap.enable_mipmaps=0!==this.downscalingQuality;this.ctx=null;k=0;for(d=this.types_by_index.length;k<d;k++){var e=this.types_by_index[k];var f=0;
for(a=e.effect_types.length;f<a;f++){var g=e.effect_types[f];g.shaderindex=this.glwrap.getShaderIndex(g.id);g.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(g.shaderindex);this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(g.shaderindex)}}k=0;for(d=this.layouts_by_index.length;k<d;k++){var h=this.layouts_by_index[k];f=0;for(a=h.effect_types.length;f<a;f++)g=h.effect_types[f],g.shaderindex=this.glwrap.getShaderIndex(g.id),g.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(g.shaderindex);
h.updateActiveEffects();f=0;for(a=h.layers.length;f<a;f++){var m=h.layers[f];e=0;for(c=m.effect_types.length;e<c;e++)g=m.effect_types[e],g.shaderindex=this.glwrap.getShaderIndex(g.id),g.preservesOpaqueness=this.glwrap.programPreservesOpaqueness(g.shaderindex),this.uses_background_blending=this.uses_background_blending||this.glwrap.programUsesDest(g.shaderindex);m.updateActiveEffects()}}}else{if(0<this.fullscreen_mode&&this.isDirectCanvas){this.canvas=null;document.oncontextmenu=function(b){return!1};
document.onselectstart=function(b){return!1};this.ctx=AppMobi.canvas.getContext("2d");try{this.ctx.samplingMode=this.linearSampling?"smooth":"sharp",this.ctx.globalScale=1,this.ctx.HTML5CompatibilityMode=!0,this.ctx.imageSmoothingEnabled=this.linearSampling}catch(W){}0!==this.width&&0!==this.height&&(this.ctx.width=this.width,this.ctx.height=this.height)}this.ctx||(k=this.isCocoonJs?{antialias:!!this.linearSampling,alpha:!0}:{alpha:!0},this.ctx=this.canvas.getContext("2d",k),this.setCtxImageSmoothingEnabled(this.ctx,
this.linearSampling));this.overlay_ctx=this.overlay_canvas=null}this.tickFunc=function(a){b.tick(!1,a)};window==window.top||this.isDomFree||this.isWinJS||this.isWindowsPhone8||(document.addEventListener("mousedown",function(){window.focus()},!0),document.addEventListener("touchstart",function(){window.focus()},!0));"undefined"!==typeof cr_is_preview&&(this.isCocoonJs&&console.log("[Construct 2] In preview-over-wifi via CocoonJS mode"),-1<window.location.search.indexOf("continuous")&&(cr.logexport("Reloading for continuous preview"),
this.loadFromSlot="__c2_continuouspreview",this.suspendDrawing=!0),this.pauseOnBlur&&!this.isMobile&&(jQuery(window).focus(function(){b.setSuspended(!1)}),jQuery(window).blur(function(){var a=window.parent;a&&a.document.hasFocus()||b.setSuspended(!0)})));window.addEventListener("blur",function(){b.onWindowBlur()});this.isDomFree||(k=function(b){if(cr.isCanvasInputEvent(b)&&document.activeElement&&document.activeElement!==document.getElementsByTagName("body")[0]&&document.activeElement.blur)try{document.activeElement.blur()}catch(ba){}},
"undefined"!==typeof PointerEvent?document.addEventListener("pointerdown",k):window.navigator.msPointerEnabled?document.addEventListener("MSPointerDown",k):document.addEventListener("touchstart",k),document.addEventListener("mousedown",k));0===this.fullscreen_mode&&this.isRetina&&1<this.devicePixelRatio&&this.setSize(this.original_width,this.original_height,!0);this.tryLockOrientation();this.getready();this.go();this.extra={};cr.seal(this)};a.prototype.setSize=function(b,a,c){var k=0,d=0,e;if(this.lastWindowWidth!==
b||this.lastWindowHeight!==a||c){this.lastWindowWidth=b;this.lastWindowHeight=a;var f=this.fullscreen_mode;if((e=(document.mozFullScreen||document.webkitIsFullScreen||!!document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen)&&!this.isCordova)||0!==this.fullscreen_mode||c){e&&(f=this.fullscreen_scaling);c=this.devicePixelRatio;if(4<=f)if(5===f&&1!==c&&(b+=1,a+=1),e=this.original_width/this.original_height,b/a>e)if(e*=a,5===f){k=e*c/this.original_width;1<k?k=Math.floor(k):1>k&&(k=
1/Math.ceil(1/k));e=this.original_width*k/c;var g=this.original_height*k/c;k=(b-e)/2;d=(a-g)/2;b=e;a=g}else k=(b-e)/2,b=e;else g=b/e,5===f?(k=g*c/this.original_height,1<k?k=Math.floor(k):1>k&&(k=1/Math.ceil(1/k)),e=this.original_width*k/c,g=this.original_height*k/c,k=(b-e)/2,d=(a-g)/2,b=e):d=(a-g)/2,a=g;else e&&0===f&&(k=Math.floor((b-this.original_width)/2),d=Math.floor((a-this.original_height)/2),b=this.original_width,a=this.original_height);2>f&&(this.aspect_scale=c);this.cssWidth=Math.round(b);
this.cssHeight=Math.round(a);this.width=Math.round(b*c);this.height=Math.round(a*c);this.redraw=!0;this.wantFullscreenScalingQuality?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):this.width<this.original_width&&this.height<this.original_height||1===f?(this.draw_width=this.width,this.draw_height=this.height,this.fullscreenScalingQuality=!0):(this.draw_width=this.original_width,this.draw_height=this.original_height,this.fullscreenScalingQuality=!1,2===f?
(e=this.original_width/this.original_height,f=this.lastWindowWidth/this.lastWindowHeight,f<e?this.draw_width=this.draw_height*f:f>e&&(this.draw_height=this.draw_width/f)):3===f&&(e=this.original_width/this.original_height,f=this.lastWindowWidth/this.lastWindowHeight,f>e?this.draw_width=this.draw_height*f:f<e&&(this.draw_height=this.draw_width/f)));this.canvasdiv&&!this.isDomFree&&(jQuery(this.canvasdiv).css({width:Math.round(b)+"px",height:Math.round(a)+"px","margin-left":Math.floor(k)+"px","margin-top":Math.floor(d)+
"px"}),"undefined"!==typeof cr_is_preview&&jQuery("#borderwrap").css({width:Math.round(b)+"px",height:Math.round(a)+"px"}));this.canvas&&(this.canvas.width=Math.round(b*c),this.canvas.height=Math.round(a*c),this.isEjecta?(this.canvas.style.left=Math.floor(k)+"px",this.canvas.style.top=Math.floor(d)+"px",this.canvas.style.width=Math.round(b)+"px",this.canvas.style.height=Math.round(a)+"px"):this.isRetina&&!this.isDomFree&&(this.canvas.style.width=Math.round(b)+"px",this.canvas.style.height=Math.round(a)+
"px"));this.overlay_canvas&&(this.overlay_canvas.width=Math.round(b*c),this.overlay_canvas.height=Math.round(a*c),this.overlay_canvas.style.width=this.cssWidth+"px",this.overlay_canvas.style.height=this.cssHeight+"px");this.glwrap&&this.glwrap.setSize(Math.round(b*c),Math.round(a*c));this.isDirectCanvas&&this.ctx&&(this.ctx.width=Math.round(b),this.ctx.height=Math.round(a));this.ctx&&this.setCtxImageSmoothingEnabled(this.ctx,this.linearSampling);this.tryLockOrientation();this.isiPhone&&!this.isCordova&&
window.scrollTo(0,0)}}};a.prototype.tryLockOrientation=function(){if(this.autoLockOrientation&&0!==this.orientations){var b="portrait";2===this.orientations&&(b="landscape");try{screen.orientation&&screen.orientation.lock?screen.orientation.lock(b).catch(function(){}):screen.lockOrientation?screen.lockOrientation(b):screen.webkitLockOrientation?screen.webkitLockOrientation(b):screen.mozLockOrientation?screen.mozLockOrientation(b):screen.msLockOrientation&&screen.msLockOrientation(b)}catch(C){console&&
console.warn&&console.warn("Failed to lock orientation: ",C)}}};a.prototype.onContextLost=function(){this.glwrap.contextLost();this.is_WebGL_context_lost=!0;var b;var a=0;for(b=this.types_by_index.length;a<b;a++){var c=this.types_by_index[a];if(c.onLostWebGLContext)c.onLostWebGLContext()}};a.prototype.onContextRestored=function(){this.is_WebGL_context_lost=!1;var b;var a=0;for(b=this.types_by_index.length;a<b;a++){var c=this.types_by_index[a];if(c.onRestoreWebGLContext)c.onRestoreWebGLContext()}};
a.prototype.positionOverlayCanvas=function(){if(!this.isDomFree){var b=(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova?jQuery(this.canvas).offset():jQuery(this.canvas).position();b.position="absolute";jQuery(this.overlay_canvas).css(b)}};var p=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame;a.prototype.setSuspended=
function(b){var a;if(b&&!this.isSuspended)for(cr.logexport("[Construct 2] Suspending"),this.isSuspended=!0,-1!==this.raf_id&&p&&p(this.raf_id),-1!==this.timeout_id&&clearTimeout(this.timeout_id),b=0,a=this.suspend_events.length;b<a;b++)this.suspend_events[b](!0);else if(!b&&this.isSuspended){cr.logexport("[Construct 2] Resuming");this.isSuspended=!1;this.last_tick_time=cr.performance_now();this.last_fps_time=cr.performance_now();b=this.logictime=this.framecount=0;for(a=this.suspend_events.length;b<
a;b++)this.suspend_events[b](!1);this.tick(!1)}};a.prototype.addSuspendCallback=function(b){this.suspend_events.push(b)};a.prototype.GetObjectReference=function(b){return this.objectRefTable[b]};a.prototype.loadProject=function(b){b&&b.project||cr.logerror("Project model unavailable");b=b.project;this.name=b[0];this.first_layout=b[1];this.fullscreen_mode=b[12];this.fullscreen_mode_set=b[12];this.original_width=b[10];this.original_height=b[11];this.parallax_x_origin=this.original_width/2;this.parallax_y_origin=
this.original_height/2;this.isDomFree&&!this.isEjecta&&(4<=b[12]||0===b[12])&&(cr.logexport("[Construct 2] Letterbox scale fullscreen modes are not supported on this platform - falling back to 'Scale outer'"),this.fullscreen_mode_set=this.fullscreen_mode=3);this.uses_loader_layout=b[18];this.loaderstyle=b[19];if(0===this.loaderstyle){var a=new Image;a.crossOrigin="anonymous";this.setImageSrc(a,"loading-logo.png");this.loaderlogos={logo:a}}else if(4===this.loaderstyle){a=new Image;a.src="";var c=new Image;
c.src="";var k=new Image;k.src="";var d=new Image;d.src="";var e=new Image;e.src="";var f=new Image;f.src="";var g=new Image;g.src="";var h=new Image;h.src="";var m=new Image;m.src="";var l=new Image;l.src="";var t=new Image;t.src="";var r=new Image;r.src="";this.loaderlogos={logo:[a,c,k,d],powered:[e,f,g,h],website:[m,l,t,r]}}this.next_uid=b[21];this.objectRefTable=cr.getObjectRefTable();this.system=new cr.system_object(this);a=0;for(c=b[2].length;a<c;a++){g=b[2][a];k=this.GetObjectReference(g[0]);
cr.add_common_aces(g,k.prototype);h=new k(this);h.singleglobal=g[1];h.is_world=g[2];h.is_rotatable=g[5];h.must_predraw=g[9];if(h.onCreate)h.onCreate();cr.seal(h);this.plugins.push(h)}this.objectRefTable=cr.getObjectRefTable();a=0;for(c=b[3].length;a<c;a++){g=b[3][a];e=this.GetObjectReference(g[1]);h=null;k=0;for(d=this.plugins.length;k<d;k++)if(this.plugins[k]instanceof e){h=this.plugins[k];break}m=new h.Type(h);m.name=g[0];m.is_family=g[2];m.instvar_sids=g[3].slice(0);m.vars_count=g[3].length;m.behs_count=
g[4];m.fx_count=g[5];m.sid=g[11];m.is_family?(m.members=[],m.family_index=this.family_count++,m.families=null):(m.members=null,m.family_index=-1,m.families=[]);m.family_var_map=null;m.family_beh_map=null;m.family_fx_map=null;m.is_contained=!1;m.container=null;g[6]?(m.texture_file=g[6][0],m.texture_filesize=g[6][1],m.texture_pixelformat=g[6][2]):(m.texture_file=null,m.texture_filesize=0,m.texture_pixelformat=0);m.animations=g[7]?g[7]:null;m.index=a;m.instances=[];m.deadCache=[];m.solstack=[new cr.selection(m)];
m.cur_sol=0;m.default_instance=null;m.default_layerindex=0;m.stale_iids=!0;m.updateIIDs=cr.type_updateIIDs;m.getFirstPicked=cr.type_getFirstPicked;m.getPairedInstance=cr.type_getPairedInstance;m.getCurrentSol=cr.type_getCurrentSol;m.pushCleanSol=cr.type_pushCleanSol;m.pushCopySol=cr.type_pushCopySol;m.popSol=cr.type_popSol;m.getBehaviorByName=cr.type_getBehaviorByName;m.getBehaviorIndexByName=cr.type_getBehaviorIndexByName;m.getEffectIndexByName=cr.type_getEffectIndexByName;m.applySolToContainer=
cr.type_applySolToContainer;m.getInstanceByIID=cr.type_getInstanceByIID;m.collision_grid=new cr.SparseGrid(this.original_width,this.original_height);m.any_cell_changed=!0;m.any_instance_parallaxed=!1;m.extra={};m.toString=cr.type_toString;m.behaviors=[];k=0;for(d=g[8].length;k<d;k++){l=g[8][k];t=this.GetObjectReference(l[1]);r=null;e=0;for(f=this.behaviors.length;e<f;e++)if(this.behaviors[e]instanceof t){r=this.behaviors[e];break}if(!r){r=new t(this);r.my_types=[];r.my_instances=new cr.ObjectSet;
if(r.onCreate)r.onCreate();cr.seal(r);this.behaviors.push(r);cr.behaviors.solid&&r instanceof cr.behaviors.solid&&(this.solidBehavior=r);cr.behaviors.jumpthru&&r instanceof cr.behaviors.jumpthru&&(this.jumpthruBehavior=r);cr.behaviors.shadowcaster&&r instanceof cr.behaviors.shadowcaster&&(this.shadowcasterBehavior=r)}-1===r.my_types.indexOf(m)&&r.my_types.push(m);e=new r.Type(r,m);e.name=l[0];e.sid=l[2];e.onCreate();cr.seal(e);m.behaviors.push(e)}m.global=g[9];m.isOnLoaderLayout=g[10];m.effect_types=
[];k=0;for(d=g[12].length;k<d;k++)m.effect_types.push({id:g[12][k][0],name:g[12][k][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:k});m.tile_poly_data=g[13];if(!this.uses_loader_layout||m.is_family||m.isOnLoaderLayout||!h.is_world)m.onCreate(),cr.seal(m);m.name&&(this.types[m.name]=m);this.types_by_index.push(m);h.singleglobal&&(k=new h.Instance(m),k.uid=this.next_uid++,k.puid=this.next_puid++,k.iid=0,k.get_iid=cr.inst_get_iid,k.toString=cr.inst_toString,k.properties=g[14],k.onCreate(),
cr.seal(k),m.instances.push(k),this.objectsByUid[k.uid.toString()]=k)}a=0;for(c=b[4].length;a<c;a++)for(e=b[4][a],f=this.types_by_index[e[0]],k=1,d=e.length;k<d;k++)g=this.types_by_index[e[k]],g.families.push(f),f.members.push(g);a=0;for(c=b[28].length;a<c;a++){e=b[28][a];f=[];k=0;for(d=e.length;k<d;k++)f.push(this.types_by_index[e[k]]);k=0;for(d=f.length;k<d;k++)f[k].is_contained=!0,f[k].container=f}if(0<this.family_count)for(a=0,c=this.types_by_index.length;a<c;a++)if(g=this.types_by_index[a],!g.is_family&&
g.families.length){g.family_var_map=Array(this.family_count);g.family_beh_map=Array(this.family_count);g.family_fx_map=Array(this.family_count);m=[];k=r=t=l=0;for(d=g.families.length;k<d;k++)for(h=g.families[k],g.family_var_map[h.family_index]=l,l+=h.vars_count,g.family_beh_map[h.family_index]=t,t+=h.behs_count,g.family_fx_map[h.family_index]=r,r+=h.fx_count,e=0,f=h.effect_types.length;e<f;e++)m.push(cr.shallowCopy({},h.effect_types[e]));g.effect_types=m.concat(g.effect_types);k=0;for(d=g.effect_types.length;k<
d;k++)g.effect_types[k].index=k}a=0;for(c=b[5].length;a<c;a++)g=b[5][a],k=new cr.layout(this,g),cr.seal(k),this.layouts[k.name]=k,this.layouts_by_index.push(k);a=0;for(c=b[6].length;a<c;a++)g=b[6][a],k=new cr.eventsheet(this,g),cr.seal(k),this.eventsheets[k.name]=k,this.eventsheets_by_index.push(k);a=0;for(c=this.eventsheets_by_index.length;a<c;a++)this.eventsheets_by_index[a].postInit();a=0;for(c=this.eventsheets_by_index.length;a<c;a++)this.eventsheets_by_index[a].updateDeepIncludes();a=0;for(c=
this.triggers_to_postinit.length;a<c;a++)this.triggers_to_postinit[a].postInit();cr.clearArray(this.triggers_to_postinit);this.audio_to_preload=b[7];this.files_subfolder=b[8];this.pixel_rounding=b[9];this.aspect_scale=1;this.enableWebGL=b[13];this.linearSampling=b[14];this.clearBackground=b[15];this.versionstr=b[16];this.useHighDpi=b[17];this.orientations=b[20];this.autoLockOrientation=0<this.orientations;this.pauseOnBlur=b[22];this.fullscreenScalingQuality=this.wantFullscreenScalingQuality=b[23];
this.downscalingQuality=b[24];this.preloadSounds=b[25];this.projectName=b[26];this.enableFrontToBack=b[27]&&!this.isIE;this.start_time=Date.now();cr.clearArray(this.objectRefTable);this.initRendererAndLoader()};var n=!1,k=0,m=[];a.prototype.queueImageLoad=function(b,a){var c=this,d=function(){k--;c.maybeLoadNextImages()};b.addEventListener("load",d);b.addEventListener("error",d);m.push([b,a]);this.maybeLoadNextImages()};a.prototype.maybeLoadNextImages=function(){for(var b;m.length&&100>k;)k++,b=m.shift(),
this.setImageSrc(b[0],b[1])};a.prototype.waitForImageLoad=function(b,a){b.cocoonLazyLoad=!0;b.onerror=function(a){n=b.c2error=!0;console&&console.error&&console.error("Error loading image '"+b.src+"': ",a)};this.isEjecta?b.src=a:b.src||("undefined"!==typeof XAPKReader?XAPKReader.get(a,function(a){b.src=a},function(c){n=b.c2error=!0;console&&console.error&&console.error("Error extracting image '"+a+"' from expansion file: ",c)}):(b.crossOrigin="anonymous",this.queueImageLoad(b,a)));this.wait_for_textures.push(b)};
a.prototype.findWaitingTexture=function(b){var a;var c=0;for(a=this.wait_for_textures.length;c<a;c++)if(this.wait_for_textures[c].cr_src===b)return this.wait_for_textures[c];return null};var q=0,v=!1;a.prototype.getready=function(){this.audioInstance&&(q=this.audioInstance.setPreloadList(this.audio_to_preload))};a.prototype.areAllTexturesAndSoundsLoaded=function(){var b=q,a=0,c=!0,k;var d=0;for(k=this.wait_for_textures.length;d<k;d++){var e=this.wait_for_textures[d];var f=e.cr_filesize;if(!f||0>=
f)f=5E4;b+=f;e.src&&(e.complete||e.loaded)&&!e.c2error?a+=f:c=!1}c&&this.preloadSounds&&this.audioInstance&&(v||(this.audioInstance.startPreloads(),v=!0),d=this.audioInstance.getPreloadedSize(),a+=d,d<q&&(c=!1));this.progress=0==b?1:a/b;return c};var u=!1;a.prototype.go=function(){if(this.ctx||this.glwrap){var b=this.ctx||this.overlay_ctx;this.overlay_canvas&&this.positionOverlayCanvas();var a=window.innerWidth,c=window.innerHeight;this.lastWindowWidth===a&&this.lastWindowHeight===c||this.setSize(a,
c);this.progress=0;this.last_progress=-1;var k=this;if(this.areAllTexturesAndSoundsLoaded()&&(4!==this.loaderstyle||u))this.go_loading_finished();else{c=Date.now()-this.start_time;if(b){var d=this.width,e=this.height;a=this.devicePixelRatio;if(3>this.loaderstyle&&(this.isCocoonJs||500<=c&&this.last_progress!=this.progress)){b.clearRect(0,0,d,e);c=d/2;e/=2;d=0===this.loaderstyle&&this.loaderlogos.logo.complete;var f=40*a,g=0,m=80*a;if(d){var h=this.loaderlogos.logo;m=h.width*a;var r=h.height*a;f=m/
2;g=r/2;b.drawImage(h,cr.floor(c-f),cr.floor(e-g),m,r)}1>=this.loaderstyle?(e+=g+(d?12*a:0),c=cr.floor(c-f)+.5,e=cr.floor(e)+.5,b.fillStyle=n?"red":"DodgerBlue",b.fillRect(c,e,Math.floor(m*this.progress),6*a),b.strokeStyle="black",b.strokeRect(c,e,m,6*a),b.strokeStyle="white",b.strokeRect(c-1*a,e-1*a,m+2*a,8*a)):2===this.loaderstyle&&(b.font=this.isEjecta?"12pt ArialMT":"12pt Arial",b.fillStyle=n?"#f00":"#999",b.textBaseLine="middle",a=Math.round(100*this.progress)+"%",d=b.measureText?b.measureText(a):
null,b.fillText(a,c-(d?d.width:0)/2,e));this.last_progress=this.progress}else if(4===this.loaderstyle){this.draw_c2_splash_loader(b);l?l(function(){k.go()}):setTimeout(function(){k.go()},16);return}}setTimeout(function(){k.go()},this.isCocoonJs?10:100)}}};var y=-1,B="undefined"===typeof cr_is_preview?200:0,x=!0,w=!1,A=0,D=0,G="undefined"===typeof cr_is_preview?3E3:0,r=null,t=null,O=0;a.prototype.draw_c2_splash_loader=function(b){if(!u){for(var a=Math.ceil(this.width),c=Math.ceil(this.height),k=this.loaderlogos.logo,
d=this.loaderlogos.powered,e=this.loaderlogos.website,g=0;4>g;++g)if(!k[g].complete||!d[g].complete||!e[g].complete)return;0===O&&(y=Date.now());g=Date.now();var m=!1,h=b;x||w?(b.clearRect(0,0,a,c),r&&r.width===a&&r.height===c||(r=document.createElement("canvas"),r.width=a,r.height=c,t=r.getContext("2d")),h=t,m=!0,x&&1===O&&(y=Date.now())):b.globalAlpha=1;h.fillStyle="#333333";h.fillRect(0,0,a,c);if(256<this.cssHeight){var l=cr.clamp(.22*c,105,.6*a);var q=.25*l;h.drawImage(f(d,l),.5*a-l/2,.2*c-q/
2,l,q);q=l=Math.min(.395*c,.95*a);h.drawImage(f(k,l),.5*a-l/2,.485*c-q/2,l,q);l=cr.clamp(.22*c,105,.6*a);q=.25*l;h.drawImage(f(e,l),.5*a-l/2,.868*c-q/2,l,q);h.fillStyle="#3C3C3C";q=Math.max(.005*c,2);h.fillRect(0,.8*c-q/2,a,q);h.fillStyle=n?"red":"#E0FF65";l=a*this.progress;h.fillRect(.5*a-l/2,.8*c-q/2,l,q)}else q=l=.55*c,h.drawImage(f(k,l),.5*a-l/2,.45*c-q/2,l,q),h.fillStyle="#3C3C3C",q=Math.max(.005*c,2),h.fillRect(0,.85*c-q/2,a,q),h.fillStyle=n?"red":"#E0FF65",l=a*this.progress,h.fillRect(.5*a-
l/2,.85*c-q/2,l,q);m&&(x?b.globalAlpha=0===O?0:Math.min((g-y)/300,1):w&&(b.globalAlpha=Math.max(1-(g-D)/300,0)),b.drawImage(r,0,0,a,c));x&&300<=g-y&&2<=O&&(x=!1,A=g);!x&&g-A>=G&&!w&&1<=this.progress&&(w=!0,D=g);if(w&&g-D>=300+B||"undefined"!==typeof cr_is_preview&&1<=this.progress&&500>Date.now()-y)u=!0,w=x=!1,this.loaderlogos=t=r=null;++O}};a.prototype.go_loading_finished=function(){this.overlay_canvas&&(this.canvas.parentNode.removeChild(this.overlay_canvas),this.overlay_canvas=this.overlay_ctx=
null);this.start_time=Date.now();this.last_fps_time=cr.performance_now();var b;if(this.uses_loader_layout){var a=0;for(b=this.types_by_index.length;a<b;a++){var c=this.types_by_index[a];c.is_family||c.isOnLoaderLayout||!c.plugin.is_world||(c.onCreate(),cr.seal(c))}}else this.isloading=!1;a=0;for(b=this.layouts_by_index.length;a<b;a++)this.layouts_by_index[a].createGlobalNonWorlds();2<=this.fullscreen_mode&&(a=this.original_width/this.original_height,b=this.width/this.height,this.aspect_scale=2!==
this.fullscreen_mode&&b>a||2===this.fullscreen_mode&&b<a?this.height/this.original_height:this.width/this.original_width);this.first_layout?this.layouts[this.first_layout].startRunning():this.layouts_by_index[0].startRunning();this.uses_loader_layout||(this.loadingprogress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW());navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide();a=0;for(b=this.types_by_index.length;a<
b;a++)if(c=this.types_by_index[a],c.onAppBegin)c.onAppBegin();document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?window.cr_setSuspended(!0):this.tick(!1);this.isDirectCanvas&&AppMobi.webview.execute("onGameReady();")};a.prototype.tick=function(b,a,c){if(this.running_layout){var k=cr.performance_now();if(c||!this.isSuspended||b){b||(l?this.raf_id=l(this.tickFunc):this.timeout_id=setTimeout(this.tickFunc,this.isMobile?1:16));a=a||k;var d=this.fullscreen_mode;((c=(document.mozFullScreen||
document.webkitIsFullScreen||document.fullScreen||!!document.msFullscreenElement)&&!this.isCordova)||this.isNodeFullscreen)&&0<this.fullscreen_scaling&&(d=this.fullscreen_scaling);if(0<d){d=window.innerWidth;var e=window.innerHeight;this.lastWindowWidth===d&&this.lastWindowHeight===e||this.setSize(d,e)}this.isDomFree||(c?this.firstInFullscreen||(this.firstInFullscreen=!0):this.firstInFullscreen?(this.firstInFullscreen=!1,0===this.fullscreen_mode&&this.setSize(Math.round(this.oldWidth/this.devicePixelRatio),
Math.round(this.oldHeight/this.devicePixelRatio),!0)):(this.oldWidth=this.width,this.oldHeight=this.height));this.isloading&&(c=this.areAllTexturesAndSoundsLoaded(),this.loadingprogress=this.progress,c&&(this.isloading=!1,this.progress=1,this.trigger(cr.system_object.prototype.cnds.OnLoadFinished,null),window.C2_RegisterSW&&window.C2_RegisterSW()));this.logic(a);!this.redraw&&!this.isCocoonJs||this.is_WebGL_context_lost||this.suspendDrawing||b||(this.redraw=!1,this.glwrap?this.drawGL():this.draw(),
this.snapshotCanvas&&(this.canvas&&this.canvas.toDataURL&&(this.snapshotData=this.canvas.toDataURL(this.snapshotCanvas[0],this.snapshotCanvas[1]),window.cr_onSnapshot&&window.cr_onSnapshot(this.snapshotData),this.trigger(cr.system_object.prototype.cnds.OnCanvasSnapshot,null)),this.snapshotCanvas=null));this.hit_breakpoint||(this.tickcount++,this.tickcount_nosave++,this.execcount++,this.framecount++);this.logictime+=cr.performance_now()-k}}};a.prototype.logic=function(b){var a;1E3<=b-this.last_fps_time&&
(this.last_fps_time+=1E3,1E3<=b-this.last_fps_time&&(this.last_fps_time=b),this.fps=this.framecount,this.framecount=0,this.cpuutilisation=this.logictime,this.logictime=0);var c=0;0!==this.last_tick_time&&(c=b-this.last_tick_time,0>c&&(c=0),this.dt1=c/=1E3,.5<this.dt1?this.dt1=0:this.dt1>1/this.minimumFramerate&&(this.dt1=1/this.minimumFramerate));this.last_tick_time=b;this.dt=this.dt1*this.timescale;this.kahanTime.add(this.dt);this.wallTime.add(c);b=(document.mozFullScreen||document.webkitIsFullScreen||
document.fullScreen||!!document.msFullscreenElement||this.isNodeFullscreen)&&!this.isCordova;if(2<=this.fullscreen_mode||b&&0<this.fullscreen_scaling){c=this.original_width/this.original_height;var k=this.width/this.height;var d=this.fullscreen_mode;b&&0<this.fullscreen_scaling&&(d=this.fullscreen_scaling);this.aspect_scale=2!==d&&k>c||2===d&&k<c?this.height/this.original_height:this.width/this.original_width;this.running_layout&&(this.running_layout.scrollToX(this.running_layout.scrollX),this.running_layout.scrollToY(this.running_layout.scrollY))}else this.aspect_scale=
this.isRetina?this.devicePixelRatio:1;this.ClearDeathRow();this.isInOnDestroy++;this.system.runWaits();this.isInOnDestroy--;this.ClearDeathRow();this.isInOnDestroy++;k=this.objects_to_pretick.valuesRef();b=0;for(c=k.length;b<c;b++)k[b].pretick();b=0;for(c=this.types_by_index.length;b<c;b++){var e=this.types_by_index[b];if(!e.is_family&&(e.behaviors.length||e.families.length))for(k=0,d=e.instances.length;k<d;k++){var f=e.instances[k];var g=0;for(a=f.behavior_insts.length;g<a;g++)f.behavior_insts[g].tick()}}b=
0;for(c=this.types_by_index.length;b<c;b++)if(e=this.types_by_index[b],!e.is_family&&(e.behaviors.length||e.families.length))for(k=0,d=e.instances.length;k<d;k++)for(f=e.instances[k],g=0,a=f.behavior_insts.length;g<a;g++){var m=f.behavior_insts[g];m.posttick&&m.posttick()}k=this.objects_to_tick.valuesRef();b=0;for(c=k.length;b<c;b++)k[b].tick();this.isInOnDestroy--;this.handleSaveLoad();for(b=0;this.changelayout&&10>b++;)this.doChangeLayout(this.changelayout);b=0;for(c=this.eventsheets_by_index.length;b<
c;b++)this.eventsheets_by_index[b].hasRun=!1;this.running_layout.event_sheet&&this.running_layout.event_sheet.run();cr.clearArray(this.registered_collisions);this.layout_first_tick=!1;this.isInOnDestroy++;b=0;for(c=this.types_by_index.length;b<c;b++)if(e=this.types_by_index[b],!e.is_family&&(e.behaviors.length||e.families.length))for(k=0,d=e.instances.length;k<d;k++)for(f=e.instances[k],g=0,a=f.behavior_insts.length;g<a;g++)m=f.behavior_insts[g],m.tick2&&m.tick2();k=this.objects_to_tick2.valuesRef();
b=0;for(c=k.length;b<c;b++)k[b].tick2();this.isInOnDestroy--};a.prototype.onWindowBlur=function(){var b,a,c;var k=0;for(b=this.types_by_index.length;k<b;k++){var d=this.types_by_index[k];if(!d.is_family){var e=0;for(a=d.instances.length;e<a;e++){var f=d.instances[e];if(f.onWindowBlur)f.onWindowBlur();if(f.behavior_insts){var g=0;for(c=f.behavior_insts.length;g<c;g++){var m=f.behavior_insts[g];if(m.onWindowBlur)m.onWindowBlur()}}}}}};a.prototype.doChangeLayout=function(b){var a=this.running_layout;
this.running_layout.stopRunning();var c;if(this.glwrap){var k=0;for(c=this.types_by_index.length;k<c;k++){var d=this.types_by_index[k];d.is_family||!d.unloadTextures||d.global&&0!==d.instances.length||-1!==b.initial_types.indexOf(d)||d.unloadTextures()}}a==b&&cr.clearArray(this.system.waits);cr.clearArray(this.registered_collisions);this.runLayoutChangeMethods(!0);b.startRunning();this.runLayoutChangeMethods(!1);this.layout_first_tick=this.redraw=!0;this.ClearDeathRow()};a.prototype.runLayoutChangeMethods=
function(b){var a,c,k;var d=0;for(a=this.behaviors.length;d<a;d++){var e=this.behaviors[d];if(b){if(e.onBeforeLayoutChange)e.onBeforeLayoutChange()}else if(e.onLayoutChange)e.onLayoutChange()}d=0;for(a=this.types_by_index.length;d<a;d++)if(e=this.types_by_index[d],e.global||e.plugin.singleglobal){var f=0;for(c=e.instances.length;f<c;f++){var g=e.instances[f];if(b){if(g.onBeforeLayoutChange)g.onBeforeLayoutChange()}else if(g.onLayoutChange)g.onLayoutChange();if(g.behavior_insts){var m=0;for(k=g.behavior_insts.length;m<
k;m++){var h=g.behavior_insts[m];if(b){if(h.onBeforeLayoutChange)h.onBeforeLayoutChange()}else if(h.onLayoutChange)h.onLayoutChange()}}}}};a.prototype.pretickMe=function(b){this.objects_to_pretick.add(b)};a.prototype.unpretickMe=function(b){this.objects_to_pretick.remove(b)};a.prototype.tickMe=function(b){this.objects_to_tick.add(b)};a.prototype.untickMe=function(b){this.objects_to_tick.remove(b)};a.prototype.tick2Me=function(b){this.objects_to_tick2.add(b)};a.prototype.untick2Me=function(b){this.objects_to_tick2.remove(b)};
a.prototype.getDt=function(b){return b&&-1!==b.my_timescale?this.dt1*b.my_timescale:this.dt};a.prototype.draw=function(){this.running_layout.draw(this.ctx);this.isDirectCanvas&&this.ctx.present()};a.prototype.drawGL=function(){this.enableFrontToBack&&(this.earlyz_index=1,this.running_layout.drawGL_earlyZPass(this.glwrap));this.running_layout.drawGL(this.glwrap);this.glwrap.present()};a.prototype.addDestroyCallback=function(b){b&&this.destroycallbacks.push(b)};a.prototype.removeDestroyCallback=function(b){cr.arrayFindRemove(this.destroycallbacks,
b)};a.prototype.getObjectByUID=function(b){b=b.toString();return this.objectsByUid.hasOwnProperty(b)?this.objectsByUid[b]:null};var P=[];a.prototype.DestroyInstance=function(b){var a;var c=b.type.name;if(this.deathRow.hasOwnProperty(c)){var k=this.deathRow[c];if(k.contains(b))return}else k=P.length?P.pop():new cr.ObjectSet,this.deathRow[c]=k;k.add(b);this.hasPendingInstances=!0;if(b.is_contained)for(c=0,a=b.siblings.length;c<a;c++)this.DestroyInstance(b.siblings[c]);this.isInClearDeathRow&&k.values_cache.push(b);
this.isEndingLayout||(this.isInOnDestroy++,this.trigger(Object.getPrototypeOf(b.type.plugin).cnds.OnDestroyed,b),this.isInOnDestroy--)};a.prototype.ClearDeathRow=function(){if(this.hasPendingInstances){var b,a;this.isInClearDeathRow=!0;var c=0;for(b=this.createRow.length;c<b;++c){var k=this.createRow[c];var d=k.type;d.instances.push(k);var e=0;for(a=d.families.length;e<a;++e)d.families[e].instances.push(k),d.families[e].stale_iids=!0}cr.clearArray(this.createRow);this.IterateDeathRow();cr.wipe(this.deathRow);
this.hasPendingInstances=this.isInClearDeathRow=!1}};a.prototype.IterateDeathRow=function(){for(var b in this.deathRow)this.deathRow.hasOwnProperty(b)&&this.ClearDeathRowForType(this.deathRow[b])};a.prototype.ClearDeathRowForType=function(b){var a=b.valuesRef(),c=a[0].type,k,d;cr.arrayRemoveAllFromObjectSet(c.instances,b);c.stale_iids=!0;0===c.instances.length&&(c.any_instance_parallaxed=!1);var e=0;for(k=c.families.length;e<k;++e){var f=c.families[e];cr.arrayRemoveAllFromObjectSet(f.instances,b);
f.stale_iids=!0}e=0;for(k=this.system.waits.length;e<k;++e){var g=this.system.waits[e];g.sols.hasOwnProperty(c.index)&&cr.arrayRemoveAllFromObjectSet(g.sols[c.index].insts,b);if(!c.is_family){var m=0;for(d=c.families.length;m<d;++m)f=c.families[m],g.sols.hasOwnProperty(f.index)&&cr.arrayRemoveAllFromObjectSet(g.sols[f.index].insts,b)}}if(g=a[0].layer){if(g.useRenderCells)for(m=g.instances,e=0,k=m.length;e<k;++e)d=m[e],b.contains(d)&&(d.update_bbox(),g.render_grid.update(d,d.rendercells,null),d.rendercells.set(0,
0,-1,-1));cr.arrayRemoveAllFromObjectSet(g.instances,b);g.setZIndicesStaleFrom(0)}for(e=0;e<a.length;++e)this.ClearDeathRowForSingleInstance(a[e],c);b.clear();P.push(b);this.redraw=!0};a.prototype.ClearDeathRowForSingleInstance=function(b,a){var c;var k=0;for(c=this.destroycallbacks.length;k<c;++k)this.destroycallbacks[k](b);b.collcells&&a.collision_grid.update(b,b.collcells,null);(k=b.layer)&&k.removeFromInstanceList(b,!0);if(b.behavior_insts)for(k=0,c=b.behavior_insts.length;k<c;++k){var d=b.behavior_insts[k];
if(d.onDestroy)d.onDestroy();d.behavior.my_instances.remove(b)}this.objects_to_pretick.remove(b);this.objects_to_tick.remove(b);this.objects_to_tick2.remove(b);if(b.onDestroy)b.onDestroy();this.objectsByUid.hasOwnProperty(b.uid.toString())&&delete this.objectsByUid[b.uid.toString()];this.objectcount--;100>a.deadCache.length&&a.deadCache.push(b)};a.prototype.createInstance=function(b,a,c,k){if(b.is_family){var d=cr.floor(Math.random()*b.members.length);return this.createInstance(b.members[d],a,c,k)}return b.default_instance?
this.createInstanceFromInit(b.default_instance,a,!1,c,k,!1):null};var Q=[];a.prototype.createInstanceFromInit=function(b,a,c,k,d,e){var f,g;if(!b)return null;var m=this.types_by_index[b[1]],h=m.plugin.is_world;if(this.isloading&&h&&!m.isOnLoaderLayout||h&&!this.glwrap&&11===b[0][11])return null;var l=a;h||(a=null);if(m.deadCache.length){var r=m.deadCache.pop();r.recycled=!0;m.plugin.Instance.call(r,m)}else r=new m.plugin.Instance(m),r.recycled=!1;!c||e||this.objectsByUid.hasOwnProperty(b[2].toString())?
r.uid=this.next_uid++:r.uid=b[2];this.objectsByUid[r.uid.toString()]=r;r.puid=this.next_puid++;r.iid=m.instances.length;var t=0;for(f=this.createRow.length;t<f;++t)this.createRow[t].type===m&&r.iid++;r.get_iid=cr.inst_get_iid;r.toString=cr.inst_toString;var q=b[3];if(r.recycled)cr.wipe(r.extra);else{r.extra={};if("undefined"!==typeof cr_is_preview)for(r.instance_var_names=[],r.instance_var_names.length=q.length,t=0,f=q.length;t<f;t++)r.instance_var_names[t]=q[t][1];r.instance_vars=[];r.instance_vars.length=
q.length}t=0;for(f=q.length;t<f;t++)r.instance_vars[t]=q[t][0];if(h){var w=b[0];r.x=cr.is_undefined(k)?w[0]:k;r.y=cr.is_undefined(d)?w[1]:d;r.z=w[2];r.width=w[3];r.height=w[4];r.depth=w[5];r.angle=w[6];r.opacity=w[7];r.hotspotX=w[8];r.hotspotY=w[9];r.blend_mode=w[10];t=w[11];!this.glwrap&&m.effect_types.length&&(r.blend_mode=t);r.compositeOp=cr.effectToCompositeOp(r.blend_mode);this.gl&&cr.setGLBlend(r,r.blend_mode,this.gl);if(r.recycled){t=0;for(f=w[12].length;t<f;t++)for(q=0,g=w[12][t].length;q<
g;q++)r.effect_params[t][q]=w[12][t][q];r.bbox.set(0,0,0,0);r.collcells.set(0,0,-1,-1);r.rendercells.set(0,0,-1,-1);r.bquad.set_from_rect(r.bbox);cr.clearArray(r.bbox_changed_callbacks)}else{r.effect_params=w[12].slice(0);t=0;for(f=r.effect_params.length;t<f;t++)r.effect_params[t]=w[12][t].slice(0);r.active_effect_types=[];r.active_effect_flags=[];r.active_effect_flags.length=m.effect_types.length;r.bbox=new cr.rect(0,0,0,0);r.collcells=new cr.rect(0,0,-1,-1);r.rendercells=new cr.rect(0,0,-1,-1);
r.bquad=new cr.quad;r.bbox_changed_callbacks=[];r.set_bbox_changed=cr.set_bbox_changed;r.add_bbox_changed_callback=cr.add_bbox_changed_callback;r.contains_pt=cr.inst_contains_pt;r.update_bbox=cr.update_bbox;r.update_render_cell=cr.update_render_cell;r.update_collision_cell=cr.update_collision_cell;r.get_zindex=cr.inst_get_zindex}r.tilemap_exists=!1;r.tilemap_width=0;r.tilemap_height=0;r.tilemap_data=null;14===w.length&&(r.tilemap_exists=!0,r.tilemap_width=w[13][0],r.tilemap_height=w[13][1],r.tilemap_data=
w[13][2]);t=0;for(f=m.effect_types.length;t<f;t++)r.active_effect_flags[t]=!0;r.shaders_preserve_opaqueness=!0;r.updateActiveEffects=cr.inst_updateActiveEffects;r.updateActiveEffects();r.uses_shaders=!!r.active_effect_types.length;r.bbox_changed=!0;r.cell_changed=!0;m.any_cell_changed=!0;r.visible=!0;r.my_timescale=-1;r.layer=a;r.zindex=a.instances.length;r.earlyz_index=0;"undefined"===typeof r.collision_poly&&(r.collision_poly=null);this.redraw=r.collisionsEnabled=!0}cr.clearArray(Q);t=0;for(f=m.families.length;t<
f;t++)Q.push.apply(Q,m.families[t].behaviors);Q.push.apply(Q,m.behaviors);if(r.recycled)for(t=0,f=Q.length;t<f;t++){var n=Q[t];var x=r.behavior_insts[t];x.recycled=!0;n.behavior.Instance.call(x,n,r);w=b[4][t];q=0;for(g=w.length;q<g;q++)x.properties[q]=w[q];x.onCreate();n.behavior.my_instances.add(r)}else for(r.behavior_insts=[],t=0,f=Q.length;t<f;t++)n=Q[t],x=new n.behavior.Instance(n,r),x.recycled=!1,x.properties=b[4][t].slice(0),x.onCreate(),cr.seal(x),r.behavior_insts.push(x),n.behavior.my_instances.add(r);
w=b[5];if(r.recycled)for(t=0,f=w.length;t<f;t++)r.properties[t]=w[t];else r.properties=w.slice(0);this.createRow.push(r);this.hasPendingInstances=!0;a&&(a.appendToInstanceList(r,!0),1!==a.parallaxX||1!==a.parallaxY)&&(m.any_instance_parallaxed=!0);this.objectcount++;if(m.is_contained){if(r.is_contained=!0,r.recycled?cr.clearArray(r.siblings):r.siblings=[],!c&&!e){t=0;for(f=m.container.length;t<f;t++)if(m.container[t]!==m){if(!m.container[t].default_instance)return null;r.siblings.push(this.createInstanceFromInit(m.container[t].default_instance,
l,!1,h?r.x:k,h?r.y:d,!0))}t=0;for(f=r.siblings.length;t<f;t++)for(r.siblings[t].siblings.push(r),q=0;q<f;q++)t!==q&&r.siblings[t].siblings.push(r.siblings[q])}}else r.is_contained=!1,r.siblings=null;r.onCreate();r.recycled||cr.seal(r);t=0;for(f=r.behavior_insts.length;t<f;t++)r.behavior_insts[t].postCreate&&r.behavior_insts[t].postCreate();return r};a.prototype.getLayerByName=function(b){var a;var c=0;for(a=this.running_layout.layers.length;c<a;c++){var k=this.running_layout.layers[c];if(cr.equals_nocase(k.name,
b))return k}return null};a.prototype.getLayerByNumber=function(b){b=cr.floor(b);0>b&&(b=0);b>=this.running_layout.layers.length&&(b=this.running_layout.layers.length-1);return this.running_layout.layers[b]};a.prototype.getLayer=function(b){return cr.is_number(b)?this.getLayerByNumber(b):this.getLayerByName(b.toString())};a.prototype.clearSol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].getCurrentSol().select_all=!0};a.prototype.pushCleanSol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].pushCleanSol()};
a.prototype.pushCopySol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].pushCopySol()};a.prototype.popSol=function(b){var a;var c=0;for(a=b.length;c<a;c++)b[c].popSol()};a.prototype.updateAllCells=function(b){if(b.any_cell_changed){var a,c=b.instances;var k=0;for(a=c.length;k<a;++k)c[k].update_collision_cell();c=this.createRow;k=0;for(a=c.length;k<a;++k)c[k].type===b&&c[k].update_collision_cell();b.any_cell_changed=!1}};a.prototype.getCollisionCandidates=function(b,a,c,k){var d,e=b?1!==b.parallaxX||
1!==b.parallaxY:!1;if(a.is_family)for(b=0,d=a.members.length;b<d;++b){var f=a.members[b];e||f.any_instance_parallaxed?cr.appendArray(k,f.instances):(this.updateAllCells(f),f.collision_grid.queryRange(c,k))}else e||a.any_instance_parallaxed?cr.appendArray(k,a.instances):(this.updateAllCells(a),a.collision_grid.queryRange(c,k))};a.prototype.getTypesCollisionCandidates=function(b,a,c,k){var d;var e=0;for(d=a.length;e<d;++e)this.getCollisionCandidates(b,a[e],c,k)};a.prototype.getSolidCollisionCandidates=
function(b,a,c){var k=this.getSolidBehavior();if(!k)return null;this.getTypesCollisionCandidates(b,k.my_types,a,c)};a.prototype.getJumpthruCollisionCandidates=function(b,a,c){var k=this.getJumpthruBehavior();if(!k)return null;this.getTypesCollisionCandidates(b,k.my_types,a,c)};a.prototype.testAndSelectCanvasPointOverlap=function(b,a,c,k){var d=b.getCurrentSol(),e,f=this.getCurrentEventStack().current_event.orblock;if(d.select_all){k||(d.select_all=!1,cr.clearArray(d.instances));var g=0;for(e=b.instances.length;g<
e;g++){var m=b.instances[g];m.update_bbox();var h=m.layer.canvasToLayer(a,c,!0);var l=m.layer.canvasToLayer(a,c,!1);if(m.contains_pt(h,l)){if(k)return!1;d.instances.push(m)}else f&&d.else_instances.push(m)}}else{var r=0;var t=f?d.else_instances:d.instances;g=0;for(e=t.length;g<e;g++)if(m=t[g],m.update_bbox(),h=m.layer.canvasToLayer(a,c,!0),l=m.layer.canvasToLayer(a,c,!1),m.contains_pt(h,l)){if(k)return!1;f?d.instances.push(m):(d.instances[r]=d.instances[g],r++)}k||(t.length=r)}b.applySolToContainer();
return k?!0:d.hasObjects()};a.prototype.testOverlap=function(b,a){if(!(b&&a&&b!==a&&b.collisionsEnabled&&a.collisionsEnabled))return!1;b.update_bbox();a.update_bbox();var c=b.layer,k=a.layer,d;if(c===k||c.parallaxX===k.parallaxX&&k.parallaxY===k.parallaxY&&c.scale===k.scale&&c.angle===k.angle&&c.zoomRate===k.zoomRate){if(!b.bbox.intersects_rect(a.bbox)||!b.bquad.intersects_quad(a.bquad)||b.tilemap_exists&&a.tilemap_exists)return!1;if(b.tilemap_exists)return this.testTilemapOverlap(b,a);if(a.tilemap_exists)return this.testTilemapOverlap(a,
b);var e=b.collision_poly&&!b.collision_poly.is_empty();var f=a.collision_poly&&!a.collision_poly.is_empty();if(!e&&!f)return!0;e?(b.collision_poly.cache_poly(b.width,b.height,b.angle),e=b.collision_poly):(this.temp_poly.set_from_quad(b.bquad,b.x,b.y,b.width,b.height),e=this.temp_poly);if(f){a.collision_poly.cache_poly(a.width,a.height,a.angle);var g=a.collision_poly}else this.temp_poly.set_from_quad(a.bquad,a.x,a.y,a.width,a.height),g=this.temp_poly;return e.intersects_poly(g,a.x-b.x,a.y-b.y)}e=
b.collision_poly&&!b.collision_poly.is_empty();f=a.collision_poly&&!a.collision_poly.is_empty();e?(b.collision_poly.cache_poly(b.width,b.height,b.angle),this.temp_poly.set_from_poly(b.collision_poly)):this.temp_poly.set_from_quad(b.bquad,b.x,b.y,b.width,b.height);e=this.temp_poly;f?(a.collision_poly.cache_poly(a.width,a.height,a.angle),this.temp_poly2.set_from_poly(a.collision_poly)):this.temp_poly2.set_from_quad(a.bquad,a.x,a.y,a.width,a.height);g=this.temp_poly2;f=0;for(d=e.pts_count;f<d;f++){var m=
2*f;var h=m+1;var l=e.pts_cache[m];var r=e.pts_cache[h];e.pts_cache[m]=c.layerToCanvas(l+b.x,r+b.y,!0);e.pts_cache[h]=c.layerToCanvas(l+b.x,r+b.y,!1)}e.update_bbox();f=0;for(d=g.pts_count;f<d;f++)m=2*f,h=m+1,l=g.pts_cache[m],r=g.pts_cache[h],g.pts_cache[m]=k.layerToCanvas(l+a.x,r+a.y,!0),g.pts_cache[h]=k.layerToCanvas(l+a.x,r+a.y,!1);g.update_bbox();return e.intersects_poly(g,0,0)};var z=new cr.quad,J=new cr.rect(0,0,0,0),I=[];a.prototype.testTilemapOverlap=function(b,a){var c,k=a.bbox,d=b.x,e=b.y;
b.getCollisionRectCandidates(k,I);var f=a.collision_poly&&!a.collision_poly.is_empty();b=0;for(c=I.length;b<c;++b){var g=I[b];var m=g.rc;if(k.intersects_rect_off(m,d,e)&&(z.set_from_rect(m),z.offset(d,e),z.intersects_quad(a.bquad)))if(f)if(a.collision_poly.cache_poly(a.width,a.height,a.angle),g.poly){if(g.poly.intersects_poly(a.collision_poly,a.x-(d+m.left),a.y-(e+m.top)))return cr.clearArray(I),!0}else{if(this.temp_poly.set_from_quad(z,0,0,m.right-m.left,m.bottom-m.top),this.temp_poly.intersects_poly(a.collision_poly,
a.x,a.y))return cr.clearArray(I),!0}else if(g.poly){if(this.temp_poly.set_from_quad(a.bquad,0,0,a.width,a.height),g.poly.intersects_poly(this.temp_poly,-(d+m.left),-(e+m.top)))return cr.clearArray(I),!0}else return cr.clearArray(I),!0}cr.clearArray(I);return!1};a.prototype.testRectOverlap=function(b,a){if(!a||!a.collisionsEnabled)return!1;a.update_bbox();if(!a.bbox.intersects_rect(b))return!1;if(a.tilemap_exists){a.getCollisionRectCandidates(b,I);var c,k=a.x,d=a.y;a=0;for(c=I.length;a<c;++a){var e=
I[a];var f=e.rc;if(b.intersects_rect_off(f,k,d))if(e.poly){if(this.temp_poly.set_from_rect(b,0,0),e.poly.intersects_poly(this.temp_poly,-(k+f.left),-(d+f.top)))return cr.clearArray(I),!0}else return cr.clearArray(I),!0}cr.clearArray(I);return!1}z.set_from_rect(b);if(!a.bquad.intersects_quad(z))return!1;if(!a.collision_poly||a.collision_poly.is_empty())return!0;a.collision_poly.cache_poly(a.width,a.height,a.angle);z.offset(-b.left,-b.top);this.temp_poly.set_from_quad(z,0,0,1,1);return a.collision_poly.intersects_poly(this.temp_poly,
b.left-a.x,b.top-a.y)};a.prototype.testSegmentOverlap=function(b,a,c,k,d){if(!d||!d.collisionsEnabled)return!1;d.update_bbox();J.set(cr.min(b,c),cr.min(a,k),cr.max(b,c),cr.max(a,k));if(!d.bbox.intersects_rect(J))return!1;if(d.tilemap_exists){d.getCollisionRectCandidates(J,I);var e,f=d.x,g=d.y;d=0;for(e=I.length;d<e;++d){var m=I[d];var h=m.rc;if(J.intersects_rect_off(h,f,g)&&(z.set_from_rect(h),z.offset(f,g),z.intersects_segment(b,a,c,k)))if(m.poly){if(m.poly.intersects_segment(f+h.left,g+h.top,b,
a,c,k))return cr.clearArray(I),!0}else return cr.clearArray(I),!0}cr.clearArray(I);return!1}if(!d.bquad.intersects_segment(b,a,c,k))return!1;if(!d.collision_poly||d.collision_poly.is_empty())return!0;d.collision_poly.cache_poly(d.width,d.height,d.angle);return d.collision_poly.intersects_segment(d.x,d.y,b,a,c,k)};a.prototype.typeHasBehavior=function(b,a){if(!a)return!1;var c,k;var d=0;for(c=b.behaviors.length;d<c;d++)if(b.behaviors[d].behavior instanceof a)return!0;if(!b.is_family)for(d=0,c=b.families.length;d<
c;d++){var e=b.families[d];var f=0;for(k=e.behaviors.length;f<k;f++)if(e.behaviors[f].behavior instanceof a)return!0}return!1};a.prototype.typeHasNoSaveBehavior=function(b){return this.typeHasBehavior(b,cr.behaviors.NoSave)};a.prototype.typeHasPersistBehavior=function(b){return this.typeHasBehavior(b,cr.behaviors.Persist)};a.prototype.getSolidBehavior=function(){return this.solidBehavior};a.prototype.getJumpthruBehavior=function(){return this.jumpthruBehavior};var M=[];a.prototype.testOverlapSolid=
function(b){var a;b.update_bbox();this.getSolidCollisionCandidates(b.layer,b.bbox,M);var c=0;for(a=M.length;c<a;++c){var k=M[c];if(k.extra.solidEnabled&&this.testOverlap(b,k))return cr.clearArray(M),k}cr.clearArray(M);return null};a.prototype.testRectOverlapSolid=function(b){var a;this.getSolidCollisionCandidates(null,b,M);var c=0;for(a=M.length;c<a;++c){var k=M[c];if(k.extra.solidEnabled&&this.testRectOverlap(b,k))return cr.clearArray(M),k}cr.clearArray(M);return null};var N=[];a.prototype.testOverlapJumpThru=
function(b,a){var c=null;a&&(c=N,cr.clearArray(c));b.update_bbox();this.getJumpthruCollisionCandidates(b.layer,b.bbox,M);var k;var d=0;for(k=M.length;d<k;++d){var e=M[d];if(e.extra.jumpthruEnabled&&this.testOverlap(b,e))if(a)c.push(e);else return cr.clearArray(M),e}cr.clearArray(M);return c};a.prototype.pushOutSolid=function(b,a,c,k,d,e){k=k||50;var f=b.x,g=b.y,m,h=null,l=null;for(m=0;m<k;m++)if(b.x=f+a*m,b.y=g+c*m,b.set_bbox_changed(),!this.testOverlap(b,h)&&((h=this.testOverlapSolid(b))&&(l=h),
!h&&(d&&(h=e?this.testOverlap(b,e)?e:null:this.testOverlapJumpThru(b))&&(l=h),!h)))return l&&this.pushInFractional(b,a,c,l,16),!0;b.x=f;b.y=g;b.set_bbox_changed();return!1};a.prototype.pushOutSolidAxis=function(b,a,c,k){k=k||50;var d=b.x,e=b.y,f=null,g=null,m,h;for(m=0;m<k;++m)for(h=0;2>h;++h){var l=2*h-1;b.x=d+a*m*l;b.y=e+c*m*l;b.set_bbox_changed();if(!this.testOverlap(b,f))if(f=this.testOverlapSolid(b))g=f;else return g&&this.pushInFractional(b,a*l,c*l,g,16),!0}b.x=d;b.y=e;b.set_bbox_changed();
return!1};a.prototype.pushOut=function(b,a,c,k,d){k=k||50;var e=b.x,f=b.y,g;for(g=0;g<k;g++)if(b.x=e+a*g,b.y=f+c*g,b.set_bbox_changed(),!this.testOverlap(b,d))return!0;b.x=e;b.y=f;b.set_bbox_changed();return!1};a.prototype.pushInFractional=function(b,a,c,k,d){var e=2,f=!1;var g=!1;for(var m=b.x,h=b.y;e<=d;)g=1/e,e*=2,b.x+=a*g*(f?1:-1),b.y+=c*g*(f?1:-1),b.set_bbox_changed(),this.testOverlap(b,k)?g=f=!0:(g=f=!1,m=b.x,h=b.y);g&&(b.x=m,b.y=h,b.set_bbox_changed())};a.prototype.pushOutSolidNearest=function(b,
a){a=cr.is_undefined(a)?100:a;var c=0,k=b.x,d=b.y,e=0,f=0,g=0,m=this.testOverlapSolid(b);if(!m)return!0;for(;c<=a;){switch(e){case 0:f=0;g=-1;c++;break;case 1:f=1;g=-1;break;case 2:f=1;g=0;break;case 3:g=f=1;break;case 4:f=0;g=1;break;case 5:f=-1;g=1;break;case 6:f=-1;g=0;break;case 7:g=f=-1}e=(e+1)%8;b.x=cr.floor(k+f*c);b.y=cr.floor(d+g*c);b.set_bbox_changed();if(!this.testOverlap(b,m)&&(m=this.testOverlapSolid(b),!m))return!0}b.x=k;b.y=d;b.set_bbox_changed();return!1};a.prototype.registerCollision=
function(b,a){b.collisionsEnabled&&a.collisionsEnabled&&this.registered_collisions.push([b,a])};a.prototype.addRegisteredCollisionCandidates=function(b,a,c){var k;var d=0;for(k=this.registered_collisions.length;d<k;++d){var e=this.registered_collisions[d];if(e[0]===b)e=e[1];else if(e[1]===b)e=e[0];else continue;if(a.is_family){if(-1===a.members.indexOf(a))continue}else if(e.type!==a)continue;-1===c.indexOf(e)&&c.push(e)}};a.prototype.checkRegisteredCollision=function(b,a){var c;var k=0;for(c=this.registered_collisions.length;k<
c;k++){var d=this.registered_collisions[k];if(d[0]===b&&d[1]===a||d[0]===a&&d[1]===b)return!0}return!1};a.prototype.calculateSolidBounceAngle=function(b,a,c,k){var d=b.x,e=b.y,f=cr.max(10,cr.distanceTo(a,c,d,e)),g=cr.angleTo(a,c,d,e),m=k||this.testOverlapSolid(b);if(!m)return cr.clamp_angle(g+cr.PI);var h=m,l,r=cr.to_radians(5);for(l=1;36>l;l++){var t=g-l*r;b.x=a+Math.cos(t)*f;b.y=c+Math.sin(t)*f;b.set_bbox_changed();if(!this.testOverlap(b,h)&&(h=k?null:this.testOverlapSolid(b),!h)){var w=t;break}}36===
l&&(w=cr.clamp_angle(g+cr.PI));h=m;for(l=1;36>l;l++)if(t=g+l*r,b.x=a+Math.cos(t)*f,b.y=c+Math.sin(t)*f,b.set_bbox_changed(),!this.testOverlap(b,h)&&(h=k?null:this.testOverlapSolid(b),!h)){var q=t;break}36===l&&(q=cr.clamp_angle(g+cr.PI));b.x=d;b.y=e;b.set_bbox_changed();if(q===w)return q;b=cr.angleDiff(q,w)/2;b=cr.angleClockwise(q,w)?cr.clamp_angle(w+b+cr.PI):cr.clamp_angle(q+b);w=Math.cos(g);g=Math.sin(g);q=Math.cos(b);b=Math.sin(b);a=w*q+g*b;return cr.angleTo(0,0,w-2*a*q,g-2*a*b)};var S=-1;a.prototype.trigger=
function(b,a,c){if(!this.running_layout)return!1;var k=this.running_layout.event_sheet;if(!k)return!1;var d=!1,e;S++;var f=k.deep_includes;var g=0;for(e=f.length;g<e;++g){var m=this.triggerOnSheet(b,a,f[g],c);d=d||m}m=this.triggerOnSheet(b,a,k,c);S--;return d||m};a.prototype.triggerOnSheet=function(b,a,c,k){var d=!1,e;if(a){var f=this.triggerOnSheetForTypeName(b,a,a.type.name,c,k);d=d||f;var g=a.type.families;var m=0;for(e=g.length;m<e;++m)f=this.triggerOnSheetForTypeName(b,a,g[m].name,c,k),d=d||
f}else f=this.triggerOnSheetForTypeName(b,a,"system",c,k),d=d||f;return d};a.prototype.triggerOnSheetForTypeName=function(b,a,c,k,d){var e,f=!1;var g="undefined"!==typeof d;var m=(g?k.fasttriggers:k.triggers)[c];if(!m)return f;var h=null;k=0;for(e=m.length;k<e;++k)if(m[k].method==b){h=m[k].evs;break}if(!h)return f;b=g?h[d]:h;if(!b)return null;k=0;for(e=b.length;k<e;k++)d=b[k][0],g=b[k][1],d=this.executeSingleTrigger(a,c,d,g),f=f||d;return f};a.prototype.executeSingleTrigger=function(b,a,c,k){var d,
e=!1;this.trigger_depth++;var f=this.getCurrentEventStack().current_event;f&&this.pushCleanSol(f.solModifiersIncludingParents);var g=1<this.trigger_depth;this.pushCleanSol(c.solModifiersIncludingParents);g&&this.pushLocalVarStack();var m=this.pushEventStack(c);m.current_event=c;if(b){var h=this.types[a].getCurrentSol();h.select_all=!1;cr.clearArray(h.instances);h.instances[0]=b;this.types[a].applySolToContainer()}b=!0;if(c.parent){a=m.temp_parents_arr;for(h=c.parent;h;)a.push(h),h=h.parent;a.reverse();
h=0;for(d=a.length;h<d;h++)if(!a[h].run_pretrigger()){b=!1;break}}b&&(this.execcount++,c.orblock?c.run_orblocktrigger(k):c.run(),e=e||m.last_event_true);this.popEventStack();g&&this.popLocalVarStack();this.popSol(c.solModifiersIncludingParents);f&&this.popSol(f.solModifiersIncludingParents);this.hasPendingInstances&&0===this.isInOnDestroy&&0===S&&!this.isRunningEvents&&this.ClearDeathRow();this.trigger_depth--;return e};a.prototype.getCurrentCondition=function(){var b=this.getCurrentEventStack();
return b.current_event.conditions[b.cndindex]};a.prototype.getCurrentConditionObjectType=function(){return this.getCurrentCondition().type};a.prototype.isCurrentConditionFirst=function(){return 0===this.getCurrentEventStack().cndindex};a.prototype.getCurrentAction=function(){var b=this.getCurrentEventStack();return b.current_event.actions[b.actindex]};a.prototype.pushLocalVarStack=function(){this.localvar_stack_index++;this.localvar_stack_index>=this.localvar_stack.length&&this.localvar_stack.push([])};
a.prototype.popLocalVarStack=function(){this.localvar_stack_index--};a.prototype.getCurrentLocalVarStack=function(){return this.localvar_stack[this.localvar_stack_index]};a.prototype.pushEventStack=function(b){this.event_stack_index++;this.event_stack_index>=this.event_stack.length&&this.event_stack.push(new cr.eventStackFrame);var a=this.getCurrentEventStack();a.reset(b);return a};a.prototype.popEventStack=function(){this.event_stack_index--};a.prototype.getCurrentEventStack=function(){return this.event_stack[this.event_stack_index]};
a.prototype.pushLoopStack=function(b){this.loop_stack_index++;this.loop_stack_index>=this.loop_stack.length&&this.loop_stack.push(cr.seal({name:b,index:0,stopped:!1}));var a=this.getCurrentLoop();a.name=b;a.index=0;a.stopped=!1;return a};a.prototype.popLoopStack=function(){this.loop_stack_index--};a.prototype.getCurrentLoop=function(){return this.loop_stack[this.loop_stack_index]};a.prototype.getEventVariableByName=function(b,a){for(var c,k,d,e,f;a;){c=0;for(k=a.subevents.length;c<k;c++)if(f=a.subevents[c],
f instanceof cr.eventvariable&&cr.equals_nocase(b,f.name))return f;a=a.parent}c=0;for(k=this.eventsheets_by_index.length;c<k;c++)for(e=this.eventsheets_by_index[c],a=0,d=e.events.length;a<d;a++)if(f=e.events[a],f instanceof cr.eventvariable&&cr.equals_nocase(b,f.name))return f;return null};a.prototype.getLayoutBySid=function(b){var a;var c=0;for(a=this.layouts_by_index.length;c<a;c++)if(this.layouts_by_index[c].sid===b)return this.layouts_by_index[c];return null};a.prototype.getObjectTypeBySid=function(b){var a;
var c=0;for(a=this.types_by_index.length;c<a;c++)if(this.types_by_index[c].sid===b)return this.types_by_index[c];return null};a.prototype.getGroupBySid=function(b){var a;var c=0;for(a=this.allGroups.length;c<a;c++)if(this.allGroups[c].sid===b)return this.allGroups[c];return null};a.prototype.doCanvasSnapshot=function(b,a){this.snapshotCanvas=[b,a];this.redraw=!0};a.prototype.signalContinuousPreview=function(){this.signalledContinuousPreview=!0};a.prototype.handleSaveLoad=function(){var b=this,a=this.saveToSlot,
k=this.lastSaveJson,f=this.loadFromSlot,g=!1;this.signalledContinuousPreview&&(g=!0,a="__c2_continuouspreview",this.signalledContinuousPreview=!1);if(a.length){this.ClearDeathRow();k=this.saveToJSONString();if(h()&&!this.isCocoonJs)e(a,k,function(){cr.logexport("Saved state to IndexedDB storage ("+k.length+" bytes)");b.lastSaveJson=k;b.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null);k=b.lastSaveJson="";g&&c()},function(d){try{localStorage.setItem("__c2save_"+a,k),cr.logexport("Saved state to WebStorage ("+
k.length+" bytes)"),b.lastSaveJson=k,b.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),k=b.lastSaveJson="",g&&c()}catch(R){cr.logexport("Failed to save game state: "+d+"; "+R),b.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}});else try{localStorage.setItem("__c2save_"+a,k),cr.logexport("Saved state to WebStorage ("+k.length+" bytes)"),b.lastSaveJson=k,this.trigger(cr.system_object.prototype.cnds.OnSaveComplete,null),k=b.lastSaveJson="",g&&c()}catch(U){cr.logexport("Error saving to WebStorage: "+
U),b.trigger(cr.system_object.prototype.cnds.OnSaveFailed,null)}this.loadFromSlot=this.saveToSlot="";this.loadFromJson=null}if(f.length){if(h()&&!this.isCocoonJs)d(f,function(a){a?(b.loadFromJson=a,cr.logexport("Loaded state from IndexedDB storage ("+b.loadFromJson.length+" bytes)")):(b.loadFromJson=localStorage.getItem("__c2save_"+f)||"",cr.logexport("Loaded state from WebStorage ("+b.loadFromJson.length+" bytes)"));b.suspendDrawing=!1;b.loadFromJson||(b.loadFromJson=null,b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,
null))},function(a){b.loadFromJson=localStorage.getItem("__c2save_"+f)||"";cr.logexport("Loaded state from WebStorage ("+b.loadFromJson.length+" bytes)");b.suspendDrawing=!1;b.loadFromJson||(b.loadFromJson=null,b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))});else{try{this.loadFromJson=localStorage.getItem("__c2save_"+f)||"",cr.logexport("Loaded state from WebStorage ("+this.loadFromJson.length+" bytes)")}catch(U){this.loadFromJson=null}this.suspendDrawing=!1;b.loadFromJson||(b.loadFromJson=
null,b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null))}this.saveToSlot=this.loadFromSlot=""}null!==this.loadFromJson&&(this.ClearDeathRow(),this.loadFromJSONString(this.loadFromJson)?(this.lastSaveJson=this.loadFromJson,this.trigger(cr.system_object.prototype.cnds.OnLoadComplete,null),this.lastSaveJson=""):b.trigger(cr.system_object.prototype.cnds.OnLoadFailed,null),this.loadFromJson=null)};a.prototype.saveToJSONString=function(){var a,c,k,d={c2save:!0,version:1,rt:{time:this.kahanTime.sum,
walltime:this.wallTime.sum,timescale:this.timescale,tickcount:this.tickcount,execcount:this.execcount,next_uid:this.next_uid,running_layout:this.running_layout.sid,start_time_offset:Date.now()-this.start_time},types:{},layouts:{},events:{groups:{},cnds:{},acts:{},vars:{}}};var e=0;for(a=this.types_by_index.length;e<a;e++){var f=this.types_by_index[e];if(!f.is_family&&!this.typeHasNoSaveBehavior(f)){var g={instances:[]};cr.hasAnyOwnProperty(f.extra)&&(g.ex=b(f.extra));var m=0;for(c=f.instances.length;m<
c;m++)g.instances.push(this.saveInstanceToJSON(f.instances[m]));d.types[f.sid.toString()]=g}}e=0;for(a=this.layouts_by_index.length;e<a;e++)m=this.layouts_by_index[e],d.layouts[m.sid.toString()]=m.saveToJSON();c=d.events.groups;e=0;for(a=this.allGroups.length;e<a;e++)m=this.allGroups[e],c[m.sid.toString()]=this.groups_by_name[m.group_name].group_active;a=d.events.cnds;for(k in this.cndsBySid)this.cndsBySid.hasOwnProperty(k)&&(e=this.cndsBySid[k],cr.hasAnyOwnProperty(e.extra)&&(a[k]={ex:b(e.extra)}));
a=d.events.acts;for(k in this.actsBySid)this.actsBySid.hasOwnProperty(k)&&(e=this.actsBySid[k],cr.hasAnyOwnProperty(e.extra)&&(a[k]={ex:b(e.extra)}));a=d.events.vars;for(k in this.varsBySid)this.varsBySid.hasOwnProperty(k)&&(e=this.varsBySid[k],e.is_constant||e.parent&&!e.is_static||(a[k]=e.data));d.system=this.system.saveToJSON();return JSON.stringify(d)};a.prototype.refreshUidMap=function(){var b,a;this.objectsByUid={};var c=0;for(b=this.types_by_index.length;c<b;c++){var k=this.types_by_index[c];
if(!k.is_family){var d=0;for(a=k.instances.length;d<a;d++){var e=k.instances[d];this.objectsByUid[e.uid.toString()]=e}}}};a.prototype.loadFromJSONString=function(b){try{var a=JSON.parse(b)}catch(W){return!1}if(!a.c2save||1<a.version)return!1;this.isLoadingState=!0;b=a.rt;this.kahanTime.reset();this.kahanTime.sum=b.time;this.wallTime.reset();this.wallTime.sum=b.walltime||0;this.timescale=b.timescale;this.tickcount=b.tickcount;this.execcount=b.execcount;this.start_time=Date.now()-b.start_time_offset;
var c=b.running_layout;if(c!==this.running_layout.sid)if(c=this.getLayoutBySid(c))this.doChangeLayout(c);else return;var k,d,e;var f=a.types;for(d in f)if(f.hasOwnProperty(d)&&(e=this.getObjectTypeBySid(parseInt(d,10)))&&!e.is_family&&!this.typeHasNoSaveBehavior(e)){f[d].ex?e.extra=f[d].ex:cr.wipe(e.extra);var g=e.instances;var m=f[d].instances;c=0;for(k=cr.min(g.length,m.length);c<k;c++)this.loadInstanceFromJSON(g[c],m[c]);c=m.length;for(k=g.length;c<k;c++)this.DestroyInstance(g[c]);c=g.length;for(k=
m.length;c<k;c++){g=null;if(e.plugin.is_world&&(g=this.running_layout.getLayerBySid(m[c].w.l),!g))continue;g=this.createInstanceFromInit(e.default_instance,g,!1,0,0,!0);this.loadInstanceFromJSON(g,m[c])}e.stale_iids=!0}this.ClearDeathRow();this.refreshUidMap();k=a.layouts;for(d in k)k.hasOwnProperty(d)&&(c=this.getLayoutBySid(parseInt(d,10)))&&c.loadFromJSON(k[d]);k=a.events.groups;for(d in k)k.hasOwnProperty(d)&&(c=this.getGroupBySid(parseInt(d,10)))&&this.groups_by_name[c.group_name]&&this.groups_by_name[c.group_name].setGroupActive(k[d]);
c=a.events.cnds;for(d in this.cndsBySid)this.cndsBySid.hasOwnProperty(d)&&(c.hasOwnProperty(d)?this.cndsBySid[d].extra=c[d].ex:this.cndsBySid[d].extra={});c=a.events.acts;for(d in this.actsBySid)this.actsBySid.hasOwnProperty(d)&&(c.hasOwnProperty(d)?this.actsBySid[d].extra=c[d].ex:this.actsBySid[d].extra={});c=a.events.vars;for(d in c)c.hasOwnProperty(d)&&this.varsBySid.hasOwnProperty(d)&&(this.varsBySid[d].data=c[d]);this.next_uid=b.next_uid;this.isLoadingState=!1;c=0;for(k=this.fireOnCreateAfterLoad.length;c<
k;++c)g=this.fireOnCreateAfterLoad[c],this.trigger(Object.getPrototypeOf(g.type.plugin).cnds.OnCreated,g);cr.clearArray(this.fireOnCreateAfterLoad);this.system.loadFromJSON(a.system);c=0;for(k=this.types_by_index.length;c<k;c++)if(e=this.types_by_index[c],!e.is_family&&!this.typeHasNoSaveBehavior(e))for(a=0,d=e.instances.length;a<d;a++){g=e.instances[a];if(e.is_contained)for(f=g.get_iid(),cr.clearArray(g.siblings),b=0,m=e.container.length;b<m;b++){var h=e.container[b];e!==h&&g.siblings.push(h.instances[f])}g.afterLoad&&
g.afterLoad();if(g.behavior_insts)for(b=0,m=g.behavior_insts.length;b<m;b++)f=g.behavior_insts[b],f.afterLoad&&f.afterLoad()}return this.redraw=!0};a.prototype.saveInstanceToJSON=function(a,c){var k;var d=a.type;var e=d.plugin;var f={};c?f.c2=!0:f.uid=a.uid;cr.hasAnyOwnProperty(a.extra)&&(f.ex=b(a.extra));if(a.instance_vars&&a.instance_vars.length)for(f.ivs={},c=0,k=a.instance_vars.length;c<k;c++)f.ivs[a.type.instvar_sids[c].toString()]=a.instance_vars[c];if(e.is_world){e={x:a.x,y:a.y,w:a.width,h:a.height,
l:a.layer.sid,zi:a.get_zindex()};0!==a.angle&&(e.a=a.angle);1!==a.opacity&&(e.o=a.opacity);.5!==a.hotspotX&&(e.hX=a.hotspotX);.5!==a.hotspotY&&(e.hY=a.hotspotY);0!==a.blend_mode&&(e.bm=a.blend_mode);a.visible||(e.v=a.visible);a.collisionsEnabled||(e.ce=a.collisionsEnabled);-1!==a.my_timescale&&(e.mts=a.my_timescale);if(d.effect_types.length)for(e.fx=[],c=0,k=d.effect_types.length;c<k;c++){var g=d.effect_types[c];e.fx.push({name:g.name,active:a.active_effect_flags[g.index],params:a.effect_params[g.index]})}f.w=
e}if(a.behavior_insts&&a.behavior_insts.length)for(f.behs={},c=0,k=a.behavior_insts.length;c<k;c++)d=a.behavior_insts[c],d.saveToJSON&&(f.behs[d.type.sid.toString()]=d.saveToJSON());a.saveToJSON&&(f.data=a.saveToJSON());return f};a.prototype.getInstanceVarIndexBySid=function(b,a){var c;var k=0;for(c=b.instvar_sids.length;k<c;k++)if(b.instvar_sids[k]===a)return k;return-1};a.prototype.getBehaviorIndexBySid=function(b,a){var c;var k=0;for(c=b.behavior_insts.length;k<c;k++)if(b.behavior_insts[k].type.sid===
a)return k;return-1};a.prototype.loadInstanceFromJSON=function(b,a,c){var k,d;var e=b.type;var f=e.plugin;if(c){if(!a.c2)return}else b.uid=a.uid;a.ex?b.extra=a.ex:cr.wipe(b.extra);if(d=a.ivs)for(k in d)if(d.hasOwnProperty(k)){var g=this.getInstanceVarIndexBySid(e,parseInt(k,10));if(!(0>g||g>=b.instance_vars.length)){var m=d[k];null===m&&(m=NaN);b.instance_vars[g]=m}}if(f.is_world){g=a.w;b.layer.sid!==g.l&&(d=b.layer,b.layer=this.running_layout.getLayerBySid(g.l),b.layer?(d.removeFromInstanceList(b,
!0),b.layer.appendToInstanceList(b,!0),b.set_bbox_changed(),b.layer.setZIndicesStaleFrom(0)):(b.layer=d,c||this.DestroyInstance(b)));b.x=g.x;b.y=g.y;b.width=g.w;b.height=g.h;b.zindex=g.zi;b.angle=g.hasOwnProperty("a")?g.a:0;b.opacity=g.hasOwnProperty("o")?g.o:1;b.hotspotX=g.hasOwnProperty("hX")?g.hX:.5;b.hotspotY=g.hasOwnProperty("hY")?g.hY:.5;b.visible=g.hasOwnProperty("v")?g.v:!0;b.collisionsEnabled=g.hasOwnProperty("ce")?g.ce:!0;b.my_timescale=g.hasOwnProperty("mts")?g.mts:-1;b.blend_mode=g.hasOwnProperty("bm")?
g.bm:0;b.compositeOp=cr.effectToCompositeOp(b.blend_mode);this.gl&&cr.setGLBlend(b,b.blend_mode,this.gl);b.set_bbox_changed();if(g.hasOwnProperty("fx"))for(c=0,d=g.fx.length;c<d;c++)m=e.getEffectIndexByName(g.fx[c].name),0>m||(b.active_effect_flags[m]=g.fx[c].active,b.effect_params[m]=g.fx[c].params);b.updateActiveEffects()}if(e=a.behs)for(k in e)e.hasOwnProperty(k)&&(c=this.getBehaviorIndexBySid(b,parseInt(k,10)),0>c||b.behavior_insts[c].loadFromJSON(e[k]));a.data&&b.loadFromJSON(a.data)};a.prototype.fetchLocalFileViaCordova=
function(b,a,c){window.resolveLocalFileSystemURL(cordova.file.applicationDirectory+"www/"+b,function(b){b.file(a,c)},c)};a.prototype.fetchLocalFileViaCordovaAsText=function(b,a,c){this.fetchLocalFileViaCordova(b,function(b){var k=new FileReader;k.onload=function(b){a(b.target.result)};k.onerror=c;k.readAsText(b)},c)};var K=[],H=0;a.prototype.maybeStartNextArrayBufferRead=function(){if(K.length&&!(8<=H)){H++;var b=K.shift();this.doFetchLocalFileViaCordovaAsArrayBuffer(b.filename,b.successCallback,
b.errorCallback)}};a.prototype.fetchLocalFileViaCordovaAsArrayBuffer=function(b,a,c){var k=this;K.push({filename:b,successCallback:function(b){H--;k.maybeStartNextArrayBufferRead();a(b)},errorCallback:function(b){H--;k.maybeStartNextArrayBufferRead();c(b)}});this.maybeStartNextArrayBufferRead()};a.prototype.doFetchLocalFileViaCordovaAsArrayBuffer=function(b,a,c){this.fetchLocalFileViaCordova(b,function(b){var c=new FileReader;c.onload=function(b){a(b.target.result)};c.readAsArrayBuffer(b)},c)};a.prototype.fetchLocalFileViaCordovaAsURL=
function(b,a,c){var k="",d=b.toLowerCase(),e=d.substr(d.length-4);d=d.substr(d.length-5);".mp4"===e?k="video/mp4":".webm"===d?k="video/webm":".m4a"===e?k="audio/mp4":".mp3"===e&&(k="audio/mpeg");this.fetchLocalFileViaCordovaAsArrayBuffer(b,function(b){b=new Blob([b],{type:k});b=URL.createObjectURL(b);a(b)},c)};a.prototype.isAbsoluteUrl=function(b){return/^(?:[a-z]+:)?\/\//.test(b)||"data:"===b.substr(0,5)||"blob:"===b.substr(0,5)};a.prototype.setImageSrc=function(b,a){this.isWKWebView&&!this.isAbsoluteUrl(a)?
this.fetchLocalFileViaCordovaAsURL(a,function(a){b.src=a},function(b){alert("Failed to load image: "+b)}):b.src=a};a.prototype.setCtxImageSmoothingEnabled=function(b,a){"undefined"!==typeof b.imageSmoothingEnabled?b.imageSmoothingEnabled=a:(b.webkitImageSmoothingEnabled=a,b.mozImageSmoothingEnabled=a,b.msImageSmoothingEnabled=a)};cr.runtime=a;cr.createRuntime=function(b){return new a(document.getElementById(b))};cr.createDCRuntime=function(b,c){return new a({dc:!0,width:b,height:c})};window.cr_createRuntime=
cr.createRuntime;window.cr_createDCRuntime=cr.createDCRuntime;window.createCocoonJSRuntime=function(){window.c2cocoonjs=!0;var b=document.createElement("screencanvas")||document.createElement("canvas");b.screencanvas=!0;document.body.appendChild(b);b=new a(b);window.c2runtime=b;window.addEventListener("orientationchange",function(){window.c2runtime.setSize(window.innerWidth,window.innerHeight)});window.c2runtime.setSize(window.innerWidth,window.innerHeight);return b};window.createEjectaRuntime=function(){var b=
document.getElementById("canvas");b=new a(b);window.c2runtime=b;window.c2runtime.setSize(window.innerWidth,window.innerHeight);return b}})();window.cr_getC2Runtime=function(){var a=document.getElementById("c2canvas");return a?a.c2runtime:window.c2runtime?window.c2runtime:null};window.cr_getSnapshot=function(a,f){var h=window.cr_getC2Runtime();h&&h.doCanvasSnapshot(a,f)};window.cr_sizeCanvas=function(a,f){if(0!==a&&0!==f){var h=window.cr_getC2Runtime();h&&h.setSize(a,f)}};
window.cr_setSuspended=function(a){var f=window.cr_getC2Runtime();f&&f.setSuspended(a)};
(function(){function a(b,a){this.runtime=b;this.event_sheet=null;this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;this.scale=1;this.angle=0;this.first_visit=!0;this.name=a[0];this.originalWidth=a[1];this.originalHeight=a[2];this.width=a[1];this.height=a[2];this.unbounded_scrolling=a[3];this.sheetname=a[4];this.sid=a[5];var c=a[6],k;this.layers=[];this.initial_types=[];b=0;for(k=c.length;b<k;b++){var d=new cr.layer(this,c[b]);d.number=b;cr.seal(d);this.layers.push(d)}c=
a[7];this.initial_nonworld=[];b=0;for(k=c.length;b<k;b++){d=c[b];var e=this.runtime.types_by_index[d[1]];e.default_instance||(e.default_instance=d);this.initial_nonworld.push(d);-1===this.initial_types.indexOf(e)&&this.initial_types.push(e)}this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];b=0;for(k=a[8].length;b<k;b++)this.effect_types.push({id:a[8][b][0],name:a[8][b][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:b}),this.effect_params.push(a[8][b][2].slice(0));
this.updateActiveEffects();this.rcTex=new cr.rect(0,0,1,1);this.rcTex2=new cr.rect(0,0,1,1);this.persist_data={}}function f(b,a){return b.zindex-a.zindex}function h(b,a){this.layout=b;this.runtime=b.runtime;this.instances=[];this.scale=1;this.angle=0;this.disableAngle=!1;this.tmprect=new cr.rect(0,0,0,0);this.tmpquad=new cr.quad;this.viewBottom=this.viewTop=this.viewRight=this.viewLeft=0;this.zindices_stale=!1;this.zindices_stale_from=-1;this.clear_earlyz_index=0;this.name=a[0];this.index=a[1];this.sid=
a[2];this.visible=a[3];this.background_color=a[4];this.transparent=a[5];this.parallaxX=a[6];this.parallaxY=a[7];this.opacity=a[8];this.forceOwnTexture=a[9];this.useRenderCells=a[10];this.zoomRate=a[11];this.blend_mode=a[12];this.effect_fallback=a[13];this.compositeOp="source-over";this.destBlend=this.srcBlend=0;this.render_grid=null;this.last_render_list=g();this.render_list_stale=!0;this.last_render_cells=new cr.rect(0,0,-1,-1);this.cur_render_cells=new cr.rect(0,0,-1,-1);this.useRenderCells&&(this.render_grid=
new cr.RenderGrid(this.runtime.original_width,this.runtime.original_height));this.render_offscreen=!1;b=a[14];var c;this.startup_initial_instances=[];this.initial_instances=[];this.created_globals=[];var k=0;for(c=b.length;k<c;k++){var d=b[k],e=this.runtime.types_by_index[d[1]];e.default_instance||(e.default_instance=d,e.default_layerindex=this.index);this.initial_instances.push(d);-1===this.layout.initial_types.indexOf(e)&&this.layout.initial_types.push(e)}cr.shallowAssignArray(this.startup_initial_instances,
this.initial_instances);this.effect_types=[];this.active_effect_types=[];this.shaders_preserve_opaqueness=!0;this.effect_params=[];k=0;for(c=a[15].length;k<c;k++)this.effect_types.push({id:a[15][k][0],name:a[15][k][1],shaderindex:-1,preservesOpaqueness:!1,active:!0,index:k}),this.effect_params.push(a[15][k][2].slice(0));this.updateActiveEffects();this.rcTex=new cr.rect(0,0,1,1);this.rcTex2=new cr.rect(0,0,1,1)}function g(){return l.length?l.pop():[]}function e(b){cr.clearArray(b);l.push(b)}a.prototype.saveObjectToPersist=
function(b){var a=b.type.sid.toString();this.persist_data.hasOwnProperty(a)||(this.persist_data[a]=[]);this.persist_data[a].push(this.runtime.saveInstanceToJSON(b))};a.prototype.hasOpaqueBottomLayer=function(){var b=this.layers[0];return!b.transparent&&1===b.opacity&&!b.forceOwnTexture&&b.visible};a.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var b;var a=0;for(b=this.effect_types.length;a<b;a++){var c=this.effect_types[a];c.active&&
(this.active_effect_types.push(c),c.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};a.prototype.getEffectByName=function(b){var a;var c=0;for(a=this.effect_types.length;c<a;c++){var k=this.effect_types[c];if(k.name===b)return k}return null};var d=[],c=!0;a.prototype.startRunning=function(){this.sheetname&&(this.event_sheet=this.runtime.eventsheets[this.sheetname],this.event_sheet.updateDeepIncludes());this.runtime.running_layout=this;this.width=this.originalWidth;this.height=this.originalHeight;
this.scrollX=this.runtime.original_width/2;this.scrollY=this.runtime.original_height/2;var b,a;var e=0;for(b=this.runtime.types_by_index.length;e<b;e++){var g=this.runtime.types_by_index[e];if(!g.is_family){var h=g.instances;g=0;for(a=h.length;g<a;g++){var l=h[g];if(l.layer){var n=l.layer.number;n>=this.layers.length&&(n=this.layers.length-1);l.layer=this.layers[n];-1===l.layer.instances.indexOf(l)&&l.layer.instances.push(l);l.layer.zindices_stale=!0}}}}if(!c)for(e=0,b=this.layers.length;e<b;++e)this.layers[e].instances.sort(f);
cr.clearArray(d);this.boundScrolling();e=0;for(b=this.layers.length;e<b;e++)l=this.layers[e],l.createInitialInstances(),l.updateViewport(null);h=!1;if(!this.first_visit){for(x in this.persist_data)if(this.persist_data.hasOwnProperty(x)&&(g=this.runtime.getObjectTypeBySid(parseInt(x,10)))&&!g.is_family&&this.runtime.typeHasPersistBehavior(g)){a=this.persist_data[x];e=0;for(b=a.length;e<b;e++){l=null;if(g.plugin.is_world&&(l=this.getLayerBySid(a[e].w.l),!l))continue;l=this.runtime.createInstanceFromInit(g.default_instance,
l,!1,0,0,!0);this.runtime.loadInstanceFromJSON(l,a[e]);h=!0;d.push(l)}cr.clearArray(a)}e=0;for(b=this.layers.length;e<b;e++)this.layers[e].instances.sort(f),this.layers[e].zindices_stale=!0}h&&(this.runtime.ClearDeathRow(),this.runtime.refreshUidMap());for(e=0;e<d.length;e++)if(l=d[e],l.type.is_contained)for(b=l.get_iid(),g=0,a=l.type.container.length;g<a;g++){var x=l.type.container[g];l.type!==x&&(x.instances.length>b?l.siblings.push(x.instances[b]):x.default_instance&&(h=this.runtime.createInstanceFromInit(x.default_instance,
l.layer,!0,l.x,l.y,!0),this.runtime.ClearDeathRow(),x.updateIIDs(),l.siblings.push(h),d.push(h)))}e=0;for(b=this.initial_nonworld.length;e<b;e++)l=this.initial_nonworld[e],g=this.runtime.types_by_index[l[1]],g.is_contained||this.runtime.createInstanceFromInit(this.initial_nonworld[e],null,!0);this.runtime.changelayout=null;this.runtime.ClearDeathRow();if(this.runtime.ctx&&!this.runtime.isDomFree)for(e=0,b=this.runtime.types_by_index.length;e<b;e++)x=this.runtime.types_by_index[e],!x.is_family&&x.instances.length&&
x.preloadCanvas2D&&x.preloadCanvas2D(this.runtime.ctx);if(this.runtime.isLoadingState)cr.shallowAssignArray(this.runtime.fireOnCreateAfterLoad,d);else for(e=0,b=d.length;e<b;e++)l=d[e],this.runtime.trigger(Object.getPrototypeOf(l.type.plugin).cnds.OnCreated,l);cr.clearArray(d);this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutStart,null);this.first_visit=!1};a.prototype.createGlobalNonWorlds=function(){var b,a;var c=b=0;for(a=this.initial_nonworld.length;b<
a;b++){var d=this.initial_nonworld[b];var e=this.runtime.types_by_index[d[1]];e.global?e.is_contained||this.runtime.createInstanceFromInit(d,null,!0):(this.initial_nonworld[c]=d,c++)}cr.truncateArray(this.initial_nonworld,c)};a.prototype.stopRunning=function(){this.runtime.isLoadingState||this.runtime.trigger(cr.system_object.prototype.cnds.OnLayoutEnd,null);this.runtime.isEndingLayout=!0;cr.clearArray(this.runtime.system.waits);var b,a;if(!this.first_visit){var d=0;for(b=this.layers.length;d<b;d++){this.layers[d].updateZIndices();
var e=this.layers[d].instances;var f=0;for(a=e.length;f<a;f++){var g=e[f];g.type.global||this.runtime.typeHasPersistBehavior(g.type)&&this.saveObjectToPersist(g)}}}d=0;for(b=this.layers.length;d<b;d++){e=this.layers[d].instances;f=0;for(a=e.length;f<a;f++)g=e[f],g.type.global||this.runtime.DestroyInstance(g);this.runtime.ClearDeathRow();cr.clearArray(e);this.layers[d].zindices_stale=!0}d=0;for(b=this.runtime.types_by_index.length;d<b;d++)if(e=this.runtime.types_by_index[d],!(e.global||e.plugin.is_world||
e.plugin.singleglobal||e.is_family)){f=0;for(a=e.instances.length;f<a;f++)this.runtime.DestroyInstance(e.instances[f]);this.runtime.ClearDeathRow()}c=!1;this.runtime.isEndingLayout=!1};var b=new cr.rect(0,0,0,0);a.prototype.recreateInitialObjects=function(a,c,d,e,f){b.set(c,d,e,f);c=0;for(d=this.layers.length;c<d;c++)this.layers[c].recreateInitialObjects(a,b)};a.prototype.draw=function(b){var a=b,c=!1,k=!this.runtime.fullscreenScalingQuality;if(k){if(!this.runtime.layout_canvas){this.runtime.layout_canvas=
document.createElement("canvas");var d=this.runtime.layout_canvas;d.width=this.runtime.draw_width;d.height=this.runtime.draw_height;this.runtime.layout_ctx=d.getContext("2d");c=!0}d=this.runtime.layout_canvas;a=this.runtime.layout_ctx;d.width!==this.runtime.draw_width&&(d.width=this.runtime.draw_width,c=!0);d.height!==this.runtime.draw_height&&(d.height=this.runtime.draw_height,c=!0);c&&this.runtime.setCtxImageSmoothingEnabled(a,this.runtime.linearSampling)}a.globalAlpha=1;a.globalCompositeOperation=
"source-over";this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&a.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height);var e;c=0;for(e=this.layers.length;c<e;c++){var f=this.layers[c];f.visible&&0<f.opacity&&11!==f.blend_mode&&(f.instances.length||!f.transparent)?f.draw(a):f.updateViewport(null)}k&&b.drawImage(d,0,0,this.runtime.width,this.runtime.height)};a.prototype.drawGL_earlyZPass=function(b){b.setEarlyZPass(!0);this.runtime.layout_tex||(this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,
this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||b.setSize(this.runtime.draw_width,this.runtime.draw_height);var a;for(a=
this.layers.length-1;0<=a;--a){var c=this.layers[a];c.visible&&1===c.opacity&&c.shaders_preserve_opaqueness&&0===c.blend_mode&&(c.instances.length||!c.transparent)?c.drawGL_earlyZPass(b):c.updateViewport(null)}b.setEarlyZPass(!1)};a.prototype.drawGL=function(b){var a=0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack;if(a){this.runtime.layout_tex||(this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,
this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layout_tex.c2width!==this.runtime.draw_width||this.runtime.layout_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layout_tex);this.runtime.fullscreenScalingQuality||b.setSize(this.runtime.draw_width,this.runtime.draw_height)}else this.runtime.layout_tex&&
(b.setRenderingToTexture(null),b.deleteTexture(this.runtime.layout_tex),this.runtime.layout_tex=null);this.runtime.clearBackground&&!this.hasOpaqueBottomLayer()&&b.clear(0,0,0,0);var c;var k=0;for(c=this.layers.length;k<c;k++){var d=this.layers[k];d.visible&&0<d.opacity&&(d.instances.length||!d.transparent)?d.drawGL(b):d.updateViewport(null)}a&&(0===this.active_effect_types.length||1===this.active_effect_types.length&&this.runtime.fullscreenScalingQuality?(1===this.active_effect_types.length?(a=this.active_effect_types[0].index,
b.switchProgram(this.active_effect_types[0].shaderindex),b.setProgramParameters(null,1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,this.scale,this.angle,0,0,this.runtime.draw_width/2,this.runtime.draw_height/2,this.runtime.kahanTime.sum,this.effect_params[a]),b.programIsAnimated(this.active_effect_types[0].shaderindex)&&(this.runtime.redraw=!0)):b.switchProgram(0),this.runtime.fullscreenScalingQuality||b.setSize(this.runtime.width,this.runtime.height),b.setRenderingToTexture(null),
b.setDepthTestEnabled(!1),b.setOpacity(1),b.setTexture(this.runtime.layout_tex),b.setAlphaBlend(),b.resetModelView(),b.updateModelView(),a=this.runtime.width/2,k=this.runtime.height/2,b.quad(-a,k,a,k,a,-k,-a,-k),b.setTexture(null),b.setDepthTestEnabled(!0)):this.renderEffectChain(b,null,null,null))};a.prototype.getRenderTarget=function(){return 0<this.active_effect_types.length||this.runtime.uses_background_blending||!this.runtime.fullscreenScalingQuality||this.runtime.enableFrontToBack?this.runtime.layout_tex:
null};a.prototype.getMinLayerScale=function(){var b=this.layers[0].getScale(),a;var c=1;for(a=this.layers.length;c<a;c++){var d=this.layers[c];(0!==d.parallaxX||0!==d.parallaxY)&&d.getScale()<b&&(b=d.getScale())}return b};a.prototype.scrollToX=function(b){if(!this.unbounded_scrolling){var a=this.runtime.draw_width*(1/this.getMinLayerScale())/2;b>this.width-a&&(b=this.width-a);b<a&&(b=a)}this.scrollX!==b&&(this.scrollX=b,this.runtime.redraw=!0)};a.prototype.scrollToY=function(b){if(!this.unbounded_scrolling){var a=
this.runtime.draw_height*(1/this.getMinLayerScale())/2;b>this.height-a&&(b=this.height-a);b<a&&(b=a)}this.scrollY!==b&&(this.scrollY=b,this.runtime.redraw=!0)};a.prototype.boundScrolling=function(){this.scrollToX(this.scrollX);this.scrollToY(this.scrollY)};a.prototype.renderEffectChain=function(b,a,c,d){var k=c?c.active_effect_types:a?a.active_effect_types:this.active_effect_types,e=1,f=0,g=0,h=0,l=this.runtime.draw_width,m=this.runtime.draw_height;c?(e=c.layer.getScale(),f=c.layer.getAngle(),g=c.layer.viewLeft,
h=c.layer.viewTop,l=c.layer.viewRight,m=c.layer.viewBottom):a&&(e=a.getScale(),f=a.getAngle(),g=a.viewLeft,h=a.viewTop,l=a.viewRight,m=a.viewBottom);var n=this.runtime.fx_tex,r,t,q=0,p=1,v=this.runtime.draw_width,z=this.runtime.draw_height,J=v/2,I=z/2,M=a?a.rcTex:this.rcTex,N=a?a.rcTex2:this.rcTex2,S=0,K=0,H=0,E=0,C=v,T=v,L=z,F=z,U=t=0;var R=c?c.layer.getAngle():0;if(c){var V=0;for(r=k.length;V<r;V++)t+=b.getProgramBoxExtendHorizontal(k[V].shaderindex),U+=b.getProgramBoxExtendVertical(k[V].shaderindex);
E=c.bbox;S=a.layerToCanvas(E.left,E.top,!0,!0);H=a.layerToCanvas(E.left,E.top,!1,!0);C=a.layerToCanvas(E.right,E.bottom,!0,!0);L=a.layerToCanvas(E.right,E.bottom,!1,!0);0!==R&&(V=a.layerToCanvas(E.right,E.top,!0,!0),r=a.layerToCanvas(E.right,E.top,!1,!0),K=a.layerToCanvas(E.left,E.bottom,!0,!0),E=a.layerToCanvas(E.left,E.bottom,!1,!0),R=Math.min(S,C,V,K),C=Math.max(S,C,V,K),S=R,R=Math.min(H,L,r,E),L=Math.max(H,L,r,E),H=R);S-=t;H-=U;C+=t;L+=U;N.left=S/v;N.top=1-H/z;N.right=C/v;N.bottom=1-L/z;K=S=cr.floor(S);
E=H=cr.floor(H);T=C=cr.ceil(C);F=L=cr.ceil(L);K-=t;E-=U;T+=t;F+=U;0>S&&(S=0);0>H&&(H=0);C>v&&(C=v);L>z&&(L=z);0>K&&(K=0);0>E&&(E=0);T>v&&(T=v);F>z&&(F=z);M.left=S/v;M.top=1-H/z;M.right=C/v;M.bottom=1-L/z}else M.left=N.left=0,M.top=N.top=0,M.right=N.right=1,M.bottom=N.bottom=1;U=c&&(b.programUsesDest(k[0].shaderindex)||0!==t||0!==U||1!==c.opacity||c.type.plugin.must_predraw)||a&&!c&&1!==a.opacity;b.setAlphaBlend();if(U){n[q]||(n[q]=b.createEmptyTexture(v,z,this.runtime.linearSampling));if(n[q].c2width!==
v||n[q].c2height!==z)b.deleteTexture(n[q]),n[q]=b.createEmptyTexture(v,z,this.runtime.linearSampling);b.switchProgram(0);b.setRenderingToTexture(n[q]);var X=F-E;b.clearRect(K,z-E-X,T-K,X);c?c.drawGL(b):(b.setTexture(this.runtime.layer_tex),b.setOpacity(a.opacity),b.resetModelView(),b.translate(-J,-I),b.updateModelView(),b.quadTex(S,L,C,L,C,H,S,H,M));N.left=N.top=0;N.right=N.bottom=1;c&&(R=M.top,M.top=M.bottom,M.bottom=R);q=1;p=0}b.setOpacity(1);t=k.length-1;var Z=b.programUsesCrossSampling(k[t].shaderindex)||
!a&&!c&&!this.runtime.fullscreenScalingQuality;V=0;for(r=k.length;V<r;V++){n[q]||(n[q]=b.createEmptyTexture(v,z,this.runtime.linearSampling));if(n[q].c2width!==v||n[q].c2height!==z)b.deleteTexture(n[q]),n[q]=b.createEmptyTexture(v,z,this.runtime.linearSampling);b.switchProgram(k[V].shaderindex);R=k[V].index;b.programIsAnimated(k[V].shaderindex)&&(this.runtime.redraw=!0);if(0!=V||U){b.setProgramParameters(d,1/v,1/z,N.left,N.top,N.right,N.bottom,e,f,g,h,(g+l)/2,(h+m)/2,this.runtime.kahanTime.sum,c?
c.effect_params[R]:a?a.effect_params[R]:this.effect_params[R]);b.setTexture(null);if(V!==t||Z){b.setRenderingToTexture(n[q]);X=F-E;var W=z-E-X;b.clearRect(K,W,T-K,X)}else c?b.setBlend(c.srcBlend,c.destBlend):a&&b.setBlend(a.srcBlend,a.destBlend),b.setRenderingToTexture(d);b.setTexture(n[p]);b.resetModelView();b.translate(-J,-I);b.updateModelView();b.quadTex(S,L,C,L,C,H,S,H,M);V!==t||Z||b.setTexture(null)}else b.setRenderingToTexture(n[q]),X=F-E,W=z-E-X,b.clearRect(K,W,T-K,X),c?(c.curFrame&&c.curFrame.texture_img?
(W=c.curFrame.texture_img,p=1/W.width,W=1/W.height):(p=1/c.width,W=1/c.height),b.setProgramParameters(d,p,W,N.left,N.top,N.right,N.bottom,e,f,g,h,(g+l)/2,(h+m)/2,this.runtime.kahanTime.sum,c.effect_params[R]),c.drawGL(b)):(b.setProgramParameters(d,1/v,1/z,0,0,1,1,e,f,g,h,(g+l)/2,(h+m)/2,this.runtime.kahanTime.sum,a?a.effect_params[R]:this.effect_params[R]),b.setTexture(a?this.runtime.layer_tex:this.runtime.layout_tex),b.resetModelView(),b.translate(-J,-I),b.updateModelView(),b.quadTex(S,L,C,L,C,H,
S,H,M)),N.left=N.top=0,N.right=N.bottom=1,c&&!Z&&(R=L,L=H,H=R);q=0===q?1:0;p=0===q?1:0}Z&&(b.switchProgram(0),c?b.setBlend(c.srcBlend,c.destBlend):a?b.setBlend(a.srcBlend,a.destBlend):this.runtime.fullscreenScalingQuality||(b.setSize(this.runtime.width,this.runtime.height),J=this.runtime.width/2,I=this.runtime.height/2,H=S=0,C=this.runtime.width,L=this.runtime.height),b.setRenderingToTexture(d),b.setTexture(n[p]),b.resetModelView(),b.translate(-J,-I),b.updateModelView(),c&&1===k.length&&!U?b.quadTex(S,
H,C,H,C,L,S,L,M):b.quadTex(S,L,C,L,C,H,S,H,M),b.setTexture(null))};a.prototype.getLayerBySid=function(b){var a;var c=0;for(a=this.layers.length;c<a;c++)if(this.layers[c].sid===b)return this.layers[c];return null};a.prototype.saveToJSON=function(){var b,a={sx:this.scrollX,sy:this.scrollY,s:this.scale,a:this.angle,w:this.width,h:this.height,fv:this.first_visit,persist:this.persist_data,fx:[],layers:{}};var c=0;for(b=this.effect_types.length;c<b;c++){var d=this.effect_types[c];a.fx.push({name:d.name,
active:d.active,params:this.effect_params[d.index]})}c=0;for(b=this.layers.length;c<b;c++)d=this.layers[c],a.layers[d.sid.toString()]=d.saveToJSON();return a};a.prototype.loadFromJSON=function(b){var a,c,d;this.scrollX=b.sx;this.scrollY=b.sy;this.scale=b.s;this.angle=b.a;this.width=b.w;this.height=b.h;this.persist_data=b.persist;"undefined"!==typeof b.fv&&(this.first_visit=b.fv);var k=b.fx;var e=0;for(a=k.length;e<a;e++)if(c=this.getEffectByName(k[e].name))c.active=k[e].active,this.effect_params[c.index]=
k[e].params;this.updateActiveEffects();e=b.layers;for(d in e)e.hasOwnProperty(d)&&(b=this.getLayerBySid(parseInt(d,10)))&&b.loadFromJSON(e[d])};cr.layout=a;h.prototype.updateActiveEffects=function(){cr.clearArray(this.active_effect_types);this.shaders_preserve_opaqueness=!0;var b;var a=0;for(b=this.effect_types.length;a<b;a++){var c=this.effect_types[a];c.active&&(this.active_effect_types.push(c),c.preservesOpaqueness||(this.shaders_preserve_opaqueness=!1))}};h.prototype.getEffectByName=function(b){var a;
var c=0;for(a=this.effect_types.length;c<a;c++){var d=this.effect_types[c];if(d.name===b)return d}return null};h.prototype.createInitialInstances=function(){var b,a;var c=b=0;for(a=this.initial_instances.length;b<a;b++){var e=this.initial_instances[b];var f=this.runtime.types_by_index[e[1]];var g=this.runtime.typeHasPersistBehavior(f);f=!0;if(!g||this.layout.first_visit){e=this.runtime.createInstanceFromInit(e,this,!0);if(!e)continue;d.push(e);e.type.global&&(f=!1,this.created_globals.push(e.uid))}f&&
(this.initial_instances[c]=this.initial_instances[b],c++)}this.initial_instances.length=c;this.runtime.ClearDeathRow();!this.runtime.glwrap&&this.effect_types.length&&(this.blend_mode=this.effect_fallback);this.compositeOp=cr.effectToCompositeOp(this.blend_mode);this.runtime.gl&&cr.setGLBlend(this,this.blend_mode,this.runtime.gl);this.render_list_stale=!0};h.prototype.recreateInitialObjects=function(b,a){var c,d=this.runtime.types_by_index,k=b.is_family,e=b.members;var f=0;for(c=this.initial_instances.length;f<
c;++f){var g=this.initial_instances[f];var h=g[0];var l=h[0];h=h[1];if(a.contains_pt(l,h)){l=d[g[1]];if(l!==b)if(k){if(0>e.indexOf(l))continue}else continue;g=this.runtime.createInstanceFromInit(g,this,!1);this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(l.plugin).cnds.OnCreated,g);if(g.is_contained)for(l=0,h=g.siblings.length;l<h;l++){var m=g.siblings[f];this.runtime.trigger(Object.getPrototypeOf(m.type.plugin).cnds.OnCreated,m)}this.runtime.isInOnDestroy--}}};h.prototype.removeFromInstanceList=
function(b,a){var c=cr.fastIndexOf(this.instances,b);0>c||(a&&this.useRenderCells&&b.rendercells&&b.rendercells.right>=b.rendercells.left&&(b.update_bbox(),this.render_grid.update(b,b.rendercells,null),b.rendercells.set(0,0,-1,-1)),c===this.instances.length-1?this.instances.pop():(cr.arrayRemove(this.instances,c),this.setZIndicesStaleFrom(c)),this.render_list_stale=!0)};h.prototype.appendToInstanceList=function(b,a){b.zindex=this.instances.length;this.instances.push(b);a&&this.useRenderCells&&b.rendercells&&
b.set_bbox_changed();this.render_list_stale=!0};h.prototype.prependToInstanceList=function(b,a){this.instances.unshift(b);this.setZIndicesStaleFrom(0);a&&this.useRenderCells&&b.rendercells&&b.set_bbox_changed()};h.prototype.moveInstanceAdjacent=function(b,a,c){var d=b.get_zindex();a=a.get_zindex();cr.arrayRemove(this.instances,d);d<a&&a--;c&&a++;a===this.instances.length?this.instances.push(b):this.instances.splice(a,0,b);this.setZIndicesStaleFrom(d<a?d:a)};h.prototype.setZIndicesStaleFrom=function(b){-1===
this.zindices_stale_from?this.zindices_stale_from=b:b<this.zindices_stale_from&&(this.zindices_stale_from=b);this.render_list_stale=this.zindices_stale=!0};h.prototype.updateZIndices=function(){if(this.zindices_stale){-1===this.zindices_stale_from&&(this.zindices_stale_from=0);var b;if(this.useRenderCells){var a=this.zindices_stale_from;for(b=this.instances.length;a<b;++a){var c=this.instances[a];c.zindex=a;this.render_grid.markRangeChanged(c.rendercells)}}else for(a=this.zindices_stale_from,b=this.instances.length;a<
b;++a)this.instances[a].zindex=a;this.zindices_stale=!1;this.zindices_stale_from=-1}};h.prototype.getScale=function(b){return this.getNormalScale()*(this.runtime.fullscreenScalingQuality||b?this.runtime.aspect_scale:1)};h.prototype.getNormalScale=function(){return(this.scale*this.layout.scale-1)*this.zoomRate+1};h.prototype.getAngle=function(){return this.disableAngle?0:cr.clamp_angle(this.layout.angle+this.angle)};var l=[],p=[],n=[];h.prototype.getRenderCellInstancesToDraw=function(){this.updateZIndices();
this.render_grid.queryRange(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom,n);if(!n.length)return g();if(1===n.length){var b=g();cr.shallowAssignArray(b,n[0]);cr.clearArray(n);return b}for(var a=!0;1<n.length;){var c;b=n;var d=a;var f=0;for(c=b.length;f<c-1;f+=2){var h=b[f];var l=b[f+1];a=g();var x=h,w=l,A=a,D=0,G=0,r=0,t=x.length,O=w.length;for(A.length=t+O;D<t&&G<O;++r){var P=x[D];var Q=w[G];P.zindex<Q.zindex?(A[r]=P,++D):(A[r]=Q,++G)}for(;D<t;++D,++r)A[r]=x[D];for(;G<O;++G,++r)A[r]=
w[G];d||(e(h),e(l));p.push(a)}1===c%2&&(d?(h=g(),cr.shallowAssignArray(h,b[c-1]),p.push(h)):p.push(b[c-1]));cr.shallowAssignArray(b,p);cr.clearArray(p);a=!1}b=n[0];cr.clearArray(n);return b};h.prototype.draw=function(b){this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0!==this.blend_mode;var a=this.runtime.canvas,c=b,d=!1;this.render_offscreen&&(this.runtime.layer_canvas||(this.runtime.layer_canvas=document.createElement("canvas"),a=this.runtime.layer_canvas,a.width=this.runtime.draw_width,
a.height=this.runtime.draw_height,this.runtime.layer_ctx=a.getContext("2d"),d=!0),a=this.runtime.layer_canvas,c=this.runtime.layer_ctx,a.width!==this.runtime.draw_width&&(a.width=this.runtime.draw_width,d=!0),a.height!==this.runtime.draw_height&&(a.height=this.runtime.draw_height,d=!0),d&&this.runtime.setCtxImageSmoothingEnabled(c,this.runtime.linearSampling),this.transparent&&c.clearRect(0,0,this.runtime.draw_width,this.runtime.draw_height));c.globalAlpha=1;c.globalCompositeOperation="source-over";
this.transparent||(c.fillStyle="rgb("+this.background_color[0]+","+this.background_color[1]+","+this.background_color[2]+")",c.fillRect(0,0,this.runtime.draw_width,this.runtime.draw_height));c.save();this.disableAngle=!0;d=this.canvasToLayer(0,0,!0,!0);var k=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(d=Math.round(d),k=Math.round(k));this.rotateViewport(d,k,c);var f=this.getScale();c.scale(f,f);c.translate(-d,-k);this.useRenderCells?(this.cur_render_cells.left=
this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(e(this.last_render_list),d=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):d=this.last_render_list):d=this.instances;
var g=null;k=0;for(f=d.length;k<f;++k){var h=d[k];h!==g&&(this.drawInstance(h,c),g=h)}this.useRenderCells&&(this.last_render_list=d);c.restore();this.render_offscreen&&(b.globalCompositeOperation=this.compositeOp,b.globalAlpha=this.opacity,b.drawImage(a,0,0))};h.prototype.drawInstance=function(b,a){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var c=b.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(a.globalCompositeOperation=b.compositeOp,
b.draw(a))}};h.prototype.updateViewport=function(b){this.disableAngle=!0;var a=this.canvasToLayer(0,0,!0,!0),c=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(a=Math.round(a),c=Math.round(c));this.rotateViewport(a,c,b)};h.prototype.rotateViewport=function(b,a,c){var d=this.getScale();this.viewLeft=b;this.viewTop=a;this.viewRight=b+1/d*this.runtime.draw_width;this.viewBottom=a+1/d*this.runtime.draw_height;this.viewLeft>this.viewRight&&(b=this.viewLeft,this.viewLeft=
this.viewRight,this.viewRight=b);this.viewTop>this.viewBottom&&(b=this.viewTop,this.viewTop=this.viewBottom,this.viewBottom=b);b=this.getAngle();0!==b&&(c&&(c.translate(this.runtime.draw_width/2,this.runtime.draw_height/2),c.rotate(-b),c.translate(this.runtime.draw_width/-2,this.runtime.draw_height/-2)),this.tmprect.set(this.viewLeft,this.viewTop,this.viewRight,this.viewBottom),this.tmprect.offset((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),this.tmpquad.set_from_rotated_rect(this.tmprect,
b),this.tmpquad.bounding_box(this.tmprect),this.tmprect.offset((this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2),this.viewLeft=this.tmprect.left,this.viewTop=this.tmprect.top,this.viewRight=this.tmprect.right,this.viewBottom=this.tmprect.bottom)};h.prototype.drawGL_earlyZPass=function(b){if(this.render_offscreen=this.forceOwnTexture){this.runtime.layer_tex||(this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));
if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layer_tex),this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layer_tex)}this.disableAngle=!0;var a=this.canvasToLayer(0,0,!0,!0),c=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(a=Math.round(a),c=Math.round(c));
this.rotateViewport(a,c,null);a=this.getScale();b.resetModelView();b.scale(a,a);b.rotateZ(-this.getAngle());b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);b.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),
this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(e(this.last_render_list),a=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):a=this.last_render_list):a=this.instances;var d=null;for(c=a.length-1;0<=c;--c){var k=a[c];k!==d&&(this.drawInstanceGL_earlyZPass(a[c],b),d=k)}this.useRenderCells&&(this.last_render_list=a);this.transparent||(this.clear_earlyz_index=this.runtime.earlyz_index++,b.setEarlyZIndex(this.clear_earlyz_index),
b.setColorFillMode(1,1,1,1),b.fullscreenQuad(),b.restoreEarlyZMode())};h.prototype.drawGL=function(b){if(this.render_offscreen=this.forceOwnTexture||1!==this.opacity||0<this.active_effect_types.length||0!==this.blend_mode){this.runtime.layer_tex||(this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling));if(this.runtime.layer_tex.c2width!==this.runtime.draw_width||this.runtime.layer_tex.c2height!==this.runtime.draw_height)b.deleteTexture(this.runtime.layer_tex),
this.runtime.layer_tex=b.createEmptyTexture(this.runtime.draw_width,this.runtime.draw_height,this.runtime.linearSampling);b.setRenderingToTexture(this.runtime.layer_tex);this.transparent&&b.clear(0,0,0,0)}this.transparent||(this.runtime.enableFrontToBack?(b.setEarlyZIndex(this.clear_earlyz_index),b.setColorFillMode(this.background_color[0]/255,this.background_color[1]/255,this.background_color[2]/255,1),b.fullscreenQuad(),b.setTextureFillMode()):b.clear(this.background_color[0]/255,this.background_color[1]/
255,this.background_color[2]/255,1));this.disableAngle=!0;var a=this.canvasToLayer(0,0,!0,!0);var c=this.canvasToLayer(0,0,!1,!0);this.disableAngle=!1;this.runtime.pixel_rounding&&(a=Math.round(a),c=Math.round(c));this.rotateViewport(a,c,null);a=this.getScale();b.resetModelView();b.scale(a,a);b.rotateZ(-this.getAngle());b.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2);b.updateModelView();this.useRenderCells?(this.cur_render_cells.left=this.render_grid.XToCell(this.viewLeft),
this.cur_render_cells.top=this.render_grid.YToCell(this.viewTop),this.cur_render_cells.right=this.render_grid.XToCell(this.viewRight),this.cur_render_cells.bottom=this.render_grid.YToCell(this.viewBottom),this.render_list_stale||!this.cur_render_cells.equals(this.last_render_cells)?(e(this.last_render_list),c=this.getRenderCellInstancesToDraw(),this.render_list_stale=!1,this.last_render_cells.copy(this.cur_render_cells)):c=this.last_render_list):c=this.instances;var d,k=null;var f=0;for(d=c.length;f<
d;++f){var g=c[f];g!==k&&(this.drawInstanceGL(c[f],b),k=g)}this.useRenderCells&&(this.last_render_list=c);this.render_offscreen&&(c=this.active_effect_types.length?this.active_effect_types[0].shaderindex:0,f=this.active_effect_types.length?this.active_effect_types[0].index:0,0===this.active_effect_types.length||1===this.active_effect_types.length&&!b.programUsesCrossSampling(c)&&1===this.opacity?(1===this.active_effect_types.length?(b.switchProgram(c),b.setProgramParameters(this.layout.getRenderTarget(),
1/this.runtime.draw_width,1/this.runtime.draw_height,0,0,1,1,a,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,this.effect_params[f]),b.programIsAnimated(c)&&(this.runtime.redraw=!0)):b.switchProgram(0),b.setRenderingToTexture(this.layout.getRenderTarget()),b.setOpacity(this.opacity),b.setTexture(this.runtime.layer_tex),b.setBlend(this.srcBlend,this.destBlend),b.resetModelView(),b.updateModelView(),a=this.runtime.draw_width/
2,c=this.runtime.draw_height/2,b.quad(-a,c,a,c,a,-c,-a,-c),b.setTexture(null)):this.layout.renderEffectChain(b,this,null,this.layout.getRenderTarget()))};h.prototype.drawInstanceGL=function(b,a){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var c=b.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(a.setEarlyZIndex(b.earlyz_index),b.uses_shaders?this.drawInstanceWithShadersGL(b,a):(a.switchProgram(0),a.setBlend(b.srcBlend,b.destBlend),b.drawGL(a)))}};
h.prototype.drawInstanceGL_earlyZPass=function(b,a){if(b.visible&&0!==b.width&&0!==b.height){b.update_bbox();var c=b.bbox;c.right<this.viewLeft||c.bottom<this.viewTop||c.left>this.viewRight||c.top>this.viewBottom||(b.earlyz_index=this.runtime.earlyz_index++,0===b.blend_mode&&1===b.opacity&&b.shaders_preserve_opaqueness&&b.drawGL_earlyZPass&&(a.setEarlyZIndex(b.earlyz_index),b.drawGL_earlyZPass(a)))}};h.prototype.drawInstanceWithShadersGL=function(b,a){var c=b.active_effect_types[0].shaderindex,d=
b.active_effect_types[0].index,k=this.getScale();if(1!==b.active_effect_types.length||a.programUsesCrossSampling(c)||a.programExtendsBox(c)||(b.angle||b.layer.getAngle())&&a.programUsesDest(c)||1!==b.opacity||b.type.plugin.must_predraw)this.layout.renderEffectChain(a,this,b,this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget()),a.resetModelView(),a.scale(k,k),a.rotateZ(-this.getAngle()),a.translate((this.viewLeft+this.viewRight)/-2,(this.viewTop+this.viewBottom)/-2),a.updateModelView();
else{a.switchProgram(c);a.setBlend(b.srcBlend,b.destBlend);a.programIsAnimated(c)&&(this.runtime.redraw=!0);var e=0,f=0,g=0,h=0;a.programUsesDest(c)&&(h=b.bbox,e=this.layerToCanvas(h.left,h.top,!0,!0),f=this.layerToCanvas(h.left,h.top,!1,!0),g=this.layerToCanvas(h.right,h.bottom,!0,!0),h=this.layerToCanvas(h.right,h.bottom,!1,!0),e/=windowWidth,f=1-f/windowHeight,g/=windowWidth,h=1-h/windowHeight);if(b.curFrame&&b.curFrame.texture_img){var l=b.curFrame.texture_img;c=1/l.width;l=1/l.height}else c=
1/b.width,l=1/b.height;a.setProgramParameters(this.render_offscreen?this.runtime.layer_tex:this.layout.getRenderTarget(),c,l,e,f,g,h,k,this.getAngle(),this.viewLeft,this.viewTop,(this.viewLeft+this.viewRight)/2,(this.viewTop+this.viewBottom)/2,this.runtime.kahanTime.sum,b.effect_params[d]);b.drawGL(a)}};h.prototype.canvasToLayer=function(b,a,c,d){var k=this.runtime.devicePixelRatio;this.runtime.isRetina&&(b*=k,a*=k);k=this.runtime.parallax_x_origin;var e=this.runtime.parallax_y_origin;k=(this.layout.scrollX-
k)*this.parallaxX+k;e=(this.layout.scrollY-e)*this.parallaxY+e;var f=k,g=e,h=1/this.getScale(!d);d?(f-=this.runtime.draw_width*h/2,g-=this.runtime.draw_height*h/2):(f-=this.runtime.width*h/2,g-=this.runtime.height*h/2);f+=b*h;g+=a*h;a=this.getAngle();0!==a&&(f-=k,g-=e,b=Math.cos(a),a=Math.sin(a),d=f*b-g*a,g=g*b+f*a,f=d+k,g+=e);return c?f:g};h.prototype.layerToCanvas=function(b,a,c,d){var k=this.runtime.parallax_x_origin,e=this.runtime.parallax_y_origin,f=(this.layout.scrollX-k)*this.parallaxX+k,g=
(this.layout.scrollY-e)*this.parallaxY+e;e=f;k=g;var h=this.getAngle();if(0!==h){b-=f;a-=g;var l=Math.cos(-h);h=Math.sin(-h);var m=b*l-a*h;a=a*l+b*h;b=m+f;a+=g}f=1/this.getScale(!d);d?(e-=this.runtime.draw_width*f/2,k-=this.runtime.draw_height*f/2):(e-=this.runtime.width*f/2,k-=this.runtime.height*f/2);e=(b-e)/f;k=(a-k)/f;b=this.runtime.devicePixelRatio;this.runtime.isRetina&&!d&&(e/=b,k/=b);return c?e:k};h.prototype.rotatePt=function(b,a,c){if(0===this.getAngle())return c?b:a;var d=this.layerToCanvas(b,
a,!0);a=this.layerToCanvas(b,a,!1);this.disableAngle=!0;b=this.canvasToLayer(d,a,!0);d=this.canvasToLayer(d,a,!0);this.disableAngle=!1;return c?b:d};h.prototype.saveToJSON=function(){var b,a={s:this.scale,a:this.angle,vl:this.viewLeft,vt:this.viewTop,vr:this.viewRight,vb:this.viewBottom,v:this.visible,bc:this.background_color,t:this.transparent,px:this.parallaxX,py:this.parallaxY,o:this.opacity,zr:this.zoomRate,fx:[],cg:this.created_globals,instances:[]};var c=0;for(b=this.effect_types.length;c<b;c++){var d=
this.effect_types[c];a.fx.push({name:d.name,active:d.active,params:this.effect_params[d.index]})}return a};h.prototype.loadFromJSON=function(b){var a;this.scale=b.s;this.angle=b.a;this.viewLeft=b.vl;this.viewTop=b.vt;this.viewRight=b.vr;this.viewBottom=b.vb;this.visible=b.v;this.background_color=b.bc;this.transparent=b.t;this.parallaxX=b.px;this.parallaxY=b.py;this.opacity=b.o;this.zoomRate=b.zr;this.created_globals=b.cg||[];cr.shallowAssignArray(this.initial_instances,this.startup_initial_instances);
var c=new cr.ObjectSet;var d=0;for(a=this.created_globals.length;d<a;++d)c.add(this.created_globals[d]);var e=d=0;for(a=this.initial_instances.length;d<a;++d)c.contains(this.initial_instances[d][2])||(this.initial_instances[e]=this.initial_instances[d],++e);cr.truncateArray(this.initial_instances,e);e=b.fx;d=0;for(a=e.length;d<a;d++)if(b=this.getEffectByName(e[d].name))b.active=e[d].active,this.effect_params[b.index]=e[d].params;this.updateActiveEffects();this.instances.sort(f);this.zindices_stale=
!0};cr.layer=h})();
(function(){function a(b,a){var c,d=b.length;switch(d){case 0:return!0;case 1:return b[0]===a[0];case 2:return b[0]===a[0]&&b[1]===a[1];default:for(c=0;c<d;c++)if(b[c]!==a[c])return!1;return!0}}function f(b,a){return b.index-a.index}function h(b){var c;if(2===b.length){if(b[0].index>b[1].index){var d=b[0];b[0]=b[1];b[1]=d}}else 2<b.length&&b.sort(f);b.length>=v.length&&(v.length=b.length+1);v[b.length]||(v[b.length]=[]);var e=v[b.length];d=0;for(c=e.length;d<c;d++){var k=e[d];if(a(b,k))return k}e.push(b);
return b}function g(b,a){this.runtime=b;this.triggers={};this.fasttriggers={};this.hasRun=!1;this.includes=new cr.ObjectSet;this.deep_includes=[];this.already_included_sheets=[];this.name=a[0];b=a[1];this.events=[];var c;a=0;for(c=b.length;a<c;a++)this.init_event(b[a],null,this.events)}function e(b){this.type=b;this.instances=[];this.else_instances=[];this.select_all=!0}function d(b,a,c){this.sheet=b;this.parent=a;this.runtime=b.runtime;this.solModifiers=[];this.solModifiersIncludingParents=[];this.has_else_block=
this.toplevelgroup=this.toplevelevent=this.initially_activated=this.group=this.solWriterAfterCnds=!1;this.conditions=[];this.actions=[];this.subevents=[];this.group_name="";this.group_active=this.initially_activated=this.group=!1;this.contained_includes=null;c[1]&&(this.group_name=c[1][1].toLowerCase(),this.group=!0,this.initially_activated=!!c[1][0],this.contained_includes=[],this.group_active=this.initially_activated,this.runtime.allGroups.push(this),this.runtime.groups_by_name[this.group_name]=
this);this.orblock=c[2];this.sid=c[4];this.group||(this.runtime.blocksBySid[this.sid.toString()]=this);var d=c[5];b=0;for(a=d.length;b<a;b++){var e=new cr.condition(this,d[b]);e.index=b;cr.seal(e);this.conditions.push(e);this.addSolModifier(e.type)}d=c[6];b=0;for(a=d.length;b<a;b++)e=new cr.action(this,d[b]),e.index=b,cr.seal(e),this.actions.push(e);if(8===c.length)for(c=c[7],b=0,a=c.length;b<a;b++)this.sheet.init_event(c[b],this,this.subevents);this.is_else_block=!1;this.conditions.length&&(this.is_else_block=
null==this.conditions[0].type&&this.conditions[0].func==cr.system_object.prototype.cnds.Else)}function c(b,a){var c;if(b&&(-1===a.indexOf(b)&&a.push(b),b.is_contained)){var d=0;for(c=b.container.length;d<c;d++){var e=b.container[d];b!==e&&-1===a.indexOf(e)&&a.push(e)}}}function b(b,a){this.block=b;this.sheet=b.sheet;this.runtime=b.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(a[1]);this.trigger=0<
a[3];this.fasttrigger=2===a[3];this.looping=a[4];this.inverted=a[5];this.isstatic=a[6];this.sid=a[7];this.runtime.cndsBySid[this.sid.toString()]=this;-1===a[0]?(this.type=null,this.run=this.run_system,this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[a[0]],this.run=this.isstatic?this.run_static:this.run_object,a[2]?(this.behaviortype=this.type.getBehaviorByName(a[2]),this.beh_index=this.type.getBehaviorIndexByName(a[2])):(this.behaviortype=null,this.beh_index=-1),this.block.parent&&
this.block.parent.setSolWriterAfterCnds());this.fasttrigger&&(this.run=this.run_true);if(10===a.length){var c=a[9];b=0;for(a=c.length;b<a;b++){var d=new cr.parameter(this,c[b]);cr.seal(d);this.parameters.push(d)}this.results.length=c.length}}function l(b,a){this.block=b;this.sheet=b.sheet;this.runtime=b.runtime;this.parameters=[];this.results=[];this.extra={};this.index=-1;this.anyParamVariesPerInstance=!1;this.func=this.runtime.GetObjectReference(a[1]);-1===a[0]?(this.type=null,this.run=this.run_system,
this.behaviortype=null,this.beh_index=-1):(this.type=this.runtime.types_by_index[a[0]],this.run=this.run_object,a[2]?(this.behaviortype=this.type.getBehaviorByName(a[2]),this.beh_index=this.type.getBehaviorIndexByName(a[2])):(this.behaviortype=null,this.beh_index=-1));this.sid=a[3];this.runtime.actsBySid[this.sid.toString()]=this;if(6===a.length){var c=a[5];b=0;for(a=c.length;b<a;b++){var d=new cr.parameter(this,c[b]);cr.seal(d);this.parameters.push(d)}this.results.length=c.length}}function p(){y++;
u.length===y&&u.push(new cr.expvalue);return u[y]}function n(b,a){this.owner=b;this.block=b.block;this.sheet=b.sheet;this.runtime=b.runtime;this.type=a[0];this.expression=null;this.solindex=0;this.get=null;this.combosel=0;this.layout=null;this.key=0;this.object=null;this.index=0;this.variadicret=this.subparams=this.fileinfo=this.eventvar=this.varname=null;this.variesPerInstance=!1;var c;switch(a[0]){case 0:case 7:this.expression=new cr.expNode(this,a[1]);this.solindex=0;this.get=this.get_exp;break;
case 1:this.expression=new cr.expNode(this,a[1]);this.solindex=0;this.get=this.get_exp_str;break;case 5:this.expression=new cr.expNode(this,a[1]);this.solindex=0;this.get=this.get_layer;break;case 3:case 8:this.combosel=a[1];this.get=this.get_combosel;break;case 6:this.layout=this.runtime.layouts[a[1]];this.get=this.get_layout;break;case 9:this.key=a[1];this.get=this.get_key;break;case 4:this.object=this.runtime.types_by_index[a[1]];this.get=this.get_object;this.block.addSolModifier(this.object);
this.owner instanceof cr.action?this.block.setSolWriterAfterCnds():this.block.parent&&this.block.parent.setSolWriterAfterCnds();break;case 10:this.index=a[1];b.type&&b.type.is_family?(this.get=this.get_familyvar,this.variesPerInstance=!0):this.get=this.get_instvar;break;case 11:this.varname=a[1];this.eventvar=null;this.get=this.get_eventvar;break;case 2:case 12:this.fileinfo=a[1];this.get=this.get_audiofile;break;case 13:for(this.get=this.get_variadic,this.subparams=[],this.variadicret=[],b=1,c=a.length;b<
c;b++){var d=new cr.parameter(this.owner,a[b]);cr.seal(d);this.subparams.push(d);this.variadicret.push(0)}}}function k(b,a,c){this.sheet=b;this.parent=a;this.runtime=b.runtime;this.solModifiers=[];this.name=c[1];this.vartype=c[2];this.initial=c[3];this.is_static=!!c[4];this.is_constant=!!c[5];this.sid=c[6];this.runtime.varsBySid[this.sid.toString()]=this;this.data=this.initial;this.parent?(this.localIndex=this.is_static||this.is_constant?-1:this.runtime.stackLocalCount++,this.runtime.all_local_vars.push(this)):
(this.localIndex=-1,this.runtime.all_global_vars.push(this))}function m(b,a,c){this.sheet=b;this.parent=a;this.runtime=b.runtime;this.solModifiers=[];this.include_sheet=null;this.include_sheet_name=c[1];this.active=!0}function q(){this.temp_parents_arr=[];this.reset(null);cr.seal(this)}var v=[];g.prototype.toString=function(){return this.name};g.prototype.init_event=function(b,a,c){switch(b[0]){case 0:b=new cr.eventblock(this,a,b);cr.seal(b);if(b.orblock)for(c.push(b),c=0,a=b.conditions.length;c<
a;c++)b.conditions[c].trigger&&this.init_trigger(b,c);else b.is_trigger()?this.init_trigger(b,0):c.push(b);break;case 1:b=new cr.eventvariable(this,a,b);cr.seal(b);c.push(b);break;case 2:b=new cr.eventinclude(this,a,b),cr.seal(b),c.push(b)}};g.prototype.postInit=function(){var b;var a=0;for(b=this.events.length;a<b;a++)this.events[a].postInit(a<b-1&&this.events[a+1].is_else_block)};g.prototype.updateDeepIncludes=function(){cr.clearArray(this.deep_includes);cr.clearArray(this.already_included_sheets);
this.addDeepIncludes(this);cr.clearArray(this.already_included_sheets)};g.prototype.addDeepIncludes=function(b){var a,c=b.deep_includes,d=b.already_included_sheets,e=this.includes.valuesRef();var k=0;for(a=e.length;k<a;++k){var f=e[k];var g=f.include_sheet;!f.isActive()||b===g||-1<d.indexOf(g)||(d.push(g),g.addDeepIncludes(b),c.push(g))}};g.prototype.run=function(b){this.runtime.resuming_breakpoint||(this.hasRun=!0,b||(this.runtime.isRunningEvents=!0));var a;var c=0;for(a=this.events.length;c<a;c++){var d=
this.events[c];d.run();this.runtime.clearSol(d.solModifiers);this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()}b||(this.runtime.isRunningEvents=!1)};g.prototype.init_trigger=function(b,a){b.orblock||this.runtime.triggers_to_postinit.push(b);var c,d,e=b.conditions[a];var k=e.type?e.type.name:"system";var f=(c=e.fasttrigger)?this.fasttriggers:this.triggers;f[k]||(f[k]=[]);k=f[k];f=e.func;if(c){if(e.parameters.length&&(e=e.parameters[0],1===e.type&&2===e.expression.type)){e=e.expression.value.toLowerCase();
c=0;for(d=k.length;c<d;c++)if(k[c].method==f){c=k[c].evs;c[e]?c[e].push([b,a]):c[e]=[[b,a]];return}c={};c[e]=[[b,a]];k.push({method:f,evs:c})}}else{c=0;for(d=k.length;c<d;c++)if(k[c].method==f){k[c].evs.push([b,a]);return}e=cr.plugins_.Sprite&&f===cr.plugins_.Sprite.prototype.cnds.OnFrameChanged?!0:!1;e?k.unshift({method:f,evs:[[b,a]]}):k.push({method:f,evs:[[b,a]]})}};cr.eventsheet=g;e.prototype.hasObjects=function(){return this.select_all?this.type.instances.length:this.instances.length};e.prototype.getObjects=
function(){return this.select_all?this.type.instances:this.instances};e.prototype.pick_one=function(b){b&&(b.runtime.getCurrentEventStack().current_event.orblock?(this.select_all&&(cr.clearArray(this.instances),cr.shallowAssignArray(this.else_instances,b.type.instances),this.select_all=!1),b=this.else_instances.indexOf(b),-1!==b&&(this.instances.push(this.else_instances[b]),this.else_instances.splice(b,1))):(this.select_all=!1,cr.clearArray(this.instances),this.instances[0]=b))};cr.selection=e;window._c2hh_=
"CF4BD01569DCA121D76845B4FE35F9DC1B4B6115";d.prototype.postInit=function(b){var a,c=this.parent;if(this.group)for(this.toplevelgroup=!0;c;){if(!c.group){this.toplevelgroup=!1;break}c=c.parent}this.toplevelevent=!this.is_trigger()&&(!this.parent||this.parent.group&&this.parent.toplevelgroup);this.has_else_block=!!b;this.solModifiersIncludingParents=this.solModifiers.slice(0);for(c=this.parent;c;){b=0;for(a=c.solModifiers.length;b<a;b++)this.addParentSolModifier(c.solModifiers[b]);c=c.parent}this.solModifiers=
h(this.solModifiers);this.solModifiersIncludingParents=h(this.solModifiersIncludingParents);b=0;for(a=this.conditions.length;b<a;b++)this.conditions[b].postInit();b=0;for(a=this.actions.length;b<a;b++)this.actions[b].postInit();b=0;for(a=this.subevents.length;b<a;b++)this.subevents[b].postInit(b<a-1&&this.subevents[b+1].is_else_block)};d.prototype.setGroupActive=function(b){if(this.group_active!==!!b){this.group_active=!!b;var a;b=0;for(a=this.contained_includes.length;b<a;++b)this.contained_includes[b].updateActive();
0<a&&this.runtime.running_layout.event_sheet&&this.runtime.running_layout.event_sheet.updateDeepIncludes()}};d.prototype.addSolModifier=function(b){c(b,this.solModifiers)};d.prototype.addParentSolModifier=function(b){c(b,this.solModifiersIncludingParents)};d.prototype.setSolWriterAfterCnds=function(){this.solWriterAfterCnds=!0;this.parent&&this.parent.setSolWriterAfterCnds()};d.prototype.is_trigger=function(){return this.conditions.length?this.conditions[0].trigger:!1};d.prototype.run=function(){var b,
a=!1,c=this.runtime,d=this.runtime.getCurrentEventStack();d.current_event=this;var e=this.conditions;this.is_else_block||(d.else_branch_ran=!1);if(this.orblock){0===e.length&&(a=!0);d.cndindex=0;for(b=e.length;d.cndindex<b;d.cndindex++){var k=e[d.cndindex];k.trigger||(k=k.run())&&(a=!0)}(d.last_event_true=a)&&this.run_actions_and_subevents()}else{d.cndindex=0;for(b=e.length;d.cndindex<b;d.cndindex++)if(k=e[d.cndindex].run(),!k){d.last_event_true=!1;this.toplevelevent&&c.hasPendingInstances&&c.ClearDeathRow();
return}d.last_event_true=!0;this.run_actions_and_subevents()}this.end_run(d)};d.prototype.end_run=function(b){b.last_event_true&&this.has_else_block&&(b.else_branch_ran=!0);this.toplevelevent&&this.runtime.hasPendingInstances&&this.runtime.ClearDeathRow()};d.prototype.run_orblocktrigger=function(b){this.runtime.getCurrentEventStack().current_event=this;this.conditions[b].run()&&(this.run_actions_and_subevents(),this.runtime.getCurrentEventStack().last_event_true=!0)};d.prototype.run_actions_and_subevents=
function(){var b=this.runtime.getCurrentEventStack(),a;b.actindex=0;for(a=this.actions.length;b.actindex<a;b.actindex++)if(this.actions[b.actindex].run())return;this.run_subevents()};d.prototype.resume_actions_and_subevents=function(){var b=this.runtime.getCurrentEventStack(),a;for(a=this.actions.length;b.actindex<a;b.actindex++)if(this.actions[b.actindex].run())return;this.run_subevents()};d.prototype.run_subevents=function(){if(this.subevents.length){var b,a,c=this.subevents.length-1;this.runtime.pushEventStack(this);
if(this.solWriterAfterCnds){var d=0;for(b=this.subevents.length;d<b;d++){var e=this.subevents[d];(a=!this.toplevelgroup||!this.group&&d<c)&&this.runtime.pushCopySol(e.solModifiers);e.run();a?this.runtime.popSol(e.solModifiers):this.runtime.clearSol(e.solModifiers)}}else for(d=0,b=this.subevents.length;d<b;d++)this.subevents[d].run();this.runtime.popEventStack()}};d.prototype.run_pretrigger=function(){var b=this.runtime.getCurrentEventStack();b.current_event=this;var a=!1,c;b.cndindex=0;for(c=this.conditions.length;b.cndindex<
c;b.cndindex++)if(this.conditions[b.cndindex].run())a=!0;else if(!this.orblock)return!1;return this.orblock?a:!0};d.prototype.retrigger=function(){this.runtime.execcount++;var b=this.runtime.getCurrentEventStack().cndindex,a=this.runtime.pushEventStack(this);if(!this.orblock)for(a.cndindex=b+1,b=this.conditions.length;a.cndindex<b;a.cndindex++)if(!this.conditions[a.cndindex].run())return this.runtime.popEventStack(),!1;this.run_actions_and_subevents();this.runtime.popEventStack();return!0};d.prototype.isFirstConditionOfType=
function(b){var a=b.index;if(0===a)return!0;for(--a;0<=a;--a)if(this.conditions[a].type===b.type)return!1;return!0};cr.eventblock=d;b.prototype.postInit=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++){var c=this.parameters[a];c.postInit();c.variesPerInstance&&(this.anyParamVariesPerInstance=!0)}};b.prototype.run_true=function(){return!0};b.prototype.run_system=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++)this.results[a]=this.parameters[a].get();return cr.xor(this.func.apply(this.runtime.system,
this.results),this.inverted)};b.prototype.run_static=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++)this.results[a]=this.parameters[a].get();a=this.func.apply(this.behaviortype?this.behaviortype:this.type,this.results);this.type.applySolToContainer();return a};b.prototype.run_object=function(){var b,a,c,d=this.type,e=d.getCurrentSol(),k=this.block.orblock&&!this.trigger,f=d.is_contained,g=d.is_family,h=d.family_index,l=this.beh_index,m=-1<l,n=this.anyParamVariesPerInstance,q=this.parameters,
p=this.results,y=this.inverted,v=this.func;if(n){var u=0;for(a=q.length;u<a;++u){var K=q[u];K.variesPerInstance||(p[u]=K.get(0))}}else for(u=0,a=q.length;u<a;++u)p[u]=q[u].get(0);if(e.select_all){cr.clearArray(e.instances);cr.clearArray(e.else_instances);var H=d.instances;var E=0;for(b=H.length;E<b;++E){var C=H[E];if(n)for(u=0,a=q.length;u<a;++u)K=q[u],K.variesPerInstance&&(p[u]=K.get(E));m?(u=0,g&&(u=C.type.family_beh_map[h]),u=v.apply(C.behavior_insts[l+u],p)):u=v.apply(C,p);(c=cr.xor(u,y))?e.instances.push(C):
k&&e.else_instances.push(C)}d.finish&&d.finish(!0);e.select_all=!1;d.applySolToContainer();return e.hasObjects()}var T=0;H=(c=k&&!this.block.isFirstConditionOfType(this))?e.else_instances:e.instances;var L=!1;E=0;for(b=H.length;E<b;++E){C=H[E];if(n)for(u=0,a=q.length;u<a;++u)K=q[u],K.variesPerInstance&&(p[u]=K.get(E));m?(u=0,g&&(u=C.type.family_beh_map[h]),u=v.apply(C.behavior_insts[l+u],p)):u=v.apply(C,p);if(cr.xor(u,y))if(L=!0,c){if(e.instances.push(C),f)for(u=0,a=C.siblings.length;u<a;u++)K=C.siblings[u],
K.type.getCurrentSol().instances.push(K)}else{H[T]=C;if(f)for(u=0,a=C.siblings.length;u<a;u++)K=C.siblings[u],K.type.getCurrentSol().instances[T]=K;T++}else if(c){H[T]=C;if(f)for(u=0,a=C.siblings.length;u<a;u++)K=C.siblings[u],K.type.getCurrentSol().else_instances[T]=K;T++}else if(k&&(e.else_instances.push(C),f))for(u=0,a=C.siblings.length;u<a;u++)K=C.siblings[u],K.type.getCurrentSol().else_instances.push(K)}cr.truncateArray(H,T);if(f)for(g=d.container,E=0,b=g.length;E<b;E++)C=g[E].getCurrentSol(),
c?cr.truncateArray(C.else_instances,T):cr.truncateArray(C.instances,T);T=L;if(c&&!L)for(E=0,b=e.instances.length;E<b;E++){C=e.instances[E];if(n)for(u=0,a=q.length;u<a;u++)K=q[u],K.variesPerInstance&&(p[u]=K.get(E));u=m?v.apply(C.behavior_insts[l],p):v.apply(C,p);if(cr.xor(u,y)){L=!0;break}}d.finish&&d.finish(T||k);return k?L:e.hasObjects()};cr.condition=b;l.prototype.postInit=function(){var b;var a=0;for(b=this.parameters.length;a<b;a++){var c=this.parameters[a];c.postInit();c.variesPerInstance&&
(this.anyParamVariesPerInstance=!0)}};l.prototype.run_system=function(){var b=this.runtime,a,c=this.parameters,d=this.results;var e=0;for(a=c.length;e<a;++e)d[e]=c[e].get();return this.func.apply(b.system,d)};l.prototype.run_object=function(){var b=this.type,a=this.beh_index,c=b.family_index,d=this.anyParamVariesPerInstance,e=this.parameters,k=this.results,f=this.func,g=b.getCurrentSol().getObjects();b=b.is_family;var h=-1<a,l,m;if(d){var n=0;for(m=e.length;n<m;++n){var q=e[n];q.variesPerInstance||
(k[n]=q.get(0))}}else for(n=0,m=e.length;n<m;++n)k[n]=e[n].get(0);var p=0;for(l=g.length;p<l;++p){var y=g[p];if(d)for(n=0,m=e.length;n<m;++n)q=e[n],q.variesPerInstance&&(k[n]=q.get(p));h?(n=0,b&&(n=y.type.family_beh_map[c]),f.apply(y.behavior_insts[a+n],k)):f.apply(y,k)}return!1};cr.action=l;var u=[],y=-1;n.prototype.postInit=function(){var b;if(11===this.type)this.eventvar=this.runtime.getEventVariableByName(this.varname,this.block.parent);else if(13===this.type){var a=0;for(b=this.subparams.length;a<
b;a++)this.subparams[a].postInit()}this.expression&&this.expression.postInit()};n.prototype.maybeVaryForType=function(b){this.variesPerInstance||!b||b.plugin.singleglobal||(this.variesPerInstance=!0)};n.prototype.setVaries=function(){this.variesPerInstance=!0};n.prototype.get_exp=function(b){this.solindex=b||0;b=p();this.expression.get(b);y--;return b.data};n.prototype.get_exp_str=function(b){this.solindex=b||0;b=p();this.expression.get(b);y--;return cr.is_string(b.data)?b.data:""};n.prototype.get_object=
function(){return this.object};n.prototype.get_combosel=function(){return this.combosel};n.prototype.get_layer=function(b){this.solindex=b||0;b=p();this.expression.get(b);y--;return b.is_number()?this.runtime.getLayerByNumber(b.data):this.runtime.getLayerByName(b.data)};n.prototype.get_layout=function(){return this.layout};n.prototype.get_key=function(){return this.key};n.prototype.get_instvar=function(){return this.index};n.prototype.get_familyvar=function(b){var a=b||0;b=this.owner.type;var c=b.getCurrentSol(),
d=c.getObjects();if(d.length)a=d[a%d.length].type;else if(c.else_instances.length)a=c.else_instances[a%c.else_instances.length].type;else if(b.instances.length)a=b.instances[a%b.instances.length].type;else return 0;return this.index+a.family_var_map[b.family_index]};n.prototype.get_eventvar=function(){return this.eventvar};n.prototype.get_audiofile=function(){return this.fileinfo};n.prototype.get_variadic=function(){var b;var a=0;for(b=this.subparams.length;a<b;a++)this.variadicret[a]=this.subparams[a].get();
return this.variadicret};cr.parameter=n;k.prototype.postInit=function(){this.solModifiers=h(this.solModifiers)};k.prototype.setValue=function(b){var a=this.runtime.getCurrentLocalVarStack();this.parent&&!this.is_static&&a?(this.localIndex>=a.length&&(a.length=this.localIndex+1),a[this.localIndex]=b):this.data=b};k.prototype.getValue=function(){var b=this.runtime.getCurrentLocalVarStack();return!this.parent||this.is_static||!b||this.is_constant?this.data:this.localIndex>=b.length||"undefined"===typeof b[this.localIndex]?
this.initial:b[this.localIndex]};k.prototype.run=function(){!this.parent||this.is_static||this.is_constant||this.setValue(this.initial)};cr.eventvariable=k;m.prototype.toString=function(){return"include:"+this.include_sheet.toString()};m.prototype.postInit=function(){this.include_sheet=this.runtime.eventsheets[this.include_sheet_name];this.sheet.includes.add(this);this.solModifiers=h(this.solModifiers);for(var b=this.parent;b;)b.group&&b.contained_includes.push(this),b=b.parent;this.updateActive()};
m.prototype.run=function(){this.parent&&this.runtime.pushCleanSol(this.runtime.types_by_index);this.include_sheet.hasRun||this.include_sheet.run(!0);this.parent&&this.runtime.popSol(this.runtime.types_by_index)};m.prototype.updateActive=function(){for(var b=this.parent;b;){if(b.group&&!b.group_active){this.active=!1;return}b=b.parent}this.active=!0};m.prototype.isActive=function(){return this.active};cr.eventinclude=m;q.prototype.reset=function(b){this.current_event=b;this.actindex=this.cndindex=
0;cr.clearArray(this.temp_parents_arr);this.any_true_state=this.else_branch_ran=this.last_event_true=!1};q.prototype.isModifierAfterCnds=function(){return this.current_event.solWriterAfterCnds?!0:this.cndindex<this.current_event.conditions.length-1?!!this.current_event.solModifiers.length:!1};cr.eventStackFrame=q})();
(function(){function a(a,b){this.owner=a;this.runtime=a.runtime;this.type=b[0];this.get=[this.eval_int,this.eval_float,this.eval_string,this.eval_unaryminus,this.eval_add,this.eval_subtract,this.eval_multiply,this.eval_divide,this.eval_mod,this.eval_power,this.eval_and,this.eval_or,this.eval_equal,this.eval_notequal,this.eval_less,this.eval_lessequal,this.eval_greater,this.eval_greaterequal,this.eval_conditional,this.eval_system_exp,this.eval_object_exp,this.eval_instvar_exp,this.eval_behavior_exp,
this.eval_eventvar_exp][this.type];var c=null;this.object_type=this.parameters=this.results=this.func=this.third=this.second=this.first=this.value=null;this.beh_index=-1;this.instance_expr=null;this.varindex=-1;this.eventvar=this.varname=this.behavior_type=null;this.return_string=!1;switch(this.type){case 0:case 1:case 2:this.value=b[1];break;case 3:this.first=new cr.expNode(a,b[1]);break;case 18:this.first=new cr.expNode(a,b[1]);this.second=new cr.expNode(a,b[2]);this.third=new cr.expNode(a,b[3]);
break;case 19:this.func=this.runtime.GetObjectReference(b[1]);this.func!==cr.system_object.prototype.exps.random&&this.func!==cr.system_object.prototype.exps.choose||this.owner.setVaries();this.results=[];this.parameters=[];3===b.length?(c=b[2],this.results.length=c.length+1):this.results.length=1;break;case 20:this.object_type=this.runtime.types_by_index[b[1]];this.beh_index=-1;this.func=this.runtime.GetObjectReference(b[2]);this.return_string=b[3];cr.plugins_.Function&&this.func===cr.plugins_.Function.prototype.exps.Call&&
this.owner.setVaries();this.instance_expr=b[4]?new cr.expNode(a,b[4]):null;this.results=[];this.parameters=[];6===b.length?(c=b[5],this.results.length=c.length+1):this.results.length=1;break;case 21:this.object_type=this.runtime.types_by_index[b[1]];this.return_string=b[2];this.instance_expr=b[3]?new cr.expNode(a,b[3]):null;this.varindex=b[4];break;case 22:this.object_type=this.runtime.types_by_index[b[1]];this.behavior_type=this.object_type.getBehaviorByName(b[2]);this.beh_index=this.object_type.getBehaviorIndexByName(b[2]);
this.func=this.runtime.GetObjectReference(b[3]);this.return_string=b[4];this.instance_expr=b[5]?new cr.expNode(a,b[5]):null;this.results=[];this.parameters=[];7===b.length?(c=b[6],this.results.length=c.length+1):this.results.length=1;break;case 23:this.varname=b[1],this.eventvar=null}this.owner.maybeVaryForType(this.object_type);4<=this.type&&17>=this.type&&(this.first=new cr.expNode(a,b[1]),this.second=new cr.expNode(a,b[2]));if(c){var d;b=0;for(d=c.length;b<d;b++)this.parameters.push(new cr.expNode(a,
c[b]))}cr.seal(this)}function f(){++d;e.length===d&&e.push(new cr.expvalue);return e[d]}function h(a,b,d){var c;var e=0;for(c=a.length;e<c;++e)a[e].get(d),b[e+1]=d.data}function g(a,b){this.type=a||cr.exptype.Integer;this.data=b||0;this.object_class=null;this.type==cr.exptype.Integer&&(this.data=Math.floor(this.data));cr.seal(this)}a.prototype.postInit=function(){23===this.type&&(this.eventvar=this.owner.runtime.getEventVariableByName(this.varname,this.owner.block.parent));this.first&&this.first.postInit();
this.second&&this.second.postInit();this.third&&this.third.postInit();this.instance_expr&&this.instance_expr.postInit();if(this.parameters){var a;var b=0;for(a=this.parameters.length;b<a;b++)this.parameters[b].postInit()}};var e=[],d=-1;a.prototype.eval_system_exp=function(a){var b=this.parameters,c=this.results;c[0]=a;a=f();h(b,c,a);--d;this.func.apply(this.runtime.system,c)};a.prototype.eval_object_exp=function(a){var b=this.object_type,c=this.results,e=this.parameters,g=this.instance_expr,k=this.func,
m=this.owner.solindex,q=b.getCurrentSol(),v=q.getObjects();if(!v.length)if(q.else_instances.length)v=q.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}c[0]=a;a.object_class=b;a=f();h(e,c,a);g&&(g.get(a),a.is_number()&&(m=a.data,v=b.instances));--d;b=v.length;if(m>=b||m<=-b)m%=b;0>m&&(m+=b);k.apply(v[m],c)};a.prototype.eval_behavior_exp=function(a){var b=this.object_type,c=this.results,e=this.parameters,g=this.instance_expr,k=this.beh_index,m=this.func,q=this.owner.solindex,
v=b.getCurrentSol(),u=v.getObjects();if(!u.length)if(v.else_instances.length)u=v.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}c[0]=a;a.object_class=b;a=f();h(e,c,a);g&&(g.get(a),a.is_number()&&(q=a.data,u=b.instances));--d;e=u.length;if(q>=e||q<=-e)q%=e;0>q&&(q+=e);q=u[q];u=0;b.is_family&&(u=q.type.family_beh_map[b.family_index]);m.apply(q.behavior_insts[k+u],c)};a.prototype.eval_instvar_exp=function(a){var b=this.instance_expr,c=this.object_type,e=this.varindex,g=this.owner.solindex,
k=c.getCurrentSol(),h=k.getObjects();if(!h.length)if(k.else_instances.length)h=k.else_instances;else{this.return_string?a.set_string(""):a.set_int(0);return}if(b){k=f();b.get(k);if(k.is_number()){g=k.data;h=c.instances;0!==h.length&&(g%=h.length,0>g&&(g+=h.length));g=c.getInstanceByIID(g);c=g.instance_vars[e];cr.is_string(c)?a.set_string(c):a.set_float(c);--d;return}--d}b=h.length;if(g>=b||g<=-b)g%=b;0>g&&(g+=b);g=h[g];h=0;c.is_family&&(h=g.type.family_var_map[c.family_index]);c=g.instance_vars[e+
h];cr.is_string(c)?a.set_string(c):a.set_float(c)};a.prototype.eval_int=function(a){a.type=cr.exptype.Integer;a.data=this.value};a.prototype.eval_float=function(a){a.type=cr.exptype.Float;a.data=this.value};a.prototype.eval_string=function(a){a.type=cr.exptype.String;a.data=this.value};a.prototype.eval_unaryminus=function(a){this.first.get(a);a.is_number()&&(a.data=-a.data)};a.prototype.eval_add=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data+=b.data,
b.is_float()&&a.make_float());--d};a.prototype.eval_subtract=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data-=b.data,b.is_float()&&a.make_float());--d};a.prototype.eval_multiply=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data*=b.data,b.is_float()&&a.make_float());--d};a.prototype.eval_divide=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data/=b.data,a.make_float());
--d};a.prototype.eval_mod=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data%=b.data,b.is_float()&&a.make_float());--d};a.prototype.eval_power=function(a){this.first.get(a);var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data=Math.pow(a.data,b.data),b.is_float()&&a.make_float());--d};a.prototype.eval_and=function(a){this.first.get(a);var b=f();this.second.get(b);b.is_string()||a.is_string()?this.eval_and_stringconcat(a,b):this.eval_and_logical(a,
b);--d};a.prototype.eval_and_stringconcat=function(a,b){a.is_string()&&b.is_string()?this.eval_and_stringconcat_str_str(a,b):this.eval_and_stringconcat_num(a,b)};a.prototype.eval_and_stringconcat_str_str=function(a,b){a.data+=b.data};a.prototype.eval_and_stringconcat_num=function(a,b){a.is_string()?a.data+=(Math.round(1E10*b.data)/1E10).toString():a.set_string(a.data.toString()+b.data)};a.prototype.eval_and_logical=function(a,b){a.set_int(a.data&&b.data?1:0)};a.prototype.eval_or=function(a){this.first.get(a);
var b=f();this.second.get(b);a.is_number()&&b.is_number()&&(a.data||b.data?a.set_int(1):a.set_int(0));--d};a.prototype.eval_conditional=function(a){this.first.get(a);a.data?this.second.get(a):this.third.get(a)};a.prototype.eval_equal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data===b.data?1:0);--d};a.prototype.eval_notequal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data!==b.data?1:0);--d};a.prototype.eval_less=function(a){this.first.get(a);
var b=f();this.second.get(b);a.set_int(a.data<b.data?1:0);--d};a.prototype.eval_lessequal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data<=b.data?1:0);--d};a.prototype.eval_greater=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data>b.data?1:0);--d};a.prototype.eval_greaterequal=function(a){this.first.get(a);var b=f();this.second.get(b);a.set_int(a.data>=b.data?1:0);--d};a.prototype.eval_eventvar_exp=function(a){var b=this.eventvar.getValue();cr.is_number(b)?
a.set_float(b):a.set_string(b)};cr.expNode=a;g.prototype.is_int=function(){return this.type===cr.exptype.Integer};g.prototype.is_float=function(){return this.type===cr.exptype.Float};g.prototype.is_number=function(){return this.type===cr.exptype.Integer||this.type===cr.exptype.Float};g.prototype.is_string=function(){return this.type===cr.exptype.String};g.prototype.make_int=function(){this.is_int()||(this.is_float()?this.data=Math.floor(this.data):this.is_string()&&(this.data=parseInt(this.data,10)),
this.type=cr.exptype.Integer)};g.prototype.make_float=function(){this.is_float()||(this.is_string()&&(this.data=parseFloat(this.data)),this.type=cr.exptype.Float)};g.prototype.make_string=function(){this.is_string()||(this.data=this.data.toString(),this.type=cr.exptype.String)};g.prototype.set_int=function(a){this.type=cr.exptype.Integer;this.data=Math.floor(a)};g.prototype.set_float=function(a){this.type=cr.exptype.Float;this.data=a};g.prototype.set_string=function(a){this.type=cr.exptype.String;
this.data=a};g.prototype.set_any=function(a){cr.is_number(a)?(this.type=cr.exptype.Float,this.data=a):cr.is_string(a)?(this.type=cr.exptype.String,this.data=a.toString()):(this.type=cr.exptype.Integer,this.data=0)};cr.expvalue=g;cr.exptype={Integer:0,Float:1,String:2}})();cr.system_object=function(a){this.runtime=a;this.waits=[]};
cr.system_object.prototype.saveToJSON=function(){var a={},f,h,g;a.waits=[];var e=a.waits;var d=0;for(f=this.waits.length;d<f;d++){var c=this.waits[d];var b={t:c.time,st:c.signaltag,s:c.signalled,ev:c.ev.sid,sm:[],sols:{}};c.ev.actions[c.actindex]&&(b.act=c.ev.actions[c.actindex].sid);var l=0;for(h=c.solModifiers.length;l<h;l++)b.sm.push(c.solModifiers[l].sid);for(g in c.sols)if(c.sols.hasOwnProperty(g)){var p=this.runtime.types_by_index[parseInt(g,10)];var n={sa:c.sols[g].sa,insts:[]};l=0;for(h=c.sols[g].insts.length;l<
h;l++)n.insts.push(c.sols[g].insts[l].uid);b.sols[p.sid.toString()]=n}e.push(b)}return a};
cr.system_object.prototype.loadFromJSON=function(a){a=a.waits;var f,h,g,e,d;cr.clearArray(this.waits);var c=0;for(f=a.length;c<f;c++){var b=a[c];if(e=this.runtime.blocksBySid[b.ev.toString()]){var l=-1;var p=0;for(h=e.actions.length;p<h;p++)if(e.actions[p].sid===b.act){l=p;break}if(-1!==l){var n={sols:{},solModifiers:[],deleteme:!1};n.time=b.t;n.signaltag=b.st||"";n.signalled=!!b.s;n.ev=e;n.actindex=l;p=0;for(h=b.sm.length;p<h;p++)(e=this.runtime.getObjectTypeBySid(b.sm[p]))&&n.solModifiers.push(e);
for(g in b.sols)if(b.sols.hasOwnProperty(g)&&(e=this.runtime.getObjectTypeBySid(parseInt(g,10)))){l=b.sols[g];var k={sa:l.sa,insts:[]};p=0;for(h=l.insts.length;p<h;p++)(d=this.runtime.getObjectByUID(l.insts[p]))&&k.insts.push(d);n.sols[e.index.toString()]=k}this.waits.push(n)}}}};
(function(){function a(){}function f(b,a){b=b.extra.c2_feo_val;a=a.extra.c2_feo_val;if(cr.is_number(b)&&cr.is_number(a))return b-a;b=""+b;a=""+a;return b<a?-1:b>a?1:0}function h(b,a){q&&b===v&&a===u||(q=new RegExp(b,a),v=b,u=a);q.lastIndex=0;return q}function g(){}function e(){var b=B.length?B.pop():{sols:{},solModifiers:[]};b.deleteme=!1;return b}function d(){var b=x.length?x.pop():{insts:[]};b.sa=!1;return b}function c(b,a){var c=b[0]-a[0];return 0!==c?c:b[1]-a[1]}function b(b,a){return b[1]-a[1]}
function l(){}function p(b,a,c){if(b!==A||a!==D||c!==G){var d=h(a,c);w=b.match(d);A=b;D=a;G=c}}var n=cr.system_object.prototype;a.prototype.EveryTick=function(){return!0};a.prototype.OnLayoutStart=function(){return!0};a.prototype.OnLayoutEnd=function(){return!0};a.prototype.Compare=function(b,a,c){return cr.do_cmp(b,a,c)};a.prototype.CompareTime=function(b,a){var c=this.runtime.kahanTime.sum;return 0===b?(b=this.runtime.getCurrentCondition(),!b.extra.CompareTime_executed&&c>=a?b.extra.CompareTime_executed=
!0:!1):cr.do_cmp(c,b,a)};a.prototype.LayerVisible=function(b){return b?b.visible:!1};a.prototype.LayerEmpty=function(b){return b?!b.instances.length:!1};a.prototype.LayerCmpOpacity=function(b,a,c){return b?cr.do_cmp(100*b.opacity,a,c):!1};a.prototype.Repeat=function(b){var a=this.runtime.getCurrentEventStack(),c=a.current_event,d=a.isModifierAfterCnds();a=this.runtime.pushLoopStack();if(d)for(d=0;d<b&&!a.stopped;d++)this.runtime.pushCopySol(c.solModifiers),a.index=d,c.retrigger(),this.runtime.popSol(c.solModifiers);
else for(d=0;d<b&&!a.stopped;d++)a.index=d,c.retrigger();this.runtime.popLoopStack();return!1};a.prototype.While=function(b){var a=this.runtime.getCurrentEventStack();b=a.current_event;var c=a.isModifierAfterCnds();a=this.runtime.pushLoopStack();if(c)for(c=0;!a.stopped;c++)this.runtime.pushCopySol(b.solModifiers),a.index=c,b.retrigger()||(a.stopped=!0),this.runtime.popSol(b.solModifiers);else for(c=0;!a.stopped;c++)a.index=c,b.retrigger()||(a.stopped=!0);this.runtime.popLoopStack();return!1};a.prototype.For=
function(b,a,c){var d=this.runtime.getCurrentEventStack(),e=d.current_event;d=d.isModifierAfterCnds();b=this.runtime.pushLoopStack(b);if(c<a)if(d)for(;a>=c&&!b.stopped;--a)this.runtime.pushCopySol(e.solModifiers),b.index=a,e.retrigger(),this.runtime.popSol(e.solModifiers);else for(;a>=c&&!b.stopped;--a)b.index=a,e.retrigger();else if(d)for(;a<=c&&!b.stopped;++a)this.runtime.pushCopySol(e.solModifiers),b.index=a,e.retrigger(),this.runtime.popSol(e.solModifiers);else for(;a<=c&&!b.stopped;++a)b.index=
a,e.retrigger();this.runtime.popLoopStack();return!1};var k=[],m=-1;a.prototype.ForEach=function(b){var a=b.getCurrentSol();m++;k.length===m&&k.push([]);var c=k[m];cr.shallowAssignArray(c,a.getObjects());var d=this.runtime.getCurrentEventStack(),e=d.current_event,f=d.isModifierAfterCnds();d=this.runtime.pushLoopStack();var g,h,l=b.is_contained;if(f)for(f=0,g=c.length;f<g&&!d.stopped;f++){this.runtime.pushCopySol(e.solModifiers);var r=c[f];a=b.getCurrentSol();a.select_all=!1;cr.clearArray(a.instances);
a.instances[0]=r;if(l){var n=0;for(h=r.siblings.length;n<h;n++){var w=r.siblings[n];var q=w.type.getCurrentSol();q.select_all=!1;cr.clearArray(q.instances);q.instances[0]=w}}d.index=f;e.retrigger();this.runtime.popSol(e.solModifiers)}else for(a.select_all=!1,cr.clearArray(a.instances),f=0,g=c.length;f<g&&!d.stopped;f++){r=c[f];a.instances[0]=r;if(l)for(n=0,h=r.siblings.length;n<h;n++)w=r.siblings[n],q=w.type.getCurrentSol(),q.select_all=!1,cr.clearArray(q.instances),q.instances[0]=w;d.index=f;e.retrigger()}cr.clearArray(c);
this.runtime.popLoopStack();m--;return!1};a.prototype.ForEachOrdered=function(b,a,c){a=b.getCurrentSol();m++;k.length===m&&k.push([]);var d=k[m];cr.shallowAssignArray(d,a.getObjects());var e=this.runtime.getCurrentEventStack(),g=e.current_event,h=this.runtime.getCurrentCondition(),l=e.isModifierAfterCnds();e=this.runtime.pushLoopStack();var r;var t=0;for(r=d.length;t<r;t++)d[t].extra.c2_feo_val=h.parameters[1].get(t);d.sort(f);1===c&&d.reverse();c=b.is_contained;if(l)for(t=0,r=d.length;t<r&&!e.stopped;t++){this.runtime.pushCopySol(g.solModifiers);
var n=d[t];a=b.getCurrentSol();a.select_all=!1;cr.clearArray(a.instances);a.instances[0]=n;if(c)for(h=0,l=n.siblings.length;h<l;h++){var w=n.siblings[h];var q=w.type.getCurrentSol();q.select_all=!1;cr.clearArray(q.instances);q.instances[0]=w}e.index=t;g.retrigger();this.runtime.popSol(g.solModifiers)}else for(a.select_all=!1,cr.clearArray(a.instances),t=0,r=d.length;t<r&&!e.stopped;t++){n=d[t];a.instances[0]=n;if(c)for(h=0,l=n.siblings.length;h<l;h++)w=n.siblings[h],q=w.type.getCurrentSol(),q.select_all=
!1,cr.clearArray(q.instances),q.instances[0]=w;e.index=t;g.retrigger()}cr.clearArray(d);this.runtime.popLoopStack();m--;return!1};a.prototype.PickByComparison=function(b,a,c,d){var e,f;if(b){m++;k.length===m&&k.push([]);var g=k[m],h=b.getCurrentSol();cr.shallowAssignArray(g,h.getObjects());h.select_all&&cr.clearArray(h.else_instances);var l=this.runtime.getCurrentCondition();var r=e=0;for(f=g.length;e<f;e++){var t=g[e];g[r]=t;a=l.parameters[1].get(e);d=l.parameters[3].get(e);cr.do_cmp(a,c,d)?r++:
h.else_instances.push(t)}cr.truncateArray(g,r);h.select_all=!1;cr.shallowAssignArray(h.instances,g);cr.clearArray(g);m--;b.applySolToContainer();return!!h.instances.length}};a.prototype.PickByEvaluate=function(b,a){var c,d;if(b){m++;k.length===m&&k.push([]);var e=k[m],f=b.getCurrentSol();cr.shallowAssignArray(e,f.getObjects());f.select_all&&cr.clearArray(f.else_instances);var g=this.runtime.getCurrentCondition();var h=c=0;for(d=e.length;c<d;c++){var l=e[c];e[h]=l;(a=g.parameters[1].get(c))?h++:f.else_instances.push(l)}cr.truncateArray(e,
h);f.select_all=!1;cr.shallowAssignArray(f.instances,e);cr.clearArray(e);m--;b.applySolToContainer();return!!f.instances.length}};a.prototype.TriggerOnce=function(){var b=this.runtime.getCurrentCondition().extra;"undefined"===typeof b.TriggerOnce_lastTick&&(b.TriggerOnce_lastTick=-1);var a=b.TriggerOnce_lastTick,c=this.runtime.tickcount;b.TriggerOnce_lastTick=c;return this.runtime.layout_first_tick||a!==c-1};a.prototype.Every=function(b){var a=this.runtime.getCurrentCondition(),c=a.extra.Every_lastTime||
0,d=this.runtime.kahanTime.sum;"undefined"===typeof a.extra.Every_seconds&&(a.extra.Every_seconds=b);var e=a.extra.Every_seconds;if(d>=c+e)return a.extra.Every_lastTime=c+e,d>=a.extra.Every_lastTime+.04&&(a.extra.Every_lastTime=d),a.extra.Every_seconds=b,!0;d<c-.1&&(a.extra.Every_lastTime=d);return!1};a.prototype.PickNth=function(b,a){if(!b)return!1;var c=b.getCurrentSol(),d=c.getObjects();a=cr.floor(a);if(0>a||a>=d.length)return!1;c.pick_one(d[a]);b.applySolToContainer();return!0};a.prototype.PickRandom=
function(b){if(!b)return!1;var a=b.getCurrentSol(),c=a.getObjects(),d=cr.floor(Math.random()*c.length);if(d>=c.length)return!1;a.pick_one(c[d]);b.applySolToContainer();return!0};a.prototype.CompareVar=function(b,a,c){return cr.do_cmp(b.getValue(),a,c)};a.prototype.IsGroupActive=function(b){return(b=this.runtime.groups_by_name[b.toLowerCase()])&&b.group_active};a.prototype.IsPreview=function(){return"undefined"!==typeof cr_is_preview};a.prototype.PickAll=function(b){if(!b||!b.instances.length)return!1;
b.getCurrentSol().select_all=!0;b.applySolToContainer();return!0};a.prototype.IsMobile=function(){return this.runtime.isMobile};a.prototype.CompareBetween=function(b,a,c){return b>=a&&b<=c};a.prototype.Else=function(){var b=this.runtime.getCurrentEventStack();return b.else_branch_ran?!1:!b.last_event_true};a.prototype.OnLoadFinished=function(){return!0};a.prototype.OnCanvasSnapshot=function(){return!0};a.prototype.EffectsSupported=function(){return!!this.runtime.glwrap};a.prototype.OnSaveComplete=
function(){return!0};a.prototype.OnSaveFailed=function(){return!0};a.prototype.OnLoadComplete=function(){return!0};a.prototype.OnLoadFailed=function(){return!0};a.prototype.ObjectUIDExists=function(b){return!!this.runtime.getObjectByUID(b)};a.prototype.IsOnPlatform=function(b){var a=this.runtime;switch(b){case 0:return!a.isDomFree&&!a.isNodeWebkit&&!a.isCordova&&!a.isWinJS&&!a.isWindowsPhone8&&!a.isBlackberry10&&!a.isAmazonWebApp;case 1:return a.isiOS;case 2:return a.isAndroid;case 3:return a.isWindows8App;
case 4:return a.isWindowsPhone8;case 5:return a.isBlackberry10;case 6:return a.isTizen;case 7:return a.isCocoonJs;case 8:return a.isCordova;case 9:return a.isArcade;case 10:return a.isNodeWebkit;case 11:return a.isCrosswalk;case 12:return a.isAmazonWebApp;case 13:return a.isWindows10;default:return!1}};var q=null,v="",u="";a.prototype.RegexTest=function(b,a,c){return h(a,c).test(b)};var y=[];a.prototype.PickOverlappingPoint=function(b,a,c){if(!b)return!1;var d=b.getCurrentSol(),e=d.getObjects(),k=
this.runtime.getCurrentEventStack().current_event.orblock,f=this.runtime.getCurrentCondition(),g;d.select_all?(cr.shallowAssignArray(y,e),cr.clearArray(d.else_instances),d.select_all=!1,cr.clearArray(d.instances)):k?(cr.shallowAssignArray(y,d.else_instances),cr.clearArray(d.else_instances)):(cr.shallowAssignArray(y,e),cr.clearArray(d.instances));e=0;for(k=y.length;e<k;++e){var h=y[e];h.update_bbox();(g=cr.xor(h.contains_pt(a,c),f.inverted))?d.instances.push(h):d.else_instances.push(h)}b.applySolToContainer();
return cr.xor(!!d.instances.length,f.inverted)};a.prototype.IsNaN=function(b){return!!isNaN(b)};a.prototype.AngleWithin=function(b,a,c){return cr.angleDiff(cr.to_radians(b),cr.to_radians(c))<=cr.to_radians(a)};a.prototype.IsClockwiseFrom=function(b,a){return cr.angleClockwise(cr.to_radians(b),cr.to_radians(a))};a.prototype.IsBetweenAngles=function(b,a,c){b=cr.to_clamped_radians(b);a=cr.to_clamped_radians(a);c=cr.to_clamped_radians(c);return cr.angleClockwise(c,a)?cr.angleClockwise(b,a)&&!cr.angleClockwise(b,
c):!(!cr.angleClockwise(b,a)&&cr.angleClockwise(b,c))};a.prototype.IsValueType=function(b,a){return"number"===typeof b?0===a:1===a};n.cnds=new a;g.prototype.GoToLayout=function(b){this.runtime.isloading||this.runtime.changelayout||(this.runtime.changelayout=b)};g.prototype.NextPrevLayout=function(b){if(!this.runtime.isloading&&!this.runtime.changelayout){var a=this.runtime.layouts_by_index.indexOf(this.runtime.running_layout);if(!b||0!==a)if(b||a!==this.runtime.layouts_by_index.length-1)this.runtime.changelayout=
this.runtime.layouts_by_index[a+(b?-1:1)]}};g.prototype.CreateObject=function(b,a,c,d){if(a&&b&&(a=this.runtime.createInstance(b,a,c,d))){this.runtime.isInOnDestroy++;this.runtime.trigger(Object.getPrototypeOf(b.plugin).cnds.OnCreated,a);if(a.is_contained)for(c=0,d=a.siblings.length;c<d;c++){var e=a.siblings[c];this.runtime.trigger(Object.getPrototypeOf(e.type.plugin).cnds.OnCreated,e)}this.runtime.isInOnDestroy--;b=b.getCurrentSol();b.select_all=!1;cr.clearArray(b.instances);b.instances[0]=a;if(a.is_contained)for(c=
0,d=a.siblings.length;c<d;c++)e=a.siblings[c],b=e.type.getCurrentSol(),b.select_all=!1,cr.clearArray(b.instances),b.instances[0]=e}};g.prototype.SetLayerVisible=function(b,a){b&&b.visible!==a&&(b.visible=a,this.runtime.redraw=!0)};g.prototype.SetLayerOpacity=function(b,a){b&&(a=cr.clamp(a/100,0,1),b.opacity!==a&&(b.opacity=a,this.runtime.redraw=!0))};g.prototype.SetLayerScaleRate=function(b,a){b&&b.zoomRate!==a&&(b.zoomRate=a,this.runtime.redraw=!0)};g.prototype.SetLayerForceOwnTexture=function(b,
a){b&&(a=!!a,b.forceOwnTexture!==a&&(b.forceOwnTexture=a,this.runtime.redraw=!0))};g.prototype.SetLayoutScale=function(b){this.runtime.running_layout&&this.runtime.running_layout.scale!==b&&(this.runtime.running_layout.scale=b,this.runtime.running_layout.boundScrolling(),this.runtime.redraw=!0)};g.prototype.ScrollX=function(b){this.runtime.running_layout.scrollToX(b)};g.prototype.ScrollY=function(b){this.runtime.running_layout.scrollToY(b)};g.prototype.Scroll=function(b,a){this.runtime.running_layout.scrollToX(b);
this.runtime.running_layout.scrollToY(a)};g.prototype.ScrollToObject=function(b){if(b=b.getFirstPicked())this.runtime.running_layout.scrollToX(b.x),this.runtime.running_layout.scrollToY(b.y)};g.prototype.SetVar=function(b,a){0===b.vartype?cr.is_number(a)?b.setValue(a):b.setValue(parseFloat(a)):1===b.vartype&&b.setValue(a.toString())};g.prototype.AddVar=function(b,a){0===b.vartype?cr.is_number(a)?b.setValue(b.getValue()+a):b.setValue(b.getValue()+parseFloat(a)):1===b.vartype&&b.setValue(b.getValue()+
a.toString())};g.prototype.SubVar=function(b,a){0===b.vartype&&(cr.is_number(a)?b.setValue(b.getValue()-a):b.setValue(b.getValue()-parseFloat(a)))};g.prototype.SetGroupActive=function(b,a){if(b=this.runtime.groups_by_name[b.toLowerCase()])switch(a){case 0:b.setGroupActive(!1);break;case 1:b.setGroupActive(!0);break;case 2:b.setGroupActive(!b.group_active)}};g.prototype.SetTimescale=function(b){0>b&&(b=0);this.runtime.timescale=b};g.prototype.SetObjectTimescale=function(b,a){0>a&&(a=0);if(b){b=b.getCurrentSol().getObjects();
var c;var d=0;for(c=b.length;d<c;d++)b[d].my_timescale=a}};g.prototype.RestoreObjectTimescale=function(b){if(!b)return!1;b=b.getCurrentSol().getObjects();var a;var c=0;for(a=b.length;c<a;c++)b[c].my_timescale=-1};var B=[],x=[];g.prototype.Wait=function(b){if(!(0>b)){var a,c=this.runtime.getCurrentEventStack(),k=e();k.time=this.runtime.kahanTime.sum+b;k.signaltag="";k.signalled=!1;k.ev=c.current_event;k.actindex=c.actindex+1;b=0;for(a=this.runtime.types_by_index.length;b<a;b++){var f=this.runtime.types_by_index[b];
var g=f.getCurrentSol();g.select_all&&-1===c.current_event.solModifiers.indexOf(f)||(k.solModifiers.push(f),f=d(),f.sa=g.select_all,cr.shallowAssignArray(f.insts,g.instances),k.sols[b.toString()]=f)}this.waits.push(k);return!0}};g.prototype.WaitForSignal=function(b){var a,c=this.runtime.getCurrentEventStack(),k=e();k.time=-1;k.signaltag=b.toLowerCase();k.signalled=!1;k.ev=c.current_event;k.actindex=c.actindex+1;b=0;for(a=this.runtime.types_by_index.length;b<a;b++){var f=this.runtime.types_by_index[b];
var g=f.getCurrentSol();g.select_all&&-1===c.current_event.solModifiers.indexOf(f)||(k.solModifiers.push(f),f=d(),f.sa=g.select_all,cr.shallowAssignArray(f.insts,g.instances),k.sols[b.toString()]=f)}this.waits.push(k);return!0};g.prototype.Signal=function(b){b=b.toLowerCase();var a;var c=0;for(a=this.waits.length;c<a;++c){var d=this.waits[c];-1===d.time&&d.signaltag===b&&(d.signalled=!0)}};g.prototype.SetLayerScale=function(b,a){b&&b.scale!==a&&(b.scale=a,this.runtime.redraw=!0)};g.prototype.ResetGlobals=
function(){var b;var a=0;for(b=this.runtime.all_global_vars.length;a<b;a++){var c=this.runtime.all_global_vars[a];c.data=c.initial}};g.prototype.SetLayoutAngle=function(b){b=cr.to_radians(b);b=cr.clamp_angle(b);this.runtime.running_layout&&this.runtime.running_layout.angle!==b&&(this.runtime.running_layout.angle=b,this.runtime.redraw=!0)};g.prototype.SetLayerAngle=function(b,a){b&&(a=cr.to_radians(a),a=cr.clamp_angle(a),b.angle!==a&&(b.angle=a,this.runtime.redraw=!0))};g.prototype.SetLayerParallax=
function(b,a,c){if(b&&(b.parallaxX!==a/100||b.parallaxY!==c/100)){b.parallaxX=a/100;b.parallaxY=c/100;if(1!==b.parallaxX||1!==b.parallaxY)for(c=b.instances,b=0,a=c.length;b<a;++b)c[b].type.any_instance_parallaxed=!0;this.runtime.redraw=!0}};g.prototype.SetLayerBackground=function(b,a){if(b){var c=cr.GetRValue(a),d=cr.GetGValue(a);a=cr.GetBValue(a);if(b.background_color[0]!==c||b.background_color[1]!==d||b.background_color[2]!==a)b.background_color[0]=c,b.background_color[1]=d,b.background_color[2]=
a,this.runtime.redraw=!0}};g.prototype.SetLayerTransparent=function(b,a){b&&!!a!==!!b.transparent&&(b.transparent=!!a,this.runtime.redraw=!0)};g.prototype.SetLayerBlendMode=function(b,a){b&&b.blend_mode!==a&&(b.blend_mode=a,b.compositeOp=cr.effectToCompositeOp(b.blend_mode),this.runtime.gl&&cr.setGLBlend(b,b.blend_mode,this.runtime.gl),this.runtime.redraw=!0)};g.prototype.StopLoop=function(){0>this.runtime.loop_stack_index||(this.runtime.getCurrentLoop().stopped=!0)};g.prototype.GoToLayoutByName=
function(b){if(!this.runtime.isloading&&!this.runtime.changelayout)for(var a in this.runtime.layouts)if(this.runtime.layouts.hasOwnProperty(a)&&cr.equals_nocase(a,b)){this.runtime.changelayout=this.runtime.layouts[a];break}};g.prototype.RestartLayout=function(b){if(!this.runtime.isloading&&!this.runtime.changelayout&&this.runtime.running_layout){this.runtime.changelayout=this.runtime.running_layout;var a;b=0;for(a=this.runtime.allGroups.length;b<a;b++){var c=this.runtime.allGroups[b];c.setGroupActive(c.initially_activated)}}};
g.prototype.SnapshotCanvas=function(b,a){this.runtime.doCanvasSnapshot(0===b?"image/png":"image/jpeg",a/100)};g.prototype.SetCanvasSize=function(b,a){if(!(0>=b||0>=a)){var c=this.runtime.fullscreen_mode;(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||this.runtime.isNodeFullscreen)&&0<this.runtime.fullscreen_scaling&&(c=this.runtime.fullscreen_scaling);0===c?this.runtime.setSize(b,a,!0):(this.runtime.original_width=b,this.runtime.original_height=
a,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0))}};g.prototype.SetLayoutEffectEnabled=function(b,a){this.runtime.running_layout&&this.runtime.glwrap&&(a=this.runtime.running_layout.getEffectByName(a))&&(b=1===b,a.active!=b&&(a.active=b,this.runtime.running_layout.updateActiveEffects(),this.runtime.redraw=!0))};g.prototype.SetLayerEffectEnabled=function(b,a,c){b&&this.runtime.glwrap&&(c=b.getEffectByName(c))&&(a=1===a,c.active!=a&&(c.active=a,b.updateActiveEffects(),
this.runtime.redraw=!0))};g.prototype.SetLayoutEffectParam=function(b,a,c){if(this.runtime.running_layout&&this.runtime.glwrap&&(b=this.runtime.running_layout.getEffectByName(b))){var d=this.runtime.running_layout.effect_params[b.index];a=Math.floor(a);0>a||a>=d.length||(1===this.runtime.glwrap.getProgramParameterType(b.shaderindex,a)&&(c/=100),d[a]!==c&&(d[a]=c,b.active&&(this.runtime.redraw=!0)))}};g.prototype.SetLayerEffectParam=function(b,a,c,d){b&&this.runtime.glwrap&&(a=b.getEffectByName(a))&&
(b=b.effect_params[a.index],c=Math.floor(c),0>c||c>=b.length||(1===this.runtime.glwrap.getProgramParameterType(a.shaderindex,c)&&(d/=100),b[c]!==d&&(b[c]=d,a.active&&(this.runtime.redraw=!0))))};g.prototype.SaveState=function(b){this.runtime.saveToSlot=b};g.prototype.LoadState=function(b){this.runtime.loadFromSlot=b};g.prototype.LoadStateJSON=function(b){this.runtime.loadFromJson=b};g.prototype.SetHalfFramerateMode=function(b){this.runtime.halfFramerateMode=0!==b};g.prototype.SetFullscreenQuality=
function(b){if(document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||this.isNodeFullscreen||0!==this.runtime.fullscreen_mode)this.runtime.wantFullscreenScalingQuality=0!==b,this.runtime.setSize(this.runtime.lastWindowWidth,this.runtime.lastWindowHeight,!0)};g.prototype.ResetPersisted=function(){var b;var a=0;for(b=this.runtime.layouts_by_index.length;a<b;++a)this.runtime.layouts_by_index[a].persist_data={},this.runtime.layouts_by_index[a].first_visit=
!0};g.prototype.RecreateInitialObjects=function(b,a,c,d,e){b&&this.runtime.running_layout.recreateInitialObjects(b,a,c,d,e)};g.prototype.SetPixelRounding=function(b){this.runtime.pixel_rounding=0!==b;this.runtime.redraw=!0};g.prototype.SetMinimumFramerate=function(b){1>b&&(b=1);120<b&&(b=120);this.runtime.minimumFramerate=b};g.prototype.SortZOrderByInstVar=function(a,d){if(a){var e;var k=a.getCurrentSol().getObjects();var f=[],g=[],h=this.runtime.running_layout,l=a.is_family,m=a.family_index;a=0;
for(e=k.length;a<e;++a){var n=k[a];if(n.layer){var t=l?n.instance_vars[d+n.type.family_var_map[m]]:n.instance_vars[d];f.push([n.layer.index,n.get_zindex()]);g.push([n,t])}}if(f.length)for(f.sort(c),g.sort(b),a=0,e=f.length;a<e;++a)n=g[a][0],d=h.layers[f[a][0]],k=f[a][1],d.instances[k]!==n&&(d.instances[k]=n,n.layer=d,d.setZIndicesStaleFrom(k))}};n.acts=new g;l.prototype["int"]=function(b,a){cr.is_string(a)?(b.set_int(parseInt(a,10)),isNaN(b.data)&&(b.data=0)):b.set_int(a)};l.prototype["float"]=function(b,
a){cr.is_string(a)?(b.set_float(parseFloat(a)),isNaN(b.data)&&(b.data=0)):b.set_float(a)};l.prototype.str=function(b,a){cr.is_string(a)?b.set_string(a):b.set_string(a.toString())};l.prototype.len=function(b,a){b.set_int(a.length||0)};l.prototype.random=function(b,a,c){void 0===c?b.set_float(Math.random()*a):b.set_float(Math.random()*(c-a)+a)};l.prototype.sqrt=function(b,a){b.set_float(Math.sqrt(a))};l.prototype.abs=function(b,a){b.set_float(Math.abs(a))};l.prototype.round=function(b,a){b.set_int(Math.round(a))};
l.prototype.floor=function(b,a){b.set_int(Math.floor(a))};l.prototype.ceil=function(b,a){b.set_int(Math.ceil(a))};l.prototype.sin=function(b,a){b.set_float(Math.sin(cr.to_radians(a)))};l.prototype.cos=function(b,a){b.set_float(Math.cos(cr.to_radians(a)))};l.prototype.tan=function(b,a){b.set_float(Math.tan(cr.to_radians(a)))};l.prototype.asin=function(b,a){b.set_float(cr.to_degrees(Math.asin(a)))};l.prototype.acos=function(b,a){b.set_float(cr.to_degrees(Math.acos(a)))};l.prototype.atan=function(b,
a){b.set_float(cr.to_degrees(Math.atan(a)))};l.prototype.exp=function(b,a){b.set_float(Math.exp(a))};l.prototype.ln=function(b,a){b.set_float(Math.log(a))};l.prototype.log10=function(b,a){b.set_float(Math.log(a)/Math.LN10)};l.prototype.max=function(b){var a=arguments[1];"number"!==typeof a&&(a=0);var c;var d=2;for(c=arguments.length;d<c;d++){var e=arguments[d];"number"===typeof e&&a<e&&(a=e)}b.set_float(a)};l.prototype.min=function(b){var a=arguments[1];"number"!==typeof a&&(a=0);var c;var d=2;for(c=
arguments.length;d<c;d++){var e=arguments[d];"number"===typeof e&&a>e&&(a=e)}b.set_float(a)};l.prototype.dt=function(b){b.set_float(this.runtime.dt)};l.prototype.timescale=function(b){b.set_float(this.runtime.timescale)};l.prototype.wallclocktime=function(b){b.set_float((Date.now()-this.runtime.start_time)/1E3)};l.prototype.time=function(b){b.set_float(this.runtime.kahanTime.sum)};l.prototype.tickcount=function(b){b.set_int(this.runtime.tickcount)};l.prototype.objectcount=function(b){b.set_int(this.runtime.objectcount)};
l.prototype.fps=function(b){b.set_int(this.runtime.fps)};l.prototype.loopindex=function(b,a){var c;if(this.runtime.loop_stack.length)if(a){for(c=this.runtime.loop_stack_index;0<=c;--c){var d=this.runtime.loop_stack[c];if(d.name===a){b.set_int(d.index);return}}b.set_int(0)}else d=this.runtime.getCurrentLoop(),b.set_int(d?d.index:-1);else b.set_int(0)};l.prototype.distance=function(b,a,c,d,e){b.set_float(cr.distanceTo(a,c,d,e))};l.prototype.angle=function(b,a,c,d,e){b.set_float(cr.to_degrees(cr.angleTo(a,
c,d,e)))};l.prototype.scrollx=function(b){b.set_float(this.runtime.running_layout.scrollX)};l.prototype.scrolly=function(b){b.set_float(this.runtime.running_layout.scrollY)};l.prototype.newline=function(b){b.set_string("\n")};l.prototype.lerp=function(b,a,c,d){b.set_float(cr.lerp(a,c,d))};l.prototype.qarp=function(b,a,c,d,e){b.set_float(cr.qarp(a,c,d,e))};l.prototype.cubic=function(b,a,c,d,e,k){b.set_float(cr.cubic(a,c,d,e,k))};l.prototype.cosp=function(b,a,c,d){b.set_float(cr.cosp(a,c,d))};l.prototype.windowwidth=
function(b){b.set_int(this.runtime.width)};l.prototype.windowheight=function(b){b.set_int(this.runtime.height)};l.prototype.uppercase=function(b,a){b.set_string(cr.is_string(a)?a.toUpperCase():"")};l.prototype.lowercase=function(b,a){b.set_string(cr.is_string(a)?a.toLowerCase():"")};l.prototype.clamp=function(b,a,c,d){a<c?b.set_float(c):a>d?b.set_float(d):b.set_float(a)};l.prototype.layerscale=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(a.scale):b.set_float(0)};l.prototype.layeropacity=
function(b,a){(a=this.runtime.getLayer(a))?b.set_float(100*a.opacity):b.set_float(0)};l.prototype.layerscalerate=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(a.zoomRate):b.set_float(0)};l.prototype.layerparallaxx=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(100*a.parallaxX):b.set_float(0)};l.prototype.layerparallaxy=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(100*a.parallaxY):b.set_float(0)};l.prototype.layerindex=function(b,a){(a=this.runtime.getLayer(a))?b.set_int(a.index):
b.set_int(-1)};l.prototype.layoutscale=function(b){this.runtime.running_layout?b.set_float(this.runtime.running_layout.scale):b.set_float(0)};l.prototype.layoutangle=function(b){b.set_float(cr.to_degrees(this.runtime.running_layout.angle))};l.prototype.layerangle=function(b,a){(a=this.runtime.getLayer(a))?b.set_float(cr.to_degrees(a.angle)):b.set_float(0)};l.prototype.layoutwidth=function(b){b.set_int(this.runtime.running_layout.width)};l.prototype.layoutheight=function(b){b.set_int(this.runtime.running_layout.height)};
l.prototype.find=function(b,a,c){cr.is_string(a)&&cr.is_string(c)?b.set_int(a.search(new RegExp(cr.regexp_escape(c),"i"))):b.set_int(-1)};l.prototype.findcase=function(b,a,c){cr.is_string(a)&&cr.is_string(c)?b.set_int(a.search(new RegExp(cr.regexp_escape(c),""))):b.set_int(-1)};l.prototype.left=function(b,a,c){b.set_string(cr.is_string(a)?a.substr(0,c):"")};l.prototype.right=function(b,a,c){b.set_string(cr.is_string(a)?a.substr(a.length-c):"")};l.prototype.mid=function(b,a,c,d){b.set_string(cr.is_string(a)?
a.substr(c,d):"")};l.prototype.tokenat=function(b,a,c,d){cr.is_string(a)&&cr.is_string(d)?(a=a.split(d),c=cr.floor(c),0>c||c>=a.length?b.set_string(""):b.set_string(a[c])):b.set_string("")};l.prototype.tokencount=function(b,a,c){cr.is_string(a)&&a.length?b.set_int(a.split(c).length):b.set_int(0)};l.prototype.replace=function(b,a,c,d){cr.is_string(a)&&cr.is_string(c)&&cr.is_string(d)?b.set_string(a.replace(new RegExp(cr.regexp_escape(c),"gi"),d)):b.set_string(cr.is_string(a)?a:"")};l.prototype.trim=
function(b,a){b.set_string(cr.is_string(a)?a.trim():"")};l.prototype.pi=function(b){b.set_float(cr.PI)};l.prototype.layoutname=function(b){this.runtime.running_layout?b.set_string(this.runtime.running_layout.name):b.set_string("")};l.prototype.renderer=function(b){b.set_string(this.runtime.gl?"webgl":"canvas2d")};l.prototype.rendererdetail=function(b){b.set_string(this.runtime.glUnmaskedRenderer)};l.prototype.anglediff=function(b,a,c){b.set_float(cr.to_degrees(cr.angleDiff(cr.to_radians(a),cr.to_radians(c))))};
l.prototype.choose=function(b){var a=cr.floor(Math.random()*(arguments.length-1));b.set_any(arguments[a+1])};l.prototype.rgb=function(b,a,c,d){b.set_int(cr.RGB(a,c,d))};l.prototype.projectversion=function(b){b.set_string(this.runtime.versionstr)};l.prototype.projectname=function(b){b.set_string(this.runtime.projectName)};l.prototype.anglelerp=function(b,a,c,d){a=cr.to_radians(a);c=cr.to_radians(c);var e=cr.angleDiff(a,c);cr.angleClockwise(c,a)?b.set_float(cr.to_clamped_degrees(a+e*d)):b.set_float(cr.to_clamped_degrees(a-
e*d))};l.prototype.anglerotate=function(b,a,c,d){a=cr.to_radians(a);c=cr.to_radians(c);d=cr.to_radians(d);b.set_float(cr.to_clamped_degrees(cr.angleRotate(a,c,d)))};l.prototype.zeropad=function(b,a,c){var d=0>a?"-":"";0>a&&(a=-a);c-=a.toString().length;for(var e=0;e<c;e++)d+="0";b.set_string(d+a.toString())};l.prototype.cpuutilisation=function(b){b.set_float(this.runtime.cpuutilisation/1E3)};l.prototype.viewportleft=function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewLeft:0)};l.prototype.viewporttop=
function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewTop:0)};l.prototype.viewportright=function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewRight:0)};l.prototype.viewportbottom=function(b,a){a=this.runtime.getLayer(a);b.set_float(a?a.viewBottom:0)};l.prototype.loadingprogress=function(b){b.set_float(this.runtime.loadingprogress)};l.prototype.unlerp=function(b,a,c,d){b.set_float(cr.unlerp(a,c,d))};l.prototype.canvassnapshot=function(b){b.set_string(this.runtime.snapshotData)};l.prototype.urlencode=
function(b,a){b.set_string(encodeURIComponent(a))};l.prototype.urldecode=function(b,a){b.set_string(decodeURIComponent(a))};l.prototype.canvastolayerx=function(b,a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.canvasToLayer(c,d,!0):0)};l.prototype.canvastolayery=function(b,a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.canvasToLayer(c,d,!1):0)};l.prototype.layertocanvasx=function(b,a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.layerToCanvas(c,d,!0):0)};l.prototype.layertocanvasy=function(b,
a,c,d){a=this.runtime.getLayer(a);b.set_float(a?a.layerToCanvas(c,d,!1):0)};l.prototype.savestatejson=function(b){b.set_string(this.runtime.lastSaveJson)};l.prototype.imagememoryusage=function(b){this.runtime.glwrap?b.set_float(Math.round(100*this.runtime.glwrap.estimateVRAM()/1048576)/100):b.set_float(0)};l.prototype.regexsearch=function(b,a,c,d){c=h(c,d);b.set_int(a?a.search(c):-1)};l.prototype.regexreplace=function(b,a,c,d,e){c=h(c,d);b.set_string(a?a.replace(c,e):"")};var w=[],A="",D="",G="";
l.prototype.regexmatchcount=function(b,a,c,d){h(c,d);p(a.toString(),c,d);b.set_int(w?w.length:0)};l.prototype.regexmatchat=function(b,a,c,d,e){e=Math.floor(e);h(c,d);p(a.toString(),c,d);!w||0>e||e>=w.length?b.set_string(""):b.set_string(w[e])};l.prototype.infinity=function(b){b.set_float(Infinity)};l.prototype.setbit=function(b,a,c,d){c|=0;b.set_int((a|0)&~(1<<c)|(0!==d?1:0)<<c)};l.prototype.togglebit=function(b,a,c){b.set_int((a|0)^1<<(c|0))};l.prototype.getbit=function(b,a,c){b.set_int((a|0)&1<<
(c|0)?1:0)};l.prototype.originalwindowwidth=function(b){b.set_int(this.runtime.original_width)};l.prototype.originalwindowheight=function(b){b.set_int(this.runtime.original_height)};n.exps=new l;n.runWaits=function(){var b,a=this.runtime.getCurrentEventStack();var c=0;for(b=this.waits.length;c<b;c++){var d=this.waits[c];if(-1===d.time){if(!d.signalled)continue}else if(d.time>this.runtime.kahanTime.sum)continue;a.current_event=d.ev;a.actindex=d.actindex;a.cndindex=0;for(f in d.sols)if(d.sols.hasOwnProperty(f)){var e=
this.runtime.types_by_index[parseInt(f,10)].getCurrentSol();var k=d.sols[f];e.select_all=k.sa;cr.shallowAssignArray(e.instances,k.insts);e=k;cr.clearArray(e.insts);x.push(e)}d.ev.resume_actions_and_subevents();this.runtime.clearSol(d.solModifiers);d.deleteme=!0}var f=c=0;for(b=this.waits.length;c<b;c++)d=this.waits[c],this.waits[f]=d,d.deleteme?(cr.wipe(d.sols),cr.clearArray(d.solModifiers),B.push(d)):f++;cr.truncateArray(this.waits,f)}})();
(function(){cr.add_common_aces=function(a,h){var f=a[1],e=a[3],d=a[4],c=a[5],b=a[6],l=a[7];a=a[8];h.cnds||(h.cnds={});h.acts||(h.acts={});h.exps||(h.exps={});var p=h.cnds,n=h.acts;h=h.exps;e&&(p.CompareX=function(b,a){return cr.do_cmp(this.x,b,a)},p.CompareY=function(b,a){return cr.do_cmp(this.y,b,a)},p.IsOnScreen=function(){var b=this.layer;this.update_bbox();var a=this.bbox;return!(a.right<b.viewLeft||a.bottom<b.viewTop||a.left>b.viewRight||a.top>b.viewBottom)},p.IsOutsideLayout=function(){this.update_bbox();
var b=this.bbox,a=this.runtime.running_layout;return 0>b.right||0>b.bottom||b.left>a.width||b.top>a.height},p.PickDistance=function(b,a,c){var d=this.getCurrentSol(),e=d.getObjects();if(!e.length)return!1;var k=e[0],f=k,g=cr.distanceTo(k.x,k.y,a,c),h;var l=1;for(h=e.length;l<h;l++){k=e[l];var m=cr.distanceTo(k.x,k.y,a,c);if(0===b&&m<g||1===b&&m>g)g=m,f=k}d.pick_one(f);return!0},n.SetX=function(b){this.x!==b&&(this.x=b,this.set_bbox_changed())},n.SetY=function(b){this.y!==b&&(this.y=b,this.set_bbox_changed())},
n.SetPos=function(b,a){if(this.x!==b||this.y!==a)this.x=b,this.y=a,this.set_bbox_changed()},n.SetPosToObject=function(b,a){var c=b.getPairedInstance(this);c&&(c.getImagePoint?(b=c.getImagePoint(a,!0),a=c.getImagePoint(a,!1)):(b=c.x,a=c.y),this.x!==b||this.y!==a)&&(this.x=b,this.y=a,this.set_bbox_changed())},n.MoveForward=function(b){0!==b&&(this.x+=Math.cos(this.angle)*b,this.y+=Math.sin(this.angle)*b,this.set_bbox_changed())},n.MoveAtAngle=function(b,a){0!==a&&(this.x+=Math.cos(cr.to_radians(b))*
a,this.y+=Math.sin(cr.to_radians(b))*a,this.set_bbox_changed())},h.X=function(b){b.set_float(this.x)},h.Y=function(b){b.set_float(this.y)},h.dt=function(b){b.set_float(this.runtime.getDt(this))});d&&(p.CompareWidth=function(b,a){return cr.do_cmp(this.width,b,a)},p.CompareHeight=function(b,a){return cr.do_cmp(this.height,b,a)},n.SetWidth=function(b){this.width!==b&&(this.width=b,this.set_bbox_changed())},n.SetHeight=function(b){this.height!==b&&(this.height=b,this.set_bbox_changed())},n.SetSize=function(b,
a){if(this.width!==b||this.height!==a)this.width=b,this.height=a,this.set_bbox_changed()},h.Width=function(b){b.set_float(this.width)},h.Height=function(b){b.set_float(this.height)},h.BBoxLeft=function(b){this.update_bbox();b.set_float(this.bbox.left)},h.BBoxTop=function(b){this.update_bbox();b.set_float(this.bbox.top)},h.BBoxRight=function(b){this.update_bbox();b.set_float(this.bbox.right)},h.BBoxBottom=function(b){this.update_bbox();b.set_float(this.bbox.bottom)});c&&(p.AngleWithin=function(b,a){return cr.angleDiff(this.angle,
cr.to_radians(a))<=cr.to_radians(b)},p.IsClockwiseFrom=function(b){return cr.angleClockwise(this.angle,cr.to_radians(b))},p.IsBetweenAngles=function(b,a){b=cr.to_clamped_radians(b);a=cr.to_clamped_radians(a);var c=cr.clamp_angle(this.angle);return cr.angleClockwise(a,b)?cr.angleClockwise(c,b)&&!cr.angleClockwise(c,a):!(!cr.angleClockwise(c,b)&&cr.angleClockwise(c,a))},n.SetAngle=function(b){b=cr.to_radians(cr.clamp_angle_degrees(b));isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},
n.RotateClockwise=function(b){0===b||isNaN(b)||(this.angle+=cr.to_radians(b),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},n.RotateCounterclockwise=function(b){0===b||isNaN(b)||(this.angle-=cr.to_radians(b),this.angle=cr.clamp_angle(this.angle),this.set_bbox_changed())},n.RotateTowardAngle=function(b,a){b=cr.angleRotate(this.angle,cr.to_radians(a),cr.to_radians(b));isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},n.RotateTowardPosition=function(b,a,c){b=cr.angleRotate(this.angle,
Math.atan2(c-this.y,a-this.x),cr.to_radians(b));isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},n.SetTowardPosition=function(b,a){b=Math.atan2(a-this.y,b-this.x);isNaN(b)||this.angle===b||(this.angle=b,this.set_bbox_changed())},h.Angle=function(b){b.set_float(cr.to_clamped_degrees(this.angle))});f||(p.CompareInstanceVar=function(b,a,c){return cr.do_cmp(this.instance_vars[b],a,c)},p.IsBoolInstanceVarSet=function(b){return this.instance_vars[b]},p.PickInstVarHiLow=function(b,a){var c=
this.getCurrentSol(),d=c.getObjects();if(!d.length)return!1;var e=d[0],k=e,f=e.instance_vars[a],g;var h=1;for(g=d.length;h<g;h++){e=d[h];var l=e.instance_vars[a];if(0===b&&l<f||1===b&&l>f)f=l,k=e}c.pick_one(k);return!0},p.PickByUID=function(b){var a;if(this.runtime.getCurrentCondition().inverted){var c=this.getCurrentSol();if(c.select_all){c.select_all=!1;cr.clearArray(c.instances);cr.clearArray(c.else_instances);var d=this.instances;var e=0;for(a=d.length;e<a;e++){var k=d[e];k.uid===b?c.else_instances.push(k):
c.instances.push(k)}}else{d=e=0;for(a=c.instances.length;e<a;e++)k=c.instances[e],c.instances[d]=k,k.uid===b?c.else_instances.push(k):d++;cr.truncateArray(c.instances,d)}this.applySolToContainer();return!!c.instances.length}k=this.runtime.getObjectByUID(b);if(!k)return!1;c=this.getCurrentSol();if(!c.select_all&&-1===c.instances.indexOf(k))return!1;if(this.is_family)for(b=k.type.families,e=0,a=b.length;e<a;e++){if(b[e]===this)return c.pick_one(k),this.applySolToContainer(),!0}else if(k.type===this)return c.pick_one(k),
this.applySolToContainer(),!0;return!1},p.OnCreated=function(){return!0},p.OnDestroyed=function(){return!0},n.SetInstanceVar=function(b,a){var c=this.instance_vars;cr.is_number(c[b])?cr.is_number(a)?c[b]=a:c[b]=parseFloat(a):cr.is_string(c[b])&&(cr.is_string(a)?c[b]=a:c[b]=a.toString())},n.AddInstanceVar=function(b,a){var c=this.instance_vars;cr.is_number(c[b])?cr.is_number(a)?c[b]+=a:c[b]+=parseFloat(a):cr.is_string(c[b])&&(cr.is_string(a)?c[b]+=a:c[b]+=a.toString())},n.SubInstanceVar=function(b,
a){var c=this.instance_vars;cr.is_number(c[b])&&(cr.is_number(a)?c[b]-=a:c[b]-=parseFloat(a))},n.SetBoolInstanceVar=function(b,a){this.instance_vars[b]=a?1:0},n.ToggleBoolInstanceVar=function(b){this.instance_vars[b]=1-this.instance_vars[b]},n.Destroy=function(){this.runtime.DestroyInstance(this)},n.LoadFromJsonString||(n.LoadFromJsonString=function(b){try{var a=JSON.parse(b)}catch(v){return}this.runtime.loadInstanceFromJSON(this,a,!0);this.afterLoad&&this.afterLoad();if(this.behavior_insts)for(b=
0,a=this.behavior_insts.length;b<a;++b){var c=this.behavior_insts[b];c.afterLoad&&c.afterLoad()}}),h.Count=function(b){var a=b.object_class.instances.length,c;var d=0;for(c=this.runtime.createRow.length;d<c;d++){var e=this.runtime.createRow[d];b.object_class.is_family?0<=e.type.families.indexOf(b.object_class)&&a++:e.type===b.object_class&&a++}b.set_int(a)},h.PickedCount=function(b){b.set_int(b.object_class.getCurrentSol().getObjects().length)},h.UID=function(b){b.set_int(this.uid)},h.IID=function(b){b.set_int(this.get_iid())},
h.AsJSON||(h.AsJSON=function(b){b.set_string(JSON.stringify(this.runtime.saveInstanceToJSON(this,!0)))}));b&&(p.IsVisible=function(){return this.visible},n.SetVisible=function(b){!b!==!this.visible&&(this.visible=!!b,this.runtime.redraw=!0)},p.CompareOpacity=function(b,a){return cr.do_cmp(cr.round6dp(100*this.opacity),b,a)},n.SetOpacity=function(b){b/=100;0>b?b=0:1<b&&(b=1);b!==this.opacity&&(this.opacity=b,this.runtime.redraw=!0)},h.Opacity=function(b){b.set_float(cr.round6dp(100*this.opacity))});
l&&(p.IsOnLayer=function(b){return b?this.layer===b:!1},p.PickTopBottom=function(b){var a=this.getCurrentSol(),c=a.getObjects();if(!c.length)return!1;var d=c[0],e=d,f;var k=1;for(f=c.length;k<f;k++)if(d=c[k],0===b){if(d.layer.index>e.layer.index||d.layer.index===e.layer.index&&d.get_zindex()>e.get_zindex())e=d}else if(d.layer.index<e.layer.index||d.layer.index===e.layer.index&&d.get_zindex()<e.get_zindex())e=d;a.pick_one(e);return!0},n.MoveToTop=function(){var b=this.layer,a=b.instances;a.length&&
a[a.length-1]===this||(b.removeFromInstanceList(this,!1),b.appendToInstanceList(this,!1),this.runtime.redraw=!0)},n.MoveToBottom=function(){var b=this.layer,a=b.instances;a.length&&a[0]===this||(b.removeFromInstanceList(this,!1),b.prependToInstanceList(this,!1),this.runtime.redraw=!0)},n.MoveToLayer=function(b){b&&b!=this.layer&&(this.layer.removeFromInstanceList(this,!0),this.layer=b,b.appendToInstanceList(this,!0),this.runtime.redraw=!0)},n.ZMoveToObject=function(b,a){b=0===b;a&&(a=a.getFirstPicked(this))&&
a.uid!==this.uid&&(this.layer.index!==a.layer.index&&(this.layer.removeFromInstanceList(this,!0),this.layer=a.layer,a.layer.appendToInstanceList(this,!0)),this.layer.moveInstanceAdjacent(this,a,b),this.runtime.redraw=!0)},h.LayerNumber=function(b){b.set_int(this.layer.number)},h.LayerName=function(b){b.set_string(this.layer.name)},h.ZIndex=function(b){b.set_int(this.get_zindex())});a&&(n.SetEffectEnabled=function(b,a){this.runtime.glwrap&&(a=this.type.getEffectIndexByName(a),0>a||(b=1===b,this.active_effect_flags[a]!==
b&&(this.active_effect_flags[a]=b,this.updateActiveEffects(),this.runtime.redraw=!0)))},n.SetEffectParam=function(b,a,c){if(this.runtime.glwrap){var d=this.type.getEffectIndexByName(b);0>d||(b=this.type.effect_types[d],d=this.effect_params[d],a=Math.floor(a),0>a||a>=d.length||(1===this.runtime.glwrap.getProgramParameterType(b.shaderindex,a)&&(c/=100),d[a]!==c&&(d[a]=c,b.active&&(this.runtime.redraw=!0))))}})};cr.set_bbox_changed=function(){this.cell_changed=this.bbox_changed=!0;this.type.any_cell_changed=
!0;this.runtime.redraw=!0;var a,h=this.bbox_changed_callbacks;var g=0;for(a=h.length;g<a;++g)h[g](this);this.layer.useRenderCells&&this.update_bbox()};cr.add_bbox_changed_callback=function(a){a&&this.bbox_changed_callbacks.push(a)};cr.update_bbox=function(){if(this.bbox_changed){var a=this.bbox,h=this.bquad;a.set(this.x,this.y,this.x+this.width,this.y+this.height);a.offset(-this.hotspotX*this.width,-this.hotspotY*this.height);this.angle?(a.offset(-this.x,-this.y),h.set_from_rotated_rect(a,this.angle),
h.offset(this.x,this.y),h.bounding_box(a)):h.set_from_rect(a);a.normalize();this.bbox_changed=!1;this.update_render_cell()}};var a=new cr.rect(0,0,0,0);cr.update_render_cell=function(){if(this.layer.useRenderCells){var f=this.layer.render_grid,h=this.bbox;a.set(f.XToCell(h.left),f.YToCell(h.top),f.XToCell(h.right),f.YToCell(h.bottom));this.rendercells.equals(a)||(this.rendercells.right<this.rendercells.left?f.update(this,null,a):f.update(this,this.rendercells,a),this.rendercells.copy(a),this.layer.render_list_stale=
!0)}};cr.update_collision_cell=function(){if(this.cell_changed&&this.collisionsEnabled){this.update_bbox();var f=this.type.collision_grid,h=this.bbox;a.set(f.XToCell(h.left),f.YToCell(h.top),f.XToCell(h.right),f.YToCell(h.bottom));this.collcells.equals(a)||(this.collcells.right<this.collcells.left?f.update(this,null,a):f.update(this,this.collcells,a),this.collcells.copy(a),this.cell_changed=!1)}};cr.inst_contains_pt=function(a,h){return this.bbox.contains_pt(a,h)&&this.bquad.contains_pt(a,h)?this.tilemap_exists?
this.testPointOverlapTile(a,h):this.collision_poly&&!this.collision_poly.is_empty()?(this.collision_poly.cache_poly(this.width,this.height,this.angle),this.collision_poly.contains_pt(a-this.x,h-this.y)):!0:!1};cr.inst_get_iid=function(){this.type.updateIIDs();return this.iid};cr.inst_get_zindex=function(){this.layer.updateZIndices();return this.zindex};cr.inst_updateActiveEffects=function(){cr.clearArray(this.active_effect_types);var a,h=!0;var g=0;for(a=this.active_effect_flags.length;g<a;g++)if(this.active_effect_flags[g]){var e=
this.type.effect_types[g];this.active_effect_types.push(e);e.preservesOpaqueness||(h=!1)}this.uses_shaders=!!this.active_effect_types.length;this.shaders_preserve_opaqueness=h};cr.inst_toString=function(){return"Inst"+this.puid};cr.type_getFirstPicked=function(a){if(a&&a.is_contained&&a.type!=this){var f;var g=0;for(f=a.siblings.length;g<f;g++){var e=a.siblings[g];if(e.type==this)return e}}a=this.getCurrentSol().getObjects();return a.length?a[0]:null};cr.type_getPairedInstance=function(a){var f=this.getCurrentSol().getObjects();
return f.length?f[a.get_iid()%f.length]:null};cr.type_updateIIDs=function(){if(this.stale_iids&&!this.is_family){var a;var h=0;for(a=this.instances.length;h<a;h++)this.instances[h].iid=h;var g=h,e=this.runtime.createRow;h=0;for(a=e.length;h<a;++h)e[h].type===this&&(e[h].iid=g++);this.stale_iids=!1}};cr.type_getInstanceByIID=function(a){if(a<this.instances.length)return this.instances[a];a-=this.instances.length;var f=this.runtime.createRow,g;var e=0;for(g=f.length;e<g;++e)if(f[e].type===this){if(0===
a)return f[e];--a}return null};cr.type_getCurrentSol=function(){return this.solstack[this.cur_sol]};cr.type_pushCleanSol=function(){this.cur_sol++;this.cur_sol===this.solstack.length?this.solstack.push(new cr.selection(this)):(this.solstack[this.cur_sol].select_all=!0,cr.clearArray(this.solstack[this.cur_sol].else_instances))};cr.type_pushCopySol=function(){this.cur_sol++;this.cur_sol===this.solstack.length&&this.solstack.push(new cr.selection(this));var a=this.solstack[this.cur_sol],h=this.solstack[this.cur_sol-
1];h.select_all?a.select_all=!0:(a.select_all=!1,cr.shallowAssignArray(a.instances,h.instances));cr.clearArray(a.else_instances)};cr.type_popSol=function(){this.cur_sol--};cr.type_getBehaviorByName=function(a){var f,g,e=0;if(!this.is_family){var d=0;for(f=this.families.length;d<f;d++){var c=this.families[d];var b=0;for(g=c.behaviors.length;b<g;b++){if(a===c.behaviors[b].name)return this.extra.lastBehIndex=e,c.behaviors[b];e++}}}d=0;for(f=this.behaviors.length;d<f;d++){if(a===this.behaviors[d].name)return this.extra.lastBehIndex=
e,this.behaviors[d];e++}return null};cr.type_getBehaviorIndexByName=function(a){return this.getBehaviorByName(a)?this.extra.lastBehIndex:-1};cr.type_getEffectIndexByName=function(a){var f;var g=0;for(f=this.effect_types.length;g<f;g++)if(this.effect_types[g].name===a)return g;return-1};cr.type_applySolToContainer=function(){if(this.is_contained&&!this.is_family){var a,h,g;this.updateIIDs();var e=this.getCurrentSol();var d=e.select_all,c=(a=this.runtime.getCurrentEventStack())&&a.current_event&&a.current_event.orblock;
a=0;for(h=this.container.length;a<h;a++){var b=this.container[a];if(b!==this){b.updateIIDs();var l=b.getCurrentSol();l.select_all=d;if(!d){cr.clearArray(l.instances);var p=0;for(g=e.instances.length;p<g;++p)l.instances[p]=b.getInstanceByIID(e.instances[p].iid);if(c)for(cr.clearArray(l.else_instances),p=0,g=e.else_instances.length;p<g;++p)l.else_instances[p]=b.getInstanceByIID(e.else_instances[p].iid)}}}}};cr.type_toString=function(){return"Type"+this.sid};cr.do_cmp=function(a,h,g){if("undefined"===
typeof a||"undefined"===typeof g)return!1;switch(h){case 0:return a===g;case 1:return a!==g;case 2:return a<g;case 3:return a<=g;case 4:return a>g;case 5:return a>=g;default:return!1}}})();cr.shaders={};cr.plugins_.AJAX=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=!1,e=null,d=null,c="",b=cr.plugins_.AJAX.prototype;b.Type=function(b){this.plugin=b;this.runtime=b.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(b){this.type=b;this.runtime=b.runtime;this.curTag=this.lastData="";this.progress=0;this.timeout=-1;if(g=this.runtime.isNWjs)e=require("path"),d=require("fs"),c=e.dirname((window.process||nw.process).execPath)+"\\"};var l=b.Instance.prototype,p=null;window.C2_AJAX_DCSide=function(b,
a,c){p&&("success"===b?(p.curTag=a,p.lastData=c,p.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,p),p.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,p)):"error"===b?(p.curTag=a,p.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,p),p.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,p)):"progress"===b&&(p.progress=c,p.curTag=a,p.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,p)))};l.onCreate=function(){p=this};l.saveToJSON=function(){return{lastData:this.lastData}};
l.loadFromJSON=function(b){this.lastData=b.lastData;this.curTag="";this.progress=0};var n={},k="";l.doRequest=function(b,a,e,f){if(this.runtime.isDirectCanvas)AppMobi.webview.execute('C2_AJAX_WebSide("'+b+'", "'+a+'", "'+e+'", '+(f?'"'+f+'"':"null")+");");else{var h=this,l=null,m=function(){h.curTag=b;h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,h);h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,h)},w=function(){if(g){var e=c+a;d.existsSync(e)?d.readFile(e,{encoding:"utf8"},
function(a,c){a?m():(h.curTag=b,h.lastData=c.replace(/\r\n/g,"\n"),h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,h),h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,h))}):m()}else m()},p=function(a){a.lengthComputable&&(h.progress=a.loaded/a.total,h.curTag=b,h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnProgress,h))};try{l=this.runtime.isWindowsPhone8?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest;l.onreadystatechange=function(){4===l.readyState&&(h.curTag=
b,h.lastData=l.responseText?l.responseText.replace(/\r\n/g,"\n"):"",400<=l.status?(h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,h),h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,h)):g&&!h.lastData.length||!g&&0===l.status&&!h.lastData.length||(h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,h),h.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,h)))};this.runtime.isWindowsPhone8||(l.onerror=w,l.ontimeout=w,l.onabort=w,l.onprogress=p);l.open(e,a);
!this.runtime.isWindowsPhone8&&0<=this.timeout&&"undefined"!==typeof l.timeout&&(l.timeout=this.timeout);try{l.responseType="text"}catch(G){}f&&l.setRequestHeader&&!n.hasOwnProperty("Content-Type")&&l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");if(l.setRequestHeader){for(var q in n)if(n.hasOwnProperty(q))try{l.setRequestHeader(q,n[q])}catch(G){}n={}}if(k&&l.overrideMimeType){try{l.overrideMimeType(k)}catch(G){}k=""}f?l.send(f):l.send()}catch(G){w()}}};a.prototype.OnComplete=
function(b){return cr.equals_nocase(b,this.curTag)};a.prototype.OnAnyComplete=function(b){return!0};a.prototype.OnError=function(b){return cr.equals_nocase(b,this.curTag)};a.prototype.OnAnyError=function(b){return!0};a.prototype.OnProgress=function(b){return cr.equals_nocase(b,this.curTag)};b.cnds=new a;f.prototype.Request=function(b,a){var c=this;this.runtime.isWKWebView&&!this.runtime.isAbsoluteUrl(a)?this.runtime.fetchLocalFileViaCordovaAsText(a,function(a){c.curTag=b;c.lastData=a.replace(/\r\n/g,
"\n");c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,c)},function(a){c.curTag=b;c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,c)}):this.doRequest(b,a,"GET")};f.prototype.RequestFile=function(b,a){var c=this;this.runtime.isWKWebView?this.runtime.fetchLocalFileViaCordovaAsText(a,function(a){c.curTag=b;c.lastData=a.replace(/\r\n/g,"\n");c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyComplete,
c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnComplete,c)},function(a){c.curTag=b;c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnAnyError,c);c.runtime.trigger(cr.plugins_.AJAX.prototype.cnds.OnError,c)}):this.doRequest(b,a,"GET")};f.prototype.Post=function(b,a,c,d){this.doRequest(b,a,d,c)};f.prototype.SetTimeout=function(b){this.timeout=1E3*b};f.prototype.SetHeader=function(b,a){n[b]=a};f.prototype.OverrideMIMEType=function(b){k=b};b.acts=new f;h.prototype.LastData=function(b){b.set_string(this.lastData)};
h.prototype.Progress=function(b){b.set_float(this.progress)};h.prototype.Tag=function(b){b.set_string(this.curTag)};b.exps=new h})();cr.plugins_.Browser=function(a){this.runtime=a};
(function(){function a(){l&&p&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback(function(b){n.onSWMessage(b)})}function f(){if(!m&&navigator.getBattery){var b=navigator.getBattery();m=!0;b&&b.then(function(b){k=b})}}function h(){}function g(){}function e(b){console&&console.warn&&console.warn("Fullscreen request failed: ",b);v.setSize(window.innerWidth,window.innerHeight)}function d(){}var c=cr.plugins_.Browser.prototype;c.Type=function(b){this.plugin=b;this.runtime=b.runtime};
var b=c.Type.prototype;b.onCreate=function(){};var l=!1,p=!1;document.addEventListener("DOMContentLoaded",function(){if(window.C2_RegisterSW&&navigator.serviceWorker){var b=document.createElement("script");b.onload=function(){l=!0;a()};b.src="offlineClient.js";document.head.appendChild(b)}});var n=null;b.onAppBegin=function(){p=!0;a()};c.Instance=function(b){this.type=b;this.runtime=b.runtime};b=c.Instance.prototype;b.onCreate=function(){var b=this;window.addEventListener("resize",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnResize,
b)});n=this;"undefined"!==typeof navigator.onLine&&(window.addEventListener("online",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOnline,b)}),window.addEventListener("offline",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOffline,b)}));this.runtime.isDirectCanvas||(document.addEventListener("appMobi.device.update.available",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,b)}),document.addEventListener("backbutton",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,
b)}),document.addEventListener("menubutton",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,b)}),document.addEventListener("searchbutton",function(){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnSearchButton,b)}),document.addEventListener("tizenhwkey",function(a){switch(a.keyName){case "back":var c=b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,b);!c&&window.tizen&&window.tizen.application.getCurrentApplication().exit();break;case "menu":(c=
b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnMenuButton,b))||a.preventDefault()}}));this.runtime.isWindows10&&"undefined"!==typeof Windows?Windows.UI.Core.SystemNavigationManager.getForCurrentView().addEventListener("backrequested",function(a){b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,b)&&(a.handled=!0)}):this.runtime.isWinJS&&WinJS.Application&&(WinJS.Application.onbackclick=function(a){return!!b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnBackButton,b)});
this.runtime.addSuspendCallback(function(a){a?b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageHidden,b):b.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnPageVisible,b)});this.is_arcade="undefined"!==typeof window.is_scirra_arcade};b.onSWMessage=function(b){b=b.data.type;"downloading-update"===b?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateFound,this):"update-ready"===b||"update-pending"===b?this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnUpdateReady,this):
"offline-ready"===b&&this.runtime.trigger(cr.plugins_.Browser.prototype.cnds.OnOfflineReady,this)};var k=null,m=!1;h.prototype.CookiesEnabled=function(){return navigator?navigator.cookieEnabled:!1};h.prototype.IsOnline=function(){return navigator?navigator.onLine:!1};h.prototype.HasJava=function(){return navigator?navigator.javaEnabled():!1};h.prototype.OnOnline=function(){return!0};h.prototype.OnOffline=function(){return!0};h.prototype.IsDownloadingUpdate=function(){return!1};h.prototype.OnUpdateReady=
function(){return!0};h.prototype.PageVisible=function(){return!this.runtime.isSuspended};h.prototype.OnPageVisible=function(){return!0};h.prototype.OnPageHidden=function(){return!0};h.prototype.OnResize=function(){return!0};h.prototype.IsFullscreen=function(){return!!(document.mozFullScreen||document.webkitIsFullScreen||document.fullScreen||this.runtime.isNodeFullscreen)};h.prototype.OnBackButton=function(){return!0};h.prototype.OnMenuButton=function(){return!0};h.prototype.OnSearchButton=function(){return!0};
h.prototype.IsMetered=function(){var b=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return b?!!b.metered:!1};h.prototype.IsCharging=function(){var b=navigator.battery||navigator.mozBattery||navigator.webkitBattery;if(b)return!!b.charging;f();return k?!!k.charging:!0};h.prototype.IsPortraitLandscape=function(b){return(window.innerWidth<=window.innerHeight?0:1)===b};h.prototype.SupportsFullscreen=function(){if(this.runtime.isNodeWebkit)return!0;var b=this.runtime.canvasdiv||
this.runtime.canvas;return!!(b.requestFullscreen||b.mozRequestFullScreen||b.msRequestFullscreen||b.webkitRequestFullScreen)};h.prototype.OnUpdateFound=function(){return!0};h.prototype.OnUpdateReady=function(){return!0};h.prototype.OnOfflineReady=function(){return!0};c.cnds=new h;g.prototype.Alert=function(b){this.runtime.isDomFree||alert(b.toString())};g.prototype.Close=function(){this.runtime.isCocoonJs?CocoonJS.App.forceToFinish():window.tizen?window.tizen.application.getCurrentApplication().exit():
navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():this.is_arcade||this.runtime.isDomFree||window.close()};g.prototype.Focus=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().focus():this.is_arcade||this.runtime.isDomFree||window.focus()};g.prototype.Blur=function(){this.runtime.isNodeWebkit?window.nwgui.Window.get().blur():this.is_arcade||this.runtime.isDomFree||window.blur()};g.prototype.GoBack=function(){navigator.app&&
navigator.app.backHistory?navigator.app.backHistory():this.is_arcade||this.runtime.isDomFree||!window.back||window.back()};g.prototype.GoForward=function(){this.is_arcade||this.runtime.isDomFree||!window.forward||window.forward()};g.prototype.GoHome=function(){this.is_arcade||this.runtime.isDomFree||!window.home||window.home()};g.prototype.GoToURL=function(b,a){this.runtime.isCocoonJs?CocoonJS.App.openURL(b):this.runtime.isEjecta?ejecta.openURL(b):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(b)):
navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(b,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(b,"_system"):this.is_arcade||this.runtime.isDomFree||(2!==a||this.is_arcade?1!==a||this.is_arcade?window.location=b:window.parent.location=b:window.top.location=b)};g.prototype.GoToURLWindow=function(b,a){this.runtime.isCocoonJs?CocoonJS.App.openURL(b):this.runtime.isEjecta?ejecta.openURL(b):this.runtime.isWinJS?Windows.System.Launcher.launchUriAsync(new Windows.Foundation.Uri(b)):
navigator.app&&navigator.app.loadUrl?navigator.app.loadUrl(b,{openExternal:!0}):self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(b,"_system"):this.is_arcade||this.runtime.isDomFree||window.open(b,a)};g.prototype.Reload=function(){this.is_arcade||this.runtime.isDomFree||window.location.reload()};var q=!0,v=null;g.prototype.RequestFullScreen=function(b){this.runtime.isDomFree?cr.logexport("[Construct 2] Requesting fullscreen is not supported on this platform - the request has been ignored"):
(2<=b&&(b+=1),6===b&&(b=2),this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!0):!this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().enterFullscreen(),this.runtime.isNodeFullscreen=!0,this.runtime.fullscreen_scaling=2<=b?b:0):document.mozFullScreen||document.webkitIsFullScreen||document.msFullscreenElement||document.fullScreen||document.fullScreenElement||(this.runtime.fullscreen_scaling=2<=b?b:0,b=document.documentElement,q&&(q=!1,v=this.runtime,b.addEventListener("mozfullscreenerror",
e),b.addEventListener("webkitfullscreenerror",e),b.addEventListener("MSFullscreenError",e),b.addEventListener("fullscreenerror",e)),b.requestFullscreen?b.requestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.msRequestFullscreen?b.msRequestFullscreen():b.webkitRequestFullScreen&&("undefined"!==typeof Element&&"undefined"!==typeof Element.ALLOW_KEYBOARD_INPUT?b.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):b.webkitRequestFullScreen())))};g.prototype.CancelFullScreen=function(){this.runtime.isDomFree?
cr.logexport("[Construct 2] Exiting fullscreen is not supported on this platform - the request has been ignored"):this.runtime.isNodeWebkit?this.runtime.isDebug?debuggerFullscreen(!1):this.runtime.isNodeFullscreen&&window.nwgui&&(window.nwgui.Window.get().leaveFullscreen(),this.runtime.isNodeFullscreen=!1):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitCancelFullScreen&&
document.webkitCancelFullScreen()};g.prototype.Vibrate=function(b){try{var a=b.split(","),c;var d=0;for(c=a.length;d<c;d++)a[d]=parseInt(a[d],10);navigator.vibrate?navigator.vibrate(a):navigator.mozVibrate?navigator.mozVibrate(a):navigator.webkitVibrate?navigator.webkitVibrate(a):navigator.msVibrate&&navigator.msVibrate(a)}catch(A){}};g.prototype.InvokeDownload=function(b,a){var c=document.createElement("a");if("undefined"===typeof c.download)window.open(b);else{var d=document.getElementsByTagName("body")[0];
c.textContent=a;c.href=b;c.download=a;d.appendChild(c);b=new MouseEvent("click");c.dispatchEvent(b);d.removeChild(c)}};g.prototype.InvokeDownloadString=function(b,a,c){var d="data:"+a+","+encodeURIComponent(b);b=document.createElement("a");"undefined"===typeof b.download?window.open(d):(a=document.getElementsByTagName("body")[0],b.textContent=c,b.href=d,b.download=c,a.appendChild(b),c=new MouseEvent("click"),b.dispatchEvent(c),a.removeChild(b))};g.prototype.ConsoleLog=function(b,a){"undefined"!==
typeof console&&(0===b&&console.log&&console.log(a.toString()),1===b&&console.warn&&console.warn(a.toString()),2===b&&console.error&&console.error(a.toString()))};g.prototype.ConsoleGroup=function(b){console&&console.group&&console.group(b)};g.prototype.ConsoleGroupEnd=function(){console&&console.groupEnd&&console.groupEnd()};g.prototype.ExecJs=function(b){try{eval&&eval(b)}catch(B){console&&console.error&&console.error("Error executing Javascript: ",B)}};var u="portrait landscape portrait-primary portrait-secondary landscape-primary landscape-secondary".split(" ");
g.prototype.LockOrientation=function(b){b=Math.floor(b);0>b||b>=u.length||(this.runtime.autoLockOrientation=!1,b=u[b],screen.orientation&&screen.orientation.lock?screen.orientation.lock(b):screen.lockOrientation?screen.lockOrientation(b):screen.webkitLockOrientation?screen.webkitLockOrientation(b):screen.mozLockOrientation?screen.mozLockOrientation(b):screen.msLockOrientation&&screen.msLockOrientation(b))};g.prototype.UnlockOrientation=function(){this.runtime.autoLockOrientation=!1;screen.orientation&&
screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()};c.acts=new g;d.prototype.URL=function(b){b.set_string(this.runtime.isDomFree?"":window.location.toString())};d.prototype.Protocol=function(b){b.set_string(this.runtime.isDomFree?"":window.location.protocol)};d.prototype.Domain=
function(b){b.set_string(this.runtime.isDomFree?"":window.location.hostname)};d.prototype.PathName=function(b){b.set_string(this.runtime.isDomFree?"":window.location.pathname)};d.prototype.Hash=function(b){b.set_string(this.runtime.isDomFree?"":window.location.hash)};d.prototype.Referrer=function(b){b.set_string(this.runtime.isDomFree?"":document.referrer)};d.prototype.Title=function(b){b.set_string(this.runtime.isDomFree?"":document.title)};d.prototype.Name=function(b){b.set_string(this.runtime.isDomFree?
"":navigator.appName)};d.prototype.Version=function(b){b.set_string(this.runtime.isDomFree?"":navigator.appVersion)};d.prototype.Language=function(b){navigator&&navigator.language?b.set_string(navigator.language):b.set_string("")};d.prototype.Platform=function(b){b.set_string(this.runtime.isDomFree?"":navigator.platform)};d.prototype.Product=function(b){navigator&&navigator.product?b.set_string(navigator.product):b.set_string("")};d.prototype.Vendor=function(b){navigator&&navigator.vendor?b.set_string(navigator.vendor):
b.set_string("")};d.prototype.UserAgent=function(b){b.set_string(this.runtime.isDomFree?"":navigator.userAgent)};d.prototype.QueryString=function(b){b.set_string(this.runtime.isDomFree?"":window.location.search)};d.prototype.QueryParam=function(b,a){this.runtime.isDomFree?b.set_string(""):(a=RegExp("[?&]"+a+"=([^&]*)").exec(window.location.search))?b.set_string(decodeURIComponent(a[1].replace(/\+/g," "))):b.set_string("")};d.prototype.Bandwidth=function(b){var a=navigator.connection||navigator.mozConnection||
navigator.webkitConnection;a?"undefined"!==typeof a.bandwidth?b.set_float(a.bandwidth):"undefined"!==typeof a.downlinkMax?b.set_float(a.downlinkMax):b.set_float(Number.POSITIVE_INFINITY):b.set_float(Number.POSITIVE_INFINITY)};d.prototype.ConnectionType=function(b){var a=navigator.connection||navigator.mozConnection||navigator.webkitConnection;a?b.set_string(a.type||"unknown"):b.set_string("unknown")};d.prototype.BatteryLevel=function(b){var a=navigator.battery||navigator.mozBattery||navigator.webkitBattery;
a?b.set_float(a.level):(f(),k?b.set_float(k.level):b.set_float(1))};d.prototype.BatteryTimeLeft=function(b){var a=navigator.battery||navigator.mozBattery||navigator.webkitBattery;a?b.set_float(a.dischargingTime):(f(),k?b.set_float(k.dischargingTime):b.set_float(Number.POSITIVE_INFINITY))};d.prototype.ExecJS=function(b,a){if(eval){var c=0;try{c=eval(a)}catch(w){console&&console.error&&console.error("Error executing Javascript: ",w)}"number"===typeof c?b.set_any(c):"string"===typeof c?b.set_any(c):
"boolean"===typeof c?b.set_any(c?1:0):b.set_any(0)}else b.set_any(0)};d.prototype.ScreenWidth=function(b){b.set_int(screen.width)};d.prototype.ScreenHeight=function(b){b.set_int(screen.height)};d.prototype.DevicePixelRatio=function(b){b.set_float(this.runtime.devicePixelRatio)};d.prototype.WindowInnerWidth=function(b){b.set_int(window.innerWidth)};d.prototype.WindowInnerHeight=function(b){b.set_int(window.innerHeight)};d.prototype.WindowOuterWidth=function(b){b.set_int(window.outerWidth)};d.prototype.WindowOuterHeight=
function(b){b.set_int(window.outerHeight)};c.exps=new d})();cr.plugins_.Button=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.plugins_.Button.prototype;h.Type=function(a){this.plugin=a;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a){this.type=a;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Button plugin not supported on this platform - the object will not be created"):(this.isCheckbox=1===this.properties[0],this.inputElem=document.createElement("input"),this.elem=
this.isCheckbox?document.createElement("label"):this.inputElem,this.labelText=null,this.inputElem.type=this.isCheckbox?"checkbox":"button",this.inputElem.id=this.properties[6],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.isCheckbox?(jQuery(this.inputElem).appendTo(this.elem),this.labelText=document.createTextNode(this.properties[1]),jQuery(this.elem).append(this.labelText),this.inputElem.checked=0!==this.properties[7],jQuery(this.elem).css("font-family","sans-serif"),
jQuery(this.elem).css("display","inline-block"),jQuery(this.elem).css("color","black")):this.inputElem.value=this.properties[1],this.elem.title=this.properties[2],this.inputElem.disabled=0===this.properties[4],this.autoFontSize=0!==this.properties[5],this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.inputElem.onclick=function(a){return function(d){d.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.Button.prototype.cnds.OnClicked,
a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchend",function(a){a.stopPropagation()},!1),jQuery(this.elem).mousedown(function(a){a.stopPropagation()}),jQuery(this.elem).mouseup(function(a){a.stopPropagation()}),jQuery(this.elem).keydown(function(a){a.stopPropagation()}),jQuery(this.elem).keyup(function(a){a.stopPropagation()}),
this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0,this.updatePosition(!0),this.runtime.tickMe(this))};g.saveToJSON=function(){var a={tooltip:this.elem.title,disabled:!!this.inputElem.disabled};this.isCheckbox?(a.checked=!!this.inputElem.checked,a.text=this.labelText.nodeValue):a.text=this.elem.value;return a};g.loadFromJSON=function(a){this.elem.title=a.tooltip;this.inputElem.disabled=a.disabled;this.isCheckbox?(this.inputElem.checked=a.checked,this.labelText.nodeValue=
a.text):this.elem.value=a.text};g.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};g.tick=function(){this.updatePosition()};g.updatePosition=function(a){if(!this.runtime.isDomFree){var d=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),b=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,
g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=b||0>=e||d>=f||c>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>d&&(d=1),1>c&&(c=1),b>=f&&(b=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==d||this.lastTop!==c||this.lastRight!==b||this.lastBottom!==e||this.lastWinWidth!==f||this.lastWinHeight!==g?(this.lastLeft=d,this.lastTop=c,this.lastRight=b,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=
g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(d)+jQuery(this.runtime.canvas).offset().left,f=Math.round(c)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(b-d)),jQuery(this.elem).height(Math.round(e-c)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(jQuery(this.elem).show(),
this.element_hidden=!1))}};g.draw=function(a){};g.drawGL=function(a){};a.prototype.OnClicked=function(){return!0};a.prototype.IsChecked=function(){return this.isCheckbox&&this.inputElem.checked};h.cnds=new a;f.prototype.SetText=function(a){this.runtime.isDomFree||(this.isCheckbox?this.labelText.nodeValue=a:this.elem.value=a)};f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetEnabled=
function(a){this.runtime.isDomFree||(this.inputElem.disabled=0===a)};f.prototype.SetFocus=function(){this.runtime.isDomFree||this.inputElem.focus()};f.prototype.SetBlur=function(){this.runtime.isDomFree||this.inputElem.blur()};f.prototype.SetCSSStyle=function(a,d){this.runtime.isDomFree||jQuery(this.elem).css(a,d)};f.prototype.SetChecked=function(a){!this.runtime.isDomFree&&this.isCheckbox&&(this.inputElem.checked=1===a)};f.prototype.ToggleChecked=function(){!this.runtime.isDomFree&&this.isCheckbox&&
(this.inputElem.checked=!this.inputElem.checked)};h.acts=new f;h.exps=new function(){}})();var lastCSS="",importList=[];function importcssfile(a){if(-1==importList.indexOf(a)){var f=document.createElement("link");f.setAttribute("rel","stylesheet");f.setAttribute("type","text/css");f.setAttribute("href",a);document.getElementsByTagName("head")[0].appendChild(f);importList.push(a)}}
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,f){f=f||0;for(var h=this.length;f<h;){if(this[f]===a)return f;++f}return-1});function removecssfile(a){for(var f=document.getElementsByTagName("link"),h=f.length;0<=h;h--)f[h]&&null!=f[h].getAttribute("href")&&-1!=f[h].getAttribute("href").indexOf(a)&&f[h].parentNode.removeChild(f[h]);importList.splice(importList.indexOf(a),1)}cr.plugins_.CSS_import=function(a){this.runtime=a};
(function(){var a=cr.plugins_.CSS_import.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a){this.type=a;this.runtime=a.runtime};var f=a.Instance.prototype;f.onCreate=function(){""!=this.properties[0]&&(importcssfile(this.properties[0]),lastCSS=this.properties[0])};f.onDestroy=function(){};f.draw=function(a){};f.drawGL=function(a){};a.cnds={};a.cnds.CompareCSS=function(a,f){return this.properties[0]===a};a.acts={};f=a.acts;
f.SetCSS=function(a){importcssfile(a);lastCSS=a};f.RemCSS=function(a){removecssfile(a)};a.exps={};a.exps.GetCSS=function(a){""!=lastCSS?a.set_string(lastCSS):""!=this.properties[0]?a.set_string(this.properties[0]):a.set_string("")}})();cr.plugins_.Dictionary=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.Dictionary.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.dictionary={};this.cur_key="";this.key_count=0};e.saveToJSON=function(){return this.dictionary};e.loadFromJSON=function(a){this.dictionary=a;this.key_count=0;for(var c in this.dictionary)this.dictionary.hasOwnProperty(c)&&
this.key_count++};a.prototype.CompareValue=function(a,c,b){return cr.do_cmp(this.dictionary[a],c,b)};a.prototype.ForEachKey=function(){var a=this.runtime.getCurrentEventStack().current_event,c;for(c in this.dictionary)this.dictionary.hasOwnProperty(c)&&(this.cur_key=c,this.runtime.pushCopySol(a.solModifiers),a.retrigger(),this.runtime.popSol(a.solModifiers));this.cur_key="";return!1};a.prototype.CompareCurrentValue=function(a,c){return cr.do_cmp(this.dictionary[this.cur_key],a,c)};a.prototype.HasKey=
function(a){return this.dictionary.hasOwnProperty(a)};a.prototype.IsEmpty=function(){return 0===this.key_count};g.cnds=new a;f.prototype.AddKey=function(a,c){this.dictionary.hasOwnProperty(a)||this.key_count++;this.dictionary[a]=c};f.prototype.SetKey=function(a,c){this.dictionary.hasOwnProperty(a)&&(this.dictionary[a]=c)};f.prototype.DeleteKey=function(a){this.dictionary.hasOwnProperty(a)&&(delete this.dictionary[a],this.key_count--)};f.prototype.Clear=function(){cr.wipe(this.dictionary);this.key_count=
0};f.prototype.JSONLoad=function(a){try{var c=JSON.parse(a)}catch(l){return}if(c.c2dictionary){this.dictionary=c.data;this.key_count=0;for(var b in this.dictionary)this.dictionary.hasOwnProperty(b)&&this.key_count++}};f.prototype.JSONDownload=function(a){var c=document.createElement("a");if("undefined"===typeof c.download)c="data:text/html,"+encodeURIComponent("<p><a download='data.json' href=\"data:application/json,"+encodeURIComponent(JSON.stringify({c2dictionary:!0,data:this.dictionary}))+'">Download link</a></p>'),
window.open(c);else{var b=document.getElementsByTagName("body")[0];c.textContent=a;c.href="data:application/json,"+encodeURIComponent(JSON.stringify({c2dictionary:!0,data:this.dictionary}));c.download=a;b.appendChild(c);a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null);c.dispatchEvent(a);b.removeChild(c)}};g.acts=new f;h.prototype.Get=function(a,c){this.dictionary.hasOwnProperty(c)?a.set_any(this.dictionary[c]):a.set_int(0)};h.prototype.KeyCount=
function(a){a.set_int(this.key_count)};h.prototype.CurrentKey=function(a){a.set_string(this.cur_key)};h.prototype.CurrentValue=function(a){this.dictionary.hasOwnProperty(this.cur_key)?a.set_any(this.dictionary[this.cur_key]):a.set_int(0)};h.prototype.AsJSON=function(a){a.set_string(JSON.stringify({c2dictionary:!0,data:this.dictionary}))};g.exps=new h})();cr.plugins_.Function=function(a){this.runtime=a};
(function(){function a(){this.name="";this.retVal=0;this.params=[]}function f(){l++;l===b.length&&b.push(new a);return b[l]}function h(){return 0>l?null:b[l]}function g(){}function e(){}function d(){}var c=cr.plugins_.Function.prototype;c.Type=function(b){this.plugin=b;this.runtime=b.runtime};c.Type.prototype.onCreate=function(){};c.Instance=function(b){this.type=b;this.runtime=b.runtime};var b=[],l=-1;c.Instance.prototype.onCreate=function(){var b=this;window.c2_callFunction=function(a,c){var d,
e=f();e.name=a.toLowerCase();e.retVal=0;if(c)for(e.params.length=c.length,a=0,d=c.length;a<d;++a){var k=c[a];e.params[a]="number"===typeof k||"string"===typeof k?k:"boolean"===typeof k?k?1:0:0}else cr.clearArray(e.params);b.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,b,e.name);l--;return e.retVal}};g.prototype.OnFunction=function(b){var a=h();return a?cr.equals_nocase(b,a.name):!1};g.prototype.CompareParam=function(b,a,c){var d=h();if(!d)return!1;b=cr.floor(b);return 0>b||b>=d.params.length?
!1:cr.do_cmp(d.params[b],a,c)};c.cnds=new g;e.prototype.CallFunction=function(b,a){var c=f();c.name=b.toLowerCase();c.retVal=0;cr.shallowAssignArray(c.params,a);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,c.name);l--};e.prototype.SetReturnValue=function(b){var a=h();a&&(a.retVal=b)};e.prototype.CallExpression=function(b){};c.acts=new e;d.prototype.ReturnValue=function(a){if(b.length){var c=l+1;c>=b.length&&(c=b.length-1);c=b[c]}else c=null;c?a.set_any(c.retVal):a.set_int(0)};
d.prototype.ParamCount=function(b){var a=h();a?b.set_int(a.params.length):b.set_int(0)};d.prototype.Param=function(b,a){a=cr.floor(a);var c=h();c?0<=a&&a<c.params.length?b.set_any(c.params[a]):b.set_int(0):b.set_int(0)};d.prototype.Call=function(b,a){var c=f();c.name=a.toLowerCase();c.retVal=0;cr.clearArray(c.params);var d;var e=2;for(d=arguments.length;e<d;e++)c.params.push(arguments[e]);this.runtime.trigger(cr.plugins_.Function.prototype.cnds.OnFunction,this,c.name);l--;b.set_any(c.retVal)};c.exps=
new d})();cr.plugins_.Keyboard=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(a){a=Math.floor(a);switch(a){case 8:return"backspace";case 9:return"tab";case 13:return"enter";case 16:return"shift";case 17:return"control";case 18:return"alt";case 19:return"pause";case 20:return"capslock";case 27:return"esc";case 33:return"pageup";case 34:return"pagedown";case 35:return"end";case 36:return"home";case 37:return"\u2190";case 38:return"\u2191";case 39:return"\u2192";case 40:return"\u2193";case 45:return"insert";case 46:return"del";
case 91:return"left window key";case 92:return"right window key";case 93:return"select";case 96:return"numpad 0";case 97:return"numpad 1";case 98:return"numpad 2";case 99:return"numpad 3";case 100:return"numpad 4";case 101:return"numpad 5";case 102:return"numpad 6";case 103:return"numpad 7";case 104:return"numpad 8";case 105:return"numpad 9";case 106:return"numpad *";case 107:return"numpad +";case 109:return"numpad -";case 110:return"numpad .";case 111:return"numpad /";case 112:return"F1";case 113:return"F2";
case 114:return"F3";case 115:return"F4";case 116:return"F5";case 117:return"F6";case 118:return"F7";case 119:return"F8";case 120:return"F9";case 121:return"F10";case 122:return"F11";case 123:return"F12";case 144:return"numlock";case 145:return"scroll lock";case 186:return";";case 187:return"=";case 188:return",";case 189:return"-";case 190:return".";case 191:return"/";case 192:return"'";case 219:return"[";case 220:return"\\";case 221:return"]";case 222:return"#";case 223:return"`";default:return String.fromCharCode(a)}}
var g=cr.plugins_.Keyboard.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime;this.keyMap=Array(256);this.usedKeys=Array(256);this.triggerKey=0};var e=g.Instance.prototype;e.onCreate=function(){var a=this;this.runtime.isDomFree||(jQuery(document).keydown(function(b){a.onKeyDown(b)}),jQuery(document).keyup(function(b){a.onKeyUp(b)}))};var d=[32,33,34,35,36,37,38,39,40,44];e.onKeyDown=function(a){var b=
!1;window!=window.top&&-1<d.indexOf(a.which)&&(a.preventDefault(),b=!0,a.stopPropagation());if(this.keyMap[a.which])this.usedKeys[a.which]&&!b&&a.preventDefault();else{this.keyMap[a.which]=!0;this.triggerKey=a.which;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKey,this);var c=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKey,this),e=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCode,this);this.runtime.isInUserInputEvent=
!1;if(c||e)this.usedKeys[a.which]=!0,b||a.preventDefault()}};e.onKeyUp=function(a){this.keyMap[a.which]=!1;this.triggerKey=a.which;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var b=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),c=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);this.runtime.isInUserInputEvent=!1;if(b||c||this.usedKeys[a.which])this.usedKeys[a.which]=
!0,a.preventDefault()};e.onWindowBlur=function(){var a;for(a=0;256>a;++a)if(this.keyMap[a]){this.keyMap[a]=!1;this.triggerKey=a;this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnAnyKeyReleased,this);var b=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyReleased,this),d=this.runtime.trigger(cr.plugins_.Keyboard.prototype.cnds.OnKeyCodeReleased,this);if(b||d)this.usedKeys[a]=!0}};e.saveToJSON=function(){return{triggerKey:this.triggerKey}};e.loadFromJSON=function(a){this.triggerKey=
a.triggerKey};a.prototype.IsKeyDown=function(a){return this.keyMap[a]};a.prototype.OnKey=function(a){return a===this.triggerKey};a.prototype.OnAnyKey=function(a){return!0};a.prototype.OnAnyKeyReleased=function(a){return!0};a.prototype.OnKeyReleased=function(a){return a===this.triggerKey};a.prototype.IsKeyCodeDown=function(a){a=Math.floor(a);return 0>a||a>=this.keyMap.length?!1:this.keyMap[a]};a.prototype.OnKeyCode=function(a){return a===this.triggerKey};a.prototype.OnKeyCodeReleased=function(a){return a===
this.triggerKey};g.cnds=new a;g.acts=new function(){};f.prototype.LastKeyCode=function(a){a.set_int(this.triggerKey)};f.prototype.StringFromKeyCode=function(a,b){a.set_string(h(b))};g.exps=new f})();cr.plugins_.List=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.List.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] List plugin not supported on this platform - the object will not be created");else{this.elem=document.createElement("select");this.elem.id=this.properties[7];
jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.elem.title=this.properties[1];this.elem.disabled=0===this.properties[3];0===this.properties[4]&&(this.elem.size=2);this.elem.multiple=0!==this.properties[5];this.autoFontSize=0!==this.properties[6];0===this.properties[2]&&(jQuery(this.elem).hide(),this.visible=!1);if(this.properties[0]){var a=this.properties[0].split(";"),c;var b=0;for(c=a.length;b<c;b++){var e=document.createElement("option");e.text=a[b];this.elem.add(e)}}var f=
this;this.elem.onchange=function(){f.runtime.trigger(cr.plugins_.List.prototype.cnds.OnSelectionChanged,f)};this.elem.onclick=function(b){b.stopPropagation();f.runtime.isInUserInputEvent=!0;f.runtime.trigger(cr.plugins_.List.prototype.cnds.OnClicked,f);f.runtime.isInUserInputEvent=!1};this.elem.ondblclick=function(b){b.stopPropagation();f.runtime.isInUserInputEvent=!0;f.runtime.trigger(cr.plugins_.List.prototype.cnds.OnDoubleClicked,f);f.runtime.isInUserInputEvent=!1};this.elem.addEventListener("touchstart",
function(b){b.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(b){b.stopPropagation()},!1);this.elem.addEventListener("touchend",function(b){b.stopPropagation()},!1);jQuery(this.elem).mousedown(function(b){b.stopPropagation()});jQuery(this.elem).mouseup(function(b){b.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.isVisible=!0;this.updatePosition(!0);this.runtime.tickMe(this)}};e.saveToJSON=function(){var a=
{tooltip:this.elem.title,disabled:!!this.elem.disabled,items:[],sel:[]},c,b=a.items;var e=0;for(c=this.elem.length;e<c;e++)b.push(this.elem.options[e].text);b=a.sel;if(this.elem.multiple)for(e=0,c=this.elem.length;e<c;e++)this.elem.options[e].selected&&b.push(e);else b.push(this.elem.selectedIndex);return a};e.loadFromJSON=function(a){this.elem.title=a.tooltip;this.elem.disabled=a.disabled;for(var c=a.items;this.elem.length;)this.elem.remove(this.elem.length-1);var b;var d=0;for(b=c.length;d<b;d++){var e=
document.createElement("option");e.text=c[d];this.elem.add(e)}a=a.sel;if(this.elem.multiple)for(d=0,b=a.length;d<b;d++)a[d]<this.elem.length&&(this.elem.options[a[d]].selected=!0);else 1<=a.length&&(this.elem.selectedIndex=a[0])};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),b=this.layer.layerToCanvas(this.x,
this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,k=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||c>=f||b>=k?(this.isVisible&&jQuery(this.elem).hide(),this.isVisible=!1):(1>c&&(c=1),1>b&&(b=1),d>=f&&(d=f-1),e>=k&&(e=k-1),f=window.innerWidth,k=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==b||
this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||this.lastWinHeight!==k?(this.lastLeft=c,this.lastTop=b,this.lastRight=d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=k,this.isVisible||(jQuery(this.elem).show(),this.isVisible=!0),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,f=Math.round(b)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-c)),jQuery(this.elem).height(Math.round(e-
b)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.isVisible||(jQuery(this.elem).show(),this.isVisible=!0))}};e.draw=function(a){};e.drawGL=function(a){};a.prototype.CompareSelection=function(a,c){return cr.do_cmp(this.elem.selectedIndex,a,c)};a.prototype.OnSelectionChanged=function(){return!0};a.prototype.OnClicked=function(){return!0};a.prototype.OnDoubleClicked=function(){return!0};a.prototype.CompareSelectedText=function(a,
c){var b=this.elem.selectedIndex;if(0>b||b>=this.elem.length)return!1;b=this.elem.options[b].text;return c?b==a:cr.equals_nocase(b,a)};a.prototype.CompareTextAt=function(a,c,b){a=Math.floor(a);if(0>a||a>=this.elem.length)return!1;a=this.elem.options[a].text;return b?a==c:cr.equals_nocase(a,c)};g.cnds=new a;f.prototype.Select=function(a){this.runtime.isDomFree||(this.elem.selectedIndex=a)};f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||
(this.visible=0!==a)};f.prototype.SetEnabled=function(a){this.runtime.isDomFree||(this.elem.disabled=0===a)};f.prototype.SetFocus=function(){this.runtime.isDomFree||this.elem.focus()};f.prototype.SetBlur=function(){this.runtime.isDomFree||this.elem.blur()};f.prototype.SetCSSStyle=function(a,c){this.runtime.isDomFree||jQuery(this.elem).css(a,c)};f.prototype.AddItem=function(a){if(!this.runtime.isDomFree){var c=document.createElement("option");c.text=a;this.elem.add(c)}};f.prototype.AddItemAt=function(a,
c){if(!this.runtime.isDomFree){a=Math.floor(a);0>a&&(a=0);var b=document.createElement("option");b.text=c;a>=this.elem.length?this.elem.add(b):this.elem.add(b,this.elem.options[a])}};f.prototype.Remove=function(a){this.runtime.isDomFree||(a=Math.floor(a),this.elem.remove(a))};f.prototype.SetItemText=function(a,c){this.runtime.isDomFree||(a=Math.floor(a),0>a||a>=this.elem.length||(this.elem.options[a].text=c))};f.prototype.Clear=function(){this.runtime.isDomFree||(this.elem.innerHTML="")};g.acts=new f;
h.prototype.ItemCount=function(a){this.runtime.isDomFree?a.set_int(0):a.set_int(this.elem.length)};h.prototype.ItemTextAt=function(a,c){this.runtime.isDomFree?a.set_string(""):(c=Math.floor(c),0>c||c>=this.elem.length?a.set_string(""):a.set_string(this.elem.options[c].text))};h.prototype.SelectedIndex=function(a){this.runtime.isDomFree?a.set_int(0):a.set_int(this.elem.selectedIndex)};h.prototype.SelectedText=function(a){if(this.runtime.isDomFree)a.set_string("");else{var c=this.elem.selectedIndex;
0>c||c>=this.elem.length?a.set_string(""):a.set_string(this.elem.options[c].text)}};h.prototype.SelectedCount=function(a){if(this.runtime.isDomFree)a.set_int(0);else{var c,b=0;var d=0;for(c=this.elem.length;d<c;d++)this.elem.options[d].selected&&b++;a.set_int(b)}};h.prototype.SelectedIndexAt=function(a,c){if(this.runtime.isDomFree)a.set_int(0);else{c=Math.floor(c);var b,d=0,e=0;var f=0;for(b=this.elem.length;f<b;f++)if(this.elem.options[f].selected){if(d===c){e=f;break}d++}a.set_int(e)}};h.prototype.SelectedTextAt=
function(a,c){if(this.runtime.isDomFree)a.set_string("");else{c=Math.floor(c);var b,d=0,e="";var f=0;for(b=this.elem.length;f<b;f++)if(this.elem.options[f].selected){if(d===c){e=this.elem.options[f].text;break}d++}a.set_string(e)}};g.exps=new h})();cr.plugins_.Mouse=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.Mouse.prototype;g.Type=function(b){this.plugin=b;this.runtime=b.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(b){this.type=b;this.runtime=b.runtime;this.buttonMap=Array(4);this.triggerDir=this.triggerType=this.triggerButton=this.mouseYcanvas=this.mouseXcanvas=0;this.handled=!1};var e=g.Instance.prototype;e.onCreate=function(){var b=this;if(!this.runtime.isDomFree){jQuery(document).mousemove(function(a){b.onMouseMove(a)});
jQuery(document).mousedown(function(a){b.onMouseDown(a)});jQuery(document).mouseup(function(a){b.onMouseUp(a)});jQuery(document).dblclick(function(a){b.onDoubleClick(a)});var a=function(a){b.onWheel(a)};document.addEventListener("mousewheel",a,!1);document.addEventListener("DOMMouseScroll",a,!1)}};var d={left:0,top:0};e.onMouseMove=function(b){var a=this.runtime.isDomFree?d:jQuery(this.runtime.canvas).offset();this.mouseXcanvas=b.pageX-a.left;this.mouseYcanvas=b.pageY-a.top};e.mouseInGame=function(){return 0<
this.runtime.fullscreen_mode?!0:0<=this.mouseXcanvas&&0<=this.mouseYcanvas&&this.mouseXcanvas<this.runtime.width&&this.mouseYcanvas<this.runtime.height};e.onMouseDown=function(b){this.mouseInGame()&&(this.buttonMap[b.which]=!0,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnAnyClick,this),this.triggerButton=b.which-1,this.triggerType=0,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,
this),this.runtime.isInUserInputEvent=!1)};e.onMouseUp=function(b){this.buttonMap[b.which]&&(this.runtime.had_a_click&&!this.runtime.isMobile&&b.preventDefault(),this.runtime.had_a_click=!0,this.buttonMap[b.which]=!1,this.runtime.isInUserInputEvent=!0,this.triggerButton=b.which-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this),this.runtime.isInUserInputEvent=!1)};e.onDoubleClick=function(b){this.mouseInGame()&&(b.preventDefault(),this.runtime.isInUserInputEvent=!0,this.triggerButton=
b.which-1,this.triggerType=1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnClick,this),this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnObjectClicked,this),this.runtime.isInUserInputEvent=!1)};e.onWheel=function(b){this.triggerDir=0>(b.wheelDelta?b.wheelDelta:b.detail?-b.detail:0)?0:1;this.handled=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnWheel,this);this.runtime.isInUserInputEvent=!1;this.handled&&cr.isCanvasInputEvent(b)&&b.preventDefault()};
e.onWindowBlur=function(){var b;var a=0;for(b=this.buttonMap.length;a<b;++a)this.buttonMap[a]&&(this.buttonMap[a]=!1,this.triggerButton=a-1,this.runtime.trigger(cr.plugins_.Mouse.prototype.cnds.OnRelease,this))};a.prototype.OnClick=function(b,a){return b===this.triggerButton&&a===this.triggerType};a.prototype.OnAnyClick=function(){return!0};a.prototype.IsButtonDown=function(b){return this.buttonMap[b+1]};a.prototype.OnRelease=function(b){return b===this.triggerButton};a.prototype.IsOverObject=function(b){var a=
this.runtime.getCurrentCondition();return cr.xor(this.runtime.testAndSelectCanvasPointOverlap(b,this.mouseXcanvas,this.mouseYcanvas,a.inverted),a.inverted)};a.prototype.OnObjectClicked=function(b,a,c){return b!==this.triggerButton||a!==this.triggerType?!1:this.runtime.testAndSelectCanvasPointOverlap(c,this.mouseXcanvas,this.mouseYcanvas,!1)};a.prototype.OnWheel=function(b){this.handled=!0;return b===this.triggerDir};g.cnds=new a;var c=null;f.prototype.SetCursor=function(b){this.runtime.isDomFree||
(b="auto pointer text crosshair move help wait none".split(" ")[b],c!==b&&(c=b,document.body.style.cursor=b))};f.prototype.SetCursorSprite=function(b){this.runtime.isDomFree||this.runtime.isMobile||!b||(b=b.getFirstPicked())&&b.curFrame&&(b=b.curFrame,c!==b&&(c=b,b="url("+b.getDataUri()+") "+Math.round(b.hotspotX*b.width)+" "+Math.round(b.hotspotY*b.height)+", auto",document.body.style.cursor="",document.body.style.cursor=b))};g.acts=new f;h.prototype.X=function(b,a){if(cr.is_undefined(a)){a=this.runtime.getLayerByNumber(0);
var c=a.scale;var d=a.zoomRate;var e=a.parallaxX;var f=a.angle;a.scale=1;a.zoomRate=1;a.parallaxX=1;a.angle=0;b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0));a.scale=c;a.zoomRate=d;a.parallaxX=e;a.angle=f}else(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!0)):b.set_float(0)};h.prototype.Y=function(b,a){if(cr.is_undefined(a)){a=this.runtime.getLayerByNumber(0);var c=a.scale;var d=
a.zoomRate;var e=a.parallaxY;var f=a.angle;a.scale=1;a.zoomRate=1;a.parallaxY=1;a.angle=0;b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1));a.scale=c;a.zoomRate=d;a.parallaxY=e;a.angle=f}else(a=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.set_float(a.canvasToLayer(this.mouseXcanvas,this.mouseYcanvas,!1)):b.set_float(0)};h.prototype.AbsoluteX=function(b){b.set_float(this.mouseXcanvas)};h.prototype.AbsoluteY=function(b){b.set_float(this.mouseYcanvas)};
g.exps=new h})();cr.plugins_.Rex_InstanceBank2=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.plugins_.Rex_InstanceBank2.prototype;h.Type=function(a){this.plugin=a;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a){this.type=a;this.runtime=a.runtime};h.Instance.prototype.onCreate=function(){this.bank=new cr.plugins_.Rex_InstanceBank2.InstBankKlass(this);this.bank.ModePreserveCurrentInsts=!1};h.cnds=new function(){};h.acts=new a;a.prototype.CleanBank=function(){this.bank.CleanBank()};a.prototype.SaveInstances=
function(a){if(a){a=a.getCurrentSol().getObjects();var e,d=a.length;for(e=0;e<d;e++)this.bank.SaveInstance(a[e])}};a.prototype.LoadInstances=function(){this.bank.LoadAllInstances()};a.prototype.StringToBank=function(a){this.bank.JSON2Bank(a)};h.exps=new f;f.prototype.BankToString=function(a){var e=this.bank.ToString();a.set_string(e)}})();
(function(){function a(a,e){return a.zindex-e.zindex}var f={};cr.plugins_.Rex_InstanceBank2.InstBankKlass=function(a){this.plugin=a;this.runtime=a.runtime;this.bank={};this.min_uid=this.max_uid=null;this.uid_mark_table={};this.objtype_mark_table={};this.layer_mark_table={};this.ModePreserveCurrentInsts=!1};var h=cr.plugins_.Rex_InstanceBank2.InstBankKlass.prototype;h.CleanBank=function(){var a=this.bank,e;for(e in a)delete a[e];this.min_uid=this.max_uid=null};h.GetInstanceStatus=function(a){var e=
this.runtime.saveInstanceToJSON(a);e.sid=a.type.sid;return e};h.SaveInstance=function(a){if(null!=a){"number"==typeof a&&(a=this.runtime.getObjectByUID(a));var e=this.GetInstanceStatus(a);this.bank[a.uid.toString()]=e;if(a.type.is_contained){a=a.siblings;var d=[];e.siblings_uids=d;var c,b=a.length;for(c=0;c<b;c++)e=a[c],d.push(e.uid),this.bank[e.uid.toString()]=this.GetInstanceStatus(e)}}};h.ReassignObj2UIDMap=function(a,e){if(a.uid!=e){var d=this.runtime.objectsByUid;delete d[a.uid.toString()];d[e.toString()]=
a;a.uid=e}};h.GetShellInstance=function(a){var e=this.runtime.getObjectByUID(a);if(null!=e)return e;if(!this.ModePreserveCurrentInsts){e=this.bank[a];if(null==e)return;var d=e.sid,c=this.SID2Type(d),b=c.instances,f,g=b.length;for(f=0;f<g;f++)if(e=b[f],!this.bank.hasOwnProperty(e.uid.toString()))return a=parseInt(a,10),this.ReassignObj2UIDMap(e,a),e.uid=a,this.objtype_mark_table[d]=c,e;this.objtype_mark_table.hasOwnProperty(d)&&delete this.objtype_mark_table[d]}return this.CreateShellInstance(a,!1)};
h.CreateShellInstance=function(a,e){var d=this.bank[a];if(null!=d){var c=this.SID2Type(d.sid),b=null;if(c.plugin.is_world&&(b=this.runtime.running_layout.getLayerBySid(d.w.l),!b))return;a=parseInt(a,10);d=this.runtime.next_uid;this.runtime.next_uid=a;e=this.runtime.createInstanceFromInit(c.default_instance,b,!1,0,0,e);d>a&&(this.runtime.next_uid=d);return e}};h.LoadInstance_step1=function(a,e,d){var c=this.bank[e];if(null!=c){null==a&&(a=this.CreateShellInstance(e,d));this.runtime.loadInstanceFromJSON(a,
c);if(!d&&a.type.is_contained){d=c.siblings_uids;var b=d.length,f=a.siblings;for(c=0;c<b;c++)this.LoadInstance_step1(f[c],d[c].toString(),!0)}this.MaxUIDSet(e);this.MinUIDSet(e);this.uid_mark_table[e]=a;this.layer_mark_table[a.layer.name]=a.layer}};h.LoadInstance_step2=function(){var f,e;for(f in this.uid_mark_table){var d=this.uid_mark_table[f];d.afterLoad&&d.afterLoad();if(d.behavior_insts){var c=d.behavior_insts.length;for(e=0;e<c;e++){var b=d.behavior_insts[e];b.afterLoad&&b.afterLoad()}}}for(var h in this.layer_mark_table)d=
this.layer_mark_table[h],d.instances.sort(a),d.zindices_stale=!0;if(!this.ModePreserveCurrentInsts)for(var p in this.objtype_mark_table)for(d=this.objtype_mark_table[p],e=d.instances,b=e.length,c=0;c<b;c++)d=e[c],this.uid_mark_table.hasOwnProperty(d.uid.toString())||this.runtime.DestroyInstance(d);for(f in this.uid_mark_table)delete this.uid_mark_table[f];for(p in this.objtype_mark_table)delete this.objtype_mark_table[p];for(h in this.layer_mark_table)delete this.layer_mark_table[h]};h.LoadAllInstances=
function(){var a;for(a in this.bank)if(!this.uid_mark_table.hasOwnProperty(a)){var e=this.GetShellInstance(a);this.LoadInstance_step1(e,a,!1)}this.LoadInstance_step2()};h.SID2Type=function(a){null==f[a]&&(f[a]=this.runtime.getObjectTypeBySid(a));return f[a]};h.MaxUIDSet=function(a){if(null==this.max_uid||this.max_uid<a)this.max_uid=a};h.MinUIDSet=function(a){if(null==this.min_uid||this.min_uid>a)this.min_uid=a};h.ToString=function(){return JSON.stringify(this.bank)};h.JSON2Bank=function(a){""!=a&&
(this.bank=JSON.parse(a))}})();cr.plugins_.Rex_SysExt=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.Rex_SysExt.prototype;g.Type=function(b){this.plugin=b;this.runtime=b.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(b){this.type=b;this.runtime=b.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.tmp_insts=[]};e._pick_all=function(b){if(!b||!b.instances.length)return!1;b.getCurrentSol().select_all=!0;b.applySolToContainer();return!0};e._pick_inverse=function(b,a,c){if(!b||!b.instances.length)return!1;
var d=b.getCurrentSol();1==c&&(d.select_all=!0,cr.shallowAssignArray(d.instances,d.getObjects()));c=d.instances;var e=c.length,f,g=-1;for(f=0;f<e;f++){var h=c[f];if(h.uid==a){g=f;break}}-1!=g&&cr.arrayRemove(c,g);d.select_all=!1;b.applySolToContainer();return 0!=d.instances.length};e._quick_pick=function(b,a){if(b&&b.instances.length){a=this.runtime.getObjectByUID(a);var c=null!=a;if(c){var d=a.type.name;if(b.is_family){c=!1;var e=b.members,f=e.length,g;for(g=0;g<f;g++)if(d==e[g].name){c=!0;break}}else c=
d==b.name}d=b.getCurrentSol();c?d.pick_one(a):d.instances.length=0;d.select_all=!1;b.applySolToContainer();return c}};e._get_layer=function(b){return"number"==typeof b?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b)};var d=function(b,a){switch(a){case 0:b=b.uid;break;case 1:b=b.x;break;case 2:b=b.y;break;case 3:b=b.width;break;case 4:b=b.height;break;case 5:b=b.angle;break;case 6:b=b.opacity;break;default:b=0}return b};g.cnds=new a;a.prototype.PickAll=function(b){return this._pick_all(b)};
a.prototype.PickInverse=function(b,a,c){return this._pick_inverse(b,a,c)};a.prototype.QuickPickByUID=function(b,a){return this._quick_pick(b,a)};g.acts=new f;f.prototype.__PickByUID=function(b,a,c){if(b&&b.instances.length){var d=b.getCurrentSol();1==c&&(d.select_all=!0);c=d.getObjects();var e=c.length,f,g=!1;for(f=0;f<e;f++){var h=c[f];if(h.uid==a){g=!0;break}}g?d.pick_one(h):d.instances.length=0;d.select_all=!1;b.applySolToContainer()}};f.prototype.PickByPropCmp=function(b,a,c,e,f){if(b&&b.instances.length){b=
b.getCurrentSol();1==f&&(b.select_all=!0);f=b.getObjects();var k=f.length,g;for(g=this.tmp_insts.length=0;g<k;g++){var h=f[g];cr.do_cmp(d(h,a),c,e)&&this.tmp_insts.push(h)}cr.shallowAssignArray(b.instances,this.tmp_insts);b.select_all=!1}};f.prototype.__PickInverse=function(b,a,c){this._pick_inverse(b,a,c)};f.prototype.PickAll=function(b){b&&(b.getCurrentSol().select_all=!0,b.applySolToContainer())};f.prototype.PickByUID=function(b,a){var c,d;if(b&&(d=this.runtime.getObjectByUID(a))){var e=b.getCurrentSol();
if(e.select_all||-1!==e.instances.indexOf(d))if(b.is_family){var f=b.families;a=0;for(c=f.length;a<c;a++)if(f[a]===d.type){e.pick_one(d);b.applySolToContainer();break}}else d.type===b&&(e.pick_one(d),b.applySolToContainer())}};f.prototype.PickInverse=function(b,a,c){var d;if(b){var e=b.getCurrentSol();c&&(e.select_all=!0);if(e.select_all){e.select_all=!1;e.instances.length=0;var f=b.instances;c=0;for(d=f.length;c<d;c++){var g=f[c];g.uid!==a&&e.instances.push(g)}}else{f=c=0;for(d=e.instances.length;c<
d;c++)g=e.instances[c],e.instances[f]=g,g.uid!==a&&f++;e.instances.length=f}b.applySolToContainer()}};f.prototype.SetGroupActive=function(b,a){if(b=this.runtime.groups_by_name[b.toLowerCase()])switch(a){case 0:b.setGroupActive(!1);break;case 1:b.setGroupActive(!0);break;case 2:b.setGroupActive(!b.group_active)}};f.prototype.SetLayerVisible=function(b,a){if(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))a=1==a,b.visible!==a&&(b.visible=a,this.runtime.redraw=!0)};
f.prototype.SwapPosByUID=function(b,a){b=this.runtime.getObjectByUID(b);a=this.runtime.getObjectByUID(a);if(b&&a){var c=b.x,d=b.y,e=a.y;b.x=a.x;b.y=e;a.x=c;a.y=d;b.set_bbox_changed();a.set_bbox_changed()}};g.exps=new h;h.prototype.Eval=function(b,a){b.set_any(eval("("+a+")"))};h.prototype.ToHexString=function(b,a){b.set_string(a.toString(16))};h.prototype.ToDecimalMark=function(b,a,c){b.set_string(a.toLocaleString(c))};h.prototype.String2ByteCount=function(b,a){a=encodeURI(a).split(/%..|./).length-
1;b.set_int(a)};h.prototype.SubString=function(b,a,c,d){b.set_string(a.substring(c,d))};h.prototype.ToFixed=function(b,a,c){null==c&&(c=10);b.set_string(a.toFixed(c))};h.prototype.ToPrecision=function(b,a,c){null==c&&(c=10);b.set_string(a.toPrecision(c))};h.prototype.ToFixedNumber=function(b,a,c){null==c&&(c=10);a=a.toFixed(c);b.set_float(parseFloat(a))};h.prototype.Newline=function(b,a){null==a&&(a=1);var c,d="";for(c=0;c<a;c++)d+="\n";b.set_string(d)};h.prototype.NormalRandom=function(b,a,c){do{var d=
2*Math.random()-1;var e=2*Math.random()-1;e=d*d+e*e}while(1<e||0==e);b.set_float(a+d*Math.sqrt(-2*Math.log(e)/e)*c)};h.prototype.NormalRandomApproximation=function(b,a,c){for(var d=0,e=0;6>e;e++)d+=Math.random();b.set_float(a+(d-3)/3*c)};h.prototype.ReflectionAngle=function(b,a,c){c=cr.to_radians(c);var d=cr.to_radians(a);a=Math.cos(d);d=Math.sin(d);var e=Math.cos(c);c=Math.sin(c);var f=a*e+d*c;a=cr.angleTo(0,0,a-2*f*e,d-2*f*c);b.set_float(cr.to_degrees(a))};var c="0123456789bcdefghjkmnpqrstuvwxyz".split("");
h.prototype.RandomBase32=function(b,a){for(var d="",e=0;e<a;e++)d+=c[Math.floor(32*Math.random())];b.set_string(d)}})();cr.plugins_.Rex_TARP=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.Rex_TARP.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.timeline=null;this.timelineUid=-1;this.recorder=new cr.plugins_.Rex_TARP.RecorderKlass(this);this.player=new cr.plugins_.Rex_TARP.PlayerKlass(this)};e.onDestroy=function(){this.player.Stop()};e._timeline_get=
function(){if(null!=this.timeline)return this.timeline;var a=this.runtime.types,c;for(c in a){var b=a[c].instances[0];if(b instanceof cr.plugins_.Rex_TimeLine.prototype.Instance)return this.timeline=b}return null};e.saveToJSON=function(){return{tluid:null!=this.timeline?this.timeline.uid:-1,r:this.recorder.saveToJSON(),p:this.player.saveToJSON()}};e.loadFromJSON=function(a){this.timelineUid=a.tluid;this.recorder.loadFromJSON(a.r);this.player.loadFromJSON(a.p)};e.afterLoad=function(){this.timeline=
-1===this.timelineUid?null:this.runtime.getObjectByUID(this.timelineUid);this.timelineUid=-1;this.recorder.afterLoad();this.player.afterLoad()};g.cnds=new a;a.prototype.OnEnd=function(){return!0};a.prototype.IsPlaying=function(){var a=this.player.timer;return a?a.IsActive():!1};g.acts=new f;f.prototype.Setup=function(a){a=a.getFirstPicked();"TIMELINE"==a.check_name?this.timeline=a:alert("TARP should connect to a timeline object")};f.prototype.RecorderStart=function(){this.recorder.Start()};f.prototype.RecordAction=
function(a,c,b){this.recorder.Write(c,b,a)};f.prototype.RecordPause=function(){this.recorder.Pause()};f.prototype.RecorderResume=function(){this.recorder.Resume()};f.prototype.PlayerLoad=function(a){this.player.JSON2List(a)};f.prototype.PlayStart=function(a){this.player.Start(a)};f.prototype.PlayerStop=function(){this.player.Stop()};f.prototype.PlayerPause=function(){this.player.Pause()};f.prototype.PlayerResume=function(){this.player.Resume()};g.exps=new h;h.prototype.LatestRecordTime=function(a){a.set_float(this.recorder.LatestRecordTimeGet())};
h.prototype.RecorderElapsedTime=function(a){a.set_float(this.recorder.ElapsedTimeGet())};h.prototype.LatestPlayTime=function(a){a.set_float(this.player.LatestPlayTimeGet())};h.prototype.PlayerElapsedTime=function(a){a.set_float(this.player.ElapsedTimeGet())};h.prototype.RecorderList=function(a){a.set_string(this.recorder.List2JSON())};h.prototype.Offset=function(a){a.set_float(this.player.offset)};h.prototype.Export2Scenario=function(a){var c=this.recorder.recorder_list,b=[],d,e=c.length;for(d=0;d<
e;d++){var f=c[d];var k=[f[0],f[1]];var g=f[2];var h=g.length;for(f=0;f<h;f++)k.push(g[f]);b.push(k)}a.set_string(JSON.stringify(b))}})();
(function(){cr.plugins_.Rex_TARP.RecorderKlass=function(a){this.plugin=a;this.recorder_list=[];this.dt_start=0;this.wallclock=new h(a)};var a=cr.plugins_.Rex_TARP.RecorderKlass.prototype;a.Setup=function(a){this.wallclock.Init(this.plugin)};a.Start=function(){this.recorder_list.length=0;this.wallclock.Start();this.dt_start=this.wallclock.current_time_get()};a.Write=function(a,e,d){if(null==this.dt_pause){d=this.wallclock.current_time_get()+d;var c=d-this.dt_start,b=[];cr.shallowAssignArray(b,e);this.recorder_list.push([c,
a,b]);this.dt_start=d}};a.Pause=function(){this.wallclock.Pause()};a.Resume=function(){this.wallclock.Resume()};a.List2JSON=function(){return JSON.stringify(this.recorder_list)};a.LatestRecordTimeGet=function(){return this.wallclock.SampleTimeGet()};a.ElapsedTimeGet=function(){return this.wallclock.ElapsedTimeGet()};a.saveToJSON=function(){return{l:this.recorder_list,dts:this.dt_start,wc:this.wallclock.saveToJSON()}};a.loadFromJSON=function(a){this.recorder_list=a.l;this.dt_start=a.dts;this.wallclock.loadFromJSON(a.wc)};
a.afterLoad=function(){this.wallclock.afterLoad()};cr.plugins_.Rex_TARP.PlayerKlass=function(a){this.plugin=a;this.timer=null;this.player_list=[];this.offset=this.play_index=0;this.current_cmd=null;this.wallclock=new h(a)};a=cr.plugins_.Rex_TARP.PlayerKlass.prototype;a.Setup=function(a){this.wallclock.Init(this.plugin)};a.JSON2List=function(a){this.player_list=JSON.parse(a)};a.Start=function(a){this.offset=a;this.play_index=0;this.wallclock.Start();this._start_cmd()};a.Stop=function(){this.timer&&
this.timer.Remove()};a.Pause=function(){this.timer&&this.timer.Suspend();this.wallclock.Pause()};a.Resume=function(){this.timer&&this.timer.Resume();this.wallclock.Resume()};a.LatestPlayTimeGet=function(){return this.wallclock.SampleTimeGet()};a.ElapsedTimeGet=function(){return this.wallclock.ElapsedTimeGet()};a._start_cmd=function(){this.player_list.length>this.play_index?(this.current_cmd=this.player_list[this.play_index],this.play_index+=1,null==this.timer&&(this.timer=this.plugin._timeline_get().CreateTimer(f),
this.timer.plugin=this),this.timer.Start(this.current_cmd[0]+this.offset),this.wallclock.current_time_get()):this.plugin.runtime.trigger(cr.plugins_.Rex_TARP.prototype.cnds.OnEnd,this.plugin)};var f=function(){this.plugin.run()};a.run=function(){var a=this.current_cmd[1],e=this.current_cmd[2];this.plugin._timeline_get().RunCallback(a,e,!0);this._start_cmd()};a.saveToJSON=function(){return{tim:null!=this.timer?this.timer.saveToJSON():null,l:this.player_list,i:this.play_index,off:this.offset,cmd:this.current_cmd,
wc:this.wallclock.saveToJSON()}};a.loadFromJSON=function(a){this.timer_save=a.tim;this.player_list=a.l;this.play_index=a.i;this.offset=a.off;this.current_cmd=a.cmd;this.wallclock.loadFromJSON(a.wc)};a.afterLoad=function(){null==this.timer_save?this.timer=null:(this.timer=this.plugin._timeline_get().LoadTimer(this.timer_save,f),this.timer.plugin=this);this.timers_save=null;this.wallclock.afterLoad()};var h=function(a){this.plugin=a;this.sample_time={tick:null,time:null};this.pause_sum=this.start_time=
0};a=h.prototype;a.Init=function(){this.sample_time.tick=null;this.sample_time.time=null;this.pause_sum=this.start_time=0};a.Start=function(){this.start_time=this.current_time_get();this.dt_pause=null;this.pause_sum=0};a.current_time_get=function(){var a=this.plugin.runtime.tickcount;a!=this.sample_time.tick&&(this.sample_time.time=this.plugin._timeline_get().TimeGet(),this.sample_time.tick=a);return this.sample_time.time};a.Pause=function(){null==this.dt_pause&&(this.dt_pause=this.current_time_get())};
a.Resume=function(){var a=this.current_time_get()-this.dt_pause;this.dt_pause=null;this.pause_sum+=a};a.SampleTimeGet=function(){var a=this.sample_time.time;return a=null==a?0:a-this.start_time};a.ElapsedTimeGet=function(){return this.current_time_get()-this.start_time-this.pause_sum};a.saveToJSON=function(){return{samptim:this.sample_time,st:this.player_list,ps:this.pause_sum}};a.loadFromJSON=function(a){this.sample_time=a.samptim;this.start_time=a.st;this.pause_sum=a.ps};a.afterLoad=function(){}})();
cr.plugins_.Rex_TimeLine=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=function(){this.lines=[]},e=g.prototype;e.alloc=function(a,b){0<this.lines.length?(b=this.lines.pop(),a.LinkTimer(b)):b=a.CreateTimer(b);return b};e.free=function(a){a.timeline=null;this.lines.push(a)};cr.plugins_.Rex_TimeLine.timerCache=new g;g=cr.plugins_.Rex_TimeLine.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};e=g.Instance.prototype;
e.onCreate=function(){this.updateMode=this.properties[0];this.ManualMode=0===this.updateMode;this.GameTimeMode=1===this.updateMode;this.RealTimeMode=2===this.updateMode;this.updateManually=this.ManualMode;this.updateWithGameTime=this.GameTimeMode;this.lastRealTime=(this.updateWithRealTime=this.RealTimeMode)?(new Date).getTime():null;this.my_timescale=-1;this.timeline=new cr.plugins_.Rex_TimeLine.TimeLine;(this.GameTimeMode||this.RealTimeMode)&&this.runtime.tickMe(this);this.check_name="TIMELINE";
this.recycled||(this.timers={});this.timerCache=cr.plugins_.Rex_TimeLine.timerCache;this.exp_triggeredTimerName="";this.c2FnType=this.timersSave=null};e.onDestroy=function(){this.timeline.CleanAll();for(var a in this.timers)this.destroyLocalTimer(a)};e.tick=function(){if(this.GameTimeMode){if(this.updateWithGameTime){var a=this.runtime.getDt(this);this.timeline.Dispatch(a)}}else if(this.RealTimeMode){var b=(new Date).getTime();this.updateWithRealTime&&(a=(b-this.lastRealTime)/1E3,this.timeline.Dispatch(a));
this.lastRealTime=b}};e.CreateTimer=function(a){var b=new cr.plugins_.Rex_TimeLine.Timer(this.timeline);b.TimeoutHandlerSet(a);return b};e.LinkTimer=function(a){a.Reset(this.timeline);return a};e.LoadTimer=function(a,b){b=this.CreateTimer(b);b.loadFromJSON(a);b.afterLoad();return b};e.getC2FnType=function(a){null===this.c2FnType&&(this.c2FnType=window.c2_callRexFunction2?"c2_callRexFunction2":window.c2_callFunction?"c2_callFunction":"");return this.c2FnType};e.RunCallback=function(a,b,d){d=this.getC2FnType(d);
return""===d?null:window[d](a,b)};e.TimeGet=function(){return this.timeline.absTime};e.create_local_timer=function(a){var b=this.timers[a];null!=b?b.Remove():(b=this.timerCache.alloc(this,d),b.plugin=this,this.timers[a]=b);return b};e.destroyLocalTimer=function(a){var b=this.timers[a];null!=b&&(b.Remove(),delete this.timers[a],this.timerCache.free(b))};e.timer_cache_clean=function(){this.timerCache.lines.length=0};var d=function(){var a=this.plugin;a.exp_triggeredTimerName=this._cb.name;a.RunCallback(this._cb.command,
this._cb.params,!0);0===this._repeat_count?this.Start():1<this._repeat_count&&(--this._repeat_count,this.Start())};e._get_timer_cb_params=function(a){return{name:a,command:"",params:[]}};e.saveToJSON=function(){var a,b={};for(a in this.timers){var d=this.timers[a];b[a]={tim:d.saveToJSON(),cmd:d._cb.command,pams:d._cb.params,rc:d._repeat_count}}return{ts:this.my_timescale,ug:this.updateWithGameTime,tl:this.timeline.saveToJSON(),timers:b,lrt:this.lastRealTime,ft:this.c2FnType}};e.loadFromJSON=function(a){this.my_timescale=
a.ts;this.timeline.loadFromJSON(a.tl);this.timersSave=a.timers;this.lastRealTime=a.lrt;this.c2FnType=a.ft;this.onDestroy();this.timer_cache_clean()};e.afterLoad=function(){var a;for(a in this.timersSave){var b=this.timersSave[a];var e=this.LoadTimer(b.tim,d);e.plugin=this;e._cb=this._get_timer_cb_params(a);e._cb.command=b.cmd;e._cb.params=b.pams;e._repeat_count=b.rc}this.timersSave=null};g.cnds=new a;a.prototype.IsRunning=function(a){return(a=this.timers[a])?a.IsActive():!1};g.acts=new f;f.prototype.PushTimeLine=
function(a){this.updateManually&&this.timeline.Dispatch(a)};f.prototype.Setup_deprecated=function(){};f.prototype.CreateTimer_deprecated=function(){};f.prototype.StartTimer=function(a,b,d){if(a=this.timers[a])a._repeat_count=d,a.Start(b)};f.prototype.StartTrgTimer=function(a){var b=this.timers[this.exp_triggeredTimerName];b&&b.Start(a)};f.prototype.PauseTimer=function(a){(a=this.timers[a])&&a.Suspend()};f.prototype.ResumeTimer=function(a){(a=this.timers[a])&&a.Resume()};f.prototype.StopTimer=function(a){(a=
this.timers[a])&&a.Remove()};f.prototype.CleanTimeLine=function(){this.timeline.CleanAll()};f.prototype.DeleteTimer=function(a){this.destroyLocalTimer(a)};f.prototype.SetTimerParameter=function(a,b,d){(a=this.timers[a])&&(a._cb.params[b]=d)};f.prototype.PauseTimeLine=function(){this.GameTimeMode?this.updateWithGameTime=!1:this.RealTimeMode&&(this.updateWithRealTime=!1)};f.prototype.ResumeTimeLine=function(){this.GameTimeMode?this.updateWithGameTime=!0:this.RealTimeMode&&(this.updateWithRealTime=!0)};
f.prototype.CreateTimer=function(a,b,d){var c=this.create_local_timer(a);c._cb=this._get_timer_cb_params(a);c._cb.command=b;cr.shallowAssignArray(c._cb.params,d)};f.prototype.SetTimerParameters=function(a,b){(a=this.timers[a])&&cr.shallowAssignArray(a._cb.params,b)};f.prototype.SetTrgTimerParameters=function(a){var b=this.timers[this.exp_triggeredTimerName];b&&cr.shallowAssignArray(b._cb.params,a)};f.prototype.DeleteTrgTimer=function(){this.destroyLocalTimer(this.exp_triggeredTimerName)};f.prototype.PushTimeLineTo=
function(a){this.updateManually&&(a-=this.timeline.absTime,0>a||this.timeline.Dispatch(a))};f.prototype.SetupCallback=function(a){this.c2FnType=0===a?"c2_callFunction":"c2_callRexFunction2"};g.exps=new h;h.prototype.TimerRemainder=function(a,b){b=(b=this.timers[b])?b.RemainderTimeGet():0;a.set_float(b)};h.prototype.TimerElapsed=function(a,b){b=(b=this.timers[b])?b.ElapsedTimeGet():0;a.set_float(b)};h.prototype.TimerRemainderPercent=function(a,b){b=(b=this.timers[b])?b.RemainderTimePercentGet():0;
a.set_float(b)};h.prototype.TimerElapsedPercent=function(a,b){b=(b=this.timers[b])?b.ElapsedTimePercentGet():0;a.set_float(b)};h.prototype.TimeLineTime=function(a){a.set_float(this.timeline.absTime)};h.prototype.TriggeredTimerName=function(a){a.set_string(this.exp_triggeredTimerName)};h.prototype.TimerDelayTime=function(a){var b=this.timers[timer_name];b=b?b.DelayTimeGet():0;a.set_float(b)}})();
(function(){cr.plugins_.Rex_TimeLine.TimeLine=function(){this.CleanAll()};var a=cr.plugins_.Rex_TimeLine.TimeLine.prototype,f=function(a,f){a=a.absTime;f=f.absTime;return a<f?-1:a>f?1:0};a.CleanAll=function(){this.triggered_timer=null;this._timer_absTime=this.absTime=0;this._waitingTimerQueue=[];this._processTimerQueue=[];this._suspendTimerQueue=[];this._activateQueue=[this._waitingTimerQueue,this._processTimerQueue];this._allQueues=[this._waitingTimerQueue,this._processTimerQueue,this._suspendTimerQueue]};
a.CurrentTimeGet=function(){return this._timer_absTime};a.RegistTimer=function(a){this._add_timer_to_activate_lists(a)};a.RemoveTimer=function(a){this._removeTimerFromQueues(a,!1);a._idle()};a.Dispatch=function(a){this.absTime+=a;this._waitingTimerQueue.sort(f);a=this._waitingTimerQueue.length;var g,e=0;for(g=0;g<a;g++){var d=this._waitingTimerQueue[g];this._is_timer_time_out(d)&&(this._processTimerQueue.push(d),e+=1)}if(e){for(g=e;g<a;g++)this._waitingTimerQueue[g-e]=this._waitingTimerQueue[g];this._waitingTimerQueue.length-=
e}for(;0<this._processTimerQueue.length;)this._processTimerQueue.sort(f),this.triggered_timer=this._processTimerQueue.shift(),this._timer_absTime=this.triggered_timer.absTime,this.triggered_timer.DoHandle();this._timer_absTime=this.absTime};a.SuspendTimer=function(a){var f=this._removeTimerFromQueues(a,!0);f&&(this._suspendTimerQueue.push(a),a.__suspend__());return f};a.ResumeTimer=function(a){var f=!1,e=this._suspendTimerQueue.indexOf(a);-1!=e&&(cr.arrayRemove(this._suspendTimerQueue,e),a.__resume__(),
this.RegistTimer(a),f=!0);return f};a.SetTimescale=function(a,f){a.__setTimescale__(f);(f=this._removeTimerFromQueues(a,!0))&&this.RegistTimer(a);return f};a.ChangeTimerRate=function(a,f){a.__changeRate__(f);(f=this._removeTimerFromQueues(a,!0))&&this.RegistTimer(a);return f};a.saveToJSON=function(){return{at:this.absTime}};a.loadFromJSON=function(a){this.absTime=a.at};a._is_timer_time_out=function(a){return a.absTime<=this.absTime};a._add_timer_to_activate_lists=function(a){(this._is_timer_time_out(a)?
this._processTimerQueue:this._waitingTimerQueue).push(a)};a._removeTimerFromQueues=function(a,f){var e=!1;f=f?this._activateQueue:this._allQueues;var d,c=f.length;for(d=0;d<c;d++){var b=f[d];var g=b.indexOf(a);if(-1!=g){cr.arrayRemove(b,g);e=!0;break}}return e};cr.plugins_.Rex_TimeLine.Timer=function(a){this.Reset(a);this.extra={}};a=cr.plugins_.Rex_TimeLine.Timer.prototype;a.Reset=function(a){this.timeline=a;this.absTime=this._remainderTime=this.delayTime=0;this.timescale=1;this._idle();this._setAbsTimeout(0)};
a.Restart=function(a){null!=a&&(this.delayTime=a);this._setAbsTimeout(this.delayTime/this.timescale);this._isAlive?this._isActive||(this._remainderTime=this.absTime,this.Resume()):(this.timeline.RegistTimer(this),this._run())};a.Start=a.Restart;a.Suspend=function(){this.timeline.SuspendTimer(this)};a.Resume=function(){this.timeline.ResumeTimer(this)};a.SetTimescale=function(a){this._isActive&&a===this.timescale||this.timeline.SetTimescale(this,a)};a.ChangeRate=function(a){this.timeline.ChangeTimerRate(this,
a)};a.Remove=function(){this._isAlive&&this.timeline.RemoveTimer(this)};a.IsAlive=function(){return this._isAlive};a.IsActive=function(){return this._isAlive&&this._isActive};a.RemainderTimeGet=function(a){var f=this.IsActive()?this.absTime-this.timeline.CurrentTimeGet():this.IsAlive()?this._remainderTime:0;a||0===this.timescale&&1===this.timescale||(f*=this.timescale);return f};a.RemainderTimeSet=function(a){if(this.IsAlive()){var f=this.delayTime;if(0!==this.timescale||1!==this.timescale)f/=this.timescale;
this._remainderTime=cr.clamp(a,0,f);this.absTime=this.timeline.CurrentTimeGet()+this._remainderTime}};a.ElapsedTimeGet=function(){return this.delayTime-this.RemainderTimeGet()};a.RemainderTimePercentGet=function(){return 0==this.delayTime?0:this.RemainderTimeGet()/this.delayTime};a.ElapsedTimePercentGet=function(){return 0==this.delayTime?0:this.ElapsedTimeGet()/this.delayTime};a.ExpiredTimeGet=function(){return this.timeline.absTime-this.absTime};a.DelayTimeGet=function(){return this.delayTime};
a.TimeoutHandlerSet=function(a){this.OnTimeout=a};a.DoHandle=function(){this._idle();this.OnTimeout&&this.OnTimeout()};a.saveToJSON=function(){var a=this.RemainderTimeGet(!0);return{dt:this.delayTime,rt:a,ts:this.timescale,alive:this._isAlive,active:this._isActive,ex:this.extra}};a.loadFromJSON=function(a){this.delayTime=a.dt;this._isAlive=a.alive;this._isActive=a.active;this.timescale=a.ts;this.extra=a.ex;this.RemainderTimeSet(a.rt)};a.afterLoad=function(){this.IsAlive()&&(this.timeline.RegistTimer(this),
this.IsActive()||this.timeline.SuspendTimer(this))};a._idle=function(){this._isActive=this._isAlive=!1};a._run=function(){this._isActive=this._isAlive=!0};a._setAbsTimeout=function(a){this.absTime=this.timeline.CurrentTimeGet()+a};a.__suspend__=function(){this._remainderTime=this.absTime-this.timeline.CurrentTimeGet();this._isActive=!1};a.__resume__=function(){this._setAbsTimeout(this._remainderTime);this._isActive=!0};a.__setTimescale__=function(a){if(!(0>a)){var f=!1;0==a&&this._isActive?this.Suspend():
0<a&&!this._isActive?(this.Resume(),f=!0):0<a&&this._isActive&&(f=!0);f&&(this.__changeRate__(this.timescale/a),this.timescale=a)}};a.__changeRate__=function(a){if(this._isActive){var f=this.timeline.CurrentTimeGet();this.absTime=f+(this.absTime-f)*a}else this._remainderTime*=a}})();cr.plugins_.Rex_UID2Prop=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.plugins_.Rex_UID2Prop.prototype;h.Type=function(a){this.plugin=a;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a){this.type=a;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.alias2pv={}};g.onDestroy=function(){};g.add_alias=function(a,d,c){var b=this.alias2pv[a];if(null==b)b={},this.alias2pv[a]=b;else for(var e in b)delete b[e];if(d.is_family)for(e=d.members.length,a=0;a<e;a++){var f=
d.members[a];b[f.sid]=c+f.family_var_map[d.family_index]}else b[d.sid]=c};g.get_pv=function(a,d){if(null==a)return 0;d=this.alias2pv[d];if(null==d)return 0;d=d[a.type.sid];return null==d?0:a.instance_vars[d]};g.saveToJSON=function(){return{alias:this.alias2pv}};g.loadFromJSON=function(a){this.alias2pv=a.alias};h.cnds=new function(){};h.acts=new a;a.prototype.DefinePrivateVariableAlias=function(a,d,c){this.add_alias(a,d,c)};a.prototype.InstDestroy=function(a){(a=this.runtime.getObjectByUID(a))&&this.runtime.DestroyInstance(a)};
a.prototype.InstSetX=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&a.x!==d&&(a.x=d,a.set_bbox_changed())};a.prototype.InstSetY=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.y&&a.y!==d&&(a.y=d,a.set_bbox_changed())};a.prototype.InstSetPos=function(a,d,c){!(a=this.runtime.getObjectByUID(a))||null==a.x||a.x===d&&a.y===c||(a.x=d,a.y=c,a.set_bbox_changed())};a.prototype.InstSetPosToObject=function(a,d,c){if((a=this.runtime.getObjectByUID(a))&&null!=a.x){var b=this.runtime.getObjectByUID(d);
b&&(b.getImagePoint?(d=b.getImagePoint(c,!0),c=b.getImagePoint(c,!1)):(d=b.x,c=b.y),a.x!==d||a.y!==c)&&(a.x=d,a.y=c,a.set_bbox_changed())}};a.prototype.InstMoveForward=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&0!==d&&(a.x+=Math.cos(a.angle)*d,a.y+=Math.sin(a.angle)*d,a.set_bbox_changed())};a.prototype.InstMoveAtAngle=function(a,d,c){(a=this.runtime.getObjectByUID(a))&&null!=a.x&&0!==c&&(a.x+=Math.cos(cr.to_radians(d))*c,a.y+=Math.sin(cr.to_radians(d))*c,a.set_bbox_changed())};a.prototype.InstSetWidth=
function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.width&&a.width!==d&&(a.width=d,a.set_bbox_changed())};a.prototype.InstSetHeight=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.height&&a.height!==d&&(a.height=d,a.set_bbox_changed())};a.prototype.InstSetSize=function(a,d,c){!(a=this.runtime.getObjectByUID(a))||null==a.width||a.width===d&&a.height===c||(a.width=d,a.height=c,a.set_bbox_changed())};a.prototype.InstSetAngle=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&
(d=cr.to_radians(cr.clamp_angle_degrees(d)),isNaN(d)||a.angle===d||(a.angle=d,a.set_bbox_changed()))};a.prototype.InstRotateClockwise=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&0!==d&&!isNaN(d)&&(a.angle+=cr.to_radians(d),a.angle=cr.clamp_angle(a.angle),a.set_bbox_changed())};a.prototype.InstRotateCounterclockwise=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&0!==d&&!isNaN(d)&&(a.angle-=cr.to_radians(d),a.angle=cr.clamp_angle(a.angle),a.set_bbox_changed())};
a.prototype.InstRotateTowardAngle=function(a,d,c){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&(d=cr.angleRotate(a.angle,cr.to_radians(c),cr.to_radians(d)),isNaN(d)||a.angle===d||(a.angle=d,a.set_bbox_changed()))};a.prototype.InstRotateTowardPosition=function(a,d,c,b){(a=this.runtime.getObjectByUID(a))&&null!=a.angle&&(d=cr.angleRotate(a.angle,Math.atan2(b-a.y,c-a.x),cr.to_radians(d)),isNaN(d)||a.angle===d||(a.angle=d,a.set_bbox_changed()))};a.prototype.InstSetTowardPosition=function(a,d,c){(a=
this.runtime.getObjectByUID(a))&&null!=a.angle&&(d=Math.atan2(c-a.y,d-a.x),isNaN(d)||a.angle===d||(a.angle=d,a.set_bbox_changed()))};a.prototype.InstSetOpacity=function(a,d){(a=this.runtime.getObjectByUID(a))&&null!=a.opacity&&(d/=100,0>d?d=0:1<d&&(d=1),d!==a.opacity&&(a.opacity=d,a.runtime.redraw=!0))};a.prototype.InstSetVisible=function(a){var d=this.runtime.getObjectByUID(uid);d&&null!=d.visible&&!a!==!d.visible&&(d.visible=a,d.runtime.redraw=!0)};h.exps=new f;f.prototype.X=function(a,d){d=this.runtime.getObjectByUID(d);
null==d||null==d.x?a.set_float(0):a.set_float(d.x)};f.prototype.Y=function(a,d){d=this.runtime.getObjectByUID(d);null==d||null==d.y?a.set_float(0):a.set_float(d.y)};f.prototype.Angle=function(a,d){d=this.runtime.getObjectByUID(d);null==d||null==d.angle?a.set_float(0):a.set_float(cr.to_clamped_degrees(d.angle))};f.prototype.Width=function(a,d){d=this.runtime.getObjectByUID(d);null==d||null==d.width?a.set_float(0):a.set_float(d.width)};f.prototype.Height=function(a,d){d=this.runtime.getObjectByUID(d);
null==d||null==d.height?a.set_float(0):a.set_float(d.height)};f.prototype.Opacity=function(a,d){d=this.runtime.getObjectByUID(d);null==d||null==d.opacity?a.set_float(0):a.set_float(d.opacity)};f.prototype.Visible=function(a,d){d=this.runtime.getObjectByUID(d);null==d||null==d.visible?a.set_float(0):a.set_float(d.visible)};f.prototype.ImgptX=function(a,d,c){d=this.runtime.getObjectByUID(d);null==d||null==d.getImagePoint?a.set_float(0):a.set_float(d.getImagePoint(c,!0))};f.prototype.ImgptY=function(a,
d,c){d=this.runtime.getObjectByUID(d);null==d||null==d.getImagePoint?a.set_float(0):a.set_float(d.getImagePoint(c,!1))};f.prototype.PV=function(a,d,c){d=this.runtime.getObjectByUID(d);a.set_any(this.get_pv(d,c))};f.prototype.DistanceTo=function(a,d,c){d=this.runtime.getObjectByUID(d);c=this.runtime.getObjectByUID(c);c=null==d||null==c||null==d.x||null==d.y||null==c.x||null==c.y?0:cr.distanceTo(d.x,d.y,c.x,c.y);a.set_float(c)};f.prototype.AngleTo=function(a,d,c){d=this.runtime.getObjectByUID(d);c=
this.runtime.getObjectByUID(c);c=null==d||null==c||null==d.x||null==d.y||null==c.x||null==c.y?0:cr.angleTo(d.x,d.y,c.x,c.y);a.set_float(cr.to_clamped_degrees(c))}})();cr.plugins_.Rex_UndoRedo=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.Rex_UndoRedo.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.handler=0===this.properties[0]?new d(this):new c(this);this.is_states_mode=0===this.properties[0];this.max_record_length=this.properties[1];this.recorder=[];this.cur_step=null;this.tmp_dict={};this.clean_all();
0===this.properties[2]&&(this.loadFromJSON=this.saveToJSON=null)};e.clean_all=function(){this.recorder.length=0;this.current_index=-1};e.Push=function(a){this.recorder.length-1==this.current_index?(this.current_index+=1,this.recorder.push(a)):(this.current_index+=1,this.recorder[this.current_index]=a,this.recorder.length=this.current_index+1);0<this.max_record_length&&this.recorder.length>this.max_record_length&&(this.recorder.shift(),--this.current_index)};e.Undo=function(a){return this.cur_step=
this.handler.Undo()};e.Redo=function(a){return this.cur_step=this.handler.Redo()};e.has_steps=function(){return-1!=this.current_index};e.steps2string=function(){return JSON.stringify(this.saveToJSON())};e.string2steps=function(a){""!=a&&(a=JSON.parse(a),this.loadFromJSON(a))};e.saveToJSON=function(){return{d:this.recorder,i:this.current_index}};e.loadFromJSON=function(a){this.recorder=a.d;this.current_index=a.i};g.cnds=new a;a.prototype.CanUndo=function(){return this.handler.CanUndo()};a.prototype.CanRedo=
function(){return this.handler.CanRedo()};a.prototype.ForEachStep=function(){var a=this.runtime.getCurrentEventStack(),c=a.current_event;a=a.isModifierAfterCnds();for(var d=this.current_index,e=this.cur_step,f=0;f<=d;f++)a&&this.runtime.pushCopySol(c.solModifiers),this.current_index=f,this.cur_step=this.recorder[f],c.retrigger(),a&&this.runtime.popSol(c.solModifiers);this.current_index=d;this.cur_step=e;return!1};g.acts=new f;f.prototype.CleanAll=function(){this.clean_all()};f.prototype.Push=function(a){if(null!=
a){var b={};b._=a}else b=this.tmp_dict,this.tmp_dict={};this.Push(b)};f.prototype.StringToSteps=function(a){this.string2steps(a)};f.prototype.SetDate=function(a,c){this.tmp_dict[a]=c};f.prototype.Undo=function(){this.Undo()};f.prototype.Redo=function(){this.Redo()};g.exps=new h;h.prototype.Undo=function(a){var b=this.Undo();b=null==b?0:b._;a.set_any(b)};h.prototype.Redo=function(a){var b=this.Redo();b=null==b?0:b._;a.set_any(b)};h.prototype.CurStep=function(a,c){null==this.cur_step?c=0:(null==c&&
(c="_"),c=this.cur_step[c]);a.set_any(c)};h.prototype.StepsCnt=function(a){a.set_int(this.recorder.length)};h.prototype.CurIndex=function(a){a.set_int(this.current_index)};h.prototype.ToString=function(a){a.set_string(this.steps2string())};var d=function(a){this.plugin=a};g=d.prototype;g.CanUndo=function(){return 0<=this.plugin.current_index};g.Undo=function(){if(!this.CanUndo())return 0;var a=this.plugin,c=a.recorder[a.current_index];--a.current_index;return c};g.CanRedo=function(){var a=this.plugin;
return a.current_index<a.recorder.length-1};g.Redo=function(){if(!this.CanRedo())return 0;var a=this.plugin;a.current_index+=1;return a.recorder[a.current_index]};var c=function(a){this.plugin=a};g=c.prototype;g.CanUndo=function(){return 0<this.plugin.current_index};g.Undo=function(){if(!this.CanUndo())return 0;var a=this.plugin;--a.current_index;return a.recorder[a.current_index]};g.CanRedo=function(){var a=this.plugin;return a.current_index<a.recorder.length-1};g.Redo=function(){if(!this.CanRedo())return 0;
var a=this.plugin;a.current_index+=1;return a.recorder[a.current_index]}})();cr.plugins_.Rex_canvas=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.Rex_canvas.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.wait_for_textures.push(this.texture_img))};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.visible=0===
this.properties[0];this.canvas=document.createElement("canvas");this.canvas.width=this.width;this.canvas.height=this.height;this.ctx=this.canvas.getContext("2d");this.ctx.drawImage(this.type.texture_img,0,0,this.width,this.height);this.update_tex=!0;this.rcTex=new cr.rect(0,0,0,0)};e.onDestroy=function(){this.ctx=null;jQuery(this.canvas).remove();this.canvas=null};e.draw=function(a){a.save();a.globalAlpha=this.opacity;var b=this.x,c=this.y;this.runtime.pixel_rounding&&(b=Math.round(b),c=Math.round(c));
0===b&&0===c||a.translate(b,c);0!==this.angle&&a.rotate(this.angle);a.drawImage(this.canvas,-(this.hotspotX*this.width),-(this.hotspotY*this.height),this.width,this.height);a.restore()};e.drawGL=function(a){this.update_tex&&(this.tex&&a.deleteTexture(this.tex),this.tex=a.loadTexture(this.canvas,!1,this.runtime.linearSampling),this.update_tex=!1);a.setTexture(this.tex);a.setOpacity(this.opacity);var b=this.bquad;if(this.runtime.pixel_rounding){var c=Math.round(this.x)-this.x,d=Math.round(this.y)-this.y;
a.quad(b.tlx+c,b.tly+d,b.trx+c,b.try_+d,b.brx+c,b.bry+d,b.blx+c,b.bly+d)}else a.quad(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly)};e.draw_instances=function(a,b,c){var d=b.ctx,e=b.canvas,f,k=a.length;for(f=0;f<k;f++){var g=a[f];if(0!=g.visible||0!=this.runtime.testOverlap(b,g)){d.save();d.scale(e.width/b.width,e.height/b.height);d.rotate(-b.angle);d.translate(-b.bquad.tlx,-b.bquad.tly);var h=g.compositeOp;g.compositeOp=c;d.globalCompositeOperation=c;g.draw(d);g.compositeOp=h;d.restore()}}};e.DrawObject=
function(a,b){a&&(this.update_bbox(),a=a.getCurrentSol(),this.draw_instances(a.select_all?a.type.instances:a.instances,this,b),this.update_tex=this.runtime.redraw=!0)};var d="source-over source-in source-out source-atop destination-over destination-in destination-out destination-atop lighter copy xor multiply screen overlay darken lighten color-dodge color-burn hard-light soft-light difference exclusion hue saturation color luminosity".split(" ");e.saveToJSON=function(){var a=this.canvas.width,b=
this.canvas.height,c=this.ctx.getImageData(0,0,a,b).data;c=window.RexC2ZlibU8Arr.u8a2String(c);return{w:a,h:b,d:c}};e.loadFromJSON=function(a){this.canvas.width=a.w;this.canvas.height=a.h;var b=window.RexC2ZlibU8Arr.string2u8a(a.d);a=this.ctx.createImageData(a.w,a.h);var c=a.data,d,e=c.length;for(d=0;d<e;d++)c[d]=b[d];this.ctx.putImageData(a,0,0);this.update_tex=this.runtime.redraw=!0};g.cnds=new a;a.prototype.OnURLLoaded=function(){return!0};g.acts=new f;f.prototype.Eval=function(a){eval("(function(ctx){"+
a+"})")(this.ctx);this.update_tex=this.runtime.redraw=!0};f.prototype.ResizeCanvas=function(a,b){this.canvas.width=a;this.canvas.height=b;this.update_tex=this.runtime.redraw=!0};f.prototype.ClearRect=function(a,b,c,d){this.ctx.clearRect(a,b,c,d);this.update_tex=this.runtime.redraw=!0};f.prototype.FillRect=function(a,b,c,d){this.ctx.fillRect(a,b,c,d);this.update_tex=this.runtime.redraw=!0};f.prototype.StrokeRect=function(a,b,c,d){this.ctx.strokeRect(a,b,c,d);this.update_tex=this.runtime.redraw=!0};
f.prototype.FillText=function(a,b,c){this.ctx.fillText(a,b,c);this.update_tex=this.runtime.redraw=!0};f.prototype.StrokeText=function(a,b,c){this.ctx.strokeText(a,b,c);this.update_tex=this.runtime.redraw=!0};f.prototype.SetLineWidth=function(a){this.ctx.lineWidth=a};var c=["butt","round","square"];f.prototype.SetLineCap=function(a){"number"===typeof a&&(a=c[a]);this.ctx.lineCap=a};var b=["bevel","round","miter"];f.prototype.SetLineCap=function(a){"number"===typeof cap&&(a=b[a]);this.ctx.lineJoin=
a};f.prototype.SetMiterLimit=function(a){this.ctx.miterLimit=a};f.prototype.SetFont=function(a){this.ctx.font=a};var l=["left","right","center","start","end"];f.prototype.SetTextAlign=function(a){"number"===typeof a&&(a=l[a]);this.ctx.textAlign=a};var p="top hanging middle alphabetic ideographic bottom".split(" ");f.prototype.SetTextBaseline=function(a){"number"===typeof a&&(a=p[a]);this.ctx.textBaseline=a};f.prototype.SetFillColor=function(a){this.ctx.fillStyle=a};f.prototype.SetStrokeColor=function(a){this.ctx.strokeStyle=
a};f.prototype.SetShadowBlur=function(a){this.ctx.shadowBlur=a};f.prototype.SetShadowColor=function(a){this.ctx.shadowColor=a};f.prototype.SetShadowOffsetX=function(a){this.ctx.shadowOffsetX=a};f.prototype.SetShadowOffsetY=function(a){this.ctx.shadowOffsetY=a};f.prototype.BeginPath=function(){this.ctx.beginPath()};f.prototype.ClosePath=function(){this.ctx.closePath()};f.prototype.MoveTo=function(a,b){this.ctx.moveTo(a,b)};f.prototype.LineTo=function(a,b){this.ctx.lineTo(a,b)};f.prototype.BezierCurveTo=
function(a,b,c,d,e,f){this.ctx.bezierCurveTo(a,b,c,d,e,f)};f.prototype.QuadraticCurveTo=function(a,b,c,d){this.ctx.quadraticCurveTo(a,b,c,d)};f.prototype.Arc=function(a,b,c,d,e,f){this.ctx.arc(a,b,c,cr.to_radians(d),cr.to_radians(e),1===f)};f.prototype.ArcTo=function(a,b,c,d,e){this.ctx.arcTo(a,b,c,d,e)};f.prototype.Rect=function(a,b,c,d){this.ctx.rect(a,b,c,d)};var n=["nonzero","evenodd"];f.prototype.Fill=function(a){"number"===typeof a&&(a=n[a]);this.ctx.fill(a);this.update_tex=this.runtime.redraw=
!0};f.prototype.Stroke=function(){this.ctx.stroke();this.update_tex=this.runtime.redraw=!0};f.prototype.Clip=function(a){"number"===typeof a&&(a=n[a]);this.ctx.clip(a)};f.prototype.EraseObject=function(a){this.DrawObject(a,"destination-out")};f.prototype.DrawObject=function(a,b){"number"===typeof b&&(b=d[b]);this.DrawObject(a,b)};f.prototype.LoadURL=function(a,b){var c=new Image,d=this;c.onload=function(){var a=!1;if(0===b&&(d.width!=c.width||d.height!=c.height))d.width=c.width,d.height=c.height,
a=!0;else if(2===b){var e=d.width/c.width,f=d.height/c.height;if(1<e&&1<f)d.width=c.width,d.height=c.height,a=!0;else if(1>e||1>f)a=e<f?e:f,d.width=c.width*a,d.height=c.height*a,a=!0}a&&(d.set_bbox_changed(),d.canvas.width=d.width,d.canvas.height=d.height);a=d.canvas;c.width!==a.width&&(a.width=c.width);c.height!==a.height&&(a.height=c.height);d.ctx.clearRect(0,0,c.width,c.height);d.ctx.drawImage(c,0,0,c.width,c.height);d.runtime.redraw=!0;d.update_tex=!0;d.runtime.trigger(cr.plugins_.Rex_canvas.prototype.cnds.OnURLLoaded,
d)};"data:"!==a.substr(0,5)&&(c.crossOrigin="anonymous");c.src=a};g.exps=new h;h.prototype.CanvasWidth=function(a){a.set_float(this.canvas.width)};h.prototype.CanvasHeight=function(a){a.set_float(this.canvas.height)};h.prototype.TextWidth=function(a,b){a.set_float(this.ctx.measureText(b).width)};h.prototype.ImageUrl=function(a){a.set_string(this.canvas.toDataURL())}})();
(function(){if(null==window.RexC2ZlibU8Arr){window.RexC2ZlibU8Arr={};var a=[];window.RexC2ZlibU8Arr.u8a2String=function(f){f=(new window.Zlib.Deflate(f)).compress();for(var h=0;h<f.length;h+=32768)a.push(String.fromCharCode.apply(null,f.subarray(h,h+32768)));f=a.join("");f=btoa(f);a.length=0;return f};window.RexC2ZlibU8Arr.string2u8a=function(a){a=atob(a);a=a.split("").map(function(a){return a.charCodeAt(0)});return(new window.Zlib.Inflate(a)).decompress()}}})();
cr.plugins_.Sprite=function(a){this.runtime=a};
(function(){function a(){if(0===this.datauri.length){var a=document.createElement("canvas");a.width=this.width;a.height=this.height;var b=a.getContext("2d");this.spritesheeted?b.drawImage(this.texture_img,this.offx,this.offy,this.width,this.height,0,0,this.width,this.height):b.drawImage(this.texture_img,0,0,this.width,this.height);this.datauri=a.toDataURL("image/png")}return this.datauri}function f(){}function h(a){a[0]=0;a[1]=0;a[2]=0;v.push(a)}function g(a,b){return a<b?""+a+","+b:""+b+","+a}function e(a,
b,c,d){b=b.uid;c=c.uid;var e=g(b,c);if(a.hasOwnProperty(e))a[e][2]=d;else{var f=v.length?v.pop():[0,0,0];f[0]=b;f[1]=c;f[2]=d;a[e]=f}}function d(a,b,c){b=g(b.uid,c.uid);a.hasOwnProperty(b)&&(h(a[b]),delete a[b])}function c(a,b,c){b=g(b.uid,c.uid);if(a.hasOwnProperty(b))return u=a[b][2],!0;u=-2;return!1}function b(a,b,c){if(!a)return!1;var d=0!==b||0!==c,e=!1,f=this.runtime.getCurrentCondition(),k=f.type;f=f.inverted;var g=a.getCurrentSol();var h=this.runtime.getCurrentEventStack().current_event.orblock;
g.select_all?(this.update_bbox(),D.copy(this.bbox),D.offset(b,c),this.runtime.getCollisionCandidates(this.layer,a,D,A),g=A):g=h?this.runtime.isCurrentConditionFirst()&&!g.else_instances.length&&g.instances.length?g.instances:g.else_instances:g.instances;B=a;w=k!==a&&!f;if(d){var l=this.x;var m=this.y;this.x+=b;this.y+=c;this.set_bbox_changed()}b=0;for(c=g.length;b<c;b++)if(h=g[b],this.runtime.testOverlap(this,h)){e=!0;if(f)break;k!==a&&x.add(h)}d&&(this.x=l,this.y=m,this.set_bbox_changed());cr.clearArray(A);
return e}function l(){}function p(){}var n=cr.plugins_.Sprite.prototype;n.Type=function(a){this.plugin=a;this.runtime=a.runtime};var k=n.Type.prototype;k.onCreate=function(){if(!this.is_family){var b,c;this.all_frames=[];this.has_loaded_textures=!1;var d=0;for(b=this.animations.length;d<b;d++){var e=this.animations[d];var f={};f.name=e[0];f.speed=e[1];f.loop=e[2];f.repeatcount=e[3];f.repeatto=e[4];f.pingpong=e[5];f.sid=e[6];f.frames=[];var k=0;for(c=e[7].length;k<c;k++){var g=e[7][k];var h={};h.texture_file=
g[0];h.texture_filesize=g[1];h.offx=g[2];h.offy=g[3];h.width=g[4];h.height=g[5];h.duration=g[6];h.hotspotX=g[7];h.hotspotY=g[8];h.image_points=g[9];h.poly_pts=g[10];h.pixelformat=g[11];h.spritesheeted=0!==h.width;h.datauri="";h.getDataUri=a;var l={left:0,top:0,right:1,bottom:1};h.sheetTex=l;h.webGL_texture=null;(l=this.runtime.findWaitingTexture(g[0]))?h.texture_img=l:(h.texture_img=new Image,h.texture_img.cr_src=g[0],h.texture_img.cr_filesize=g[1],h.texture_img.c2webGL_texture=null,this.runtime.waitForImageLoad(h.texture_img,
g[0]));cr.seal(h);f.frames.push(h);this.all_frames.push(h)}cr.seal(f);this.animations[d]=f}}};k.updateAllCurrentTexture=function(){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.curWebGLTexture=c.curFrame.webGL_texture}};k.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.texture_img.c2webGL_texture=null;c.webGL_texture=null}this.has_loaded_textures=!1;this.updateAllCurrentTexture()}};k.onRestoreWebGLContext=
function(){if(!this.is_family&&this.instances.length){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.webGL_texture=this.runtime.glwrap.loadTexture(c.texture_img,!1,this.runtime.linearSampling,c.pixelformat)}this.updateAllCurrentTexture()}};k.loadTextures=function(){if(!this.is_family&&!this.has_loaded_textures&&this.runtime.glwrap){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];c.webGL_texture=this.runtime.glwrap.loadTexture(c.texture_img,
!1,this.runtime.linearSampling,c.pixelformat)}this.has_loaded_textures=!0}};k.unloadTextures=function(){if(!this.is_family&&!this.instances.length&&this.has_loaded_textures){var a;var b=0;for(a=this.all_frames.length;b<a;++b){var c=this.all_frames[b];this.runtime.glwrap.deleteTexture(c.webGL_texture);c.webGL_texture=null}this.has_loaded_textures=!1}};var m=[];k.preloadCanvas2D=function(a){var b;cr.clearArray(m);var c=0;for(b=this.all_frames.length;c<b;++c){var d=this.all_frames[c].texture_img;-1===
m.indexOf(d)&&(a.drawImage(d,0,0),m.push(d))}};n.Instance=function(a){this.type=a;this.runtime=a.runtime;a=this.type.animations[0].frames[0].poly_pts;this.recycled?this.collision_poly.set_pts(a):this.collision_poly=new cr.CollisionPoly(a)};var q=n.Instance.prototype;q.onCreate=function(){this.visible=0===this.properties[0];this.inAnimTrigger=this.isTicking=!1;this.collisionsEnabled=0!==this.properties[3];this.cur_animation=this.getAnimationByName(this.properties[1])||this.type.animations[0];this.cur_frame=
this.properties[2];0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);var a=this.cur_animation.frames[this.cur_frame];this.collision_poly.set_pts(a.poly_pts);this.hotspotX=a.hotspotX;this.hotspotY=a.hotspotY;this.cur_anim_speed=this.cur_animation.speed;this.cur_anim_repeatto=this.cur_animation.repeatto;1===this.type.animations.length&&1===this.type.animations[0].frames.length||0===this.cur_anim_speed||(this.runtime.tickMe(this),
this.isTicking=!0);this.recycled?this.animTimer.reset():this.animTimer=new cr.KahanAdder;this.frameStart=this.getNowTime();this.animPlaying=!0;this.animRepeats=0;this.animForwards=!0;this.changeAnimName=this.animTriggerName="";this.changeAnimFrom=0;this.changeAnimFrame=-1;this.type.loadTextures();var b,c;a=0;for(b=this.type.animations.length;a<b;a++){var d=this.type.animations[a];var e=0;for(c=d.frames.length;e<c;e++){var f=d.frames[e];0===f.width&&(f.width=f.texture_img.width,f.height=f.texture_img.height);
if(f.spritesheeted){var k=f.texture_img;var g=f.sheetTex;g.left=f.offx/k.width;g.top=f.offy/k.height;g.right=(f.offx+f.width)/k.width;g.bottom=(f.offy+f.height)/k.height;0===f.offx&&0===f.offy&&f.width===k.width&&f.height===k.height&&(f.spritesheeted=!1)}}}this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture};q.saveToJSON=function(){var a={a:this.cur_animation.sid,f:this.cur_frame,cas:this.cur_anim_speed,fs:this.frameStart,ar:this.animRepeats,at:this.animTimer.sum,
rt:this.cur_anim_repeatto};this.animPlaying||(a.ap=this.animPlaying);this.animForwards||(a.af=this.animForwards);return a};q.loadFromJSON=function(a){var b=this.getAnimationBySid(a.a);b&&(this.cur_animation=b);this.cur_frame=a.f;0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);this.cur_anim_speed=a.cas;this.frameStart=a.fs;this.animRepeats=a.ar;this.animTimer.reset();this.animTimer.sum=a.at;this.animPlaying=
a.hasOwnProperty("ap")?a.ap:!0;this.animForwards=a.hasOwnProperty("af")?a.af:!0;a.hasOwnProperty("rt")?this.cur_anim_repeatto=a.rt:this.cur_anim_repeatto=this.cur_animation.repeatto;this.curFrame=this.cur_animation.frames[this.cur_frame];this.curWebGLTexture=this.curFrame.webGL_texture;this.collision_poly.set_pts(this.curFrame.poly_pts);this.hotspotX=this.curFrame.hotspotX;this.hotspotY=this.curFrame.hotspotY};q.animationFinish=function(a){this.cur_frame=a?0:this.cur_animation.frames.length-1;this.animPlaying=
!1;this.animTriggerName=this.cur_animation.name;this.inAnimTrigger=!0;this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnyAnimFinished,this);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnAnimFinished,this);this.inAnimTrigger=!1;this.animRepeats=0};q.getNowTime=function(){return this.animTimer.sum};q.tick=function(){this.animTimer.add(this.runtime.getDt(this));this.changeAnimName.length&&this.doChangeAnim();0<=this.changeAnimFrame&&this.doChangeAnimFrame();var a=this.getNowTime(),
b=this.cur_animation,c=b.frames[this.cur_frame],d=c.duration/this.cur_anim_speed;this.animPlaying&&a>=this.frameStart+d&&(this.animForwards?this.cur_frame++:this.cur_frame--,this.frameStart+=d,this.cur_frame>=b.frames.length&&(b.pingpong?(this.animForwards=!1,this.cur_frame=b.frames.length-2):b.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=b.repeatcount?this.animationFinish(!1):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame&&(b.pingpong?(this.cur_frame=
1,this.animForwards=!0,b.loop||(this.animRepeats++,this.animRepeats>=b.repeatcount&&this.animationFinish(!0))):b.loop?this.cur_frame=this.cur_anim_repeatto:(this.animRepeats++,this.animRepeats>=b.repeatcount?this.animationFinish(!0):this.cur_frame=this.cur_anim_repeatto)),0>this.cur_frame?this.cur_frame=0:this.cur_frame>=b.frames.length&&(this.cur_frame=b.frames.length-1),a>this.frameStart+b.frames[this.cur_frame].duration/this.cur_anim_speed&&(this.frameStart=a),a=b.frames[this.cur_frame],this.OnFrameChanged(c,
a),this.runtime.redraw=!0)};q.getAnimationByName=function(a){var b;var c=0;for(b=this.type.animations.length;c<b;c++){var d=this.type.animations[c];if(cr.equals_nocase(d.name,a))return d}return null};q.getAnimationBySid=function(a){var b;var c=0;for(b=this.type.animations.length;c<b;c++){var d=this.type.animations[c];if(d.sid===a)return d}return null};q.doChangeAnim=function(){var a=this.cur_animation.frames[this.cur_frame],b=this.getAnimationByName(this.changeAnimName);this.changeAnimName="";!b||
cr.equals_nocase(b.name,this.cur_animation.name)&&this.animPlaying||(this.cur_animation=b,this.cur_anim_speed=b.speed,this.cur_anim_repeatto=b.repeatto,0>this.cur_frame&&(this.cur_frame=0),this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1),1===this.changeAnimFrom&&(this.cur_frame=0),this.animPlaying=!0,this.frameStart=this.getNowTime(),this.animForwards=!0,this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.runtime.redraw=!0)};q.doChangeAnimFrame=
function(){var a=this.cur_animation.frames[this.cur_frame],b=this.cur_frame;this.cur_frame=cr.floor(this.changeAnimFrame);0>this.cur_frame&&(this.cur_frame=0);this.cur_frame>=this.cur_animation.frames.length&&(this.cur_frame=this.cur_animation.frames.length-1);b!==this.cur_frame&&(this.OnFrameChanged(a,this.cur_animation.frames[this.cur_frame]),this.frameStart=this.getNowTime(),this.runtime.redraw=!0);this.changeAnimFrame=-1};q.OnFrameChanged=function(a,b){var c=a.width,d=a.height,e=b.width,f=b.height;
c!=e&&(this.width*=e/c);d!=f&&(this.height*=f/d);this.hotspotX=b.hotspotX;this.hotspotY=b.hotspotY;this.collision_poly.set_pts(b.poly_pts);this.set_bbox_changed();this.curFrame=b;this.curWebGLTexture=b.webGL_texture;c=0;for(d=this.behavior_insts.length;c<d;c++)if(e=this.behavior_insts[c],e.onSpriteFrameChanged)e.onSpriteFrameChanged(a,b);this.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnFrameChanged,this)};q.draw=function(a){a.globalAlpha=this.opacity;var b=this.curFrame,c=b.spritesheeted,
d=b.texture_img,e=this.x,f=this.y,k=this.width,g=this.height;if(0===this.angle&&0<=k&&0<=g)e-=this.hotspotX*k,f-=this.hotspotY*g,this.runtime.pixel_rounding&&(e=Math.round(e),f=Math.round(f)),c?a.drawImage(d,b.offx,b.offy,b.width,b.height,e,f,k,g):a.drawImage(d,e,f,k,g);else{this.runtime.pixel_rounding&&(e=Math.round(e),f=Math.round(f));a.save();var h=0<k?1:-1,l=0<g?1:-1;a.translate(e,f);1===h&&1===l||a.scale(h,l);a.rotate(this.angle*h*l);e=-(this.hotspotX*cr.abs(k));f=-(this.hotspotY*cr.abs(g));
c?a.drawImage(d,b.offx,b.offy,b.width,b.height,e,f,cr.abs(k),cr.abs(g)):a.drawImage(d,e,f,cr.abs(k),cr.abs(g));a.restore()}};q.drawGL_earlyZPass=function(a){this.drawGL(a)};q.drawGL=function(a){a.setTexture(this.curWebGLTexture);a.setOpacity(this.opacity);var b=this.curFrame,c=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,e=Math.round(this.y)-this.y;b.spritesheeted?a.quadTex(c.tlx+d,c.tly+e,c.trx+d,c.try_+e,c.brx+d,c.bry+e,c.blx+d,c.bly+e,b.sheetTex):a.quad(c.tlx+d,c.tly+
e,c.trx+d,c.try_+e,c.brx+d,c.bry+e,c.blx+d,c.bly+e)}else b.spritesheeted?a.quadTex(c.tlx,c.tly,c.trx,c.try_,c.brx,c.bry,c.blx,c.bly,b.sheetTex):a.quad(c.tlx,c.tly,c.trx,c.try_,c.brx,c.bry,c.blx,c.bly)};q.getImagePointIndexByName=function(a){var b=this.curFrame,c;var d=0;for(c=b.image_points.length;d<c;d++)if(cr.equals_nocase(a,b.image_points[d][0]))return d;return-1};q.getImagePoint=function(a,b){var c=this.curFrame,d=c.image_points;var e=cr.is_string(a)?this.getImagePointIndexByName(a):a-1;e=cr.floor(e);
if(0>e||e>=d.length)return b?this.x:this.y;a=(d[e][1]-c.hotspotX)*this.width;d=d[e][2];d=(d-c.hotspotY)*this.height;c=Math.cos(this.angle);e=Math.sin(this.angle);var f=a*c-d*e;d=d*c+a*e;a=f+this.x;d+=this.y;return b?a:d};var v=[],u=-2,y=[];f.prototype.OnCollision=function(a){if(!a)return!1;var b=this.runtime,f=b.getCurrentCondition(),k=f.type,g=null;f.extra.collmemory?g=f.extra.collmemory:(g={},f.extra.collmemory=g);f.extra.spriteCreatedDestroyCallback||(f.extra.spriteCreatedDestroyCallback=!0,b.addDestroyCallback(function(a){var b=
f.extra.collmemory;a=a.uid;var c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];if(d[0]===a||d[1]===a)h(b[c]),delete b[c]}}));var l=k.getCurrentSol(),m=a.getCurrentSol();l=l.getObjects();var w,n,A=this.runtime.tickcount,q=A-1,x=b.getCurrentEventStack().current_event;for(w=0;w<l.length;w++){var p=l[w];if(m.select_all){p.update_bbox();this.runtime.getCollisionCandidates(p.layer,a,p.bbox,y);var D=y;this.runtime.addRegisteredCollisionCandidates(p,a,D)}else D=m.getObjects();for(n=0;n<D.length;n++){var G=
D[n];if(b.testOverlap(p,G)||b.checkRegisteredCollision(p,G)){var v=c(g,p,G);v=!v||u<q;e(g,p,G,A);if(v){b.pushCopySol(x.solModifiers);v=k.getCurrentSol();var B=a.getCurrentSol();v.select_all=!1;B.select_all=!1;k===a?(v.instances.length=2,v.instances[0]=p,v.instances[1]=G,k.applySolToContainer()):(v.instances.length=1,B.instances.length=1,v.instances[0]=p,B.instances[0]=G,k.applySolToContainer(),a.applySolToContainer());x.retrigger();b.popSol(x.solModifiers)}}else d(g,p,G)}cr.clearArray(y)}return!1};
var B=null,x=new cr.ObjectSet,w=!1,A=[],D=new cr.rect(0,0,0,0);k.finish=function(a){if(w){if(a){var b=this.runtime.getCurrentEventStack().current_event.orblock;a=B.getCurrentSol();var c=x.valuesRef(),d;if(a.select_all){a.select_all=!1;cr.clearArray(a.instances);var e=0;for(d=c.length;e<d;++e)a.instances[e]=c[e];if(b)for(cr.clearArray(a.else_instances),e=0,d=B.instances.length;e<d;++e)c=B.instances[e],x.contains(c)||a.else_instances.push(c)}else if(b)for(b=a.instances.length,e=0,d=c.length;e<d;++e)a.instances[b+
e]=c[e],cr.arrayFindRemove(a.else_instances,c[e]);else cr.shallowAssignArray(a.instances,c);B.applySolToContainer()}x.clear();w=!1}};f.prototype.IsOverlapping=function(a){return b.call(this,a,0,0)};f.prototype.IsOverlappingOffset=function(a,c,d){return b.call(this,a,c,d)};f.prototype.IsAnimPlaying=function(a){return this.changeAnimName.length?cr.equals_nocase(this.changeAnimName,a):cr.equals_nocase(this.cur_animation.name,a)};f.prototype.CompareFrame=function(a,b){return cr.do_cmp(this.cur_frame,
a,b)};f.prototype.CompareAnimSpeed=function(a,b){return cr.do_cmp(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed,a,b)};f.prototype.OnAnimFinished=function(a){return cr.equals_nocase(this.animTriggerName,a)};f.prototype.OnAnyAnimFinished=function(){return!0};f.prototype.OnFrameChanged=function(){return!0};f.prototype.IsMirrored=function(){return 0>this.width};f.prototype.IsFlipped=function(){return 0>this.height};f.prototype.OnURLLoaded=function(){return!0};f.prototype.IsCollisionEnabled=
function(){return this.collisionsEnabled};n.cnds=new f;l.prototype.Spawn=function(a,b,c){if(a&&b&&(b=this.runtime.createInstance(a,b,this.getImagePoint(c,!0),this.getImagePoint(c,!1)))){"undefined"!==typeof b.angle&&(b.angle=this.angle,b.set_bbox_changed());this.runtime.isInOnDestroy++;var d;this.runtime.trigger(Object.getPrototypeOf(a.plugin).cnds.OnCreated,b);if(b.is_contained){var e=0;for(d=b.siblings.length;e<d;e++){var f=b.siblings[e];this.runtime.trigger(Object.getPrototypeOf(f.type.plugin).cnds.OnCreated,
f)}}this.runtime.isInOnDestroy--;e=this.runtime.getCurrentAction();c=!1;if(cr.is_undefined(e.extra.Spawn_LastExec)||e.extra.Spawn_LastExec<this.runtime.execcount)c=!0,e.extra.Spawn_LastExec=this.runtime.execcount;if(a!=this.type&&(a=a.getCurrentSol(),a.select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=b):a.instances.push(b),b.is_contained))for(e=0,d=b.siblings.length;e<d;e++)f=b.siblings[e],a=f.type.getCurrentSol(),a.select_all=!1,c?(cr.clearArray(a.instances),a.instances[0]=f):a.instances.push(f)}};
l.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};l.prototype.StopAnim=function(){this.animPlaying=!1};l.prototype.StartAnim=function(a){this.animPlaying=!0;this.frameStart=this.getNowTime();1===a&&0!==this.cur_frame&&(this.changeAnimFrame=0,this.inAnimTrigger||this.doChangeAnimFrame());this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};l.prototype.SetAnim=function(a,b){this.changeAnimName=
a;this.changeAnimFrom=b;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnim()};l.prototype.SetAnimFrame=function(a){this.changeAnimFrame=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0);this.inAnimTrigger||this.doChangeAnimFrame()};l.prototype.SetAnimSpeed=function(a){this.cur_anim_speed=cr.abs(a);this.animForwards=0<=a;this.isTicking||(this.runtime.tickMe(this),this.isTicking=!0)};l.prototype.SetAnimRepeatToFrame=function(a){a=Math.floor(a);
0>a&&(a=0);a>=this.cur_animation.frames.length&&(a=this.cur_animation.frames.length-1);this.cur_anim_repeatto=a};l.prototype.SetMirrored=function(a){a=cr.abs(this.width)*(0===a?-1:1);this.width!==a&&(this.width=a,this.set_bbox_changed())};l.prototype.SetFlipped=function(a){a=cr.abs(this.height)*(0===a?-1:1);this.height!==a&&(this.height=a,this.set_bbox_changed())};l.prototype.SetScale=function(a){var b=this.curFrame,c=b.width*a*(0>this.width?-1:1);a=b.height*a*(0>this.height?-1:1);if(this.width!==
c||this.height!==a)this.width=c,this.height=a,this.set_bbox_changed()};l.prototype.LoadURL=function(a,b,c){var d=new Image,e=this,f=this.curFrame;d.onload=function(){f.texture_img.src===d.src?e.runtime.glwrap&&e.curFrame===f&&(e.curWebGLTexture=f.webGL_texture):(f.texture_img=d,f.offx=0,f.offy=0,f.width=d.width,f.height=d.height,f.spritesheeted=!1,f.datauri="",f.pixelformat=0,e.runtime.glwrap&&(f.webGL_texture&&e.runtime.glwrap.deleteTexture(f.webGL_texture),f.webGL_texture=e.runtime.glwrap.loadTexture(d,
!1,e.runtime.linearSampling),e.curFrame===f&&(e.curWebGLTexture=f.webGL_texture),e.type.updateAllCurrentTexture()));0===b&&(e.width=d.width,e.height=d.height,e.set_bbox_changed());e.runtime.redraw=!0;e.runtime.trigger(cr.plugins_.Sprite.prototype.cnds.OnURLLoaded,e)};"data:"!==a.substr(0,5)&&0===c&&(d.crossOrigin="anonymous");this.runtime.setImageSrc(d,a)};l.prototype.SetCollisions=function(a){this.collisionsEnabled!==(0!==a)&&((this.collisionsEnabled=0!==a)?this.set_bbox_changed():(this.collcells.right>=
this.collcells.left&&this.type.collision_grid.update(this,this.collcells,null),this.collcells.set(0,0,-1,-1)))};n.acts=new l;p.prototype.AnimationFrame=function(a){a.set_int(this.cur_frame)};p.prototype.AnimationFrameCount=function(a){a.set_int(this.cur_animation.frames.length)};p.prototype.AnimationName=function(a){a.set_string(this.cur_animation.name)};p.prototype.AnimationSpeed=function(a){a.set_float(this.animForwards?this.cur_anim_speed:-this.cur_anim_speed)};p.prototype.ImagePointX=function(a,
b){a.set_float(this.getImagePoint(b,!0))};p.prototype.ImagePointY=function(a,b){a.set_float(this.getImagePoint(b,!1))};p.prototype.ImagePointCount=function(a){a.set_int(this.curFrame.image_points.length)};p.prototype.ImageWidth=function(a){a.set_float(this.curFrame.width)};p.prototype.ImageHeight=function(a){a.set_float(this.curFrame.height)};n.exps=new p})();cr.plugins_.TR_UltimateAds=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.TR_UltimateAds.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){if(this.isValidDevice()){this.isVideoLoaded=!1;this.debugData=this.errorMsg="";this.isShowingRewardInterstitial=this.isInterstitialLoaded=this.isShowingInterstitial=this.isBannerLoaded=this.isShowingBanner=
!1;var a=!!this.properties[8];this.bannerSize=this.runtime.isAndroid?this.properties[1]:this.properties[5];this.bannerAdUnit=this.runtime.isAndroid?this.properties[0]:this.properties[4];this.interstitialAdUnit=this.runtime.isAndroid?this.properties[2]:this.properties[6];this.rewardedVideoAdUnit=this.runtime.isAndroid?this.properties[3]:this.properties[7];switch(this.bannerSize){case 0:this.bannerSize="SMART";break;case 1:this.bannerSize="BANNER";break;case 2:this.bannerSize="MEDIUM_REC";break;case 3:this.bannerSize=
"LEADERBOARD"}if(a||!this.bannerAdUnit)this.bannerAdUnit="ca-app-pub-3940256099942544/6300978111";if(a||!this.interstitialAdUnit)this.interstitialAdUnit="ca-app-pub-3940256099942544/1033173712";if(a||!this.rewardedVideoAdUnit)this.rewardedVideoAdUnit=this.runtime.isAndroid?"ca-app-pub-3940256099942544/5224354917":"ca-app-pub-3940256099942544/1712485313";this.banner=window.Cocoon.Ad.createBanner(this.bannerAdUnit.trim(),this.bannerSize);this.interstitial=window.Cocoon.Ad.createInterstitial(this.interstitialAdUnit.trim());
this.rewardedVideo=window.Cocoon.Ad.createRewardedVideo(this.rewardedVideoAdUnit.trim());var c=this;this.banner.on("show",function(){c.isShowingBanner=!0;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnBannerShown,c)});this.banner.on("load",function(){c.isBannerLoaded=!0;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnBannerLoaded,c)});this.banner.on("click",function(){c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnBannerClicked,c)});this.banner.on("fail",
function(){c.isBannerLoaded=!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnBannerFailed,c)});this.banner.on("dismiss",function(){c.isShowingBanner=!1;c.isBannerLoaded=!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnBannerDismissed,c)});this.interstitial.on("show",function(){c.isShowingInterstitial=!0;c.isInterstitialLoaded=!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnInterstitialShown,c)});this.interstitial.on("load",function(){c.isInterstitialLoaded=
!0;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnInterstitialLoaded,c)});this.interstitial.on("click",function(){c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnInterstitialClicked,c)});this.interstitial.on("fail",function(){c.isInterstitialLoaded=!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnInterstitialFailed,c)});this.interstitial.on("dismiss",function(){c.isShowingInterstitial=!1;c.isInterstitialLoaded=!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnInterstitialDismissed,
c)});this.rewardedVideo.on("show",function(){c.isShowingRewardInterstitial=!0;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialShown,c)});this.rewardedVideo.on("load",function(){c.isVideoLoaded=!0;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialLoaded,c)});this.rewardedVideo.on("click",function(){c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialClicked,c)});this.rewardedVideo.on("fail",function(){c.isVideoLoaded=
!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialFailed,c)});this.rewardedVideo.on("dismiss",function(){c.isShowingRewardInterstitial=!1;c.isVideoLoaded=!1;c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialDismissed,c)});this.rewardedVideo.on("reward",function(a,d){c.isShowingRewardInterstitial=!1;c.isVideoLoaded=!1;d?(c.errorMsg=d,c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialStopped,c)):c.runtime.trigger(cr.plugins_.TR_UltimateAds.prototype.cnds.OnRewardInterstitialSucceeded,
c)})}};e.isValidDevice=function(){return(this.runtime.isAndroid||this.runtime.isiOS)&&!cr.is_undefined(window.Cocoon)};a.prototype.OnRewardInterstitialShown=function(){return!0};a.prototype.OnRewardInterstitialLoaded=function(){return!0};a.prototype.OnRewardInterstitialClicked=function(){return!0};a.prototype.OnRewardInterstitialFailed=function(){return!0};a.prototype.OnRewardInterstitialDismissed=function(){return!0};a.prototype.OnRewardInterstitialSucceeded=function(){return!0};a.prototype.OnRewardInterstitialStopped=
function(){return!0};a.prototype.IsShowingRewardInterstitial=function(){return this.isShowingRewardInterstitial};a.prototype.IsVideoLoaded=function(){return this.isVideoLoaded};a.prototype.OnBannerShown=function(){return!0};a.prototype.OnBannerLoaded=function(){return!0};a.prototype.OnBannerClicked=function(){return!0};a.prototype.OnBannerFailed=function(){return!0};a.prototype.OnBannerDismissed=function(){return!0};a.prototype.IsShowingBanner=function(){return this.isShowingBanner};a.prototype.IsBannerLoaded=
function(){return this.isBannerLoaded};a.prototype.OnInterstitialShown=function(){return!0};a.prototype.OnInterstitialLoaded=function(){return!0};a.prototype.OnInterstitialClicked=function(){return!0};a.prototype.OnInterstitialFailed=function(){return!0};a.prototype.OnInterstitialDismissed=function(){return!0};a.prototype.IsShowingInterstitial=function(){return this.isShowingInterstitial};a.prototype.IsInterstitialLoaded=function(){return this.isInterstitialLoaded};g.cnds=new a;f.prototype.ShowRewardInterstitial=
function(){this.isValidDevice()&&(this.isVideoLoaded?this.rewardedVideo.show():this.rewardedVideo.load())};f.prototype.LoadRewardInterstitial=function(){this.isValidDevice()&&this.rewardedVideo.load()};f.prototype.ShowBanner=function(){this.isValidDevice()&&(this.isBannerLoaded?(this.isShowingBanner=!0,this.banner.show()):this.banner.load())};f.prototype.HideBanner=function(){this.isValidDevice()&&this.isBannerLoaded&&(this.isShowingBanner=!1,this.banner.hide())};f.prototype.LoadBanner=function(){this.isValidDevice()&&
this.banner.load()};f.prototype.SetLayout=function(a){if(this.isValidDevice()){switch(a){case 0:var c="TOP_CENTER";break;case 1:c="BOTTOM_CENTER";break;case 2:c="CUSTOM"}this.banner.setLayout(c)}};f.prototype.SetPosition=function(a,c){this.isValidDevice()&&this.banner.setPosition(a,c)};f.prototype.ShowInterstitial=function(){this.isValidDevice()&&(this.isInterstitialLoaded?this.interstitial.show():this.interstitial.load())};f.prototype.LoadInterstitial=function(){this.isValidDevice()&&this.interstitial.load()};
g.acts=new f;h.prototype.LastError=function(a){a.set_any(this.errorMsg)};g.exps=new h})();cr.plugins_.Text=function(a){this.runtime=a};
(function(){function a(){return n.length?n.pop():{}}function f(a){var b;var c=0;for(b=a.length;c<b;c++)n.push(a[c]);cr.clearArray(a)}function h(a){return a.length&&" "===a.charAt(a.length-1)?a.substring(0,a.length-1):a}function g(){}function e(){}function d(){}var c=cr.plugins_.Text.prototype;c.onCreate=function(){c.acts.SetWidth=function(a){this.width!==a&&(this.width=a,this.text_changed=!0,this.set_bbox_changed())}};c.Type=function(a){this.plugin=a;this.runtime=a.runtime};var b=c.Type.prototype;
b.onCreate=function(){};b.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.mycanvas=null;c.myctx=null;c.mytex=null}}};c.Instance=function(a){this.type=a;this.runtime=a.runtime;this.recycled?cr.clearArray(this.lines):this.lines=[];this.text_changed=!0};b=c.Instance.prototype;var l={};b.onCreate=function(){this.text=this.properties[0];this.visible=0===this.properties[1];this.font=this.properties[2];this.color=this.properties[3];
this.halign=this.properties[4];this.valign=this.properties[5];this.wrapbyword=0===this.properties[7];this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.line_height_offset=this.properties[8];this.fontstyle=this.facename="";this.textHeight=this.textWidth=this.ptSize=0;this.parseFont();this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=new cr.rect(0,0,1,1);this.runtime.glwrap&&
this.runtime.tickMe(this)};b.parseFont=function(){var a=this.font.split(" "),b;for(b=0;b<a.length;b++)if("pt"===a[b].substr(a[b].length-2,2)){this.ptSize=parseInt(a[b].substr(0,a[b].length-2));this.pxHeight=Math.ceil(this.ptSize/72*96)+4;0<b&&(this.fontstyle=a[b-1]);this.facename=a[b+1];for(b+=2;b<a.length;b++)this.facename+=" "+a[b];break}};b.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,fn:this.facename,
fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,lrt:this.last_render_tick}};b.loadFromJSON=function(a){this.text=a.t;this.font=a.f;this.color=a.c;this.halign=a.ha;this.valign=a.va;this.wrapbyword=a.wr;this.line_height_offset=a.lho;this.facename=a.fn;this.fontstyle=a.fs;this.ptSize=a.ps;this.pxHeight=a.pxh;this.textWidth=a.tw;this.textHeight=a.th;this.last_render_tick=a.lrt;this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height};
b.tick=function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var a=this.layer;this.update_bbox();var b=this.bbox;if(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};b.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};b.updateFont=function(){this.font=
this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename;this.text_changed=!0;this.runtime.redraw=!0};b.draw=function(a,b){a.font=this.font;a.textBaseline="top";a.fillStyle=this.color;a.globalAlpha=b?1:this.opacity;if(b){var c=Math.abs(this.layer.getScale());a.save();a.scale(c,c)}if(this.text_changed||this.width!==this.lastwrapwidth)this.type.plugin.WordWrap(this.text,this.lines,a,this.width,this.wrapbyword),this.text_changed=!1,this.lastwrapwidth=this.width;this.update_bbox();c=b?0:this.bquad.tlx;
var d=b?0:this.bquad.tly;this.runtime.pixel_rounding&&(c=c+.5|0,d=d+.5|0);0===this.angle||b||(a.save(),a.translate(c,d),a.rotate(this.angle),d=c=0);var e=d+this.height,f=this.pxHeight;f+=this.line_height_offset;var g;1===this.valign?d+=Math.max(this.height/2-this.lines.length*f/2,0):2===this.valign&&(d+=Math.max(this.height-this.lines.length*f-2,0));for(g=0;g<this.lines.length;g++){var k=c;1===this.halign?k=c+(this.width-this.lines[g].width)/2:2===this.halign&&(k=c+(this.width-this.lines[g].width));
a.fillText(this.lines[g].text,k,d);d+=f;if(d>=e-f)break}(0!==this.angle||b)&&a.restore();this.last_render_tick=this.runtime.tickcount};b.drawGL=function(a){if(!(1>this.width||1>this.height)){var b=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var c=this.layer.getScale(),d=this.layer.getAngle(),e=this.rcTex,f=c*this.width,g=c*this.height,k=Math.ceil(f),h=Math.ceil(g),l=Math.abs(k),n=Math.abs(h),p=this.runtime.draw_width/2,r=this.runtime.draw_height/2;this.myctx||(this.mycanvas=
document.createElement("canvas"),this.mycanvas.width=l,this.mycanvas.height=n,this.lastwidth=l,this.lastheight=n,b=!0,this.myctx=this.mycanvas.getContext("2d"));if(l!==this.lastwidth||n!==this.lastheight)this.mycanvas.width=l,this.mycanvas.height=n,this.mytex&&(a.deleteTexture(this.mytex),this.mytex=null),b=!0;b&&(this.myctx.clearRect(0,0,l,n),this.draw(this.myctx,!0),this.mytex||(this.mytex=a.createEmptyTexture(l,n,this.runtime.linearSampling,this.runtime.isMobile)),a.videoToTexture(this.mycanvas,
this.mytex,this.runtime.isMobile));this.lastwidth=l;this.lastheight=n;a.setTexture(this.mytex);a.setOpacity(this.opacity);a.resetModelView();a.translate(-p,-r);a.updateModelView();var t=this.bquad;b=this.layer.layerToCanvas(t.tlx,t.tly,!0,!0);l=this.layer.layerToCanvas(t.tlx,t.tly,!1,!0);n=this.layer.layerToCanvas(t.trx,t.try_,!0,!0);p=this.layer.layerToCanvas(t.trx,t.try_,!1,!0);r=this.layer.layerToCanvas(t.brx,t.bry,!0,!0);var O=this.layer.layerToCanvas(t.brx,t.bry,!1,!0),P=this.layer.layerToCanvas(t.blx,
t.bly,!0,!0);t=this.layer.layerToCanvas(t.blx,t.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===d){var Q=(b+.5|0)-b,z=(l+.5|0)-l;b+=Q;l+=z;n+=Q;p+=z;r+=Q;O+=z;P+=Q;t+=z}0===this.angle&&0===d?(n=b+k,p=l,r=n,O=l+h,P=b,t=O,e.right=1,e.bottom=1):(e.right=f/k,e.bottom=g/h);a.quadTex(b,l,n,p,r,O,P,t,e);a.resetModelView();a.scale(c,c);a.rotateZ(-this.layer.getAngle());a.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);a.updateModelView();
this.last_render_tick=this.runtime.tickcount}};var p=[];c.TokeniseWords=function(a){cr.clearArray(p);for(var b="",c,d=0;d<a.length;)if(c=a.charAt(d),"\n"===c)b.length&&(p.push(b),b=""),p.push("\n"),++d;else if(" "===c||"\t"===c||"-"===c){do b+=a.charAt(d),d++;while(d<a.length&&(" "===a.charAt(d)||"\t"===a.charAt(d)));p.push(b);b=""}else d<a.length&&(b+=c,d++);b.length&&p.push(b)};var n=[];c.WordWrap=function(b,c,d,e,g){if(b&&b.length)if(2>=e)f(c);else{if(100>=b.length&&-1===b.indexOf("\n")){var k=
d.measureText(b).width;if(k<=e){f(c);c.push(a());c[0].text=b;c[0].width=k;return}}this.WrapText(b,c,d,e,g)}else f(c)};c.WrapText=function(b,c,d,e,f){f&&(this.TokeniseWords(b),b=p);var g="",k,l=0;for(k=0;k<b.length;k++)if("\n"===b[k]){l>=c.length&&c.push(a());g=h(g);var m=c[l];m.text=g;m.width=d.measureText(g).width;l++;g=""}else{var A=g;g+=b[k];m=d.measureText(g).width;m>=e&&(l>=c.length&&c.push(a()),A=h(A),m=c[l],m.text=A,m.width=d.measureText(A).width,l++,g=b[k],f||" "!==g||(g=""))}g.length&&(l>=
c.length&&c.push(a()),g=h(g),m=c[l],m.text=g,m.width=d.measureText(g).width,l++);for(k=l;k<c.length;k++)n.push(c[k]);c.length=l};g.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};c.cnds=new g;e.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.text!==a&&(this.text=a,this.text_changed=!0,this.runtime.redraw=!0)};e.prototype.AppendText=function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);if(a=a.toString())this.text+=
a,this.text_changed=!0,this.runtime.redraw=!0};e.prototype.SetFontFace=function(a,b){var c="";switch(b){case 1:c="bold";break;case 2:c="italic";break;case 3:c="bold italic"}if(a!==this.facename||c!==this.fontstyle)this.facename=a,this.fontstyle=c,this.updateFont()};e.prototype.SetFontSize=function(a){this.ptSize!==a&&(this.ptSize=a,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())};e.prototype.SetFontColor=function(a){a="rgb("+cr.GetRValue(a).toString()+","+cr.GetGValue(a).toString()+
","+cr.GetBValue(a).toString()+")";a!==this.color&&(this.color=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};e.prototype.SetWebFont=function(a,b){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var c=this,d=function(){c.runtime.redraw=!0;c.text_changed=!0};if(l.hasOwnProperty(b)){if(a="'"+a+"'",this.facename!==a)for(this.facename=a,this.updateFont(),a=1;10>a;a++)setTimeout(d,100*a),setTimeout(d,
1E3*a)}else{var e=document.createElement("link");e.href=b;e.rel="stylesheet";e.type="text/css";e.onload=d;document.getElementsByTagName("head")[0].appendChild(e);l[b]=!0;this.facename="'"+a+"'";this.updateFont();for(a=1;10>a;a++)setTimeout(d,100*a),setTimeout(d,1E3*a)}}};e.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};c.acts=new e;d.prototype.Text=function(a){a.set_string(this.text)};d.prototype.FaceName=
function(a){a.set_string(this.facename)};d.prototype.FaceSize=function(a){a.set_int(this.ptSize)};d.prototype.TextWidth=function(a){var b=0,c;var d=0;for(c=this.lines.length;d<c;d++){var e=this.lines[d].width;b<e&&(b=e)}a.set_int(b)};d.prototype.TextHeight=function(a){a.set_int(this.lines.length*(this.pxHeight+this.line_height_offset)-this.line_height_offset)};c.exps=new d})();cr.plugins_.TextBox=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.TextBox.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype,d="text password email number tel url".split(" ");-1<navigator.userAgent.indexOf("MSIE 9")&&(d[2]="text",d[3]="text",d[4]="text",d[5]="text");e.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Textbox plugin not supported on this platform - the object will not be created");
else{6===this.properties[7]?(this.elem=document.createElement("textarea"),jQuery(this.elem).css("resize","none")):(this.elem=document.createElement("input"),this.elem.type=d[this.properties[7]]);this.elem.id=this.properties[9];jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.elem.autocomplete="off";this.elem.value=this.properties[0];this.elem.placeholder=this.properties[1];this.elem.title=this.properties[2];this.elem.disabled=0===this.properties[4];this.elem.readOnly=
1===this.properties[5];this.elem.spellcheck=1===this.properties[6];this.autoFontSize=0!==this.properties[8];this.element_hidden=!1;0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var a=function(a){return function(){a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,a)}}(this);this.elem.oninput=a;-1!==navigator.userAgent.indexOf("MSIE")&&(this.elem.oncut=a);this.elem.onclick=function(a){return function(b){b.stopPropagation();a.runtime.isInUserInputEvent=
!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.ondblclick=function(a){return function(b){b.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnDoubleClicked,a);a.runtime.isInUserInputEvent=!1}}(this);this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1);this.elem.addEventListener("touchend",
function(a){a.stopPropagation()},!1);jQuery(this.elem).mousedown(function(a){a.stopPropagation()});jQuery(this.elem).mouseup(function(a){a.stopPropagation()});jQuery(this.elem).keydown(function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});jQuery(this.elem).keyup(function(a){13!==a.which&&27!=a.which&&a.stopPropagation()});this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)}};e.saveToJSON=function(){return{text:this.elem.value,
placeholder:this.elem.placeholder,tooltip:this.elem.title,disabled:!!this.elem.disabled,readonly:!!this.elem.readOnly,spellcheck:!!this.elem.spellcheck}};e.loadFromJSON=function(a){this.elem.value=a.text;this.elem.placeholder=a.placeholder;this.elem.title=a.tooltip;this.elem.disabled=a.disabled;this.elem.readOnly=a.readonly;this.elem.spellcheck=a.spellcheck};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=
function(a){if(!this.runtime.isDomFree){var b=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||b>=f||c>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):
(1>b&&(b=1),1>c&&(c=1),d>=f&&(d=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==b||this.lastTop!==c||this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||this.lastWinHeight!==g?(this.lastLeft=b,this.lastTop=c,this.lastRight=d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(b)+jQuery(this.runtime.canvas).offset().left,f=Math.round(c)+jQuery(this.runtime.canvas).offset().top,
jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-b)),jQuery(this.elem).height(Math.round(e-c)),this.autoFontSize&&jQuery(this.elem).css("font-size",this.layer.getScale(!0)/this.runtime.devicePixelRatio-.2+"em")):this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1))}};e.draw=function(a){};e.drawGL=function(a){};a.prototype.CompareText=function(a,b){return this.runtime.isDomFree?!1:0===b?cr.equals_nocase(this.elem.value,
a):this.elem.value===a};a.prototype.OnTextChanged=function(){return!0};a.prototype.OnClicked=function(){return!0};a.prototype.OnDoubleClicked=function(){return!0};g.cnds=new a;f.prototype.SetText=function(a){this.runtime.isDomFree||(this.elem.value=a)};f.prototype.SetPlaceholder=function(a){this.runtime.isDomFree||(this.elem.placeholder=a)};f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};
f.prototype.SetEnabled=function(a){this.runtime.isDomFree||(this.elem.disabled=0===a)};f.prototype.SetReadOnly=function(a){this.runtime.isDomFree||(this.elem.readOnly=0===a)};f.prototype.SetFocus=function(){this.runtime.isDomFree||this.elem.focus()};f.prototype.SetBlur=function(){this.runtime.isDomFree||this.elem.blur()};f.prototype.SetCSSStyle=function(a,b){this.runtime.isDomFree||jQuery(this.elem).css(a,b)};f.prototype.ScrollToBottom=function(){this.runtime.isDomFree||(this.elem.scrollTop=this.elem.scrollHeight)};
g.acts=new f;h.prototype.Text=function(a){this.runtime.isDomFree?a.set_string(""):a.set_string(this.elem.value)};g.exps=new h})();cr.plugins_.TiledBg=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.TiledBg.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};var e=g.Type.prototype;e.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.waitForImageLoad(this.texture_img,this.texture_file),this.webGL_texture=this.pattern=null)};e.onLostWebGLContext=function(){this.is_family||(this.webGL_texture=null)};e.onRestoreWebGLContext=function(){if(!this.is_family&&
this.instances.length){this.webGL_texture||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat));var a;var c=0;for(a=this.instances.length;c<a;c++)this.instances[c].webGL_texture=this.webGL_texture}};e.loadTextures=function(){this.is_family||this.webGL_texture||!this.runtime.glwrap||(this.webGL_texture=this.runtime.glwrap.loadTexture(this.texture_img,!0,this.runtime.linearSampling,this.texture_pixelformat))};e.unloadTextures=
function(){this.is_family||this.instances.length||!this.webGL_texture||(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};e.preloadCanvas2D=function(a){a.drawImage(this.texture_img,0,0)};g.Instance=function(a){this.type=a;this.runtime=a.runtime};e=g.Instance.prototype;e.onCreate=function(){this.visible=0===this.properties[0];this.rcTex=new cr.rect(0,0,0,0);this.has_own_texture=!1;this.texture_img=this.type.texture_img;this.runtime.glwrap?(this.type.loadTextures(),this.webGL_texture=
this.type.webGL_texture):(this.type.pattern||(this.type.pattern=this.runtime.ctx.createPattern(this.type.texture_img,"repeat")),this.pattern=this.type.pattern)};e.afterLoad=function(){this.has_own_texture=!1;this.texture_img=this.type.texture_img};e.onDestroy=function(){this.runtime.glwrap&&this.has_own_texture&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null)};e.draw=function(a){a.globalAlpha=this.opacity;a.save();a.fillStyle=this.pattern;var c=
this.x,b=this.y;this.runtime.pixel_rounding&&(c=Math.round(c),b=Math.round(b));var d=-(this.hotspotX*this.width),e=-(this.hotspotY*this.height),f=d%this.texture_img.width,g=e%this.texture_img.height;0>f&&(f+=this.texture_img.width);0>g&&(g+=this.texture_img.height);a.translate(c,b);a.rotate(this.angle);a.translate(f,g);a.fillRect(d-f,e-g,this.width,this.height);a.restore()};e.drawGL_earlyZPass=function(a){this.drawGL(a)};e.drawGL=function(a){a.setTexture(this.webGL_texture);a.setOpacity(this.opacity);
var c=this.rcTex;c.right=this.width/this.texture_img.width;c.bottom=this.height/this.texture_img.height;var b=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,e=Math.round(this.y)-this.y;a.quadTex(b.tlx+d,b.tly+e,b.trx+d,b.try_+e,b.brx+d,b.bry+e,b.blx+d,b.bly+e,c)}else a.quadTex(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly,c)};a.prototype.OnURLLoaded=function(){return!0};g.cnds=new a;f.prototype.SetEffect=function(a){this.blend_mode=a;this.compositeOp=cr.effectToCompositeOp(a);
cr.setGLBlend(this,a,this.runtime.gl);this.runtime.redraw=!0};f.prototype.LoadURL=function(a,c){var b=new Image,d=this;b.onload=function(){d.texture_img=b;d.runtime.glwrap?(d.has_own_texture&&d.webGL_texture&&d.runtime.glwrap.deleteTexture(d.webGL_texture),d.webGL_texture=d.runtime.glwrap.loadTexture(b,!0,d.runtime.linearSampling)):d.pattern=d.runtime.ctx.createPattern(b,"repeat");d.has_own_texture=!0;d.runtime.redraw=!0;d.runtime.trigger(cr.plugins_.TiledBg.prototype.cnds.OnURLLoaded,d)};"data:"!==
a.substr(0,5)&&0===c&&(b.crossOrigin="anonymous");this.runtime.setImageSrc(b,a)};g.acts=new f;h.prototype.ImageWidth=function(a){a.set_float(this.texture_img.width)};h.prototype.ImageHeight=function(a){a.set_float(this.texture_img.height)};g.exps=new h})();cr.plugins_.Touch=function(a){this.runtime=a};
(function(){function a(a){n=a.x;k=a.y;m=a.z}function f(a,b,c,d){var e=q.length?q.pop():new h;e.init(a,b,c,d);return e}function h(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function g(a){return a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||a.originalEvent&&a.originalEvent.sourceCapabilities&&a.originalEvent.sourceCapabilities.firesTouchEvents}function e(){}function d(){}
function c(){}var b=cr.plugins_.Touch.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};b.Type.prototype.onCreate=function(){};b.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.mouseDown=!1};var l=b.Instance.prototype,p={left:0,top:0};l.findTouch=function(a){var b;var c=0;for(b=this.touches.length;c<b;c++)if(this.touches[c].id===a)return c;return-1};var n=0,k=0,m=0,q=[];h.prototype.init=function(a,b,c,d){var e=cr.performance_now();this.starttime=this.lasttime=
this.time=e;this.startx=a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=c;this.startindex=d;this.tooFarForHold=this.triggeredHold=!1};h.prototype.update=function(a,b,c,d,e,f){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=c;this.width=d;this.height=e;this.pressure=f;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};h.prototype.maybeTriggerHold=function(a,
b){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnHoldGestureObject,a),a.getTouchIndex=0)};var v=-1E3,u=-1E3,y=-1E4;h.prototype.maybeTriggerTap=function(a,
b){if(!this.triggeredHold){var c=cr.performance_now();333>=c-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=c-y&&25>cr.distanceTo(v,u,this.x,this.y)?(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,a),u=v=-1E3,y=-1E4):(a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGesture,
a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,a),v=this.x,u=this.y,y=c),a.getTouchIndex=0)}};l.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_permission=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=
0!==this.properties[0];var b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,c=document;this.runtime.isDirectCanvas?c=b=window.Canvas:this.runtime.isCocoonJs&&(c=b=window);var d=this;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),b.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),c.addEventListener("pointerup",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("pointercancel",function(a){d.onPointerEnd(a,
!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",function(a){d.onPointerStart(a)},!1),b.addEventListener("MSPointerMove",
function(a){d.onPointerMove(a)},!1),c.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("MSPointerCancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(b.addEventListener("touchstart",function(a){d.onTouchStart(a)},!1),b.addEventListener("touchmove",function(a){d.onTouchMove(a)},
!1),c.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),c.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},f=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},g=Windows.Devices.Sensors.Accelerometer.getDefault();g&&(g.reportInterval=Math.max(g.minimumReportInterval,16),g.addEventListener("readingchanged",
e));var k=Windows.Devices.Sensors.Inclinometer.getDefault();k&&(k.reportInterval=Math.max(k.minimumReportInterval,16),k.addEventListener("readingchanged",f));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(g&&g.removeEventListener("readingchanged",e),k&&k.removeEventListener("readingchanged",f)):(g&&g.addEventListener("readingchanged",e),k&&k.addEventListener("readingchanged",f))},!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=
a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&(jQuery(document).mousemove(function(a){d.onMouseMove(a)}),jQuery(document).mousedown(function(a){d.onMouseDown(a)}),
jQuery(document).mouseup(function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this)};l.onPointerMove=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),c=cr.performance_now();if(0<=b){var d=this.runtime.isDomFree?p:jQuery(this.runtime.canvas).offset();
b=this.touches[b];2>c-b.time||b.update(c,a.pageX-d.left,a.pageY-d.top,a.width||0,a.height||0,a.pressure||0)}}};l.onPointerStart=function(a){if(a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.runtime.isDomFree?p:jQuery(this.runtime.canvas).offset(),c=a.pageX-b.left;b=a.pageY-b.top;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(f(c,b,a.pointerId,this.trigger_index));
this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=c;this.curTouchY=b;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this);this.runtime.isInUserInputEvent=!1}};l.onPointerEnd=function(a,b){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),a=this.findTouch(a.pointerId),
this.trigger_index=0<=a?this.touches[a].startindex:-1,this.trigger_id=0<=a?this.touches[a].id:-1,this.runtime.isInUserInputEvent=!0,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),0<=a&&(b||this.touches[a].maybeTriggerTap(this,a),100>q.length&&q.push(this.touches[a]),this.touches.splice(a,1)),this.runtime.isInUserInputEvent=!1)};l.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),
c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];var f=this.findTouch(e.identifier);if(0<=f){var g=this.runtime.isDomFree?p:jQuery(this.runtime.canvas).offset();f=this.touches[f];2>b-f.time||f.update(b,e.pageX-g.left,e.pageY-g.top,2*(e.radiusX||e.webkitRadiusX||e.mozRadiusX||e.msRadiusX||0),2*(e.radiusY||e.webkitRadiusY||e.mozRadiusY||e.msRadiusY||0),e.force||e.webkitForce||e.mozForce||e.msForce||0)}}};l.onTouchStart=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&
a.preventDefault();var b=this.runtime.isDomFree?p:jQuery(this.runtime.canvas).offset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];var g=this.findTouch(e.identifier);if(-1===g){g=e.pageX-b.left;var k=e.pageY-b.top;this.trigger_index=this.touches.length;this.trigger_id=e.identifier;this.touches.push(f(g,k,e.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchStart,
this);this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchStart,this);this.curTouchX=g;this.curTouchY=k;this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchObject,this)}}this.runtime.isInUserInputEvent=!1};l.onTouchEnd=function(a,b){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();this.runtime.isInUserInputEvent=!0;var c;var d=0;for(c=a.changedTouches.length;d<c;d++){var e=a.changedTouches[d];e=this.findTouch(e.identifier);0<=e&&(this.trigger_index=this.touches[e].startindex,
this.trigger_id=this.touches[e].id,this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnNthTouchEnd,this),this.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnTouchEnd,this),b||this.touches[e].maybeTriggerTap(this,e),100>q.length&&q.push(this.touches[e]),this.touches.splice(e,1))}this.runtime.isInUserInputEvent=!1};l.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==m?90*m:this.orient_alpha};l.getBeta=function(){return this.runtime.isCordova&&0===this.orient_beta&&
0!==k?90*k:this.orient_beta};l.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==n?90*n:this.orient_gamma};l.onMouseDown=function(a){g(a)||(this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!0)};l.onMouseMove=function(a){if(this.mouseDown&&!g(a))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};l.onMouseUp=function(a){a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();
this.runtime.had_a_click=!0;g(a)||(this.onTouchEnd({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]}),this.mouseDown=!1)};l.tick2=function(){var a,b=cr.performance_now();var c=0;for(a=this.touches.length;c<a;++c){var d=this.touches[c];d.time<=b-50&&(d.lasttime=b);d.maybeTriggerHold(this,c)}};e.prototype.OnTouchStart=function(){return!0};e.prototype.OnTouchEnd=function(){return!0};e.prototype.IsInTouch=function(){return this.touches.length};e.prototype.OnTouchObject=function(a){return a?
this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};var B=[];e.prototype.IsTouchingObject=function(a){if(!a)return!1;var b=a.getCurrentSol(),c=b.getObjects(),d,e;var f=0;for(d=c.length;f<d;f++){var g=c[f];g.update_bbox();var k=0;for(e=this.touches.length;k<e;k++){var h=this.touches[k];var l=g.layer.canvasToLayer(h.x,h.y,!0);h=g.layer.canvasToLayer(h.x,h.y,!1);if(g.contains_pt(l,h)){B.push(g);break}}}return B.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,
B),a.applySolToContainer(),cr.clearArray(B),!0):!1};e.prototype.CompareTouchSpeed=function(a,b,c){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var d=this.touches[a];a=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;var e=0;0<d&&(e=a/d);return cr.do_cmp(e,b,c)};e.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};e.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};e.prototype.CompareOrientation=
function(a,b,c){a=0===a?this.getAlpha():1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,c)};e.prototype.CompareAcceleration=function(a,b,c){var d=0;0===a?d=this.acc_g_x:1===a?d=this.acc_g_y:2===a?d=this.acc_g_z:3===a?d=this.acc_x:4===a?d=this.acc_y:5===a&&(d=this.acc_z);return cr.do_cmp(d,b,c)};e.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.OnNthTouchEnd=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.HasNthTouch=
function(a){a=Math.floor(a);return this.touches.length>=a+1};e.prototype.OnHoldGesture=function(){return!0};e.prototype.OnTapGesture=function(){return!0};e.prototype.OnDoubleTapGesture=function(){return!0};e.prototype.OnHoldGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnDoubleTapGestureObject=
function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnPermissionGranted=function(a){return this.trigger_permission===a};e.prototype.OnPermissionDenied=function(a){return this.trigger_permission===a};b.cnds=new e;d.prototype.RequestPermission=function(a){var b=this,c=Promise.resolve(!0);0===a?window.DeviceOrientationEvent&&window.DeviceOrientationEvent.requestPermission&&(c=window.DeviceOrientationEvent.requestPermission().then(function(a){return"granted"===
a})):window.DeviceMotionEvent&&window.DeviceMotionEvent.requestPermission&&(c=window.DeviceMotionEvent.requestPermission().then(function(a){return"granted"===a}));c.then(function(c){b.trigger_permission=a;c?b.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionGranted,b):b.runtime.trigger(cr.plugins_.Touch.prototype.cnds.OnPermissionDenied,b)})};b.acts=new d;c.prototype.TouchCount=function(a){a.set_int(this.touches.length)};c.prototype.X=function(a,b){var c=this.getTouchIndex;if(0>c||c>=
this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxX;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0));b.scale=d;b.zoomRate=e;b.parallaxX=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0)):a.set_float(0)};c.prototype.XAt=
function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,
this.touches[b].y,!0)):a.set_float(0)};c.prototype.XForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,
b.y,!0)):a.set_float(0)};c.prototype.Y=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxY;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1));b.scale=d;b.zoomRate=e;b.parallaxY=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?
a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1)):a.set_float(0)};c.prototype.YAt=function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):
this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};c.prototype.YForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):
this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};c.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};c.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};c.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};c.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):
a.set_float(0)};c.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};c.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};c.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0>=c?a.set_float(0):a.set_float(b/c)}};c.prototype.SpeedForID=
function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0>=c?a.set_float(0):a.set_float(b/c)}};c.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};c.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,
b.lasty,b.x,b.y))))};c.prototype.Alpha=function(a){a.set_float(this.getAlpha())};c.prototype.Beta=function(a){a.set_float(this.getBeta())};c.prototype.Gamma=function(a){a.set_float(this.getGamma())};c.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};c.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};c.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};c.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};c.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};
c.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};c.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};c.prototype.TouchID=function(a){a.set_float(this.trigger_id)};c.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};c.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};c.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};
b.exps=new c})();cr.plugins_.UserMedia=function(a){this.runtime=a};
(function(){function a(a){if(a)if(a.stop)a.stop();else{a=a.getTracks();for(var b=0,c=a.length;b<c;++b){var d=a[b];d.stop&&d.stop()}}}function f(){!r&&A&&(G=A.getVoices(),r=!0)}function h(){f();return G?G.length:0}function g(a){f();return!G||0>a||a>=G.length?null:G[a]}function e(){}function d(){}function c(){}var b=cr.plugins_.UserMedia.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};var l=b.Type.prototype;l.onCreate=function(){};l.onRestoreWebGLContext=function(){if(!this.is_family&&
this.instances.length){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.video_active&&0<=c.v.videoWidth&&0<=c.v.videoHeight&&(c.webGL_texture=this.runtime.glwrap.createEmptyTexture(c.v.videoWidth,c.v.videoHeight,this.runtime.linearSampling))}}};b.Instance=function(a){this.type=a;this.runtime=a.runtime};l=b.Instance.prototype;var p=!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia;window.URL||(window.URL=window.webkitURL||window.mozURL||window.msURL);var n=
[],k=[],m=!1,q=!(!window.webkitSpeechRecognition&&!window.speechRecognition),v=-1,u=null,y=null,B="",x=[],w="",A=window.speechSynthesis||window.webkitSpeechSynthesis||window.mozSpeechSynthesis||window.msSpeechSynthesis,D=window.SpeechSynthesisUtterance||window.webkitSpeechSynthesisUtterance||window.mozSpeechSynthesisUtterance||window.msSpeechSynthesisUtterance,G=null,r=!1;l.onCreate=function(){var a=this;if(this.v=document.createElement("video"))this.v.crossOrigin="anonymous",this.v.autoplay=!0,this.v.addEventListener("canplaythrough",
function(){a.video_active&&(a.video_ready=!0)});cr.setGLBlend(this,0,this.runtime.gl);this.audio_active=this.video_active=!1;this.media_stream=null;this.runtime.tickMe(this);this.snapshot_data="";this.webGL_texture=null;this.lastDecodedFrame=-1;this.video_ready=!1;this.viaCtx=this.viaCanvas=null;this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge;this.speechRecognition=null;this.interimTranscript=this.finalTranscript="";this.isRecognisingSpeech=!1;this.lastSpeechError="";if(this.runtime.isWinJS&&
!this.runtime.isWindows8Capable){var b=Windows.Devices.Sensors.LightSensor.getDefault();if(b){var c=b.minimumReportInterval;b.reportInterval=16<c?c:16;b.addEventListener("readingchanged",function(b){v=b.reading.illuminanceInLux;a.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeviceLight,a)})}}else window.addEventListener("devicelight",function(b){v=b.value;a.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeviceLight,a)})};l.onDestroy=function(){this.media_stream&&(a(this.media_stream),
this.media_stream=null,this.audio_active=this.video_ready=this.video_active=!1);this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null};l.tick=function(){this.video_active&&this.video_ready&&(this.runtime.redraw=!0)};l.draw=function(a){a.globalAlpha=this.opacity;a.save();a.fillStyle="#000";a.fillRect(this.x,this.y,this.width,this.height);if(this.video_active&&this.video_ready){var b=this.v.videoWidth/
this.v.videoHeight,c=this.width,d=this.height,e=0,f=0;if(c/d>b){var g=d*b;b=d;e=Math.floor((c-g)/2);0>e&&(e=0)}else g=c,b=c/b,f=Math.floor((d-b)/2),0>f&&(f=0);try{a.drawImage(this.v,this.x+e,this.y+f,g,b)}catch(M){}}a.restore()};l.drawGL=function(a){a.setBlend(this.srcBlend,this.destBlend);a.setOpacity(this.opacity);var b=this.bquad;a.setTexture(null);a.quad(b.tlx,b.tly,b.trx,b.try_,b.brx,b.bry,b.blx,b.bly);if(!(!this.video_active||!this.video_ready||0>=this.v.videoWidth||0>=this.v.videoHeight)){this.webGL_texture||
(this.webGL_texture=a.createEmptyTexture(this.v.videoWidth,this.v.videoHeight,this.runtime.linearSampling));b=this.v.webkitDecodedFrameCount||this.v.mozParsedFrames;var c=!1;b?b>this.lastDecodedFrame&&(c=!0,this.lastDecodedFrame=b):c=!0;c&&(this.useViaCanvasWorkaround?(this.viaCtx||(this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=this.v.videoWidth,this.viaCanvas.height=this.v.videoHeight,this.viaCtx=this.viaCanvas.getContext("2d")),this.viaCtx.drawImage(this.v,0,0),a.videoToTexture(this.viaCanvas,
this.webGL_texture)):a.videoToTexture(this.v,this.webGL_texture));c=this.v.videoWidth/this.v.videoHeight;var d=this.width,e=this.height,f=0,g=0;d/e>c?(b=e*c,c=e,f=Math.floor((d-b)/2),0>f&&(f=0)):(b=d,c=d/c,g=Math.floor((e-c)/2),0>g&&(g=0));d=this.x+f;g=this.y+g;b=d+b;c=g+c;a.setTexture(this.webGL_texture);a.quad(d,g,b,g,b,c,d,c)}};e.prototype.OnApproved=function(){return!0};e.prototype.OnDeclined=function(){return!0};e.prototype.SupportsUserMedia=function(){return p};e.prototype.SupportsSpeechRecognition=
function(){return q};e.prototype.OnSpeechRecognitionStart=function(){return!0};e.prototype.OnSpeechRecognitionEnd=function(){return!0};e.prototype.OnSpeechRecognitionError=function(){return!0};e.prototype.OnSpeechRecognitionResult=function(){return!0};e.prototype.IsRecognisingSpeech=function(){return this.isRecognisingSpeech};e.prototype.OnDeviceLight=function(){return!0};e.prototype.SupportsSpeechSynthesis=function(){return!!A&&!!D};e.prototype.IsSpeaking=function(){return A&&A.speaking};e.prototype.OnMediaSources=
function(){return!0};e.prototype.OnCanvasRecordingReady=function(){return!0};e.prototype.SupportsCanvasRecording=function(){return this.runtime.canvas&&this.runtime.canvas.captureStream&&"undefined"!==typeof MediaRecorder};e.prototype.IsCanvasRecordFormatSupported=function(a){a=0===a?"video/webm;codecs=vp8":"video/webm;codecs=vp9";return"undefined"===typeof MediaRecorder?!1:MediaRecorder.isTypeSupported?!!MediaRecorder.isTypeSupported(a):MediaRecorder.canRecordMimeType?!!MediaRecorder.canRecordMimeType(a):
!1};b.cnds=new e;d.prototype.RequestCamera=function(a,b,c){if(!m&&p){m=!0;var d=this;a=Math.floor(a);var e={};e.video=0>a||a>=k.length?{}:{deviceId:{exact:k[a].deviceId}};0<b&&0<c&&(e.video.width=Math.floor(b),e.video.height=Math.floor(c));navigator.mediaDevices.getUserMedia(e).then(function(a){d.media_stream=a;d.video_ready=!1;"undefined"!==typeof d.v.srcObject?d.v.srcObject=a:d.v.src=window.URL.createObjectURL(a);d.v.play();d.video_active=!0;m=!1;d.lastDecodedFrame=-1;d.runtime.glwrap&&d.webGL_texture&&
(d.runtime.glwrap.deleteTexture(d.webGL_texture),d.webGL_texture=null);d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnApproved,d)}).catch(function(a){m=!1;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeclined,d)})}};d.prototype.RequestMic=function(a,b){if(!m&&p){m=!0;var c=this;b=Math.floor(b);var d={};d.audio=0>b||b>=n.length?!0:{optional:[{deviceId:n[b].deviceId}]};navigator.mediaDevices.getUserMedia(d).then(function(b){c.media_stream=b;window.c2OnAudioMicStream&&window.c2OnAudioMicStream(b,
a);c.audio_active=!0;m=!1;c.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnApproved,c)}).catch(function(){m=!1;c.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnDeclined,c)})}};d.prototype.Stop=function(){this.media_stream&&(a(this.media_stream),this.media_stream=null,this.audio_active=this.video_ready=this.video_active=!1)};d.prototype.Snapshot=function(a,b){if(this.video_active&&this.video_ready){var c=document.createElement("canvas");c.width=this.v.videoWidth;c.height=this.v.videoHeight;
c.getContext("2d").drawImage(this.v,0,0,this.v.videoWidth,this.v.videoHeight);this.snapshot_data=c.toDataURL(0===a?"image/png":"image/jpeg",b/100)}};d.prototype.RequestSpeechRecognition=function(a,b,c){if(q){window.webkitSpeechRecognition?this.speechRecognition=new window.webkitSpeechRecognition:window.speechRecognition&&(this.speechRecognition=new window.speechRecognition);this.speechRecognition.lang=a;this.speechRecognition.continuous=0===b;this.speechRecognition.interimResults=0===c;this.isRecognisingSpeech=
!1;this.finalTranscript=this.interimTranscript="";var d=this;this.speechRecognition.onstart=function(){d.isRecognisingSpeech=!0;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionStart,d)};this.speechRecognition.onend=function(){d.isRecognisingSpeech=!1;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionEnd,d)};this.speechRecognition.onerror=function(a){d.isRecognisingSpeech=!1;d.lastSpeechError=a.error||"unknown";d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionError,
d)};this.speechRecognition.onresult=function(a){var b;d.interimTranscript="";for(b=a.resultIndex;b<a.results.length;++b)a.results[b].isFinal?d.finalTranscript+=a.results[b][0].transcript:d.interimTranscript+=a.results[b][0].transcript;d.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnSpeechRecognitionResult,d)};this.speechRecognition.start()}};d.prototype.StepSpeechRecognition=function(){this.speechRecognition&&(this.speechRecognition.stop(),this.speechRecognition=null)};d.prototype.SpeakText=
function(a,b,c,d,e,g){if(A&&D){a=new D(a);b&&(a.lang=b);if(c){a:{f();if(G){var k;b=0;for(k=G.length;b<k;++b){var h=G[b];if(h.voiceURI===c){b=h;break a}}}b=null}a.voice=b;a.voiceURI=c}c=Math.pow(10,d/20);0>c&&(c=0);1<c&&(c=1);a.volume=c;a.rate=e;a.pitch=g;A.speak(a)}};d.prototype.StopSpeaking=function(){A&&A.cancel()};d.prototype.PauseSpeaking=function(){A&&A.pause()};d.prototype.ResumeSpeaking=function(){A&&A.resume()};d.prototype.GetMediaSources=function(){var a=this;cr.clearArray(n);cr.clearArray(k);
var b=function(b){var c;var d=0;for(c=b.length;d<c;++d){var e=b[d];var f=e.kind;"audio"===f||"audioinput"===f?n.push(e):("video"===f||"videoinput"===f)&&k.push(e);a.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnMediaSources,a)}};navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(b):window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&window.MediaStreamTrack.getSources(b)};d.prototype.StartRecordingCanvas=function(b,c,d){if(!u&&
!y&&this.runtime.canvas&&this.runtime.canvas.captureStream&&"undefined"!==typeof window.MediaRecorder){y=0<d?this.runtime.canvas.captureStream(d):this.runtime.canvas.captureStream();cr.clearArray(x);B=0===b?"video/webm;codecs=vp8":"video/webm;codecs=vp9";var e=this;try{u=new window.MediaRecorder(y,{bitsPerSecond:1E3*c,mimeType:B})}catch(z){a(y);y=null;return}u.ondataavailable=function(a){x.push(a.data)};u.onerror=function(a){console.error("Recording error: ",a)};u.onwarning=function(a){console.warn("Recording warning: ",
a)};u.onstop=function(a){a=new Blob(x,{type:B});w&&URL.revokeObjectURL(w);w=URL.createObjectURL(a);e.runtime.trigger(cr.plugins_.UserMedia.prototype.cnds.OnCanvasRecordingReady,e)};window.setTimeout(function(){u.start()},100)}};d.prototype.StopRecordingCanvas=function(){u&&(u.stop(),u=null,a(y),y=null)};b.acts=new d;c.prototype.VideoWidth=function(a){a.set_int(this.v?this.v.videoWidth:0)};c.prototype.VideoHeight=function(a){a.set_int(this.v?this.v.videoHeight:0)};c.prototype.SnapshotURL=function(a){a.set_string(this.snapshot_data)};
c.prototype.FinalTranscript=function(a){a.set_string(this.finalTranscript)};c.prototype.InterimTranscript=function(a){a.set_string(this.interimTranscript)};c.prototype.SpeechError=function(a){a.set_string(this.lastSpeechError)};c.prototype.AmbientLux=function(a){a.set_float(v)};c.prototype.VoiceCount=function(a){a.set_int(h())};c.prototype.VoiceNameAt=function(a,b){b=Math.floor(b);b=g(b);a.set_string(b?b.name:"")};c.prototype.VoiceLangAt=function(a,b){b=Math.floor(b);b=g(b);a.set_string(b?b.lang:
"")};c.prototype.VoiceURIAt=function(a,b){b=Math.floor(b);b=g(b);a.set_string(b?b.voiceURI:"")};c.prototype.AudioSourceCount=function(a){a.set_int(n.length)};c.prototype.AudioSourceLabelAt=function(a,b){b=Math.floor(b);0>b||b>=n.length?a.set_string(""):a.set_string(n[b].label||"")};c.prototype.CameraSourceCount=function(a){a.set_int(k.length)};c.prototype.CameraSourceLabelAt=function(a,b){b=Math.floor(b);0>b||b>=k.length?a.set_string(""):a.set_string(k[b].label||"")};c.prototype.CameraSourceFacingAt=
function(a,b){b=Math.floor(b);0>b||b>=k.length?a.set_string(""):a.set_string(k[b].facing||k[b].facingMode||"")};c.prototype.CanvasRecordingURL=function(a){a.set_string(w)};b.exps=new c})();if(void 0===window)var window="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window;var __CONSTRUCT2_RUNTIME2__=!0,__CONSTRUCT3_RUNTIME2__=!1,__CONSTRUCT3_RUNTIME3__=!1,__DEBUG__=!1;cr.plugins_.ValerypopoffJSPlugin=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.ValerypopoffJSPlugin.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){function a(a,b){if(void 0===document)a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"'document' is not defined. You're probably launching the game in a Worker. Workers are not supported yet. Export project with 'Use worker' option unchecked in the 'Advanced' section of the 'Project properties' panel."});
else{var c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",b);c.onreadystatechange=function(){"complete"==this.readyState&&a.sciptsToLoad--};c.onload=function(){a.sciptsToLoad--};c.onerror=function(){a.ShowError({debug_caller:"Including '"+b+"' script to the page",caller_name:"Including '"+b+"' script to the page",error_message:"Probably file not found"})};document.getElementsByTagName("head")[0].appendChild(c)}}this.returnValue=void 0;this.sciptsToLoad=
0;this.Aliases={};this.construct_compare_function_prefix="ConstructCompare_";this.AliasDotpartsCache={count:0,max_count:4096,Dotparts:{},AliasNames:{},AliasTrailers:{},IsAlias:{}};this.NonAliasDotpartsCache={count:0,max_count:2048,Dotparts:{}};if(""!=this.properties[0]){var b=[];b=__CONSTRUCT2_RUNTIME2__?this.properties[0].split(";"):this.properties[0].split(/[;\n\r]/);for(var c=0;c<b.length;c++)if(b[c]=b[c].trim(),0!=b[c].length&&(this.sciptsToLoad++,__CONSTRUCT2_RUNTIME2__&&a(this,b[c]),__CONSTRUCT3_RUNTIME2__&&
a(this,this.runtime.getLocalFileUrl(b[c])),__CONSTRUCT3_RUNTIME3__)){var d=this;void 0!==d._runtime.GetAssetManager().LoadProjectFileUrl?d._runtime.GetAssetManager().LoadProjectFileUrl(b[c]).then(function(b){a(d,b)},function(a){d.ShowError({debug_caller:"Including '"+b[c]+"' script to the page",caller_name:"Including '"+b[c]+"' script to the page",error_message:a.message})}).catch(function(a){d.ShowError({debug_caller:"Including '"+b[c]+"' script to the page",caller_name:"Including '"+b[c]+"' script to the page",
error_message:a.message})}):a(d,d._runtime.GetAssetManager().GetLocalFileUrl(b[c]))}}};e.draw=function(a){};e.drawGL=function(a){};var d=function(a){for(var b=[],c=0,e=0,f=0,g=a.length;f<g;f++)"["==a[f]?c++:"]"==a[f]?e++:"."==a[f]&&c==e&&b.push(f);var h=[],l=b.length-1;b.forEach(function(c,d,e){e=a.substring(b[d-1]+1,c);""!=e&&h.push(e);d==l&&(e=a.substring(c+1),""!=e&&h.push(e))});0==h.length&&h.push(a);h.forEach(function(a,b,c){"["==a[0]&&(c[b]=d(a.substring(1,a.length-1)))});return h},c=function(a,
b){return a=a.replace(/#[0-9]+/g,function(a){a=b[a.substr(1)];return"string"===typeof a?"'"+a+"'":a})},b=function(a,b){a+="(";if(b)for(var c=0,d=b.length;c<d;++c)a="string"===typeof b[c]?a+"'"+b[c]+"'":a+b[c],c!=b.length-1&&(a+=",");return a+")"},l={Value:function(a,b){var c=b[0];b.splice(0,1);var d=this.ParseJS(c,!0,a);if(d.error)ret.set_any(void 0);else{var e=void 0;try{e=d.end}catch(u){this.ShowError({debug_caller:"Value",caller_name:a,"show-alias-expression":d.alias_found,alias_expression:d.trimmed_code,
error_message:u.message});ret.set_any(void 0);return}"function"==typeof d.end&&(e=this.CallJSfunction(c,b,!1,a,d));return e}},CallJSfunction:function(a,c,d,e,f){void 0===d&&(d=!0);void 0===e&&(e="'Call function' action");f=void 0===f?this.ParseJS(a,!0,e):f;if(!f.error)if(0<=a.indexOf("(")||0<=a.indexOf(")"))a={debug_caller:"CallJSfunction",caller_name:e,error_message:"'"+f.trimmed_code+"' must be a function name, not a function call. Remove parentheses."},f.alias_found&&(a["show-alias-expression"]=
!0,a.alias_expression=f.trimmed_code),this.ShowError(a);else{var g=void 0;try{g=f.end.apply(f.context,c)}catch(y){y instanceof TypeError&&0<=y.message.indexOf("apply")&&0<=y.message.indexOf("undefined")&&(y.message=a+" is undefined");a={debug_caller:"CallJSfunction",caller_name:e,error_message:y.message};f.alias_found?(a["show-alias-expression"]=!0,a.alias_expression=b(f.trimmed_code,c),a["show-code"]=!0,a.code=b(this.Aliases[f.alias_name].js+f.alias_trailer,c)):(a["show-code"]=!0,a.code=b(f.trimmed_code,
c));this.ShowError(a);return}d&&(this.returnValue=g);return g}},CallAlias:function(a,b,c,d){void 0===c&&(c=!0);void 0===d&&(d="'Call alias' action");a=this.ParseJS(a,!0,d);if(!a.error)return this.CallJSfunction(this.Aliases[a.alias_name].js+a.alias_trailer,b,c,d,a)},ShowError:function(a){var b="ValerypopoffJS plugin: Error in "+a.caller_name+"\n";b+="--------------------- \n";__DEBUG__&&(b+="DEBUG CALLER: "+a.debug_caller+"\n",b+="--------------------- \n");a["show-alias-expression"]&&(b+="Alias expression: "+
a.alias_expression+"\n",b+="--------------------- \n");a["show-code"]&&(b+="JS code: "+a.code+"\n",b+="--------------------- \n");b+=a.error_message;console.error(b)},Resolve:function(a,b,c,d,e){for(var f=window,g=f,h="",k=0,l=a.length;k<l;k++){h=a[k];if("object"==typeof h){h=this.Resolve(h,b,c,d,e);if(h.error)return{error:!0};h=h.end;try{g=g[h]}catch(A){return a={debug_caller:"Resolve",caller_name:b,error_message:A.message,"show-code":!0,code:c},d&&(a["show-alias-expression"]=!0,a.code=this.Aliases[d].js+
e,a.alias_expression=c),this.ShowError(a),{error:!0}}}else try{f==window?/^[$A-Z_][0-9A-Z_$]*$/i.test(h)?g=g[h]:("'"==h[0]&&(h=h.substring(1,h.length-1)),g=h):g=g[h]}catch(A){return a={debug_caller:"Resolve",caller_name:b,error_message:A.message,"show-code":!0,code:c},d&&(a["show-alias-expression"]=!0,a.code=this.Aliases[d].js+e,a.alias_expression=c),this.ShowError(a),{error:!0}}k<l-1&&(f=g)}return{error:!1,context:f,end:g,endname:h}},ParseJS:function(a,b,c){b=!1;var e=void 0,f=void 0;a=a.trim().replace(/\s*([\.\[\]])\s*/g,
"$1");var g=this.AliasDotpartsCache;if(g.Dotparts[a]){var h=g.Dotparts[a];g.IsAlias[a]&&(b=!0,e=g.AliasNames[a],f=g.AliasTrailers[a])}else{e=a.split(/[\.\[]/)[0];f=a.substring(e.length);this.Aliases[e]?(b=!0,h=f?d(this.Aliases[e].dotstring+f.split("[").join(".[")):d(this.Aliases[e].dotstring)):(f=e=void 0,h=d(a.split("[").join(".[")));if(g.count>=g.max_count)for(var k in g.Dotparts)if(delete g.Dotparts[k],g.IsAlias[k]&&(delete g.AliasNames[k],delete g.AliasTrailers[k],delete g.IsAlias[k]),g.count--,
g.count<=g.max_count)break;g.Dotparts[a]=h;b&&(g.AliasNames[a]=e,g.AliasTrailers[a]=f,g.IsAlias[a]=!0);g.count++}c=this.Resolve(h,c,a,e,f);return{error:c.error,end:c.end,endname:c.endname,context:c.context,trimmed_code:a,alias_found:b,alias_name:e,alias_trailer:f}}},p;for(p in l)e[p]=l[p];l={C2CompareFunctionReturnValue:function(a,b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareFunctionReturnValue.call(this,c,d,b,a)},C2CompareAliasCallReturnValue:function(a,
b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareAliasCallReturnValue.call(this,c,d,b,a)},C2CompareExecReturnWithParams:function(a,b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareExecReturnWithParams.call(this,c,d,b,a)},C2CompareValue:function(a,b,c,d){switch(b){case 2:b=4;break;case 3:b=5;break;case 4:b=2;break;case 5:b=3}return this.CNDS.CompareValue.call(this,c,d,b,a)},CompareExecReturnWithParams:function(a,
b,d,e){var f=void 0;b.length&&(a=c(a,b));try{f=eval(a)}catch(u){this.ShowError({debug_caller:"CompareExecReturnWithParams",caller_name:"'Compare JS code Completion value' condition",error_message:u.message,"show-code":!0,code:a});return}"boolean"===typeof f&&(f=f?1:0);return cr.do_cmp(f,d,e)},CompareFunctionReturnValue:function(a,b,c,d){a=this.CallJSfunction(a,b,!1,"'Compare Function return value' condition");"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,c,d)},CompareStoredReturnValue:function(a,
b){var c=this.returnValue;"boolean"===typeof c&&(c=c?1:0);return cr.do_cmp(c,a,b)},AllScriptsLoaded:function(){return 0>=this.sciptsToLoad?!0:!1},CompareValue:function(a,b,c,d){a=this.Value("'Compare Value' condition",[].concat(a,b));"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,c,d)},CompareAliasValue:function(a,b,c){var d=this.ParseJS(a,!0,"'Set alias' action");if(!d.alias_found)b={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition",error_message:"No such alias '"+a+"'"},
this.ShowError(b);else if(!d.error)if((a=d.context[this.construct_compare_function_prefix+d.endname])&&"object"==typeof d.context)try{return a.call(d.context,b,c)}catch(v){b={debug_caller:"CompareAliasValue",caller_name:"'Compare alias' condition","show-alias-expression":!0,alias_expression:d.trimmed_code,error_message:"Error in user defined '"+this.construct_compare_function_prefix+d.endname+"' function: "+v.message},this.ShowError(b)}else return d=d.end,"boolean"===typeof d&&(d=d?1:0),cr.do_cmp(d,
b,c)},CompareAliasCallReturnValue:function(a,b,c,d){a=this.CallAlias(a,b,!1,"'Compare Alias Call return value' condition");"boolean"===typeof a&&(a=a?1:0);return cr.do_cmp(a,c,d)}};for(p in l)a.prototype[p]=l[p];g.cnds=new a;l={ExecuteJSWithParams:function(a,b){this.returnValue=void 0;a=a.replace(/#[0-9]+/g,function(a){a=b[a.substr(1)];return"string"===typeof a?"'"+a+"'":a});try{this.returnValue=eval(a)}catch(m){this.ShowError({debug_caller:"ExecuteJSWithParams",caller_name:"'Execute JS code' action",
"show-code":!0,code:a,error_message:m.message})}},CallJSfunction:function(a,b,c,d,e){this.CallJSfunction(a,b,c,d,e)},SetValue:function(a,b){var c=this.ParseJS(a,!0,"'Set value' action");if(!c.error)try{c.context[c.endname]=b}catch(q){a+="=",this.ShowError({debug_caller:"SetValue",caller_name:"'Set value' action","show-alias-expression":c.alias_found,alias_expression:c.trimmed_code,"show-code":!0,code:"string"==typeof b?a+"'"+b+"'":a+b,error_message:q.message})}},Call:function(a,b,c,d){this.CallJSfunction(a,
b,!0,"'Call' action")},InitAlias:function(a,b){a=a.trim();b=b.trim();if(0==b.length)a={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Javascript string of alias '"+a+"' must not be empty."},this.ShowError(a);else if(0<=a.indexOf(".")||0<=a.indexOf("[")||0<=a.indexOf("]"))a={debug_caller:"InitAlias",caller_name:"'Init alias' action",error_message:"Alias name must not contain '.', '[' or ']' signs: '"+a+"'"},this.ShowError(a);else if(void 0!=this.Aliases[a])a={debug_caller:"InitAlias",
caller_name:"'Init alias' action",error_message:"Alias '"+a+"' already exists"},this.ShowError(a);else{var c={};c.js=b;c.dotstring=b.split("[").join(".[");this.Aliases[a]=c}},SetAlias:function(a,b){var c=this.ParseJS(a,!0,"'Set alias' action");if(!c.alias_found)b={debug_caller:"SetAlias",caller_name:"'Set alias' action",error_message:"No such alias '"+c.trimmed_code+"'"},this.ShowError(b);else if(!c.error)try{c.context[c.endname]=b}catch(q){a+="=",b={debug_caller:"SetAlias",caller_name:"'Set alias' action",
"show-alias-expression":!0,alias_expression:c.trimmed_code,"show-code":!0,code:"string"==typeof b?a+"'"+b+"'":a+b,error_message:q.message},this.ShowError(b)}},CallAlias:function(a,b,c,d){this.CallAlias(a,b,c,d)}};for(p in l)f.prototype[p]=l[p];g.acts=new f;l={JSCodeValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var d=0;d<a.length-1;d++)a[d]=a[d+
1];a.pop()}d=a[0];a.splice(0,1);a.length&&(d=c(d,a));a=void 0;try{a=eval(d)}catch(q){this.ShowError({debug_caller:"JSCodeValue",caller_name:"'JSCodeValue' expression","show-code":!0,code:d,error_message:q.message});b.set_any(void 0);return}if("boolean"==typeof a){if(b.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(b.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},StoredReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},
set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}if("boolean"===typeof this.returnValue){if(b.set_any(this.returnValue?1:0),__CONSTRUCT3_RUNTIME3__)return this.returnValue?1:0}else if(b.set_any(this.returnValue),__CONSTRUCT3_RUNTIME3__)return this.returnValue},FunctionReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},
set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}c=a[0];var d=this.ParseJS(c,!1,"'FunctionReturnValue' expression");a.splice(0,1);if(d.error)b.set_any(void 0);else{var e=void 0;e=this.CallJSfunction(c,a,!1,"'FunctionReturnValue' expression",d);if("boolean"===typeof e){if(b.set_any(e?1:0),__CONSTRUCT3_RUNTIME3__)return e?1:0}else if(b.set_any(e),__CONSTRUCT3_RUNTIME3__)return e}},Value:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b=
{set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}a=this.Value("'Value' expression",a);if("boolean"===typeof a){if(b.set_any(a?1:0),__CONSTRUCT3_RUNTIME3__)return a?1:0}else if(b.set_any(a),__CONSTRUCT3_RUNTIME3__)return a},AliasValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};
else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}a=this.ParseJS(a[0],!0,"'AliasValue' expression");if(a.alias_found)if(a.error)b.set_any(void 0);else{c=void 0;try{c=a.end}catch(q){a={debug_caller:"AliasValue",caller_name:"'AliasValue' expression","show-alias-expression":!0,alias_expression:a.trimmed_code,error_message:q.message};this.ShowError(a);b.set_any(void 0);return}if("boolean"===typeof c){if(b.set_any(c?1:0),__CONSTRUCT3_RUNTIME3__)return c?1:0}else if(b.set_any(c),__CONSTRUCT3_RUNTIME3__)return c}else a=
{debug_caller:"AliasValue",caller_name:"'AliasValue' expression",error_message:"No such alias '"+a.trimmed_code+"'"},this.ShowError(a),b.set_any(void 0)},AliasCallReturnValue:function(){var a=Array.prototype.slice.call(arguments);if(__CONSTRUCT3_RUNTIME3__)var b={set_int:function(){},set_float:function(){},set_string:function(){},set_any:function(){}};else{b=a[0];for(var c=0;c<a.length-1;c++)a[c]=a[c+1];a.pop()}c=a[0];var d=this.ParseJS(c,!0,"'AliasCallValue' expression");a.splice(0,1);if(d.alias_found)if(d.error)b.set_any(void 0);
else{var e=void 0;e=this.CallJSfunction(c,a,!1,"'AliasCallValue' expression",d);if("boolean"===typeof e){if(b.set_any(e?1:0),__CONSTRUCT3_RUNTIME3__)return e?1:0}else if(b.set_any(e),__CONSTRUCT3_RUNTIME3__)return e}else this.ShowError({debug_caller:"AliasCallValue",caller_name:"'AliasCallValue' expression",error_message:"No such alias '"+d.trimmed_code+"'"}),b.set_any(void 0)}};for(p in l)h.prototype[p]=l[p];g.exps=new h;e.EXPS=g.exps;e.CNDS=g.cnds;e.ACTS=g.acts})();
function flood_fill(a,f,h,g,e,d){function c(b){return q==a[b]&&v==a[b+1]&&u==a[b+2]}function b(b){a[b]=p;a[b+1]=n;a[b+2]=k;a[b+3]=255}function l(a){c(m+4*a)?B[a]||(y.push([g+a,e]),B[a]=!0):B[a]&&(B[a]=!1)}if(!(0>g||g>f||0>e||e>h)){d=$("<div></div>").css("background-color",d).css("background-color");"transparent"==d&&(d="rgb(0,0,0)");d=d.slice(4,-1).split(",");var p=d[0],n=d[1],k=d[2],m=4*(e*f+g),q=a[m],v=a[m+1],u=a[m+2];if(p!=q||n!=v||k!=u)for(var y=[[g,e]];y.length;){d=y.pop();g=d[0];e=d[1];for(m=
4*(e*f+g);0<=e--&&c(m);)m-=4*f;m+=4*f;++e;var B=[];B[-1]=!1;for(B[1]=!1;e++<h-1&&c(m);)b(m),0<g&&l(-1),g<f-1&&l(1),m+=4*f}}}cr.plugins_.c2canvas=function(a){this.runtime=a};
(function(){var a=cr.plugins_.c2canvas.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){this.is_family||(this.texture_img=new Image,this.texture_img.src=this.texture_file,this.texture_img.cr_filesize=this.texture_filesize,this.runtime.wait_for_textures.push(this.texture_img))};a.Instance=function(a){this.type=a;this.runtime=a.runtime};var f=a.Instance.prototype,h="lighter xor copy destination-over source-in destination-in source-out destination-out source-atop destination-atop".split(" ");
f.effectToCompositeOp=function(a){return 0>=a||11<=a?"source-over":h[a-1]};f.updateBlend=function(a){var e=this.runtime.gl;if(e)switch(this.srcBlend=e.ONE,this.destBlend=e.ONE_MINUS_SRC_ALPHA,a){case 1:this.destBlend=this.srcBlend=e.ONE;break;case 3:this.srcBlend=e.ONE;this.destBlend=e.ZERO;break;case 4:this.srcBlend=e.ONE_MINUS_DST_ALPHA;this.destBlend=e.ONE;break;case 5:this.srcBlend=e.DST_ALPHA;this.destBlend=e.ZERO;break;case 6:this.srcBlend=e.ZERO;this.destBlend=e.SRC_ALPHA;break;case 7:this.srcBlend=
e.ONE_MINUS_DST_ALPHA;this.destBlend=e.ZERO;break;case 8:this.srcBlend=e.ZERO;this.destBlend=e.ONE_MINUS_SRC_ALPHA;break;case 9:this.srcBlend=e.DST_ALPHA;this.destBlend=e.ONE_MINUS_SRC_ALPHA;break;case 10:this.srcBlend=e.ONE_MINUS_DST_ALPHA,this.destBlend=e.SRC_ALPHA}};f.onCreate=function(){this.visible=0===this.properties[0];this.compositeOp=this.effectToCompositeOp(this.properties[1]);this.updateBlend(this.properties[1]);this.canvas=document.createElement("canvas");this.canvas.width=this.width;
this.canvas.height=this.height;this.ctx=this.canvas.getContext("2d");this.ctx.drawImage(this.type.texture_img,0,0,this.width,this.height);this.tCanvas=document.createElement("canvas");this.tCtx=this.tCanvas.getContext("2d");this.update_tex=!0;this.rcTex=new cr.rect(0,0,0,0)};f.onDestroy=function(){};f.saveToJSON=function(){return{canvas_w:this.canvas.width,canvas_h:this.canvas.height,image:this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data}};f.loadFromJSON=function(a){for(var e=
this.canvas.width=a.canvas_w,d=this.canvas.height=a.canvas_h,c=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data,b=0;b<d;++b)for(var f=0;f<e;++f)for(var g=4*(b*e+f),h=0;4>h;++h)c[g+h]=a.image[g+h]};f.draw_instances=function(a,e){for(var d in a)if(0!=a[d].visible||0!=this.runtime.testOverlap(this,a[d]))e.save(),e.scale(this.canvas.width/this.width,this.canvas.height/this.height),e.rotate(-this.angle),e.translate(-this.bquad.tlx,-this.bquad.tly),e.globalCompositeOperation=a[d].compositeOp,
void 0!==a[d].type.pattern&&void 0!==a[d].type.texture_img&&(a[d].pattern=e.createPattern(a[d].type.texture_img,"repeat")),a[d].draw(e),e.restore()};f.draw=function(a){a.save();a.globalAlpha=this.opacity;a.globalCompositeOperation=this.compositeOp;var e=this.x,d=this.y;this.runtime.pixel_rounding&&(e=Math.round(e),d=Math.round(d));a.translate(e,d);a.rotate(this.angle);a.drawImage(this.canvas,-(this.hotspotX*this.width),-(this.hotspotY*this.height),this.width,this.height);a.restore()};f.drawGL=function(a){a.setBlend(this.srcBlend,
this.destBlend);this.update_tex&&(this.tex&&a.deleteTexture(this.tex),this.tex=a.loadTexture(this.canvas,!1,this.runtime.linearSampling),this.update_tex=!1);a.setTexture(this.tex);a.setOpacity(this.opacity);var e=this.bquad;if(this.runtime.pixel_rounding){var d=Math.round(this.x)-this.x,c=Math.round(this.y)-this.y;a.quad(e.tlx+d,e.tly+c,e.trx+d,e.try_+c,e.brx+d,e.bry+c,e.blx+d,e.bly+c)}else a.quad(e.tlx,e.tly,e.trx,e.try_,e.brx,e.bry,e.blx,e.bly)};a.cnds={};a.acts={};f=a.acts;f.SetEffect=function(a){this.compositeOp=
this.effectToCompositeOp(a);this.update_tex=this.runtime.redraw=!0};f.DrawPoint=function(a,e,d){var c=this.ctx;c.fillStyle=d;c.fillRect(a,e,1,1);this.update_tex=this.runtime.redraw=!0};f.ResizeCanvas=function(a,e){this.canvas.width=a;this.canvas.height=e;this.update_tex=this.runtime.redraw=!0};f.PasteObject=function(a){var e=this.ctx;this.update_bbox();a=a.getCurrentSol();this.draw_instances(a.select_all?a.type.instances:a.instances,e);this.update_tex=this.runtime.redraw=!0};f.PasteLayer=function(a){if(!a||
!a.visible)return!1;var e=this.ctx;this.update_bbox();this.tCanvas.width=this.canvas.width;this.tCanvas.height=this.canvas.height;var d=this.tCtx;d.clearRect(0,0,this.tCanvas.width,this.tCanvas.height);this.draw_instances(a.instances,d);e.drawImage(this.tCanvas,0,0,this.width,this.height);this.update_tex=this.runtime.redraw=!0};f.DrawBox=function(a,e,d,c,b){this.ctx.fillStyle=b;this.ctx.fillRect(a,e,d,c);this.update_tex=this.runtime.redraw=!0};f.DrawLine=function(a,e,d,c,b,f){var g=this.ctx;g.strokeStyle=
b;g.lineWidth=f;g.beginPath();g.moveTo(a,e);g.lineTo(d,c);g.stroke();this.update_tex=this.runtime.redraw=!0};f.ClearCanvas=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.update_tex=this.runtime.redraw=!0};f.FillColor=function(a){this.ctx.fillStyle=a;this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);this.update_tex=this.runtime.redraw=!0};f.fillGradient=function(a,e,d){var c=this.ctx,b=this.canvas.width,f=this.canvas.height;switch(a){case 0:var g=c.createLinearGradient(0,
0,b,0);break;case 1:g=c.createLinearGradient(0,0,0,f);break;case 2:g=c.createLinearGradient(0,0,b,f);break;case 3:g=c.createLinearGradient(b,0,0,f);break;case 4:g=c.createRadialGradient(b/2,f/2,0,b/2,f/2,Math.sqrt(b*b+f*f)/2)}try{g.addColorStop(0,e)}catch(n){g.addColorStop(0,"black")}try{g.addColorStop(1,d)}catch(n){g.addColorStop(1,"black")}this.ctx.fillStyle=g;this.ctx.fillRect(0,0,b,f);this.update_tex=this.runtime.redraw=!0};f.beginPath=function(){this.ctx.beginPath()};f.drawPath=function(a,e){var d=
this.ctx;d.strokeStyle=a;d.lineWidth=e;d.stroke();this.update_tex=this.runtime.redraw=!0};f.setLineSettings=function(a,e){var d=this.ctx;d.lineCap=["butt","round","square"][a];d.lineJoin=["round","bevel","milet"][e]};f.fillPath=function(a){this.ctx.fillStyle=a;this.ctx.fill();this.update_tex=this.runtime.redraw=!0};f.moveTo=function(a,e){this.ctx.moveTo(a,e)};f.lineTo=function(a,e){this.ctx.lineTo(a,e)};f.arc=function(a,e,d,c,b,f){this.ctx.arc(a,e,d,cr.to_radians(c),cr.to_radians(b),1==f)};f.drawCircle=
function(a,e,d,c,b){var f=this.ctx;f.strokeStyle=c;f.lineWidth=b;f.beginPath();f.arc(a,e,d,0,cr.to_radians(360),!0);f.stroke();this.update_tex=this.runtime.redraw=!0};f.bezierCurveTo=function(a,e,d,c,b,f){this.ctx.bezierCurveTo(a,e,d,c,b,f)};f.quadraticCurveTo=function(a,e,d,c){this.ctx.quadraticCurveTo(a,e,d,c)};f.rectPath=function(a,e,d,c){this.ctx.rect(a,e,d,c)};f.FloodFill=function(a,e,d){var c=this.ctx,b=c.getImageData(0,0,this.canvas.width,this.canvas.height);flood_fill(b.data,this.canvas.width,
this.canvas.height,a,e,d);c.putImageData(b,0,0);this.update_tex=this.runtime.redraw=!0};f.setLineDash=function(a,e){this.ctx.setLineDash([a,e])};a.exps={};a=a.exps;a.rgbaAt=function(a,e,d){e=this.ctx.getImageData(e,d,1,1).data;a.set_string("rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]/255+")")};a.redAt=function(a,e,d){e=this.ctx.getImageData(e,d,1,1).data;a.set_int(e[0])};a.greenAt=function(a,e,d){e=this.ctx.getImageData(e,d,1,1).data;a.set_int(e[1])};a.blueAt=function(a,e,d){e=this.ctx.getImageData(e,
d,1,1).data;a.set_int(e[2])};a.alphaAt=function(a,e,d){e=this.ctx.getImageData(e,d,1,1).data;a.set_int(100*e[3]/255)};a.imageUrl=function(a){a.set_string(this.canvas.toDataURL())};a.AsJSON=function(a){a.set_string(JSON.stringify({c2array:!0,size:[1,1,this.canvas.width*this.canvas.height*4],data:[[this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data]]}))}})();cr.plugins_.filechooser=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}function g(a,c){if(!a)return null;c=Math.floor(c);return 0>c||c>=a.length?null:a[c]}var e=cr.plugins_.filechooser.prototype;e.Type=function(a){this.plugin=a;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a){this.type=a;this.runtime=a.runtime};var d=e.Instance.prototype,c=window.URL||window.webkitURL||window.mozURL||window.msURL;d.onCreate=function(){if(this.runtime.isDomFree)cr.logexport("[Construct 2] File Chooser plugin not supported on this platform - the object will not be created");
else{this.elem=document.createElement("input");this.elem.type="file";this.elem.setAttribute("accept",this.properties[0]);0!==this.properties[1]&&this.elem.setAttribute("multiple","");this.elem.id=this.properties[3];jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");this.element_hidden=!1;0===this.properties[2]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0);var a=this;this.elem.onchange=function(){a.runtime.trigger(cr.plugins_.filechooser.prototype.cnds.OnChanged,
a)};this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0;this.updatePosition(!0);this.runtime.tickMe(this)}};d.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};d.tick=function(){this.updatePosition()};d.updatePosition=function(a){if(!this.runtime.isDomFree){var b=this.layer.layerToCanvas(this.x,this.y,!0),c=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||b>=f||c>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>b&&(b=1),1>c&&(c=1),d>=f&&(d=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==b||this.lastTop!==c||this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||
this.lastWinHeight!==g?(this.lastLeft=b,this.lastTop=c,this.lastRight=d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(b)+jQuery(this.runtime.canvas).offset().left,f=Math.round(c)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-b)),jQuery(this.elem).height(Math.round(e-c))):this.element_hidden&&
(jQuery(this.elem).show(),this.element_hidden=!1))}};d.draw=function(a){};d.drawGL=function(a){};a.prototype.OnChanged=function(){return!0};e.cnds=new a;f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetCSSStyle=function(a,c){this.runtime.isDomFree||jQuery(this.elem).css(a,c)};f.prototype.ReleaseFile=function(a){!this.runtime.isDomFree&&c&&c.revokeObjectURL&&c.revokeObjectURL(a)};e.acts=new f;h.prototype.FileCount=function(a){a.set_int(this.runtime.isDomFree?
0:this.elem.files.length||0)};h.prototype.FileNameAt=function(a,c){c=this.runtime.isDomFree?null:g(this.elem.files,c);a.set_string(c?c.name||"":"")};h.prototype.FileSizeAt=function(a,c){c=this.runtime.isDomFree?null:g(this.elem.files,c);a.set_int(c?c.size||0:0)};h.prototype.FileTypeAt=function(a,c){c=this.runtime.isDomFree?null:g(this.elem.files,c);a.set_string(c?c.type||"":"")};h.prototype.FileURLAt=function(a,d){(d=this.runtime.isDomFree?null:g(this.elem.files,d))?d.c2url?a.set_string(d.c2url):
c&&c.createObjectURL?(d.c2url=c.createObjectURL(d),a.set_string(d.c2url)):a.set_string(""):a.set_string("")};e.exps=new h})();cr.plugins_.pix_dialogs=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.pix_dialogs.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){self=this;self.currID;self.getValue};e.onDestroy=function(){};e.saveToJSON=function(){return{}};e.loadFromJSON=function(a){};e.draw=function(a){};e.drawGL=function(a){};a.prototype.dialogConfirmed=function(a){return self.currID==
a?!0:!1};a.prototype.dialogCancelled=function(a){return self.currID==a?!0:!1};g.cnds=new a;f.prototype.openDialog=function(a,c,b,e){self.currID=c;var d;0==a?d=confirm(b):1==a?d=prompt(b,e):2==a&&alert(b);0==a&&1==d?self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self):2==a?self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self):null!==d&&!1!==d?(self.getValue=d,self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,self)):
self.runtime.trigger(cr.plugins_.pix_dialogs.prototype.cnds.dialogCancelled,self)};g.acts=new f;h.prototype.getValue=function(a){a.set_any(self.getValue)};g.exps=new h})();cr.plugins_.progressbar=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.progressbar.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Progress Bar plugin not supported on this platform - the object will not be created"):(this.elem=document.createElement("progress"),this.value=this.properties[0],
this.max=this.properties[1],0<this.max&&0<=this.value&&(this.elem.max=this.max,this.elem.value=this.value),this.elem.id=this.properties[4],this.elem.title=this.properties[2],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.element_hidden=!1,0===this.properties[3]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.elem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.progressbar.prototype.cnds.OnClicked,
a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchend",function(a){a.stopPropagation()},!1),jQuery(this.elem).mousedown(function(a){a.stopPropagation()}),jQuery(this.elem).mouseup(function(a){a.stopPropagation()}),this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0,this.updatePosition(!0),
this.runtime.tickMe(this))};e.saveToJSON=function(){return{v:this.elem.value,m:this.elem.max}};e.loadFromJSON=function(a){this.elem.value=a.v;this.elem.max=a.m};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),b=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||c>=f||b>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>c&&(c=1),1>b&&(b=1),d>=f&&(d=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==b||this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||
this.lastWinHeight!==g?(this.lastLeft=c,this.lastTop=b,this.lastRight=d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,f=Math.round(b)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-c)),jQuery(this.elem).height(Math.round(e-b))):this.element_hidden&&
(jQuery(this.elem).show(),this.element_hidden=!1))}};e.draw=function(a){};e.drawGL=function(a){};a.prototype.OnClicked=function(){return!0};a.prototype.CompareProgress=function(a,c){return this.isDomFree?!1:cr.do_cmp(this.elem.value,a,c)};g.cnds=new a;f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetCSSStyle=function(a,c){this.runtime.isDomFree||jQuery(this.elem).css(a,c)};
f.prototype.SetProgress=function(a){this.runtime.isDomFree||(this.value=a,this.elem.max=this.max,this.elem.value=this.value)};f.prototype.SetMaximum=function(a){this.runtime.isDomFree||(this.max=a,this.elem.max=this.max,this.elem.value=this.value)};f.prototype.SetIndeterminate=function(){this.runtime.isDomFree||(this.elem.removeAttribute("value"),this.elem.removeAttribute("max"))};g.acts=new f;h.prototype.Progress=function(a){a.set_float(this.runtime.isDomFree?0:this.elem.value)};h.prototype.Maximum=
function(a){a.set_float(this.runtime.isDomFree?0:this.elem.max)};g.exps=new h})();cr.plugins_.rex_TouchWrap=function(a){this.runtime=a};
(function(){function a(a){n=a.x;k=a.y;m=a.z}function f(a,b,c,d){var e=q.length?q.pop():new g;e.init(a,b,c,d);return e}function h(a){100>q.length&&q.push(a)}function g(){this.startindex=this.id=this.lasty=this.lastx=this.y=this.x=this.starty=this.startx=this.lasttime=this.time=this.starttime=0;this.tooFarForHold=this.triggeredHold=!1}function e(){}function d(){}function c(){}var b=cr.plugins_.rex_TouchWrap.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};b.Type.prototype.onCreate=
function(){};b.Instance=function(a){this.type=a;this.runtime=a.runtime;this.touches=[];this.touchDown=this.mouseDown=!1;this.check_name="TOUCHWRAP";this.cursor={x:null,y:null};this._callbackObjs=[];this.fake_ret={value:0,set_any:function(a){this.value=a},set_int:function(a){this.value=a},set_float:function(a){this.value=a}}};var l=b.Instance.prototype,p={left:0,top:0};l.findTouch=function(a){var b;var c=0;for(b=this.touches.length;c<b;c++)if(this.touches[c].id===a)return c;return-1};var n=0,k=0,m=
0,q=[];g.prototype.init=function(a,b,c,d){var e=cr.performance_now();this.starttime=this.lasttime=this.time=e;this.startx=a;this.starty=b;this.x=a;this.y=b;this.lastx=a;this.lasty=b;this.pressure=this.height=this.width=0;this.id=c;this.startindex=d;this.tooFarForHold=this.triggeredHold=!1};g.prototype.update=function(a,b,c,d,e,f){this.lasttime=this.time;this.time=a;this.lastx=this.x;this.lasty=this.y;this.x=b;this.y=c;this.width=d;this.height=e;this.pressure=f;!this.tooFarForHold&&15<=cr.distanceTo(this.startx,
this.starty,this.x,this.y)&&(this.tooFarForHold=!0)};g.prototype.maybeTriggerHold=function(a,b){!this.triggeredHold&&500<=cr.performance_now()-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(this.triggeredHold=!0,a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnHoldGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnHoldGestureObject,
a),a.getTouchIndex=0)};var v=-1E3,u=-1E3,y=-1E4;g.prototype.maybeTriggerTap=function(a,b){if(!this.triggeredHold){var c=cr.performance_now();333>=c-this.starttime&&!this.tooFarForHold&&15>cr.distanceTo(this.startx,this.starty,this.x,this.y)&&(a.trigger_index=this.startindex,a.trigger_id=this.id,a.getTouchIndex=b,666>=c-y&&25>cr.distanceTo(v,u,this.x,this.y)?(a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnDoubleTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnDoubleTapGestureObject,
a),u=v=-1E3,y=-1E4):(a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTapGesture,a),a.curTouchX=this.x,a.curTouchY=this.y,a.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTapGestureObject,a),v=this.x,u=this.y,y=c),a.getTouchIndex=0)}};l.onCreate=function(){this.isWindows8=!("undefined"===typeof window.c2isWindows8||!window.c2isWindows8);this.getTouchIndex=this.trigger_id=this.trigger_index=this.curTouchY=this.curTouchX=this.acc_z=this.acc_y=this.acc_x=this.acc_g_z=this.acc_g_y=
this.acc_g_x=this.orient_gamma=this.orient_beta=this.orient_alpha=0;this.useMouseInput=0!==this.properties[0];var b=0<this.runtime.fullscreen_mode?document:this.runtime.canvas,c=document;this.runtime.isDirectCanvas?c=b=window.Canvas:this.runtime.isCocoonJs&&(c=b=window);var d=this;"undefined"!==typeof PointerEvent?(b.addEventListener("pointerdown",function(a){d.onPointerStart(a)},!1),b.addEventListener("pointermove",function(a){d.onPointerMove(a)},!1),c.addEventListener("pointerup",function(a){d.onPointerEnd(a,
!1)},!1),c.addEventListener("pointercancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),this.runtime.canvas.addEventListener("gesturehold",function(a){a.preventDefault()},!1),document.addEventListener("gesturehold",function(a){a.preventDefault()},!1))):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",
function(a){d.onPointerStart(a)},!1),b.addEventListener("MSPointerMove",function(a){d.onPointerMove(a)},!1),c.addEventListener("MSPointerUp",function(a){d.onPointerEnd(a,!1)},!1),c.addEventListener("MSPointerCancel",function(a){d.onPointerEnd(a,!0)},!1),this.runtime.canvas&&(this.runtime.canvas.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1),document.addEventListener("MSGestureHold",function(a){a.preventDefault()},!1))):(b.addEventListener("touchstart",function(a){d.onTouchStart(a)},
!1),b.addEventListener("touchmove",function(a){d.onTouchMove(a)},!1),c.addEventListener("touchend",function(a){d.onTouchEnd(a,!1)},!1),c.addEventListener("touchcancel",function(a){d.onTouchEnd(a,!0)},!1));if(this.isWindows8){var e=function(a){a=a.reading;d.acc_x=a.accelerationX;d.acc_y=a.accelerationY;d.acc_z=a.accelerationZ},f=function(a){a=a.reading;d.orient_alpha=a.yawDegrees;d.orient_beta=a.pitchDegrees;d.orient_gamma=a.rollDegrees},g=Windows.Devices.Sensors.Accelerometer.getDefault();g&&(g.reportInterval=
Math.max(g.minimumReportInterval,16),g.addEventListener("readingchanged",e));var h=Windows.Devices.Sensors.Inclinometer.getDefault();h&&(h.reportInterval=Math.max(h.minimumReportInterval,16),h.addEventListener("readingchanged",f));document.addEventListener("visibilitychange",function(a){document.hidden||document.msHidden?(g&&g.removeEventListener("readingchanged",e),h&&h.removeEventListener("readingchanged",f)):(g&&g.addEventListener("readingchanged",e),h&&h.addEventListener("readingchanged",f))},
!1)}else window.addEventListener("deviceorientation",function(a){d.orient_alpha=a.alpha||0;d.orient_beta=a.beta||0;d.orient_gamma=a.gamma||0},!1),window.addEventListener("devicemotion",function(a){a.accelerationIncludingGravity&&(d.acc_g_x=a.accelerationIncludingGravity.x||0,d.acc_g_y=a.accelerationIncludingGravity.y||0,d.acc_g_z=a.accelerationIncludingGravity.z||0);a.acceleration&&(d.acc_x=a.acceleration.x||0,d.acc_y=a.acceleration.y||0,d.acc_z=a.acceleration.z||0)},!1);this.useMouseInput&&!this.runtime.isDomFree&&
(document.addEventListener("mousemove",function(a){d.onMouseMove(a)}),document.addEventListener("mousedown",function(a){d.onMouseDown(a)}),document.addEventListener("mouseup",function(a){d.onMouseUp(a)}));!this.runtime.isiOS&&this.runtime.isCordova&&navigator.accelerometer&&navigator.accelerometer.watchAcceleration&&navigator.accelerometer.watchAcceleration(a,null,{frequency:40});this.runtime.tick2Me(this);this.enable=1==this.properties[1];this.lastTouchY=this.lastTouchX=null};l.getCanvasOffset=function(){this.runtime.isDomFree||
(p.left=this.runtime.canvas.offsetLeft,p.top=this.runtime.canvas.offsetTop);return p};l.onPointerMove=function(a){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&a.preventDefault();var b=this.findTouch(a.pointerId),c=cr.performance_now(),d=this._callbackObjs.length;if(0<=b){var e=this.getCanvasOffset();b=this.touches[b];if(!(2>c-b.time))for(b.update(c,a.pageX-e.left,a.pageY-e.top,a.width||0,a.height||0,a.pressure||0),c=a.pageX-e.left,e=a.pageY-e.top,
a=0;a<d;a++)this._callbackObjs[a].OnTouchMove&&this._callbackObjs[a].OnTouchMove(b.identifier,c,e)}}};l.onPointerStart=function(a){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.getCanvasOffset(),c=a.pageX-b.left;b=a.pageY-b.top;cr.performance_now();this.trigger_index=this.touches.length;this.trigger_id=a.pointerId;this.touches.push(f(c,b,a.pointerId,this.trigger_index));this.runtime.isInUserInputEvent=
!0;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchStart,this);this.curTouchX=c;this.curTouchY=b;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchObject,this);c=this._callbackObjs.length;for(a=0;a<c;a++)this._callbackObjs[a].OnTouchStart&&this._callbackObjs[a].OnTouchStart(this.trigger_id,this.curTouchX,this.curTouchY);this.runtime.isInUserInputEvent=!1}};l.onPointerEnd=function(a,
b){if(this.enable&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();a=this.findTouch(a.pointerId);this.trigger_index=0<=a?this.touches[a].startindex:-1;this.trigger_id=0<=a?this.touches[a].id:-1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchEnd,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchEnd,this);0<=a&&(this.lastTouchX=this.touches[a].x,
this.lastTouchY=this.touches[a].y,this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchReleasedObject,this));var c=this._callbackObjs.length,d;for(d=0;d<c;d++)this._callbackObjs[d].OnTouchEnd&&this._callbackObjs[d].OnTouchEnd(this.trigger_id);0<=a&&(b||this.touches[a].maybeTriggerTap(this,a),h(this.touches[a]),this.touches.splice(a,1));this.runtime.isInUserInputEvent=!1}};l.onTouchMove=function(a){if(this.enable){a.preventDefault&&a.preventDefault();var b=cr.performance_now(),c,d=
this._callbackObjs.length;var e=0;for(c=a.changedTouches.length;e<c;e++){var f=a.changedTouches[e];var g=this.findTouch(f.identifier);if(0<=g){var h=this.getCanvasOffset();g=this.touches[g];if(!(2>b-g.time)){g.update(b,f.pageX-h.left,f.pageY-h.top,2*(f.radiusX||f.webkitRadiusX||f.mozRadiusX||f.msRadiusX||0),2*(f.radiusY||f.webkitRadiusY||f.mozRadiusY||f.msRadiusY||0),f.force||f.webkitForce||f.mozForce||f.msForce||0);g=f.pageX-h.left;var k=f.pageY-h.top;for(h=0;h<d;h++)this._callbackObjs[h].OnTouchMove&&
this._callbackObjs[h].OnTouchMove(f.identifier,g,k)}}}}};l.onTouchStart=function(a){if(this.enable){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b=this.getCanvasOffset();cr.performance_now();this.runtime.isInUserInputEvent=!0;var c,d=this._callbackObjs.length;var e=0;for(c=a.changedTouches.length;e<c;e++){var g=a.changedTouches[e];var h=this.findTouch(g.identifier);if(-1===h){h=g.pageX-b.left;var k=g.pageY-b.top;this.trigger_index=this.touches.length;this.trigger_id=g.identifier;
this.touches.push(f(h,k,g.identifier,this.trigger_index));this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchStart,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchStart,this);this.curTouchX=h;this.curTouchY=k;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchObject,this);for(g=0;g<d;g++)this._callbackObjs[g].OnTouchStart&&this._callbackObjs[g].OnTouchStart(this.trigger_id,this.curTouchX,this.curTouchY)}}this.runtime.isInUserInputEvent=
!1}};l.onTouchEnd=function(a,b){if(this.enable){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();this.runtime.isInUserInputEvent=!0;var c,d=this._callbackObjs.length,e;var f=0;for(c=a.changedTouches.length;f<c;f++){var g=a.changedTouches[f];g=this.findTouch(g.identifier);if(0<=g){this.trigger_index=this.touches[g].startindex;this.trigger_id=this.touches[g].id;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnNthTouchEnd,this);this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchEnd,
this);this.lastTouchX=this.touches[g].x;this.lastTouchY=this.touches[g].y;this.runtime.trigger(cr.plugins_.rex_TouchWrap.prototype.cnds.OnTouchReleasedObject,this);for(e=0;e<d;e++)this._callbackObjs[e].OnTouchEnd&&this._callbackObjs[e].OnTouchEnd(this.trigger_id);b||this.touches[g].maybeTriggerTap(this,g);h(this.touches[g]);this.touches.splice(g,1)}}this.runtime.isInUserInputEvent=!1}};l.getAlpha=function(){return this.runtime.isCordova&&0===this.orient_alpha&&0!==m?90*m:this.orient_alpha};l.getBeta=
function(){return this.runtime.isCordova&&0===this.orient_beta&&0!==k?90*k:this.orient_beta};l.getGamma=function(){return this.runtime.isCordova&&0===this.orient_gamma&&0!==n?90*n:this.orient_gamma};l.updateCursor=function(a){var b=this.getCanvasOffset();this.cursor.x=a.pageX-b.left;this.cursor.y=a.pageY-b.top};l.onMouseDown=function(a){if(this.enable){this.updateCursor(a);this.mouseDown=!0;a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault();var b=this.findTouch(0);
-1!==b&&(h(this.touches[b]),cr.arrayRemove(this.touches,b));this.onTouchStart({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})}};l.onMouseMove=function(a){if(this.enable&&(this.updateCursor(a),this.mouseDown))this.onTouchMove({changedTouches:[{pageX:a.pageX,pageY:a.pageY,identifier:0}]})};l.onMouseUp=function(a){this.enable&&(this.updateCursor(a),this.mouseDown=!1,a.preventDefault&&this.runtime.had_a_click&&!this.runtime.isMobile&&a.preventDefault(),this.runtime.had_a_click=!0,this.onTouchEnd({changedTouches:[{pageX:a.pageX,
pageY:a.pageY,identifier:0}]}))};l.tick2=function(){if(this.enable){var a,b=cr.performance_now();var c=0;for(a=this.touches.length;c<a;++c){var d=this.touches[c];d.time<=b-50&&(d.lasttime=b);d.maybeTriggerHold(this,c)}this.lastTouchY=this.lastTouchX=null}};e.prototype.OnTouchStart=function(){return!0};e.prototype.OnTouchEnd=function(){return!0};e.prototype.IsInTouch=function(){return this.IsInTouch()};e.prototype.OnTouchObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,
this.curTouchY,!1):!1};var B=[];e.prototype.IsTouchingObject=function(a){if(this.IsInTouch()){if(!a)return!1;var b=a.getCurrentSol(),c=b.getObjects(),d,e;var f=0;for(d=c.length;f<d;f++){var g=c[f];g.update_bbox();var h=0;for(e=this.touches.length;h<e;h++){var k=this.touches[h];var l=g.layer.canvasToLayer(k.x,k.y,!0);k=g.layer.canvasToLayer(k.x,k.y,!1);if(g.contains_pt(l,k)){B.push(g);break}}}return B.length?(b.select_all=!1,cr.shallowAssignArray(b.instances,B),a.applySolToContainer(),cr.clearArray(B),
!0):!1}};e.prototype.CompareTouchSpeed=function(a,b,c){a=Math.floor(a);if(0>a||a>=this.touches.length)return!1;var d=this.touches[a];a=cr.distanceTo(d.x,d.y,d.lastx,d.lasty);d=(d.time-d.lasttime)/1E3;var e=0;0<d&&(e=a/d);return cr.do_cmp(e,b,c)};e.prototype.OrientationSupported=function(){return"undefined"!==typeof window.DeviceOrientationEvent};e.prototype.MotionSupported=function(){return"undefined"!==typeof window.DeviceMotionEvent};e.prototype.CompareOrientation=function(a,b,c){a=0===a?this.getAlpha():
1===a?this.getBeta():this.getGamma();return cr.do_cmp(a,b,c)};e.prototype.CompareAcceleration=function(a,b,c){var d=0;0===a?d=this.acc_g_x:1===a?d=this.acc_g_y:2===a?d=this.acc_g_z:3===a?d=this.acc_x:4===a?d=this.acc_y:5===a&&(d=this.acc_z);return cr.do_cmp(d,b,c)};e.prototype.OnNthTouchStart=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.OnNthTouchEnd=function(a){a=Math.floor(a);return a===this.trigger_index};e.prototype.HasNthTouch=function(a){a=Math.floor(a);return this.touches.length>=
a+1};e.prototype.OnHoldGesture=function(){return!0};e.prototype.OnTapGesture=function(){return!0};e.prototype.OnDoubleTapGesture=function(){return!0};e.prototype.OnHoldGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnDoubleTapGestureObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,
this.curTouchX,this.curTouchY,!1):!1};e.prototype.OnTouchReleasedObject=function(a){return a?this.runtime.testAndSelectCanvasPointOverlap(a,this.lastTouchX,this.lastTouchY,!1):!1};b.cnds=new e;b.acts=new d;d.prototype.SetEnable=function(a){this.enable=1==a};c.prototype.TouchCount=function(a){a.set_int(this.touches.length)};c.prototype.X=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;
var e=b.zoomRate;var f=b.parallaxX;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0));b.scale=d;b.zoomRate=e;b.parallaxX=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!0)):a.set_float(0)};c.prototype.XAt=function(a,b,c){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=
this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!0)):a.set_float(0)};c.prototype.XForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);
else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxX;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxX=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!0));c.scale=d;c.zoomRate=e;c.parallaxX=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!0)):a.set_float(0)};c.prototype.Y=function(a,b){var c=this.getTouchIndex;if(0>c||c>=this.touches.length)a.set_float(0);
else if(cr.is_undefined(b)){b=this.runtime.getLayerByNumber(0);var d=b.scale;var e=b.zoomRate;var f=b.parallaxY;var g=b.angle;b.scale=1;b.zoomRate=1;b.parallaxY=1;b.angle=0;a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1));b.scale=d;b.zoomRate=e;b.parallaxY=f;b.angle=g}else(b=cr.is_number(b)?this.runtime.getLayerByNumber(b):this.runtime.getLayerByName(b))?a.set_float(b.canvasToLayer(this.touches[c].x,this.touches[c].y,!1)):a.set_float(0)};c.prototype.YAt=function(a,b,c){b=Math.floor(b);
if(0>b||b>=this.touches.length)a.set_float(0);else if(cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(this.touches[b].x,this.touches[b].y,!1)):a.set_float(0)};
c.prototype.YForID=function(a,b,c){b=this.findTouch(b);if(0>b)a.set_float(0);else if(b=this.touches[b],cr.is_undefined(c)){c=this.runtime.getLayerByNumber(0);var d=c.scale;var e=c.zoomRate;var f=c.parallaxY;var g=c.angle;c.scale=1;c.zoomRate=1;c.parallaxY=1;c.angle=0;a.set_float(c.canvasToLayer(b.x,b.y,!1));c.scale=d;c.zoomRate=e;c.parallaxY=f;c.angle=g}else(c=cr.is_number(c)?this.runtime.getLayerByNumber(c):this.runtime.getLayerByName(c))?a.set_float(c.canvasToLayer(b.x,b.y,!1)):a.set_float(0)};
c.prototype.AbsoluteX=function(a){this.touches.length?a.set_float(this.touches[0].x):a.set_float(0)};c.prototype.AbsoluteXAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].x)};c.prototype.AbsoluteXForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].x)};c.prototype.AbsoluteY=function(a){this.touches.length?a.set_float(this.touches[0].y):a.set_float(0)};c.prototype.AbsoluteYAt=function(a,b){b=Math.floor(b);0>b||
b>=this.touches.length?a.set_float(0):a.set_float(this.touches[b].y)};c.prototype.AbsoluteYForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].y)};c.prototype.SpeedAt=function(a,b){b=Math.floor(b);if(0>b||b>=this.touches.length)a.set_float(0);else{var c=this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0===c?a.set_float(0):a.set_float(b/c)}};c.prototype.SpeedForID=function(a,b){b=this.findTouch(b);if(0>b)a.set_float(0);else{var c=
this.touches[b];b=cr.distanceTo(c.x,c.y,c.lastx,c.lasty);c=(c.time-c.lasttime)/1E3;0===c?a.set_float(0):a.set_float(b/c)}};c.prototype.AngleAt=function(a,b){b=Math.floor(b);0>b||b>=this.touches.length?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};c.prototype.AngleForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):(b=this.touches[b],a.set_float(cr.to_degrees(cr.angleTo(b.lastx,b.lasty,b.x,b.y))))};c.prototype.Alpha=function(a){a.set_float(this.getAlpha())};
c.prototype.Beta=function(a){a.set_float(this.getBeta())};c.prototype.Gamma=function(a){a.set_float(this.getGamma())};c.prototype.AccelerationXWithG=function(a){a.set_float(this.acc_g_x)};c.prototype.AccelerationYWithG=function(a){a.set_float(this.acc_g_y)};c.prototype.AccelerationZWithG=function(a){a.set_float(this.acc_g_z)};c.prototype.AccelerationX=function(a){a.set_float(this.acc_x)};c.prototype.AccelerationY=function(a){a.set_float(this.acc_y)};c.prototype.AccelerationZ=function(a){a.set_float(this.acc_z)};
c.prototype.TouchIndex=function(a){a.set_int(this.trigger_index)};c.prototype.TouchID=function(a){a.set_float(this.trigger_id)};c.prototype.WidthForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].width)};c.prototype.HeightForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].height)};c.prototype.PressureForID=function(a,b){b=this.findTouch(b);0>b?a.set_float(0):a.set_float(this.touches[b].pressure)};b.exps=new c;l.HookMe=function(a){this._callbackObjs.push(a)};
l.UnHookMe=function(a){cr.arrayFindRemove(this._callbackObjs,a)};l.IsInTouch=function(){return 0<this.touches.length};var x=cr.plugins_.rex_TouchWrap.prototype.exps;l.TouchCount=function(){x.TouchCount.call(this,this.fake_ret);return this.fake_ret.value};l.X=function(a){x.X.call(this,this.fake_ret,a);return this.fake_ret.value};l.XAt=function(a,b){x.XAt.call(this,this.fake_ret,a,b);return this.fake_ret.value};l.XForID=function(a,b){x.XForID.call(this,this.fake_ret,a,b);return this.fake_ret.value};
l.Y=function(a){x.Y.call(this,this.fake_ret,a);return this.fake_ret.value};l.YAt=function(a,b){x.YAt.call(this,this.fake_ret,a,b);return this.fake_ret.value};l.YForID=function(a,b){x.YForID.call(this,this.fake_ret,a,b);return this.fake_ret.value};l.AbsoluteX=function(){x.AbsoluteX.call(this,this.fake_ret);return this.fake_ret.value};l.AbsoluteXAt=function(a){x.AbsoluteXAt.call(this,this.fake_ret,a);return this.fake_ret.value};l.AbsoluteXForID=function(a){x.AbsoluteXForID.call(this,this.fake_ret,a);
return this.fake_ret.value};l.AbsoluteY=function(){x.AbsoluteY.call(this,this.fake_ret);return this.fake_ret.value};l.AbsoluteYAt=function(a){x.AbsoluteYAt.call(this,this.fake_ret,a);return this.fake_ret.value};l.AbsoluteYForID=function(a){x.AbsoluteYForID.call(this,this.fake_ret,a);return this.fake_ret.value};l.CursorX=function(a){if(null==this.cursor.x)return null;if(cr.is_undefined(a)){var b=this.runtime.getLayerByNumber(0);var c=b.scale;var d=b.zoomRate;var e=b.parallaxX;var f=b.angle;b.scale=
1;b.zoomRate=1;b.parallaxX=1;b.angle=0;a=b.canvasToLayer(this.cursor.x,this.cursor.y,!0);b.scale=c;b.zoomRate=d;b.parallaxX=e;b.angle=f}else a=(b=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.canvasToLayer(this.cursor.x,this.cursor.y,!0):0;return a};l.CursorY=function(a){if(null==this.cursor.y)return null;if(cr.is_undefined(a)){var b=this.runtime.getLayerByNumber(0);var c=b.scale;var d=b.zoomRate;var e=b.parallaxX;var f=b.angle;b.scale=1;b.zoomRate=1;b.parallaxX=
1;b.angle=0;a=b.canvasToLayer(this.cursor.x,this.cursor.y,!1);b.scale=c;b.zoomRate=d;b.parallaxX=e;b.angle=f}else a=(b=cr.is_number(a)?this.runtime.getLayerByNumber(a):this.runtime.getLayerByName(a))?b.canvasToLayer(this.cursor.x,this.cursor.y,!1):0;return a};l.CursorAbsoluteX=function(){return this.cursor.x};l.CursorAbsoluteY=function(){return this.cursor.y}})();cr.plugins_.rex_bbcodeText=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.rex_bbcodeText.prototype;g.onCreate=function(){g.acts.SetWidth=function(a){this.width!==a&&(this.width=a,this.set_bbox_changed(),this.isCanvasSizeLocked||this.render_text(this.is_force_render))}};g.Type=function(a){this.plugin=a;this.runtime=a.runtime};var e=g.Type.prototype;e.onCreate=function(){};e.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;b++){var c=this.instances[b];c.mycanvas=
null;c.myctx=null;c.mytex=null}}};g.Instance=function(a){this.type=a;this.runtime=a.runtime;this.text_changed=!0};e=g.Instance.prototype;var d={},c=["miter","round","bevel"];e.onCreate=function(){this.text="";this.set_text(this.properties[0]);this.visible=0===this.properties[1];this.font=this.properties[2];this.color=this.properties[3];this.halign=this.properties[4];this.valign=this.properties[5];this.textShadow="";this.wrapbyword=0===this.properties[7];this.lastwrapwidth=this.lastwidth=this.width;
this.lastheight=this.height;this.line_height_offset=this.properties[8];this.baseLine_mode=this.properties[9];this.vshift=this.properties[10];this.is_force_render=1===this.properties[11];this.LockCanvasSize(1===this.properties[12],this.width,this.height);this.fontstyle=this.facename="";this.textHeight=this.textWidth=this.ptSize=0;this.parseFont();this.mytex=this.myctx=this.mycanvas=null;this.need_text_redraw=!1;this.last_render_tick=this.runtime.tickcount;this.recycled?this.rcTex.set(0,0,1,1):this.rcTex=
new cr.rect(0,0,1,1);this.runtime.glwrap&&this.runtime.tickMe(this);this._tag=null;this.recycled||(this.canvas_text=new l);this.canvas_text.Reset(this);this.canvas_text.textBaseline=0===this.baseLine_mode?"alphabetic":"top";this.canvas_text.stroke.lineWidth=this.properties[13];this.canvas_text.stroke.lineJoin=c[this.properties[14]];this.canvas_text.underline.thickness=this.properties[15];this.canvas_text.underline.offset=this.properties[16];this.setShadow(this.properties[17],this.properties[18],this.properties[19],
this.properties[20]);this.canvas_text.backgroundColor=this.properties[21];this.text&&this.render_text(this.is_force_render)};e.parseFont=function(){var a=this.font.split(" "),b;for(b=0;b<a.length;b++)if("pt"===a[b].substr(a[b].length-2,2)){this.ptSize=parseInt(a[b].substr(0,a[b].length-2));this.pxHeight=Math.ceil(this.ptSize/72*96)+4;0<b&&(this.fontstyle=a[b-1]);this.facename=a[b+1];for(b+=2;b<a.length;b++)this.facename+=" "+a[b];break}};e.saveToJSON=function(){return{t:this.text,f:this.font,c:this.color,
ha:this.halign,va:this.valign,wr:this.wrapbyword,lho:this.line_height_offset,vs:this.vshift,fn:this.facename,fs:this.fontstyle,ps:this.ptSize,pxh:this.pxHeight,tw:this.textWidth,th:this.textHeight,ts:this.textShadow,lrt:this.last_render_tick,bl:this.canvas_text.textBaseline,txtObj:this.canvas_text.saveToJSON(),isLcs:this.isCanvasSizeLocked,lcw:this.lockedCanvasWidth,lch:this.lockedCanvasHeight}};e.loadFromJSON=function(a){this.text=a.t;this.font=a.f;this.color=a.c;this.halign=a.ha;this.valign=a.va;
this.wrapbyword=a.wr;this.line_height_offset=a.lho;this.vshift=a.vs;this.facename=a.fn;this.fontstyle=a.fs;this.ptSize=a.ps;this.pxHeight=a.pxh;this.textWidth=a.tw;this.textHeight=a.th;this.textShadow=a.ts;this.last_render_tick=a.lrt;this.text_changed=!0;this.lastwrapwidth=this.lastwidth=this.width;this.lastheight=this.height;this.canvas_text.textBaseline=a.bl;this.canvas_text.loadFromJSON(a.txtObj);this.isCanvasSizeLocked=a.isLcs;this.lockedCanvasWidth=a.lcw;this.lockedCanvasHeight=a.lch};e.tick=
function(){if(this.runtime.glwrap&&this.mytex&&300<=this.runtime.tickcount-this.last_render_tick){var a=this.layer;this.update_bbox();var b=this.bbox;if(b.right<a.viewLeft||b.bottom<a.viewTop||b.left>a.viewRight||b.top>a.viewBottom)this.runtime.glwrap.deleteTexture(this.mytex),this.mycanvas=this.myctx=this.mytex=null}};e.onDestroy=function(){this.mycanvas=this.myctx=null;this.runtime.glwrap&&this.mytex&&this.runtime.glwrap.deleteTexture(this.mytex);this.mytex=null};e.updateFont=function(){this.font=
this.fontstyle+" "+this.ptSize.toString()+"pt "+this.facename;this.render_text(this.is_force_render)};e.draw=function(a,b,c){var d=!1,e=this.isCanvasSizeLocked?this.lockedCanvasWidth:this.width,f=this.isCanvasSizeLocked?this.lockedCanvasHeight:this.height;a.globalAlpha=b?1:this.opacity;if(b){var g=this.layer.getScale();d||(a.save(),d=!0);a.scale(g,g)}if(this.text_changed||e!==this.lastwrapwidth)this.canvas_text.text_changed=!0,this.text_changed=!1,this.lastwrapwidth=e;this.update_bbox();g=b?0:this.bquad.tlx;
var h=b?0:this.bquad.tly;this.runtime.pixel_rounding&&(g=g+.5|0,h=h+.5|0);if(!b){var k=e!==this.width||f!==this.height;if((b=0!==this.angle)||k){d||(a.save(),d=!0);if(k){k=this.width/e;var l=this.height/f;a.scale(k,l);a.translate(g/k,h/l);h=g=0}b&&(0===g&&0===h||a.translate(g,h),a.rotate(this.angle))}}b=this.pxHeight;b+=this.line_height_offset*this.runtime.devicePixelRatio;this.canvas_text.canvas=a.canvas;this.canvas_text.context=a;this.canvas_text.default_propScope.family=this.facename;this.canvas_text.default_propScope.ptSize=
this.ptSize.toString()+"pt";this.canvas_text.default_propScope.style=this.fontstyle;this.canvas_text.default_propScope.color=this.color;this.canvas_text.default_propScope.shadow=this.textShadow;this.canvas_text.lineHeight=b;this.canvas_text.textInfo.text=this.text;this.canvas_text.textInfo.x=g;this.canvas_text.textInfo.y=h;this.canvas_text.textInfo.boxWidth=e;this.canvas_text.textInfo.boxHeight=f;this.canvas_text.textInfo.ignore=c;this.canvas_text.drawText();d&&a.restore();this.last_render_tick=this.runtime.tickcount};
e.drawGL=function(a){if(!(1>this.width||1>this.height)){var b=this.text_changed||this.need_text_redraw;this.need_text_redraw=!1;var c=this.layer.getScale(),d=this.layer.getAngle(),e=this.rcTex,f=c*this.width,g=c*this.height,h=Math.ceil(f),k=Math.ceil(g),l=this.runtime.draw_width/2,m=this.runtime.draw_height/2,p=this.isCanvasSizeLocked?Math.ceil(c*this.lockedCanvasWidth):h,n=this.isCanvasSizeLocked?Math.ceil(c*this.lockedCanvasHeight):k;this.myctx||(this.mycanvas=document.createElement("canvas"),this.mycanvas.width=
p,this.mycanvas.height=n,this.lastwidth=p,this.lastheight=n,b=!0,this.myctx=this.mycanvas.getContext("2d"));if(p!==this.lastwidth||n!==this.lastheight)this.mycanvas.width=p,this.mycanvas.height=n,this.mytex&&(a.deleteTexture(this.mytex),this.mytex=null),b=!0;b&&(this.myctx.clearRect(0,0,p,n),this.draw(this.myctx,!0),this.mytex||(this.mytex=a.createEmptyTexture(h,k,this.runtime.linearSampling,this.runtime.isMobile)),a.videoToTexture(this.mycanvas,this.mytex,this.runtime.isMobile));this.lastwidth=p;
this.lastheight=n;a.setTexture(this.mytex);a.setOpacity(this.opacity);a.resetModelView();a.translate(-l,-m);a.updateModelView();var F=this.bquad;b=this.layer.layerToCanvas(F.tlx,F.tly,!0,!0);l=this.layer.layerToCanvas(F.tlx,F.tly,!1,!0);m=this.layer.layerToCanvas(F.trx,F.try_,!0,!0);p=this.layer.layerToCanvas(F.trx,F.try_,!1,!0);n=this.layer.layerToCanvas(F.brx,F.bry,!0,!0);var q=this.layer.layerToCanvas(F.brx,F.bry,!1,!0),r=this.layer.layerToCanvas(F.blx,F.bly,!0,!0);F=this.layer.layerToCanvas(F.blx,
F.bly,!1,!0);if(this.runtime.pixel_rounding||0===this.angle&&0===d){var u=(b+.5|0)-b,t=(l+.5|0)-l;b+=u;l+=t;m+=u;p+=t;n+=u;q+=t;r+=u;F+=t}0===this.angle&&0===d?(m=b+h,p=l,n=m,q=l+k,r=b,F=q,e.right=1,e.bottom=1):(e.right=f/h,e.bottom=g/k);a.quadTex(b,l,m,p,n,q,r,F,e);a.resetModelView();a.scale(c,c);a.rotateZ(-this.layer.getAngle());a.translate((this.layer.viewLeft+this.layer.viewRight)/-2,(this.layer.viewTop+this.layer.viewBottom)/-2);a.updateModelView();this.last_render_tick=this.runtime.tickcount}};
e._get_webgl_ctx=function(){var a=this.myctx;if(!a){this.mycanvas=document.createElement("canvas");a=Math.ceil(this.layer.getScale()*this.width);var b=Math.ceil(this.layer.getAngle()*this.height);this.mycanvas.width=a;this.mycanvas.height=b;this.lastwidth=a;this.lastheight=b;a=this.myctx=this.mycanvas.getContext("2d")}return a};e.fake_render=function(){var a=this.runtime.enableWebGL?this._get_webgl_ctx():this.runtime.ctx;this.draw(a,null,!0)};e.render_text=function(a){a&&(this.text_changed=!0,this.fake_render());
this.text_changed=!0;this.runtime.redraw=!0};e.set_text=function(a){this.text!==a&&(this.text=a,this.render_text(this.is_force_render))};e.setShadow=function(a,b,c,d){d=d.replace(/ /g,"");this.textShadow=a.toString()+"px "+b.toString()+"px "+c.toString()+"px "+d};e.LockCanvasSize=function(a,b,c){this.isCanvasSizeLocked=a;this.lockedCanvasWidth=b;this.lockedCanvasHeight=c};e.getRawText=function(a){return this.canvas_text.getRawText(a)};e.getSubText=function(a,b,c){return this.canvas_text.getSubText(a,
b,c)};e.copyPensMgr=function(a){return this.canvas_text.copyPensMgr(a)};g.cnds=new a;a.prototype.CompareText=function(a,b){return b?this.text==a:cr.equals_nocase(this.text,a)};g.acts=new f;f.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);this.set_text(a.toString())};f.prototype.AppendText=function(a){cr.is_number(a)&&(a=Math.round(1E10*a)/1E10);a=a.toString();0<a.length&&this.set_text(this.text+a)};f.prototype.SetFontFace=function(a,b){var c="";switch(b){case 1:c=
"bold";break;case 2:c="italic";break;case 3:c="bold italic"}if(a!==this.facename||c!==this.fontstyle)this.facename=a,this.fontstyle=c,this.updateFont()};f.prototype.SetFontSize=function(a){this.ptSize!==a&&(this.ptSize=a,this.pxHeight=Math.ceil(this.ptSize/72*96)+4,this.updateFont())};f.prototype.SetFontColor=function(a){a="number"==typeof a?"rgb("+cr.GetRValue(a).toString()+","+cr.GetGValue(a).toString()+","+cr.GetBValue(a).toString()+")":a;a!==this.color&&(this.color=a,this.render_text(this.is_force_render))};
f.prototype.SetWebFont=function(a,b){if(this.runtime.isDomFree)cr.logexport("[Construct 2] Text plugin: 'Set web font' not supported on this platform - the action has been ignored");else{var c=this,e=function(){c.runtime.redraw=!0;c.text_changed=!0},f="'"+a+"'";if(d.hasOwnProperty(b)){if(this.facename!==f)for(this.facename=f,this.updateFont(),a=1;10>a;a++)setTimeout(e,100*a),setTimeout(e,1E3*a)}else for(f=document.createElement("link"),f.href=b,f.rel="stylesheet",f.type="text/css",f.onload=e,document.getElementsByTagName("head")[0].appendChild(f),
d[b]=!0,this.facename="'"+a+"'",this.updateFont(),a=1;10>a;a++)setTimeout(e,100*a),setTimeout(e,1E3*a)}};f.prototype.SetEffect=function(a){this.compositeOp=cr.effectToCompositeOp(a);cr.setGLBlend(this,a,this.runtime.gl);this.render_text(this.is_force_render)};f.prototype.SetFontStyle=function(a){var b="";switch(a){case 1:b="bold";break;case 2:b="italic";break;case 3:b="bold italic"}b!==this.fontstyle&&(this.fontstyle=b,this.updateFont())};f.prototype.SetFontFace2=function(a){a!==this.facename&&(this.facename=
a,this.updateFont())};f.prototype.SetLineHeight=function(a){this.line_height_offset!==a&&(this.line_height_offset=a,this.render_text(this.is_force_render))};f.prototype.SetHorizontalAlignment=function(a){this.halign!==a&&(this.halign=a,this.render_text(this.is_force_render))};f.prototype.SetVerticalAlignment=function(a){this.valign!==a&&(this.valign=a,this.render_text(this.is_force_render))};f.prototype.SetWrapping=function(a){a=0===a;this.wrapbyword!==a&&(this.wrapbyword=a,this.render_text(this.is_force_render))};
f.prototype.SetShadow=function(a,b,c,d){this.setShadow(a,b,c,d);this.render_text(this.is_force_render)};f.prototype.SetThickness=function(a){a!==this.canvas_text.underline.thickness&&(this.canvas_text.underline.thickness=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetOffsetY=function(a){a!==this.canvas_text.underline.offset&&(this.canvas_text.underline.offset=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetStrokeLineWidth=function(a){a!==this.canvas_text.stroke.lineWidth&&
(this.canvas_text.stroke.lineWidth=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetStrokeLineJoin=function(a){a=c[a];a!==this.canvas_text.stroke.lineJoin&&(this.canvas_text.stroke.lineJoin=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.SetBackgroundColor=function(a){a!==this.canvas_text.backgroundColor&&(this.canvas_text.backgroundColor=a,this.need_text_redraw=!0,this.runtime.redraw=!0)};f.prototype.LockCanvasSize=function(a,b){this.LockCanvasSize(!0,a,b)};f.prototype.UnLockCanvasSize=
function(){this.LockCanvasSize(!1)};f.prototype.AddImage=function(a,b,c){b&&(window.RexImageBank.AddImage(a,b.getFirstPicked(),c),this.render_text(this.is_force_render))};f.prototype.RemoveImage=function(a){window.RexImageBank.RemoveImage(a);this.render_text(this.is_force_render)};f.prototype.RemoveAll=function(){window.RexImageBank.RemoveAll();this.render_text(this.is_force_render)};g.exps=new h;h.prototype.Text=function(a,b,c){b=null==b&&null==c?this.text:this.getSubText(b,c);a.set_string(b)};h.prototype.FaceName=
function(a){a.set_string(this.facename)};h.prototype.FaceSize=function(a){a.set_int(this.ptSize)};h.prototype.TextWidth=function(a){a.set_int(this.canvas_text.getTextWidth())};h.prototype.TextHeight=function(a){var b=this.canvas_text.getLines().length*(this.pxHeight+this.line_height_offset)-this.line_height_offset;0===this.baseLine_mode&&(b+=this.vshift);a.set_float(b)};h.prototype.RawText=function(a){a.set_string(this.canvas_text.getRawText())};h.prototype.LastClassPropValue=function(a,b,c){var d,
e=this.canvas_text.getLastPen();e&&(d=e.prop[b]);d||(d=c||0);a.set_any(d)};e=function(){this.lines=[]};var b=e.prototype;b.allocLine=function(){return 0<this.lines.length?this.lines.pop():null};b.freeLine=function(a){this.lines.push(a)};b.freeAllLines=function(a){var b;var c=0;for(b=a.length;c<b;c++)this.freeLine(a[c]);a.length=0};var l=function(){this.context=this.canvas=null;this.savedClasses={};this.textInfo={text:"",x:0,y:0,boxWidth:0,boxHeight:0,ignore:null};this.pensMgr=new C;this.text_changed=
!0;this.default_propScope={family:"Verdana",weight:"",ptSize:"12pt",color:"#000000",style:"normal",shadow:""};this.stroke={lineWidth:1,lineJoin:"miter"};this.underline={thickness:1,offset:0};this.textAlign="start";this.lineHeight="16";this.textBaseline="alphabetic";this.backgroundColor=""};b=l.prototype;b.Reset=function(a){this.plugin=a};b.getLines=function(){return this.pensMgr.getLines()};b.apply_propScope=function(a){if(this.isTextMode(a)){var b;a.hasOwnProperty("b")||a.hasOwnProperty("i")?a.b&&
a.i?b="bold italic":a.b?b="bold":a.i&&(b="italic"):b=this.default_propScope.weight;var c=a.weight||this.default_propScope.weight,d=this.getTextSize(a);this.context.font=b+" "+c+" "+d+" "+(a.family||this.default_propScope.family);b=this.getFillColor(a);"none"!==b.toLowerCase()&&(this.context.fillStyle=b);b=this.getStokeColor(a);"none"!==b.toLowerCase()&&(this.context.strokeStyle=b,this.context.lineWidth=this.stroke.lineWidth,this.context.lineJoin=this.stroke.lineJoin,this.context.miterLimit=2)}a=a.shadow?
this.default_propScope.shadow:"";""!==a&&(a=a.split(" "),this.context.shadowOffsetX=parseFloat(a[0].replace("px","")),this.context.shadowOffsetY=parseFloat(a[1].replace("px","")),this.context.shadowBlur=parseFloat(a[2].replace("px","")),this.context.shadowColor=a[3])};b.isTextMode=function(a){return!a.hasOwnProperty("img")};b.getTextSize=function(a){return a.hasOwnProperty("size")?a.size:this.default_propScope.ptSize};b.getFillColor=function(a){return a.hasOwnProperty("color")?a.color:this.default_propScope.color};
b.getStokeColor=function(a){return a.hasOwnProperty("stroke")?a.stroke:"none"};b.draw_pen=function(a,b,c){var d=this.context;d.save();this.apply_propScope(a.prop);b+=a.x;c+=a.y;var e=a.prop.u;e&&(e=!0===e?this.getFillColor(a.prop):e,this.draw_underline(a.text,b,c,this.getTextSize(a.prop),e));if(a.prop.hasOwnProperty("img")){if(a=window.RexImageBank.GetImage(a.prop.img))c+=a.yoffset,"alphabetic"==this.textBaseline&&(c-=this.lineHeight),d.drawImage(a.img,b,c,a.width,a.height)}else"none"!==this.getStokeColor(a.prop).toLowerCase()&&
d.strokeText(a.text,b,c),"none"!==this.getFillColor(a.prop).toLowerCase()&&d.fillText(a.text,b,c);d.restore()};b.draw_underline=function(a,b,c,d,e){var f=this.context;a=f.measureText(a).width;c+=this.underline.offset;"top"===this.textBaseline&&(c+=parseInt(d));f.beginPath();f.strokeStyle=e;f.lineWidth=this.underline.thickness;f.moveTo(b,c);f.lineTo(b+a,c);f.stroke()};b.preProcess=function(){if(""!==this.backgroundColor){var a=this.context;a.fillStyle=this.backgroundColor;a.fillRect(0,0,this.textInfo.boxWidth,
this.textInfo.boxHeight)}};b.drawPens=function(a,b){var c=b.boxWidth,d=b.boxHeight,e=b.x,f=b.y;b=a.getLines();var g=b.length;d=1===this.plugin.valign?Math.max((d-g*this.lineHeight)/2,0):2===this.plugin.valign?Math.max(d-g*this.lineHeight-2,0):0;d+=f;"alphabetic"==this.textBaseline&&(d+=this.plugin.vshift*this.plugin.runtime.devicePixelRatio);var h;for(f=0;f<g;f++){var k=a.getLineWidth(f);if(0!==k){k=1===this.plugin.halign?(c-k)/2:2===this.plugin.halign?c-k:0;k+=e;var l=b[f];var m=l.length;for(h=0;h<
m;h++){var p=l[h];""!==p.text&&this.draw_pen(p,k,d)}}}};b.postProcess=function(){};var p=[],n=function(a,b){var c=/\[b\]|\[\/b\]|\[i\]|\[\/i\]|\[size=(\d+)\]|\[\/size\]|\[color=([a-z]+|#[0-9abcdef]+)\]|\[\/color\]|\[u\]|\[u=([a-z]+|#[0-9abcdef]+)\]|\[\/u\]|\[shadow\]|\[\/shadow\]|\[stroke=([a-z]+|#[0-9abcdef]+)\]|\[\/stroke\]|\[img=([^\]]+)\]|\[\/img\]/ig;p.length=0;for(var d,e=0,f=a.length,g;;){d=c.exec(a);if(!d)break;d=d[0];g=c.lastIndex-d.length;e<g&&p.push(a.substring(e,g));null==b&&p.push(d);
e=c.lastIndex}e<f&&p.push(a.substring(e,f));return p},k=/\[b\]/i,m=/\[\/b\]/i,q=/\[i\]/i,v=/\[\/i\]/i,u=/\[size=(\d+)\]/i,y=/\[\/size\]/i,B=/\[color=([a-z]+|#[0-9abcdef]+)\]/i,x=/\[\/color\]/i,w=/\[u\]/i,A=/\[u=([a-z]+|#[0-9abcdef]+)\]/i,D=/\[\/u\]/i,G=/\[shadow\]/i,r=/\[\/shadow\]/i,t=/\[stroke=([a-z]+|#[0-9abcdef]+)\]/i,O=/\[\/stroke\]/i,P=/\[img=([^\]]+)\]/i,Q=/\[\/img\]/i,z={};b.updatePens=function(a,b,c){null==b&&(b=this.textInfo);a.freePens();var d=b.text;b=b.boxWidth;if(""!==d){var e=0,f=0;
d=n(d);if(0!==d.length){var g,h=d.length;for(g=0;g<h;g++){var l=d[g];if(k.test(l))J(z,!0,"b",!0);else if(m.test(l))J(z,!1,"b");else if(q.test(l))J(z,!0,"i",!0);else if(v.test(l))J(z,!1,"i");else if(u.test(l))l=l.match(u),J(z,!0,"size",l[1]+"pt");else if(y.test(l))J(z,!1,"size");else if(B.test(l))l=l.match(B),J(z,!0,"color",l[1]);else if(x.test(l))J(z,!1,"color");else if(w.test(l))l.match(w),J(z,!0,"u",!0);else if(A.test(l))l=l.match(A),J(z,!0,"u",l[1]);else if(D.test(l))J(z,!1,"u");else if(G.test(l))J(z,
!0,"shadow",!0);else if(r.test(l))J(z,!1,"shadow");else if(t.test(l))l=l.match(t),J(z,!0,"stroke",l[1]);else if(O.test(l))J(z,!1,"stroke");else if(P.test(l)){l=l.match(P);l=l[1];var p=window.RexImageBank.GetImage(l);p&&(J(z,!0,"img",l),c?a.addPen(null,null,null,null,z,0):(p.width>b-(e-0)&&(e=0,f+=this.lineHeight),a.addPen(null,e,f,p.width,z,0),e+=p.width),J(z,!1,"img"))}else if(Q.test(l))J(z,!1,"img");else if(c)a.addPen(l,null,null,null,z,0);else{this.context.save();this.apply_propScope(z);a:{var F=
l;p=this.context;var U=b,C=this.plugin.wrapbyword,E=e-0;l=S;N.freeAllLines(l);if(F&&F.length&&!(2>=U)){if(100>=F.length&&-1===F.indexOf("\n")){var R=p.measureText(F).width;if(R<=U-E){N.freeAllLines(l);l.push(N.newline(F,R,M));break a}}if(C){K.length=0;var H="";for(var I=0;I<F.length;)if(R=F.charAt(I),"\n"===R)H.length&&(K.push(H),H=""),K.push("\n"),++I;else if(" "===R||"\t"===R||"-"===R){do H+=F.charAt(I),I++;while(I<F.length&&(" "===F.charAt(I)||"\t"===F.charAt(I)));K.push(H);H=""}else I<F.length&&
(H+=R,I++);H.length&&K.push(H);F=K}I=F;var L="",T=I.length,Y=0;for(F=0;F<T;F++)"\n"===I[F]?(Y>=l.length&&l.push(N.newline(L,p.measureText(L).width,1)),Y++,L="",E=0):(H=L,L+=I[F],R=p.measureText(L).width,R>=U-E&&(Y>=l.length&&l.push(N.newline(H,p.measureText(H).width,2)),Y++,L=I[F],C||" "!==L||(L=""),E=0));L.length&&(Y>=l.length&&l.push(N.newline(L,p.measureText(L).width,M)),Y++);for(F=Y;F<l.length;F++)N.freeLine(l[F]);l.length=Y}}p=l.length;for(U=0;U<p;U++)C=l[U],a.addPen(C.text,e,f,C.width,z,C.newLineMode),
C.newLineMode!==M?(e=0,f+=this.lineHeight):e+=C.width;this.context.restore()}}for(var aa in z)delete z[aa]}}};var J=function(a,b,c,d){!0===b?a[c]=d:a.hasOwnProperty(c)&&delete a[c];return a};b.drawText=function(){var a=this.textInfo;this.text_changed&&(this.updatePens(this.pensMgr,a),this.text_changed=!1);a.ignore||(this.context.textBaseline=this.textBaseline,this.context.textAlign=this.textAlign,this.preProcess(),this.drawPens(this.pensMgr,a),this.postProcess())};var I=null;b.getSubText=function(a,
b,c){if(null==c)return this.pensMgr.getSliceTagText(a,b);null===I&&(I=new C);var d=this.textInfo.text;this.textInfo.text=c;this.updatePens(I,this.textInfo,!0);this.textInfo.text=d;return I.getSliceTagText(a,b)};b.getRawText=function(a){if(null==a)return this.pensMgr.getRawText();a=n(a,1);if(0===a.length)return"";var b,c=a.length,d="";for(b=0;b<c;b++)d+=a[b];return d};b.copyPensMgr=function(a){return this.pensMgr.copy(a)};b.getTextWidth=function(a){null==a&&(a=this.pensMgr);return a.getMaxLineWidth()};
b.getLastPen=function(a){null==a&&(a=this.pensMgr);return a.getLastPen()};b.defineClass=function(a,b){this.savedClasses[a]=b;return!0};b.getClass=function(a){return this.savedClasses[a]};b.trim=function(a){var b;a=a.replace(/^\s\s*/,"");var c=/\s/;for(b=a.length;c.test(a.charAt(--b)););return a.slice(0,b+1)};b.saveToJSON=function(){return{cls:this.savedClasses,stroke:[this.stroke.lineWidth,this.stroke.lineJoin],u:[this.underline.thickness,this.underline.offset],bgc:this.backgroundColor}};b.loadFromJSON=
function(a){this.savedClasses=a.cls;this.stroke.lineWidth=a.stroke[0];this.stroke.lineJoin=a.stroke[1];this.underline.thickness=a.u[0];this.underline.offset=a.u[1];this.backgroundColor=a.bgc};var M=0,N=new e;N.newline=function(a,b,c){var d=this.allocLine()||{};d.text=a;d.width=b;d.newLineMode=c;return d};var S=[],K=[],H=new e,E=new e,C=function(){this.pens=[];this.lines=[]};e=C.prototype;e.freePens=function(){var a,b=this.lines.length;for(a=0;a<b;a++)this.lines[a].length=0;H.freeAllLines(this.pens);
E.freeAllLines(this.lines)};e.addPen=function(a,b,c,d,e,f){var g=H.allocLine();null===g&&(g=new L);g.setPen(a,b,c,d,e,f);a=this.pens[this.pens.length-1];g.startIndex=null==a?0:a.getNextStartIndex();this.pens.push(g);a=this.lines[this.lines.length-1];null==a&&(a=E.allocLine()||[],this.lines.push(a));a.push(g);f!==M&&(a=E.allocLine()||[],this.lines.push(a))};e.getPens=function(){return this.pens};e.getLastPen=function(){return this.pens[this.pens.length-1]};e.getLines=function(){return this.lines};
e.getLineStartChartIndex=function(a){a=this.lines[a];return null==a?0:a[0].startIndex};e.getLineEndChartIndex=function(a){for(var b=!1,c;0<=a&&!(c=this.lines[a],b=null!=c&&0<c.length);a--);return b?c[c.length-1].getEndIndex():0};e.copy=function(a){null==a&&(a=new C);a.freePens();var b,c=this.lines.length,d;for(b=0;b<c;b++){var e=this.lines[b];var f=e.length;for(d=0;d<f;d++){var g=e[d];a.addPen(g.text,g.x,g.y,g.width,g.prop,g.newLineMode)}}return a};e.getLineWidth=function(a){a=this.lines[a];return a?
(a=a[a.length-1])?a.getLastX():0:0};e.getMaxLineWidth=function(){var a=0,b,c=this.lines.length;for(b=0;b<c;b++){var d=this.getLineWidth(b);d>a&&(a=d)}return a};e.getRawText=function(){var a="",b,c=this.pens.length;for(b=0;b<c;b++)a+=this.pens[b].getRawText();return a};e.getRawTextLength=function(){var a=0,b,c=this.pens.length;for(b=0;b<c;b++)a+=this.pens[b].getRawText().length;return a};e.getSliceTagText=function(a,b){null==a&&(a=0);if(null==b){b=this.getLastPen();if(null==b)return"";b=b.getEndIndex()}var c=
"",d,e=this.pens.length,f,g;for(d=0;d<e;d++){var h=this.pens[d];var k=h.getRawText();var l=h.startIndex;var m=h.getNextStartIndex();if(!(m<a)){(f=l>=a&&m<b)||(k=k.substring(a-l,b-l));l=void 0;f=h.prop;null==g&&(g=T);for(l in g)f.hasOwnProperty(l)||(k="[/"+l+"]"+k);var p="";for(l in f)g[l]!==f[l]&&(p="size"===l?p+("[size="+f[l].replace("pt","")+"]"):"color"===l||"stroke"===l||"img"===l?p+("["+l+"="+f[l]+"]"):"u"===l?!0===f[l]?p+"[u]":p+("[u="+f[l]+"]"):p+("["+l+"]"));c+=p+k;g=h.prop;if(m>=b)break}}return c};
var T={},L=function(){this.width=this.y=this.x=this.text=null;this.prop={};this.startIndex=this.newLineMode=null};e=L.prototype;e.setPen=function(a,b,c,d,e,f,g){this.text=a;this.x=b;this.y=c;this.width=d;a=this.prop;null==a&&(a={});for(var h in a)e.hasOwnProperty(h)||delete a[h];for(h in e)a[h]=e[h];this.newLineMode=f;this.startIndex=g};e.getRawText=function(){var a=this.text||"";1==this.newLineMode&&(a+="\n");return a};e.getNextStartIndex=function(){return this.startIndex+this.getRawText().length};
e.getEndIndex=function(){return this.getNextStartIndex()-1};e.getLastX=function(){return this.x+this.width};e=function(){this.images={}};b=e.prototype;b.AddImage=function(a,b,c){var d=b?b.canvas?b.canvas:b.curFrame&&b.curFrame.texture_img?b.curFrame.texture_img:null:null;b&&(this.images[a]={img:d,width:b.width,height:b.height,yoffset:c})};b.GetImage=function(a,b){return this.images[a]};b.RemoveImage=function(a){this.images.hasOwnProperty(a)&&delete this.images[a]};b.RemoveAll=function(){for(var a in this.images)delete this.images[a]};
window.RexImageBank=new e})();cr.plugins_.sirg_fancyBox=function(a){this.runtime=a};
(function(){function a(){}var f=cr.plugins_.sirg_fancyBox.prototype;f.Type=function(a){this.plugin=a;this.runtime=a.runtime};f.Type.prototype.onCreate=function(){};f.Instance=function(a){this.type=a;this.runtime=a.runtime};var h=f.Instance.prototype;h.onCreate=function(){};h.onDestroy=function(){};h.saveToJSON=function(){return{}};h.loadFromJSON=function(a){};h.draw=function(a){};h.drawGL=function(a){};f.cnds=new function(){};a.prototype.ShowFancyBoxInline=function(a,e,d,c,b){switch(d){case 0:d="float";
break;case 1:d="inside";break;case 2:d="outside";break;case 3:d="over";break;default:d="outside"}jQuery.fancybox({type:"inline",content:b,title:1==e?a:null,helpers:{title:{type:d,position:1==c?"top":"bottom"}}})};a.prototype.ShowFancyBoxAjax=function(a,e,d,c,b){switch(d){case 0:d="float";break;case 1:d="inside";break;case 2:d="outside";break;case 3:d="over";break;default:d="outside"}jQuery.fancybox({type:"ajax",href:b,title:1==e?a:null,helpers:{title:{type:d,position:1==c?"top":"bottom"}}})};a.prototype.ShowFancyBoxIframe=
function(a,e,d,c,b){switch(d){case 0:d="float";break;case 1:d="inside";break;case 2:d="outside";break;case 3:d="over";break;default:d="outside"}jQuery.fancybox({type:"iframe",href:b,title:1==e?a:null,helpers:{title:{type:d,position:1==c?"top":"bottom"}}})};a.prototype.ShowFancyBoxSwf=function(a,e,d,c,b){switch(d){case 0:d="float";break;case 1:d="inside";break;case 2:d="outside";break;case 3:d="over";break;default:d="outside"}jQuery.fancybox({type:"swf",href:b,title:1==e?a:null,helpers:{title:{type:d,
position:1==c?"top":"bottom"}}})};a.prototype.ShowFancyBoxImage=function(a,e,d,c,b){switch(d){case 0:d="float";break;case 1:d="inside";break;case 2:d="outside";break;case 3:d="over";break;default:d="outside"}jQuery.fancybox({type:"image",href:b,title:1==e?a:null,helpers:{title:{type:d,position:1==c?"top":"bottom"}}})};a.prototype.ShowFancyBoxHtml=function(a,e,d,c,b){switch(d){case 0:d="float";break;case 1:d="inside";break;case 2:d="outside";break;case 3:d="over";break;default:d="outside"}jQuery.fancybox({type:"html",
content:b,title:1==e?a:null,helpers:{title:{type:d,position:1==c?"top":"bottom"}}})};a.prototype.ShowFancyBoxSimple=function(a){jQuery.fancybox({type:"inline",content:a})};f.acts=new a;f.exps=new function(){}})();cr.plugins_.sliderbar=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.plugins_.sliderbar.prototype;g.Type=function(a){this.plugin=a;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a){this.type=a;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.runtime.isDomFree?cr.logexport("[Construct 2] Slider Bar plugin not supported on this platform - the object will not be created"):(this.elem=document.createElement("input"),this.elem.type="range",this.elem.max=
this.properties[2],this.elem.min=this.properties[1],this.elem.step=this.properties[3],this.elem.value=this.properties[0],this.elem.disabled=0===this.properties[6],this.elem.id=this.properties[7],this.elem.title=this.properties[4],jQuery(this.elem).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body"),this.element_hidden=!1,0===this.properties[5]&&(jQuery(this.elem).hide(),this.visible=!1,this.element_hidden=!0),this.elem.onclick=function(a){return function(c){c.stopPropagation();a.runtime.isInUserInputEvent=
!0;a.runtime.trigger(cr.plugins_.sliderbar.prototype.cnds.OnClicked,a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.onchange=function(a){return function(c){a.runtime.isInUserInputEvent=!0;a.runtime.trigger(cr.plugins_.sliderbar.prototype.cnds.OnChanged,a);a.runtime.isInUserInputEvent=!1}}(this),this.elem.addEventListener("touchstart",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchmove",function(a){a.stopPropagation()},!1),this.elem.addEventListener("touchend",function(a){a.stopPropagation()},
!1),jQuery(this.elem).mousedown(function(a){a.stopPropagation()}),jQuery(this.elem).mouseup(function(a){a.stopPropagation()}),jQuery(this.elem).keydown(function(a){a.stopPropagation()}),jQuery(this.elem).keyup(function(a){a.stopPropagation()}),this.lastWinHeight=this.lastWinWidth=this.lastBottom=this.lastRight=this.lastTop=this.lastLeft=0,this.updatePosition(!0),this.runtime.tickMe(this))};e.saveToJSON=function(){return{v:this.elem.value,mi:this.elem.min,ma:this.elem.max,s:this.elem.step}};e.loadFromJSON=
function(a){this.elem.min=a.mi;this.elem.max=a.ma;this.elem.step=a.s;this.elem.value=a.v};e.onDestroy=function(){this.runtime.isDomFree||(jQuery(this.elem).remove(),this.elem=null)};e.tick=function(){this.updatePosition()};e.updatePosition=function(a){if(!this.runtime.isDomFree){var c=this.layer.layerToCanvas(this.x,this.y,!0),b=this.layer.layerToCanvas(this.x,this.y,!1),d=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,
!1),f=this.runtime.width/this.runtime.devicePixelRatio,g=this.runtime.height/this.runtime.devicePixelRatio;!this.visible||!this.layer.visible||0>=d||0>=e||c>=f||b>=g?(this.element_hidden||jQuery(this.elem).hide(),this.element_hidden=!0):(1>c&&(c=1),1>b&&(b=1),d>=f&&(d=f-1),e>=g&&(e=g-1),f=window.innerWidth,g=window.innerHeight,a||this.lastLeft!==c||this.lastTop!==b||this.lastRight!==d||this.lastBottom!==e||this.lastWinWidth!==f||this.lastWinHeight!==g?(this.lastLeft=c,this.lastTop=b,this.lastRight=
d,this.lastBottom=e,this.lastWinWidth=f,this.lastWinHeight=g,this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1),a=Math.round(c)+jQuery(this.runtime.canvas).offset().left,f=Math.round(b)+jQuery(this.runtime.canvas).offset().top,jQuery(this.elem).css("position","absolute"),jQuery(this.elem).offset({left:a,top:f}),jQuery(this.elem).width(Math.round(d-c)),jQuery(this.elem).height(Math.round(e-b))):this.element_hidden&&(jQuery(this.elem).show(),this.element_hidden=!1))}};e.draw=function(a){};
e.drawGL=function(a){};a.prototype.OnClicked=function(){return!0};a.prototype.OnChanged=function(){return!0};a.prototype.CompareValue=function(a,c){return this.isDomFree?!1:cr.do_cmp(parseFloat(this.elem.value),a,c)};g.cnds=new a;f.prototype.SetTooltip=function(a){this.runtime.isDomFree||(this.elem.title=a)};f.prototype.SetVisible=function(a){this.runtime.isDomFree||(this.visible=0!==a)};f.prototype.SetCSSStyle=function(a,c){this.runtime.isDomFree||jQuery(this.elem).css(a,c)};f.prototype.SetValue=
function(a){this.runtime.isDomFree||(this.elem.value=a)};f.prototype.SetMaximum=function(a){this.runtime.isDomFree||(this.elem.max=a)};f.prototype.SetMinimum=function(a){this.runtime.isDomFree||(this.elem.min=a)};f.prototype.SetStep=function(a){this.runtime.isDomFree||(this.elem.step=a)};f.prototype.SetEnabled=function(a){this.runtime.isDomFree||(this.elem.disabled=0===a)};g.acts=new f;h.prototype.Value=function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.value)||0)};h.prototype.Maximum=
function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.max)||0)};h.prototype.Minimum=function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.min)||0)};h.prototype.Step=function(a){a.set_float(this.runtime.isDomFree?0:parseFloat(this.elem.step)||0)};g.exps=new h})();
var toggle_css='<style type="text/css"> .switch5 { -webkit-tap-highlight-color : rgba(0,0,0,0); background-color: #fff; float: right; height: 28px; width: 77px; border-radius: 20px; margin-top: -5px; box-shadow: inset 0 1px 3px #BABABA, inset -5px 13px 0.5px 0px rgba(232, 232, 232, 0.6), inset -1px 1px 2px rgba(0, 0, 0, 0.7), inset 1px 2px 1px 0px rgba(0, 0, 0, 1); overflow: hidden; } .switch5 input[type=checkbox] { display: none; } .switch5::before { content: ""; display: block; height: 28px; \twidth: 0px; position: absolute; border-radius: 20px; -webkit-box-shadow: inset 0 1px 2px #0059ac, inset 4px 11px 0.5px 2px rgba(0, 101, 189, 0.5), inset -1px 1px 2px rgba(0, 0, 0, 0.7), inset 0px 1px 1px rgba(0, 0, 0, 1.0); box-shadow: inset 0 1px 2px #0059ac, inset 4px 11px 0.5px 2px rgba(0, 101, 189, 0.5), inset -1px 1px 2px rgba(0, 0, 0, 0.7), inset 0px 1px 1px rgba(0, 0, 0, 1.0);\tbackground-color: #2a94ec; } .switch5.on::before { width: 77px; } .switch5 > .thumb { display: block; width: 25px; height: 25px; position: relative; top: 0.5; left: 1; \tz-index: 3; border: solid 1px #818181; border-radius: 28px; box-shadow: inset 0 1px 1px white, inset 0 -1px 1px white, 0 0px 1px rgba(0, 0, 0, 0.8); background-color: #CECECE; background-image: -webkit-linear-gradient(#CECECE, #FBFBFB); background-image: -moz-linear-gradient(#CECECE, #FBFBFB); background-image: -o-linear-gradient(#CECECE, #FBFBFB); -o-transition: all 0.125s ease-in-out; -webkit-transition: all 0.125s ease-in-out; -moz-transition: all 0.125s ease-in-out; -o-transform: translateX(0px); -webkit-transform: translate3d(0,0,0); -moz-transform: translateX(0px); } .switch5.on > .thumb { -webkit-transform: translate3d(49px,0,0); -o-transform: translateX(49px); -moz-transform: translateX(49px); } .switch5 > .thumb::before { content: ""; display: block; height: 14px; width: 2px; background-color: white; box-shadow: 0px -0.5px 0.5px #000; border: none; position: absolute; top: 6px; left: -24px; } .switch5 > .thumb::after { content: ""; display: block; height: 10px; width: 10px; border-radius: 10px; border: solid 2px #777;\tposition: absolute; right: -32px; top: 6px; }  .switch4 { -webkit-tap-highlight-color : rgba(0,0,0,0); background-color: #fff; float: right; height: 28px; width: 90px; border-radius: 4px; margin-top: -5px; box-shadow: inset 0 1px 3px #BABABA, inset 4px 13px 0.5px 0px rgba(232, 232, 232, 0.6), inset 1px 2px 1px 0px rgba(0, 0, 0, 1); overflow: hidden; } .switch4 input[type=checkbox] { display: none; } .switch4::before { content: ""; display: block; height: 28px; width: 0px; position: absolute; border-radius: 4px; -webkit-box-shadow: inset 0 1px 4px #0059ac, inset -5px 10px 4px 3px rgba(0, 101, 189, 0.6), inset -30px 1px 2px rgba(0, 0, 0, 0.4), inset 0px 1px 1px rgba(0, 0, 0, 1.0); box-shadow:  inset 0 1px 4px #0059ac, inset -5px 10px 4px 3px rgba(0, 101, 189, 0.6), inset -30px 1px 2px rgba(0, 0, 0, 0.4), inset 0px 1px 1px rgba(0, 0, 0, 1.0); background-color: #2a94ec; } .switch4.on::before { width: 77px; } .switch4 > .thumb { display: block; \twidth: 39px; height: 26px; position: relative; top: 0; left: 0; z-index: 3; border: solid 1px #818181; border-radius: 4px; box-shadow: inset 0 1px 1px white, inset 0 -1px 1px white, 0 0px 2px rgba(0, 0, 0, 0.6); background-color: #CECECE; background-image: -webkit-linear-gradient(#CECECE, #FBFBFB); background-image: -moz-linear-gradient(#CECECE, #FBFBFB); background-image: -o-linear-gradient(#CECECE, #FBFBFB); -o-transition: all 0.125s ease-in-out; -webkit-transition: all 0.125s ease-in-out; -moz-transition: all 0.125s ease-in-out; -o-transform: translateX(0px); -webkit-transform: translate3d(0,0,0); -moz-transform: translateX(0px); } .switch4.on > .thumb { -webkit-transform: translate3d(49px,0,0); -o-transform: translateX(49px); -moz-transform: translateX(49px); left: -1; } .switch4 > .thumb::before { content: ""; display: block;\theight: 14px; width: 2px; background-color: white;\t box-shadow: 0px -0.5px 0.5px #000; border: none; position: absolute; top: 6px; left: -24px; } .switch4 > .thumb::after { content: ""; display: block; height: 10px; width: 10px; border-radius: 10px; border: solid 2px #777; position: absolute; right: -32px; top: 6px; } </style>',toggle_t=
0;cr.plugins_.togglebutton=function(a){this.runtime=a};
(function(){var a=cr.plugins_.togglebutton.prototype;a.Type=function(a){this.plugin=a;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a){this.type=a;this.runtime=a.runtime;this.triggerToggle=this.triggerID=null};var f=a.Instance.prototype;f.onCreate=function(){this.iOS_version=[!0,!1][this.properties[0]];this.toggle_status=[!0,!1][this.properties[1]];var a=document.createElement("span");a.id="togglebutton_"+this.uid;a.style.zIndex=this.properties[2];1==this.toggle_status&&
1==this.iOS_version?a.className="switch4 on":0==this.toggle_status&&1==this.iOS_version?a.className="switch4":1==this.toggle_status&&0==this.iOS_version?a.className="switch5 on":0==this.toggle_status&&0==this.iOS_version&&(a.className="switch5");var f=document.createElement("span");f.className="thumb";var e=document.createElement("input");e.type="checkbox";jQuery(a).appendTo(this.runtime.canvasdiv?this.runtime.canvasdiv:"body");a.appendChild(f);a.appendChild(e);++toggle_t;1==toggle_t&&jQuery(toggle_css).appendTo("head");
a.onclick=function(d){return function(){d.triggerID="togglebutton_"+d.uid;d.triggerToggle="switch4 on"==a.className||"switch5 on"==a.className?1:0;"switch4 on"==a.className?a.className="switch4":"switch5 on"==a.className?a.className="switch5":"switch4"==a.className?a.className="switch4 on":"switch5"==a.className&&(a.className="switch5 on");d.runtime.trigger(cr.plugins_.togglebutton.prototype.cnds.toggleStatus,d)}}(this);document.addEventListener("touchmove",function(a){a.preventDefault()},!1);a.addEventListener("touchstart",
function(a){a.stopPropagation()},!1);this.updatePosition();this.runtime.tickMe(this)};f.draw=function(){};f.drawGL=function(a){};f.onDestroy=function(){jQuery(this.elem).remove();this.elem=null};f.tick=function(){this.updatePosition()};f.updatePosition=function(){this.elem=document.getElementById("togglebutton_"+this.uid);var a=this.layer.layerToCanvas(this.x,this.y,!0),f=this.layer.layerToCanvas(this.x,this.y,!1),e=this.layer.layerToCanvas(this.x+this.width,this.y+this.height,!0),d=this.layer.layerToCanvas(this.x+
this.width,this.y+this.height,!1);if(!this.visible||!this.layer.visible||0>=e||0>=d||a>=this.runtime.width||f>=this.runtime.height)jQuery(this.elem).hide();else{jQuery(this.elem).show();var c=Math.round(a)+jQuery(this.runtime.canvas).offset().left,b=Math.round(f)+jQuery(this.runtime.canvas).offset().top;jQuery(this.elem).offset({left:c,top:b});jQuery(this.elem).width(e-a);jQuery(this.elem).height(d-f)}};a.acts={};f=a.acts;f.set_toggleStatus=function(a){var f=document.getElementById("togglebutton_"+
this.uid);if(!f)return!1;0===a&&1==this.iOS_version?f.className="switch4 on":1===a&&1==this.iOS_version?f.className="switch4":0===a&&0==this.iOS_version?f.className="switch5 on":1===a&&0==this.iOS_version&&(f.className="switch5")};f.switch_toggleStatus=function(){var a=document.getElementById("togglebutton_"+this.uid);switch(a.className){case "switch4 on":a.className="switch4";break;case "switch4":a.className="switch4 on";break;case "switch5 on":a.className="switch5";break;case "switch5":a.className=
"switch5 on"}};a.cnds={};a.cnds.toggleStatus=function(a){return"togglebutton_"+this.uid==this.triggerID&&this.triggerToggle==a};a.exps={}})();cr.plugins_.video=function(a){this.runtime=a};
(function(){function a(a){return a&&!a.paused&&!a.ended&&0<a.currentTime}function f(){var a=m.slice(0);cr.clearArray(m);var b,c;var d=0;for(b=a.length;d<b;++d){var e=a[d];(c=e.play())&&c.catch(function(a){h(e)})}}function h(a){-1===m.indexOf(a)&&m.push(a)}function g(a){0>a&&(a=0);1<a&&(a=1);return Math.log(a)/Math.log(10)*20}function e(){}function d(){}function c(){}var b=cr.plugins_.video.prototype;b.Type=function(a){this.plugin=a;this.runtime=a.runtime};var l=b.Type.prototype;l.onCreate=function(){};
l.onLostWebGLContext=function(){if(!this.is_family){var a;var b=0;for(a=this.instances.length;b<a;++b){var c=this.instances[b];c.webGL_texture=null}}};l=document.createElement("video");var p=!!l.canPlayType("video/webm"),n=!!l.canPlayType("video/ogg"),k=!!l.canPlayType("video/mp4");l=null;b.Instance=function(a){this.type=a;this.runtime=a.runtime};l=b.Instance.prototype;var m=[];document.addEventListener("touchend",f,!0);document.addEventListener("click",f,!0);document.addEventListener("keydown",f,
!0);l.queueVideoPlay=function(a){if(this.video){var b=this;if(a){try{var c=this.video.play()}catch(x){h(this.video);return}c?c.catch(function(a){b.video&&h(b.video)}):this.useNextTouchWorkaround&&!this.runtime.isInUserInputEvent&&h(this.video)}else a=m.indexOf(this.video),0<=a&&m.splice(a,1)}};l.onCreate=function(){this.webm_src=this.properties[0];this.ogv_src=this.properties[1];this.mp4_src=this.properties[2];this.autoplay=this.properties[3];this.playInBackground=0!==this.properties[4];this.videoWasPlayingOnSuspend=
!1;this.video=document.createElement("video");this.video.crossOrigin="anonymous";this.video.playsInline=!0;this.webGL_texture=null;this.currentTrigger=-1;this.viaCtx=this.viaCanvas=null;this.useViaCanvasWorkaround=this.runtime.isIE||this.runtime.isMicrosoftEdge;var a=this;this.video.addEventListener("canplay",function(){a.currentTrigger=0;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("canplaythrough",function(){a.currentTrigger=1;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,
a)});this.video.addEventListener("ended",function(){a.currentTrigger=2;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("error",function(){a.currentTrigger=3;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("loadstart",function(){a.currentTrigger=4;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("playing",function(){a.currentTrigger=5;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,
a)});this.video.addEventListener("pause",function(){a.currentTrigger=6;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.video.addEventListener("stalled",function(){a.currentTrigger=7;a.runtime.trigger(cr.plugins_.video.prototype.cnds.OnPlaybackEvent,a)});this.useNextTouchWorkaround=(this.runtime.isiOS||this.runtime.isAndroid&&(this.runtime.isChrome||this.runtime.isAndroidStockBrowser))&&!this.runtime.isCrosswalk&&!this.runtime.isDomFree;0===this.autoplay?(this.video.autoplay=
!1,this.video.preload="none"):1===this.autoplay?(this.video.autoplay=!1,this.video.preload="auto"):2===this.autoplay&&(this.video.autoplay=!0);this.setSource(this.webm_src,this.ogv_src,this.mp4_src);2===this.autoplay&&this.queueVideoPlay(!0);this.visible=0!==this.properties[5];this.runtime.tickMe(this);this.recycled||(a=this,this.runtime.addSuspendCallback(function(b){a.onSuspend(b)}))};l.onSuspend=function(b){!this.playInBackground&&this.video&&(b?a(this.video)&&(this.queueVideoPlay(!1),this.video.pause(),
this.videoWasPlayingOnSuspend=!0):this.videoWasPlayingOnSuspend&&(this.queueVideoPlay(!0),this.videoWasPlayingOnSuspend=!1))};l.setSource=function(a,b,c){var d="";p&&a?d=a:n&&b?d=b:k&&c&&(d=c);d&&(this.runtime.isAbsoluteUrl(d)||(d=d.toLowerCase()),this.video.src=d);this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null};l.onDestroy=function(){this.queueVideoPlay(!1);a(this.video)&&this.video.pause();
this.runtime.glwrap&&this.webGL_texture&&(this.runtime.glwrap.deleteTexture(this.webGL_texture),this.webGL_texture=null);this.viaCtx=this.viaCanvas=null;this.video.src="";this.video=null};l.tick=function(){a(this.video)&&(this.runtime.redraw=!0)};l.saveToJSON=function(){return{s:this.video.src||"",p:!!a(this.video),t:this.video.currentTime||0}};l.loadFromJSON=function(a){if(a&&"undefined"!==typeof a.s){var b=a.s;this.setSource(b,b,b);try{this.video.currentTime=a.t}catch(B){}a.p?this.queueVideoPlay(!0):
(this.queueVideoPlay(!1),this.video.pause())}};l.draw=function(a){if(this.video){var b=this.video.videoWidth,c=this.video.videoHeight;if(!(0>=b||0>=c)){var d=b/c;b=this.width;c=this.height;var e=0,f=0;if(b/c>d){var g=c*d;d=c;e=Math.floor((b-g)/2);0>e&&(e=0)}else g=b,d=b/d,f=Math.floor((c-d)/2),0>f&&(f=0);a.globalAlpha=this.opacity;a.drawImage(this.video,this.x+e,this.y+f,g,d)}}};var q=new cr.rect(0,0,0,0),v=new cr.quad;l.drawGL=function(a){if(this.video){var b=this.video.videoWidth,c=this.video.videoHeight;
if(!(0>=b||0>=c)){var d=b/c,e=this.width,f=this.height,g=0,h=0;if(e/f>d){var k=f*d;d=f;g=Math.floor((e-k)/2);0>g&&(g=0)}else k=e,d=e/d,h=Math.floor((f-d)/2),0>h&&(h=0);this.webGL_texture||(this.webGL_texture=a.createEmptyTexture(b,c,this.runtime.linearSampling,!1,!1));this.useViaCanvasWorkaround?(this.viaCtx||(this.viaCanvas=document.createElement("canvas"),this.viaCanvas.width=b,this.viaCanvas.height=c,this.viaCtx=this.viaCanvas.getContext("2d")),this.viaCtx.drawImage(this.video,0,0),a.videoToTexture(this.viaCanvas,
this.webGL_texture)):a.videoToTexture(this.video,this.webGL_texture);a.setBlend(this.srcBlend,this.destBlend);a.setOpacity(this.opacity);a.setTexture(this.webGL_texture);q.set(this.x+g,this.y+h,this.x+g+k,this.y+h+d);v.set_from_rect(q);a.quad(v.tlx,v.tly,v.trx,v.try_,v.brx,v.bry,v.blx,v.bly)}}};e.prototype.IsPlaying=function(){return a(this.video)};e.prototype.IsPaused=function(){return this.video.paused};e.prototype.HasEnded=function(){return this.video.ended};e.prototype.IsMuted=function(){return this.video.muted};
e.prototype.OnPlaybackEvent=function(a){return this.currentTrigger===a};b.cnds=new e;d.prototype.SetSource=function(a,b,c){this.setSource(a,b,c);this.video.load()};d.prototype.SetPlaybackTime=function(a){try{this.video.currentTime=a}catch(y){console&&console.error&&console.error("Exception setting video playback time: ",y)}};d.prototype.SetLooping=function(a){this.video.loop=0!==a};d.prototype.SetMuted=function(a){this.video.muted=0!==a};d.prototype.SetVolume=function(a){var b=this.video;a=Math.pow(10,
a/20);0>a&&(a=0);1<a&&(a=1);b.volume=a};d.prototype.Pause=function(){this.queueVideoPlay(!1);this.video.pause()};d.prototype.Play=function(){this.queueVideoPlay(!0)};b.acts=new d;c.prototype.PlaybackTime=function(a){a.set_float(this.video.currentTime||0)};c.prototype.Duration=function(a){a.set_float(this.video.duration||0)};c.prototype.Volume=function(a){a.set_float(g(this.video.volume||0))};b.exps=new c})();
cr.behaviors.DragnDrop=function(a){this.runtime=a;var f=this;this.runtime.isDomFree||(jQuery(document).mousemove(function(a){f.onMouseMove(a)}),jQuery(document).mousedown(function(a){f.onMouseDown(a)}),jQuery(document).mouseup(function(a){f.onMouseUp(a)}));a=0<this.runtime.fullscreen_mode?document:this.runtime.canvas;this.runtime.isDirectCanvas?a=window.Canvas:this.runtime.isCocoonJs&&(a=window);"undefined"!==typeof PointerEvent?(a.addEventListener("pointerdown",function(a){f.onPointerStart(a)},!1),
a.addEventListener("pointermove",function(a){f.onPointerMove(a)},!1),a.addEventListener("pointerup",function(a){f.onPointerEnd(a)},!1),a.addEventListener("pointercancel",function(a){f.onPointerEnd(a)},!1)):window.navigator.msPointerEnabled?(a.addEventListener("MSPointerDown",function(a){f.onPointerStart(a)},!1),a.addEventListener("MSPointerMove",function(a){f.onPointerMove(a)},!1),a.addEventListener("MSPointerUp",function(a){f.onPointerEnd(a)},!1),a.addEventListener("MSPointerCancel",function(a){f.onPointerEnd(a)},
!1)):(a.addEventListener("touchstart",function(a){f.onTouchStart(a)},!1),a.addEventListener("touchmove",function(a){f.onTouchMove(a)},!1),a.addEventListener("touchend",function(a){f.onTouchEnd(a)},!1),a.addEventListener("touchcancel",function(a){f.onTouchEnd(a)},!1))};
(function(){function a(a){var b;var c=0;for(b=a.behavior_insts.length;c<b;c++)if(a.behavior_insts[c]instanceof g.Instance)return a.behavior_insts[c];return null}function f(){}function h(){}var g=cr.behaviors.DragnDrop.prototype,e={left:0,top:0};g.onMouseDown=function(a){if(1===a.which)this.onInputDown("leftmouse",a.pageX,a.pageY)};g.onMouseMove=function(a){if(1===a.which)this.onInputMove("leftmouse",a.pageX,a.pageY)};g.onMouseUp=function(a){if(1===a.which)this.onInputUp("leftmouse")};g.onTouchStart=
function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault();var b;var c=0;for(b=a.changedTouches.length;c<b;c++){var d=a.changedTouches[c];var e=d.identifier;this.onInputDown(e?e.toString():"<none>",d.pageX,d.pageY)}};g.onTouchMove=function(a){a.preventDefault&&a.preventDefault();var b;var c=0;for(b=a.changedTouches.length;c<b;c++){var d=a.changedTouches[c];var e=d.identifier;this.onInputMove(e?e.toString():"<none>",d.pageX,d.pageY)}};g.onTouchEnd=function(a){a.preventDefault&&cr.isCanvasInputEvent(a)&&
a.preventDefault();var b;var c=0;for(b=a.changedTouches.length;c<b;c++){var d=a.changedTouches[c];d=d.identifier;this.onInputUp(d?d.toString():"<none>")}};g.onPointerStart=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),this.onInputDown(a.pointerId.toString(),a.pageX,a.pageY))};g.onPointerMove=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&a.preventDefault(),
this.onInputMove(a.pointerId.toString(),a.pageX,a.pageY))};g.onPointerEnd=function(a){a.pointerType!==a.MSPOINTER_TYPE_MOUSE&&"mouse"!==a.pointerType&&(a.preventDefault&&cr.isCanvasInputEvent(a)&&a.preventDefault(),this.onInputUp(a.pointerId.toString()))};g.onInputDown=function(c,b,d){var f=this.runtime.isDomFree?e:jQuery(this.runtime.canvas).offset();b-=f.left;d-=f.top;f=this.my_instances.valuesRef();var g,h=null;var l=0;for(g=f.length;l<g;l++){var q=f[l];var v=a(q);if(v.enabled&&!v.dragging){v=
q.layer.canvasToLayer(b,d,!0);var u=q.layer.canvasToLayer(b,d,!1);q.update_bbox();if(q.contains_pt(v,u))if(h)q.layer.index>h.layer.index?(h=q,y=v,B=u):q.layer.index===h.layer.index&&q.get_zindex()>h.get_zindex()&&(h=q,y=v,B=u);else{h=q;var y=v;var B=u}}}if(h)a(h).onDown(c,y,B)};g.onInputMove=function(c,b,d){var f=this.runtime.isDomFree?e:jQuery(this.runtime.canvas).offset();b-=f.left;d-=f.top;var g=this.my_instances.valuesRef(),h;var l=0;for(h=g.length;l<h;l++){var q=g[l];var v=a(q);!v.enabled||!v.dragging||
v.dragging&&v.dragsource!==c||(f=q.layer.canvasToLayer(b,d,!0),q=q.layer.canvasToLayer(b,d,!1),v.onMove(f,q))}};g.onInputUp=function(c){var b=this.my_instances.valuesRef(),d;var e=0;for(d=b.length;e<d;e++){var f=b[e];f=a(f);if(f.dragging&&f.dragsource===c)f.onUp()}};g.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};var d=g.Instance.prototype;
d.onCreate=function(){this.dragging=!1;this.dy=this.dx=0;this.dragsource="<none>";this.axes=this.properties[0];this.enabled=0!==this.properties[1]};d.saveToJSON=function(){return{enabled:this.enabled}};d.loadFromJSON=function(a){this.enabled=a.enabled;this.dragging=!1};d.onDown=function(a,b,d){this.dx=b-this.inst.x;this.dy=d-this.inst.y;this.dragging=!0;this.dragsource=a;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDragStart,this.inst);this.runtime.isInUserInputEvent=
!1};d.onMove=function(a,b){a-=this.dx;b-=this.dy;if(0===this.axes){if(this.inst.x!==a||this.inst.y!==b)this.inst.x=a,this.inst.y=b,this.inst.set_bbox_changed()}else 1===this.axes?this.inst.x!==a&&(this.inst.x=a,this.inst.set_bbox_changed()):2===this.axes&&this.inst.y!==b&&(this.inst.y=b,this.inst.set_bbox_changed())};d.onUp=function(){this.dragging=!1;this.runtime.isInUserInputEvent=!0;this.runtime.trigger(cr.behaviors.DragnDrop.prototype.cnds.OnDrop,this.inst);this.runtime.isInUserInputEvent=!1};
d.tick=function(){};f.prototype.IsDragging=function(){return this.dragging};f.prototype.OnDragStart=function(){return!0};f.prototype.OnDrop=function(){return!0};f.prototype.IsEnabled=function(){return!!this.enabled};g.cnds=new f;h.prototype.SetEnabled=function(a){this.enabled=0!==a;this.enabled||(this.dragging=!1)};h.prototype.Drop=function(){if(this.dragging)this.onUp()};g.acts=new h;g.exps=new function(){}})();cr.behaviors.Fade=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Fade.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.activeAtStart=1===this.properties[0];this.setMaxOpacity=!1;this.fadeInTime=this.properties[1];this.waitTime=this.properties[2];this.fadeOutTime=this.properties[3];
this.destroy=this.properties[4];this.stage=this.activeAtStart?0:3;this.recycled?this.stageTime.reset():this.stageTime=new cr.KahanAdder;this.maxOpacity=this.inst.opacity?this.inst.opacity:1;this.activeAtStart&&(0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0))};e.saveToJSON=function(){return{fit:this.fadeInTime,wt:this.waitTime,fot:this.fadeOutTime,s:this.stage,st:this.stageTime.sum,mo:this.maxOpacity}};e.loadFromJSON=function(a){this.fadeInTime=
a.fit;this.waitTime=a.wt;this.fadeOutTime=a.fot;this.stage=a.s;this.stageTime.reset();this.stageTime.sum=a.st;this.maxOpacity=a.mo};e.tick=function(){this.stageTime.add(this.runtime.getDt(this.inst));0===this.stage&&(this.inst.opacity=this.stageTime.sum/this.fadeInTime*this.maxOpacity,this.runtime.redraw=!0,this.inst.opacity>=this.maxOpacity&&(this.inst.opacity=this.maxOpacity,this.stage=1,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeInEnd,this.inst)));1===this.stage&&
this.stageTime.sum>=this.waitTime&&(this.stage=2,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnWaitEnd,this.inst));2===this.stage&&0!==this.fadeOutTime&&(this.inst.opacity=this.maxOpacity-this.stageTime.sum/this.fadeOutTime*this.maxOpacity,this.runtime.redraw=!0,0>this.inst.opacity&&(this.inst.opacity=0,this.stage=3,this.stageTime.reset(),this.runtime.trigger(cr.behaviors.Fade.prototype.cnds.OnFadeOutEnd,this.inst),1===this.destroy&&this.runtime.DestroyInstance(this.inst)))};
e.doStart=function(){this.stage=0;this.stageTime.reset();0===this.fadeInTime?(this.stage=1,0===this.waitTime&&(this.stage=2)):(this.inst.opacity=0,this.runtime.redraw=!0)};a.prototype.OnFadeOutEnd=function(){return!0};a.prototype.OnFadeInEnd=function(){return!0};a.prototype.OnWaitEnd=function(){return!0};g.cnds=new a;f.prototype.StartFade=function(){this.activeAtStart||this.setMaxOpacity||(this.maxOpacity=this.inst.opacity?this.inst.opacity:1,this.setMaxOpacity=!0);3===this.stage&&this.doStart()};
f.prototype.RestartFade=function(){this.doStart()};f.prototype.SetFadeInTime=function(a){0>a&&(a=0);this.fadeInTime=a};f.prototype.SetWaitTime=function(a){0>a&&(a=0);this.waitTime=a};f.prototype.SetFadeOutTime=function(a){0>a&&(a=0);this.fadeOutTime=a};g.acts=new f;h.prototype.FadeInTime=function(a){a.set_float(this.fadeInTime)};h.prototype.WaitTime=function(a){a.set_float(this.waitTime)};h.prototype.FadeOutTime=function(a){a.set_float(this.fadeOutTime)};g.exps=new h})();
cr.behaviors.Flash=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.behaviors.Flash.prototype;h.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.timeleft=this.stagetimeleft=this.stage=this.offtime=this.ontime=0};g.saveToJSON=function(){return{ontime:this.ontime,offtime:this.offtime,stage:this.stage,stagetimeleft:this.stagetimeleft,
timeleft:this.timeleft}};g.loadFromJSON=function(a){this.ontime=a.ontime;this.offtime=a.offtime;this.stage=a.stage;this.stagetimeleft=a.stagetimeleft;this.timeleft=a.timeleft;null===this.timeleft&&(this.timeleft=Infinity)};g.tick=function(){if(!(0>=this.timeleft)){var a=this.runtime.getDt(this.inst);this.timeleft-=a;0>=this.timeleft?(this.timeleft=0,this.inst.visible=!0,this.runtime.redraw=!0,this.runtime.trigger(cr.behaviors.Flash.prototype.cnds.OnFlashEnded,this.inst)):(this.stagetimeleft-=a,0>=
this.stagetimeleft&&(0===this.stage?(this.inst.visible=!1,this.stage=1,this.stagetimeleft+=this.offtime):(this.inst.visible=!0,this.stage=0,this.stagetimeleft+=this.ontime),this.runtime.redraw=!0))}};a.prototype.IsFlashing=function(){return 0<this.timeleft};a.prototype.OnFlashEnded=function(){return!0};h.cnds=new a;f.prototype.Flash=function(a,d,c){this.ontime=a;this.offtime=d;this.stage=1;this.stagetimeleft=d;this.timeleft=c;this.inst.visible=!1;this.runtime.redraw=!0};f.prototype.StopFlashing=function(){this.timeleft=
0;this.inst.visible=!0;this.runtime.redraw=!0};h.acts=new f;h.exps=new function(){}})();cr.behaviors.Pin=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Pin.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.pinObject=null;this.pinObjectUid=-1;this.mode=this.lastKnownAngle=this.theirStartAngle=this.myStartAngle=this.pinDist=this.pinAngle=0;var a=this;this.recycled||
(this.myDestroyCallback=function(c){a.onInstanceDestroyed(c)});this.runtime.addDestroyCallback(this.myDestroyCallback)};e.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,pa:this.pinAngle,pd:this.pinDist,msa:this.myStartAngle,tsa:this.theirStartAngle,lka:this.lastKnownAngle,m:this.mode}};e.loadFromJSON=function(a){this.pinObjectUid=a.uid;this.pinAngle=a.pa;this.pinDist=a.pd;this.myStartAngle=a.msa;this.theirStartAngle=a.tsa;this.lastKnownAngle=a.lka;this.mode=a.m};e.afterLoad=
function(){this.pinObject=-1===this.pinObjectUid?null:this.runtime.getObjectByUID(this.pinObjectUid);this.pinObjectUid=-1};e.onInstanceDestroyed=function(a){this.pinObject==a&&(this.pinObject=null)};e.onDestroy=function(){this.pinObject=null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};e.tick=function(){};e.tick2=function(){if(this.pinObject){this.lastKnownAngle!==this.inst.angle&&(this.myStartAngle=cr.clamp_angle(this.myStartAngle+(this.inst.angle-this.lastKnownAngle)));var a=this.inst.x,
c=this.inst.y;if(3===this.mode||4===this.mode){var b=cr.distanceTo(this.inst.x,this.inst.y,this.pinObject.x,this.pinObject.y);if(b>this.pinDist||4===this.mode&&b<this.pinDist)c=cr.angleTo(this.pinObject.x,this.pinObject.y,this.inst.x,this.inst.y),a=this.pinObject.x+Math.cos(c)*this.pinDist,c=this.pinObject.y+Math.sin(c)*this.pinDist}else a=this.pinObject.x+Math.cos(this.pinObject.angle+this.pinAngle)*this.pinDist,c=this.pinObject.y+Math.sin(this.pinObject.angle+this.pinAngle)*this.pinDist;this.lastKnownAngle=
b=cr.clamp_angle(this.myStartAngle+(this.pinObject.angle-this.theirStartAngle));0!==this.mode&&1!==this.mode&&3!==this.mode&&4!==this.mode||this.inst.x===a&&this.inst.y===c||(this.inst.x=a,this.inst.y=c,this.inst.set_bbox_changed());0!==this.mode&&2!==this.mode||this.inst.angle===b||(this.inst.angle=b,this.inst.set_bbox_changed())}};a.prototype.IsPinned=function(){return!!this.pinObject};g.cnds=new a;f.prototype.Pin=function(a,c){a&&(a=a.getFirstPicked(this.inst))&&(this.pinObject=a,this.pinAngle=
cr.angleTo(a.x,a.y,this.inst.x,this.inst.y)-a.angle,this.pinDist=cr.distanceTo(a.x,a.y,this.inst.x,this.inst.y),this.lastKnownAngle=this.myStartAngle=this.inst.angle,this.theirStartAngle=a.angle,this.mode=c)};f.prototype.Unpin=function(){this.pinObject=null};g.acts=new f;h.prototype.PinnedUID=function(a){a.set_int(this.pinObject?this.pinObject.uid:-1)};g.exps=new h})();cr.behaviors.Rex_CanvasExt=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Rex_CanvasExt.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){var a=this.properties[0];1===a&&(this.my_saveToJSON=this.zlib_saveToJSON,this.my_loadFromJSON=this.zlib_loadFromJSON);0!==a&&(this.inst.saveToJSON=
this.my_saveToJSON,this.inst.loadFromJSON=this.my_loadFromJSON)};e.tick=function(){};e.zlib_saveToJSON=function(){var a=this.canvas.width,c=this.canvas.height,b=this.ctx.getImageData(0,0,a,c).data;b=window.RexC2ZlibU8Arr.u8a2String(b);return{w:a,h:c,d:b}};e.zlib_loadFromJSON=function(a){this.canvas.width=a.w;this.canvas.height=a.h;var c=window.RexC2ZlibU8Arr.string2u8a(a.d);a=this.ctx.createImageData(a.w,a.h);var b=a.data,d,e=b.length;for(d=0;d<e;d++)b[d]=c[d];this.ctx.putImageData(a,0,0);this.update_tex=
!0};e.draw_instances=function(a,c,b){var d=c.ctx,e=c.canvas,f,g=a.length;for(f=0;f<g;f++){var h=a[f];if(0!=h.visible||0!=this.runtime.testOverlap(c,h)){d.save();d.scale(e.width/c.width,e.height/c.height);d.rotate(-c.angle);d.translate(-c.bquad.tlx,-c.bquad.tly);var q=h.compositeOp;h.compositeOp=b;d.globalCompositeOperation=b;h.draw(d);h.compositeOp=q;d.restore()}}};g.cnds=new a;a.prototype.OnURLLoaded=function(){return!0};g.acts=new f;f.prototype.JSONLoad=function(a){try{var c=JSON.parse(a)}catch(b){return}this.my_loadFromJSON.call(this.inst,
c);this.inst.runtime.redraw=!0;this.inst.update_tex=!0};f.prototype.EraseObject=function(a){var c=this.inst;this.inst.update_bbox();a=a.getCurrentSol();this.draw_instances(a.select_all?a.type.instances:a.instances,c,"destination-out");this.inst.runtime.redraw=!0;this.inst.update_tex=!0};f.prototype.LoadURL=function(a,c,b){var d=new Image,e=this;d.onload=function(){var a=e.inst,b=!1;if(0===c&&(a.width!=d.width||a.height!=d.height))a.width=d.width,a.height=d.height,b=!0;else if(2===c){var f=a.width/
d.width,g=a.height/d.height;if(1<f&&1<g)a.width=d.width,a.height=d.height,b=!0;else if(1>f||1>g)b=f<g?f:g,a.width=d.width*b,a.height=d.height*b,b=!0}b&&(a.set_bbox_changed(),a.canvas.width=a.width,a.canvas.height=a.height);b=a.canvas;d.width!==b.width&&(b.width=d.width);d.height!==b.height&&(b.height=d.height);a.ctx.clearRect(0,0,d.width,d.height);a.ctx.drawImage(d,0,0,d.width,d.height);e.runtime.redraw=!0;a.update_tex=!0;e.runtime.trigger(cr.behaviors.Rex_CanvasExt.prototype.cnds.OnURLLoaded,a)};
"data:"!==a.substr(0,5)&&0===b&&(d.crossOrigin="anonymous");this.runtime.setImageSrc(d,a)};f.prototype.Eval=function(a){a=eval("(function(ctx){"+a+"})");var c=this.inst;a(c.ctx);c.runtime.redraw=!0;c.update_tex=!0};f.prototype.SetShadow=function(a,c,b,e){var d=this.inst.ctx;d.shadowOffsetX=a;d.shadowOffsetY=c;d.shadowBlur=b;d.shadowColor=e};g.exps=new h;h.prototype.AsJSON=function(a){var c=this.my_saveToJSON.call(this.inst);a.set_string(JSON.stringify(c))}})();
(function(){if(null==window.RexC2ZlibU8Arr){window.RexC2ZlibU8Arr={};var a=[];window.RexC2ZlibU8Arr.u8a2String=function(f){f=(new window.Zlib.Deflate(f)).compress();for(var h=0;h<f.length;h+=32768)a.push(String.fromCharCode.apply(null,f.subarray(h,h+32768)));f=a.join("");f=btoa(f);a.length=0;return f};window.RexC2ZlibU8Arr.string2u8a=function(a){a=atob(a);a=a.split("").map(function(a){return a.charCodeAt(0)});return(new window.Zlib.Inflate(a)).decompress()}}})();
cr.behaviors.Rex_MoveTo=function(a){this.runtime=a};
(function(){function a(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function f(){}function h(){}function g(){}var e=cr.behaviors.Rex_MoveTo.prototype;e.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var d=e.Instance.prototype;d.onCreate=function(){this.enabled=1===
this.properties[0];this.recycled||(this.moveParams={});this.moveParams.max=this.properties[1];this.moveParams.acc=this.properties[2];this.moveParams.dec=this.properties[3];this.soildStopEnable=1===this.properties[4];this.isContinueMode=1===this.properties[5];this.recycled||(this.target={x:0,y:0,a:0});this.isMoving=!1;this.remainDt=this.remainDistance=this.currentSpeed=0;this.recycled||(this.prePosition={x:0,y:0});this.prePosition.x=0;this.prePosition.y=0;this.movingAngleData=c(this.movingAngleData);
this.movingAngleStartData=c(this.movingAngleStartData);this.lastTick=null;this.isMyCall=!1};var c=function(a){null==a&&(a={});a.x=0;a.y=0;a.a=-1;return a};d.tick=function(){this.remainDt=0;if(this.enabled&&this.isMoving){var a=this.runtime.getDt(this.inst);this.move(a)}};d.move=function(a){if(0!=a){this.prePosition.x===this.inst.x&&this.prePosition.y===this.inst.y||this.resetCurrentPosition();var b=!1;0!=this.moveParams.dec&&(b=this.currentSpeed*this.currentSpeed/(2*this.moveParams.dec)>=this.remainDistance);
b=b?-this.moveParams.dec:this.moveParams.acc;0!=b&&this.setCurrentSpeed(this.currentSpeed+b*a);a*=this.currentSpeed;this.remainDistance-=a;b=!1;var c=this.target.a,d=Math.cos(c);c=Math.sin(c);0>=this.remainDistance||0>=this.currentSpeed?(b=!0,this.inst.x=this.target.x,this.inst.y=this.target.y,0<this.currentSpeed&&(this.remainDt=-this.remainDistance/this.currentSpeed),this.getMovingAngle(),this.setCurrentSpeed(0),this.remainDistance=0):(this.inst.x+=a*d,this.inst.y+=a*c);this.inst.set_bbox_changed();
var e=!1;if(this.soildStopEnable){var f=this.runtime.testOverlapSolid(this.inst);f&&(this.runtime.registerCollision(this.inst,f),this.runtime.pushOutSolid(this.inst,-d,-c,Math.max(a,50)),e=!0)}this.prePosition.x=this.inst.x;this.prePosition.y=this.inst.y;e?(this.isMoving=!1,this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_MoveTo.prototype.cnds.OnSolidStop,this.inst),this.isMyCall=!1):b&&(this.isMoving=!1,this.isMyCall=!0,this.runtime.trigger(cr.behaviors.Rex_MoveTo.prototype.cnds.OnHitTarget,
this.inst),this.isMyCall=!1)}};d.tick2=function(){this.movingAngleData.x=this.inst.x;this.movingAngleData.y=this.inst.y};d.setCurrentSpeed=function(a){null!=a?this.currentSpeed=a>this.moveParams.max?this.moveParams.max:a:0==this.moveParams.acc&&(this.currentSpeed=this.moveParams.max)};d.resetCurrentPosition=function(){var a=this.target.x-this.inst.x,c=this.target.y-this.inst.y;this.target.a=Math.atan2(c,a);this.remainDistance=Math.sqrt(a*a+c*c);this.prePosition.x=this.inst.x;this.prePosition.y=this.inst.y};
d.setTargetPos=function(a,c){this.target.x=a;this.target.y=c;this.setCurrentSpeed(null);this.resetCurrentPosition();this.movingAngleData.x=this.inst.x;this.movingAngleData.y=this.inst.y;this.isMoving=!0;this.movingAngleStartData.x=this.inst.x;this.movingAngleStartData.y=this.inst.y;this.movingAngleStartData.a=cr.to_clamped_degrees(cr.angleTo(this.inst.x,this.inst.y,a,c));this.isContinueMode&&this.move(this.remainDt)};d.isTickChanged=function(){var a=this.runtime.tickcount,c=this.lastTick!=a;this.lastTick=
a;return c};d.getMovingAngle=function(a){if(this.isTickChanged()){a=this.inst.x-this.movingAngleData.x;var b=this.inst.y-this.movingAngleData.y;if(0!=a||0!=b)this.movingAngleData.a=cr.to_clamped_degrees(Math.atan2(b,a))}return this.movingAngleData.a};d.saveToJSON=function(){return{en:this.enabled,v:a(this.moveParams),t:a(this.target),is_m:this.isMoving,c_spd:this.currentSpeed,rd:this.remainDistance,pp:a(this.prePosition),ma:a(this.movingAngleData),ms:a(this.movingAngleStartData),lt:this.lastTick}};
d.loadFromJSON=function(a){this.enabled=a.en;this.moveParams=a.v;this.target=a.t;this.isMoving=a.is_m;this.currentSpeed=a.c_spd;this.remainDistance=a.rd;this.prePosition=a.pp;this.movingAngleData=a.ma;this.movingAngleStartData=a.ms;this.lastTick=a.lt};e.cnds=new f;f.prototype.OnHitTarget=function(){return this.isMyCall};f.prototype.CompareSpeed=function(a,c){return cr.do_cmp(this.currentSpeed,a,c)};f.prototype.OnMoving=function(){return!1};f.prototype.IsMoving=function(){return this.enabled&&this.isMoving};
f.prototype.CompareMovingAngle=function(a,c){return-1!=this.getMovingAngle()?cr.do_cmp(this.getMovingAngle(),a,c):!1};f.prototype.OnSolidStop=function(){return this.isMyCall};e.acts=new h;h.prototype.SetEnabled=function(a){this.enabled=1===a};h.prototype.SetMaxSpeed=function(a){this.moveParams.max=a;this.setCurrentSpeed(null)};h.prototype.SetAcceleration=function(a){this.moveParams.acc=a;this.setCurrentSpeed(null)};h.prototype.SetDeceleration=function(a){this.moveParams.dec=a};h.prototype.SetTargetPos=
function(a,c){this.setTargetPos(a,c)};h.prototype.SetCurrentSpeed=function(a){this.setCurrentSpeed(a)};h.prototype.SetTargetPosOnObject=function(a){a&&(a=a.getFirstPicked(),null!=a&&this.setTargetPos(a.x,a.y))};h.prototype.SetTargetPosByDeltaXY=function(a,c){this.setTargetPos(this.inst.x+a,this.inst.y+c)};h.prototype.SetTargetPosByDistanceAngle=function(a,c){c=cr.to_clamped_radians(c);this.setTargetPos(this.inst.x+a*Math.cos(c),this.inst.y+a*Math.sin(c))};h.prototype.Stop=function(){this.isMoving=
!1};h.prototype.SetTargetPosOnUID=function(a){a=this.runtime.getObjectByUID(a);null!=a&&this.setTargetPos(a.x,a.y)};h.prototype.SetStopBySolid=function(a){this.soildStopEnable=1===a};e.exps=new g;g.prototype.Activated=function(a){a.set_int(this.enabled?1:0)};g.prototype.Speed=function(a){a.set_float(this.currentSpeed)};g.prototype.MaxSpeed=function(a){a.set_float(this.moveParams.max)};g.prototype.Acc=function(a){a.set_float(this.moveParams.acc)};g.prototype.Dec=function(a){a.set_float(this.moveParams.dec)};
g.prototype.TargetX=function(a){a.set_float(this.target.x)};g.prototype.TargetY=function(a){a.set_float(this.target.y)};g.prototype.MovingAngle=function(a){a.set_float(this.getMovingAngle())};g.prototype.MovingAngleStart=function(a){a.set_float(this.movingAngleStartData.a)}})();cr.behaviors.Rex_Rotate=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Rex_Rotate.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.enable=1==this.properties[0];this.direction=this.properties[1];this.speed=this.properties[2];this.acc=this.properties[3]};e.tick=function(){if(this.enable){var a=
this.runtime.getDt(this.inst);this.speed+=this.acc*a;0!=this.speed&&(a*=this.speed,0==this.direction&&(a=-a),this.inst.angle+=cr.to_clamped_radians(a),this.inst.set_bbox_changed())}};e.saveToJSON=function(){return{en:this.enable,d:this.direction,s:this.speed,a:this.acc}};e.loadFromJSON=function(a){this.enable=a.en;this.direction=a.d;this.speed=a.s;this.acc=a.a};g.cnds=new a;a.prototype.CompareSpeed=function(a,c){return cr.do_cmp(this.speed,a,c)};g.acts=new f;f.prototype.SetActivated=function(a){this.enable=
1==a};f.prototype.SetDirection=function(a){this.direction=a};f.prototype.SetSpeed=function(a){this.speed=a};f.prototype.SetAcceleration=function(a){this.acc=a};g.exps=new h;h.prototype.Speed=function(a){a.set_float(this.speed)};h.prototype.Acceleration=function(a){a.set_float(this.acc)};h.prototype.Activated=function(a){a.set_int(this.enable?1:0)}})();cr.behaviors.Rex_TouchArea2=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Rex_TouchArea2.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};var e=g.Type.prototype;e.onCreate=function(){this.touchwrap=null};e.TouchWrapGet=function(){if(null==this.touchwrap){var a=this.runtime.types,c;for(c in a){var b=a[c].instances[0];if(null!=b&&"TOUCHWRAP"==b.check_name){this.touchwrap=b;break}}}};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=
a.runtime;a.TouchWrapGet()};e=g.Instance.prototype;e.onCreate=function(){this.enabled=1===this.properties[0];this.is_touched=!1;this.cur_touchY=this.cur_touchX=-1;this.delta_touchY=this.delta_touchX=0;this._distance=this._vectorY=this._vectorX=this.start_touchY=this.start_touchX=-1};e.tick=function(){if(this.enabled){var a=this.type.touchwrap,c=a.touches,b=c.length,e=!1,f=this.inst;f.update_bbox();var g=this.cur_touchX,h=this.cur_touchY;if(a.IsInTouch())for(a=0;a<b;a++){var m=c[a];var q=f.layer.canvasToLayer(m.x,
m.y,!0);m=f.layer.canvasToLayer(m.x,m.y,!1);if(f.contains_pt(q,m)){this.cur_touchX=q;this.cur_touchY=m;e=!0;break}}this._distance=this._vectorY=this._vectorX=-1;c=this.is_touched;this.is_touched=e;c&&e?(this.delta_touchX=this.cur_touchX-g,this.delta_touchY=this.cur_touchY-h):this.delta_touchY=this.delta_touchX=0;!c&&e&&(this.start_touchX=this.cur_touchX,this.start_touchY=this.cur_touchY,this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchStart,f));g==this.cur_touchX&&h==this.cur_touchY||
this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchMoving,f);c&&!e&&this.runtime.trigger(cr.behaviors.Rex_TouchArea2.prototype.cnds.OnTouchEnd,f)}};e._dist_get=function(){-1==this._distance&&(this._distance=cr.distanceTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY));return this._distance};e._unit_vecXY_get=function(){if(-1==this._vectorX&&-1==this._vectorY)if(this.start_touchX==this.cur_touchX&&this.start_touchY==this.cur_touchY)this._vectorY=this._vectorX=
0;else{var a=cr.angleTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY);this._vectorX=Math.cos(a);this._vectorY=Math.sin(a)}};e._currx_get=function(){return this.is_touched?this.cur_touchX:-1};e._curry_get=function(){return this.is_touched?this.cur_touchY:-1};e._startx_get=function(){return this.is_touched?this.start_touchX:-1};e._starty_get=function(){return this.is_touched?this.start_touchY:-1};e._distance_get=function(){return this.is_touched?this._dist_get():-1};e._angle_get=
function(){if(this.is_touched){var a=cr.angleTo(this.start_touchX,this.start_touchY,this.cur_touchX,this.cur_touchY);a=cr.to_clamped_degrees(a)}else a=-1;return a};e._vectorx_get=function(){if(this.is_touched){this._unit_vecXY_get();var a=this._vectorX}else a=0;return a};e._vectory_get=function(){if(this.is_touched){this._unit_vecXY_get();var a=this._vectorY}else a=0;return a};g.cnds=new a;a.prototype.OnTouchStart=function(){return!0};a.prototype.OnTouchEnd=function(){return!0};a.prototype.IsInTouch=
function(){return this.is_touched};a.prototype.OnTouchMoving=function(){return!0};a.prototype.CompareDragDistance=function(a,c){return this.is_touched?cr.do_cmp(this._distance_get(),a,c):!1};a.prototype.CompareDragAngle=function(a,c){return this.is_touched?cr.do_cmp(this._angle_get(),a,c):!1};g.acts=new f;f.prototype.SetEnabled=function(a){this.enabled=0!==a};g.exps=new h;h.prototype.X=function(a){a.set_float(this._currx_get())};h.prototype.Y=function(a){a.set_float(this._curry_get())};h.prototype.StartX=
function(a){a.set_float(this._startx_get())};h.prototype.StartY=function(a){a.set_float(this._starty_get())};h.prototype.Distance=function(a){a.set_float(this._distance_get())};h.prototype.Angle=function(a){a.set_float(this._angle_get())};h.prototype.VectorX=function(a){a.set_float(this._vectorx_get())};h.prototype.VectorY=function(a){a.set_float(this._vectory_get())};h.prototype.DeltaX=function(a){a.set_float(this.delta_touchX)};h.prototype.DeltaY=function(a){a.set_float(this.delta_touchY)}})();
cr.behaviors.Rex_layouter_text=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.behaviors.Rex_layouter_text.prototype;h.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.check_name="LAYOUTER";this.content="";this.charObjectSID=-1;this.char2frameindex={};this.setChar2FrameIndex(this.properties[0]);this.spriteObjType=
null;this.spriteIndex=0};g.setChar2FrameIndex=function(a){for(var d in this.char2frameindex)delete this.char2frameindex[d];var c,b=a.length;for(c=0;c<b;c++)d=a.charAt(c),this.char2frameindex[d]=c};g.tick=function(){};g.getCharObject=function(){null==this.spriteObjType&&(this.spriteObjType=this.runtime.getObjectTypeBySid(this.charObjectSID));return this.spriteObjType};g.getSpriteInst=function(){for(var a=null,d=this.inst.sprites,c=d.length;this.spriteIndex<c&&!(a=this.runtime.getObjectByUID(d[this.spriteIndex]),
this.spriteIndex+=1,a instanceof cr.plugins_.Sprite.prototype.Instance);)a=null;return a};g.setText=function(a){var d=this.getCharObject();if(d){this.content=a;var c=cr.plugins_.Sprite.prototype.acts.SetAnimFrame,b=cr.plugins_.Sprite.prototype.acts.SetAnimSpeed,e,f=a.length;this.spriteIndex=0;var g=[],h=null;for(e=0;e<f;e++){var m=this.getSpriteInst();null==m&&(m=this.inst.createInstance(d,0,0),g.push(m),h=0);var q=a.charAt(e);q=this.char2frameindex[q];null==q&&(q=-1);m.cur_frame!=q&&c.call(m,q);
0!=m.cur_anim_speed&&b.call(m,0)}if(null==h){for(m=this.getSpriteInst();null!=m;)g.push(m),m=this.getSpriteInst();0<g.length&&(h=1)}0==h?this.inst.addInsts(g):1==h&&this.inst.destroy_insts(g)}};g.saveToJSON=function(){return{t:this.content,csid:this.charObjectSID,c2fi:this.char2frameindex}};g.loadFromJSON=function(a){this.content=a.t;this.charObjectSID=a.csid;this.char2frameindex=a.c2fi};h.cnds=new function(){};h.acts=new a;a.prototype.SetCharacterObject=function(a){a&&(this.spriteObjType=a,this.charObjectSID=
a.sid)};a.prototype.SetText=function(a){cr.is_number(a)&&1E9>a&&(a=Math.round(1E10*a)/1E10);a=a.toString();this.content!==a&&this.setText(a)};h.exps=new f;f.prototype.Value=function(a){a.set_float(this.value)}})();cr.behaviors.Rex_pinOffsetXY=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Rex_pinOffsetXY.prototype;g.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};g.Type.prototype.onCreate=function(){};g.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var e=g.Instance.prototype;e.onCreate=function(){this.pinObject=null;this.pinObjectUid=-1;this.pinOffsetY=this.pinOffsetX=0;var a=this;this.recycled||(this.myDestroyCallback=function(c){a.onInstanceDestroyed(c)});
this.runtime.addDestroyCallback(this.myDestroyCallback)};e.saveToJSON=function(){return{uid:this.pinObject?this.pinObject.uid:-1,offx:this.pinOffsetX,offy:this.pinOffsetY}};e.loadFromJSON=function(a){this.pinObjectUid=a.uid;this.pinOffsetX=a.offx;this.pinOffsetY=a.offy};e.afterLoad=function(){this.pinObject=-1===this.pinObjectUid?null:this.runtime.getObjectByUID(this.pinObjectUid);this.pinObjectUid=-1};e.onInstanceDestroyed=function(a){this.pinObject==a&&(this.pinObject=null)};e.onDestroy=function(){this.pinObject=
null;this.runtime.removeDestroyCallback(this.myDestroyCallback)};e.tick=function(){};e.tick2=function(){if(this.pinObject){var a=this.pinObject.x+this.pinOffsetX,c=this.pinObject.y+this.pinOffsetY;if(this.inst.x!==a||this.inst.y!==c)this.inst.x=a,this.inst.y=c,this.inst.set_bbox_changed()}};g.cnds=new a;a.prototype.IsPinned=function(){return!!this.pinObject};g.acts=new f;f.prototype.Pin=function(a,c,b){a&&(a=a.getFirstPicked(this.inst))&&(null==c&&(c=this.inst.x-a.x),null==b&&(b=this.inst.y-a.y),
this.pinObject=a,this.pinOffsetX=c,this.pinOffsetY=b)};f.prototype.Unpin=function(){this.pinObject=null};g.exps=new h;h.prototype.PinnedUID=function(a){a.set_int(this.pinObject?this.pinObject.uid:-1)}})();cr.behaviors.Rex_text_properties=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.behaviors.Rex_text_properties.prototype;h.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.text_type=this.get_text_type()};g.tick=function(){};g.get_text_type=function(){return cr.plugins_.Text&&this.inst instanceof cr.plugins_.Text.prototype.Instance?
"Text":cr.plugins_.Spritefont2&&this.inst instanceof cr.plugins_.Spritefont2.prototype.Instance?"Spritefont2":cr.plugins_.TextBox&&this.inst instanceof cr.plugins_.TextBox.prototype.Instance?"TextBox":cr.plugins_.rex_TagText&&this.inst instanceof cr.plugins_.rex_TagText.prototype.Instance?"rex_TagText":cr.plugins_.rex_bbcodeText&&this.inst instanceof cr.plugins_.rex_bbcodeText.prototype.Instance?"rex_bbcodeText":""};g._get_webgl_ctx=function(){var a=this.inst,d=a.myctx;if(!d){a.mycanvas=document.createElement("canvas");
d=Math.ceil(a.layer.getScale()*a.width);var c=Math.ceil(a.layer.getAngle()*a.height);a.mycanvas.width=d;a.mycanvas.height=c;a.lastwidth=d;a.lastheight=c;a.myctx=a.mycanvas.getContext("2d");d=a.myctx}return d};g.drawText=function(){var a=this.inst,d=this.runtime.enableWebGL?this._get_webgl_ctx():this.runtime.ctx;a.draw(d)};h.cnds=new function(){};h.acts=new a;a.prototype.SetHorizontalAlignment=function(a){"Spritefont2"===this.text_type?cr.plugins_.Spritefont2.prototype.acts.SetHAlign.call(this.inst,
a):(this.inst.halign!=a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0),this.inst.halign=a)};a.prototype.SetVerticalAlignment=function(a){"Spritefont2"===this.text_type?cr.plugins_.Spritefont2.prototype.acts.SetVAlign.call(this.inst,a):(this.inst.valign!=a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0),this.inst.valign=a)};a.prototype.SetWrapping=function(a){a=0===a;"Spritefont2"===this.text_type?this.inst.wrapbyword!=a&&(this.inst.text_changed=!0,this.runtime.redraw=!0):this.inst.wrapbyword!=
a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0);this.inst.wrapbyword=a};a.prototype.SetLineHeight=function(a){"Spritefont2"===this.text_type?cr.plugins_.Spritefont2.prototype.acts.SetLineHeight.call(this.inst,a):(this.inst.line_height_offset!=a&&(this.inst.need_text_redraw=!0,this.runtime.redraw=!0),this.inst.line_height_offset=a)};a.prototype.SetFontFace=function(a,d){if("Spritefont2"!==this.text_type){var c="";switch(d){case 1:c="bold";break;case 2:c="italic";break;case 3:c="bold italic"}d=
this.inst;if(a!==d.facename||c!==d.fontstyle)d.facename=a,d.fontstyle=c,d.updateFont()}};h.exps=new f;f.prototype.LineBreakContent=function(a){this.drawText();if("Text"===this.text_type||"Spritefont2"===this.text_type)var d=this.inst.lines.join("\n");else if("rex_TagText"===this.text_type||"rex_bbcodeText"===this.text_type){d=this.inst.copyPensMgr();for(var c=d.getLines().length,b=[],e=0;e<c;e++){var f=d.getLineStartChartIndex(e),g=d.getLineEndChartIndex(e);f=d.getSliceTagText(f,g+1);b.push(f)}d=
b.join("\n")}a.set_string(d)}})();cr.behaviors.Rex_text_resize=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.behaviors.Rex_text_resize.prototype;h.Type=function(a,c){this.behavior=a;this.objtype=c;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a,c){this.type=a;this.behavior=a.behavior;this.inst=c;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.isAutoResize=1===this.properties[0];this.minWidth=this.properties[1];this.minHeight=this.properties[2];this.maxWidth=this.inst.width;this.maxHeight=this.inst.height;
this.isResizeNow=!1;this.backgroundObjects={};this.preWidth=this.inst.width;this.preHeight=this.inst.height;this.bgInstsSave=null;this.textObjType=this.getTextObjType();this.FnGetTextHeight=this.getFnGetTextHeight();this.FnGetTextWidth=this.getFnGetTextWidth();this.recycled||(this.myDestroyCallback=function(a){return function(c){a.onInstanceDestroyed(c)}}(this));this.runtime.addDestroyCallback(this.myDestroyCallback)};g.onInstanceDestroyed=function(a){a=a.uid;this.backgroundObjects.hasOwnProperty(a)&&
delete this.backgroundObjects[a]};g.onDestroy=function(){for(var a in this.backgroundObjects)delete this.backgroundObjects[a];this.runtime.removeDestroyCallback(this.myDestroyCallback)};g.tick=function(){};g.tick2=function(){this.isAutoResize&&this.isTextChanged()&&this.resize()};g.forceDrawing=function(){var a=this.inst,c=this.runtime.enableWebGL?this.getWebglCtx():this.runtime.ctx;a.width=this.maxWidth;a.set_bbox_changed();a.draw(c);a.text_changed=!0;a.runtime.redraw=!0};g.getWebglCtx=function(){var a=
this.inst,c=a.myctx;if(!c){a.mycanvas=document.createElement("canvas");c=Math.ceil(a.layer.getScale()*a.width);var b=Math.ceil(a.layer.getAngle()*a.height);a.mycanvas.width=c;a.mycanvas.height=b;a.lastwidth=c;a.lastheight=b;a.myctx=a.mycanvas.getContext("2d");c=a.myctx}return c};g.resize=function(){this.forceDrawing();this.resizeMyself()&&(this.resizeBackground(),this.saveCurrentSize(),this.runtime.trigger(cr.behaviors.Rex_text_resize.prototype.cnds.OnSizeChanged,this.inst))};g.resizeMyself=function(){var a=
this.getTextWidth()+1;a=cr.clamp(a,this.minWidth,this.maxWidth);var c=this.getTextHeight()+1;c<this.minHeight&&(c=this.minHeight);var b=this.inst,e=!1;if(a!==b.width||c!==b.height)this.setInstSize(a,c),e=!0;return e};g.getTextObjType=function(){return cr.plugins_.Text&&this.inst instanceof cr.plugins_.Text.prototype.Instance?1:cr.plugins_.Spritefont2&&this.inst instanceof cr.plugins_.Spritefont2.prototype.Instance?2:cr.plugins_.rex_TagText&&this.inst instanceof cr.plugins_.rex_TagText.prototype.Instance?
10:cr.plugins_.rex_bbcodeText&&this.inst instanceof cr.plugins_.rex_bbcodeText.prototype.Instance?11:cr.plugins_.SpriteFontPlus&&this.inst instanceof cr.plugins_.SpriteFontPlus.prototype.Instance?4:0};g.setInstSize=function(a,c){var b=this.inst;b.width=a;b.height=c;b.set_bbox_changed();switch(this.textObjType){case 1:b.lastwrapwidth=a;break;case 2:b.lastwrapwidth=a;break;case 10:b.lastwrapwidth=a;break;case 11:b.lastwrapwidth=a}};g.resizeBackground=function(){var a=this.inst.width-this.maxWidth,c=
this.inst.height-this.maxHeight,b;for(b in this.backgroundObjects){var e=this.backgroundObjects[b];var f=e.inst;var g=e.rm;var h=e.maxw+a;e=e.maxh+c;if(0===g){if(f.width!==h||f.height!==e)f.height=e,f.width=h,f.set_bbox_changed()}else 1===g&&f.height!==e&&(f.height=e,f.set_bbox_changed())}};g.saveCurrentSize=function(){this.preWidth=this.inst.width;this.preHeight=this.inst.height};g.getFnGetTextHeight=function(){switch(this.textObjType){case 1:return cr.plugins_.Text.prototype.exps.TextHeight;case 2:return cr.plugins_.Spritefont2.prototype.exps.TextHeight;
case 10:return cr.plugins_.rex_TagText.prototype.exps.TextHeight;case 11:return cr.plugins_.rex_bbcodeText.prototype.exps.TextHeight}};g.getFnGetTextWidth=function(){switch(this.textObjType){case 1:return cr.plugins_.Text.prototype.exps.TextWidth;case 2:return cr.plugins_.Spritefont2.prototype.exps.TextWidth;case 10:return cr.plugins_.rex_TagText.prototype.exps.TextWidth;case 11:return cr.plugins_.rex_bbcodeText.prototype.exps.TextWidth}};var e={value:0,set_any:function(a){this.value=a},set_int:function(a){this.value=
a},set_float:function(a){this.value=a},set_string:function(a){this.value=a}};g.getTextHeight=function(){this.FnGetTextHeight.call(this.inst,e);return e.value};g.getTextWidth=function(){this.FnGetTextWidth.call(this.inst,e);return e.value};g.isTextChanged=function(){switch(this.textObjType){case 1:return this.inst.text_changed;case 2:return this.inst.text_changed;case 10:return this.inst.text_changed;case 11:return this.inst.text_changed}};g.saveToJSON=function(){var a,c={};for(a in this.backgroundObjects){var b=
this.backgroundObjects[a];c[a]={rm:b.rm,maxw:b.maxw,maxh:b.maxh}}return{minw:this.minWidth,minh:this.minHeight,maxw:this.maxWidth,maxh:this.maxHeight,pw:this.preWidth,ph:this.preHeight,bg:c}};g.loadFromJSON=function(a){this.minWidth=a.minw;this.minHeight=a.minh;this.maxWidth=a.maxw;this.maxHeight=a.maxh;this.preWidth=a.pw;this.preHeight=a.ph;this.bgInstsSave=a.bg};g.afterLoad=function(){for(var a in this.backgroundObjects)delete this.backgroundObjects[a];for(a in this.bgInstsSave){a=parseInt(a);var c=
this.runtime.getObjectByUID(a);this.backgroundObjects[a]=this.bgInstsSave[a];this.backgroundObjects[a].inst=c}this.bgInstsSave=null};h.cnds=new a;a.prototype.OnSizeChanged=function(){return!0};h.acts=new f;f.prototype.Resize=function(){this.resize()};f.prototype.SetMaxWidth=function(a){this.maxWidth=a};f.prototype.SetMinWidth=function(a){this.minWidth=a};f.prototype.SetMinHeight=function(a){this.minHeight=a};f.prototype.AddBackground=function(a,c){a&&(a=a.getFirstPicked())&&(this.backgroundObjects[a.uid]=
{inst:a,rm:c,maxw:a.width,maxh:a.height})};h.exps=new function(){}})();cr.behaviors.Rex_text_typing=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}var g=cr.behaviors.Rex_text_typing.prototype;g.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};var e=g.Type.prototype;e.onCreate=function(){this.timeline=null;this.timelineUid=-1};e.getTimeline=function(){if(null!=this.timeline)return this.timeline;var a=this.runtime.types,b;for(b in a){var d=a[b].instances[0];if(d instanceof cr.plugins_.Rex_TimeLine.prototype.Instance)return this.timeline=d}return null};g.Instance=function(a,
b){this.type=a;this.behavior=a.behavior;this.inst=b;this.runtime=a.runtime};e=g.Instance.prototype;e.onCreate=function(){this.typeMode=this.properties[0];this.isLineBreak=1===this.properties[1];this.typingTimer=null;this.typingIndex=this.typingSpeed=0;this.content="";this.typingContent=null;this.rawTextLength=0;this.timerSave=null;this.textType=this.getTextObjType();this.FnSetText=this.getFnSetText(this.textType)};e.getTextObjType=function(){return cr.plugins_.Text&&this.inst instanceof cr.plugins_.Text.prototype.Instance?
1:cr.plugins_.Spritefont2&&this.inst instanceof cr.plugins_.Spritefont2.prototype.Instance?2:cr.plugins_.TextBox&&this.inst instanceof cr.plugins_.TextBox.prototype.Instance?3:cr.plugins_.rex_TagText&&this.inst instanceof cr.plugins_.rex_TagText.prototype.Instance?10:cr.plugins_.rex_bbcodeText&&this.inst instanceof cr.plugins_.rex_bbcodeText.prototype.Instance?11:cr.plugins_.SpriteFontPlus&&this.inst instanceof cr.plugins_.SpriteFontPlus.prototype.Instance?4:0};e.getFnSetText=function(a){return 1===
a?cr.plugins_.Text.prototype.acts.SetText:2===a?cr.plugins_.Spritefont2.prototype.acts.SetText:3===a?cr.plugins_.TextBox.prototype.acts.SetText:10===a?cr.plugins_.rex_TagText.prototype.acts.SetText:11===this.textType?cr.plugins_.rex_bbcodeText.prototype.acts.SetText:4===this.textType?cr.plugins_.SpriteFontPlus.prototype.acts.SetText:null};e.onDestroy=function(){this.removeTypingTimer()};e.removeTypingTimer=function(){null!=this.typingTimer&&this.typingTimer.Remove()};e.tick=function(){};e.getRawTextLength=
function(a){return 1===this.textType||2===this.textType||4===this.textType||3===this.textType?a.length:10===this.textType||11===this.textType?this.inst.getRawText(a).length:0};e.getSubString=function(a,b,d){null==b&&(b=0);null==d&&(d=this.getRawTextLength(a));if(b>d){var c=b;b=d;d=c}if(1==this.textType||2==this.textType||4===this.textType||3==this.textType)var e=a.slice(b,d);else if(10===this.textType||11===this.textType)e=this.inst.getSubText(b,d,a);return e};e.getTypingString=function(a,b,d){if(0===
d)var c=this.getSubString(a,0,b);else if(1===d)c=this.rawTextLength,c=this.getSubString(a,c-b,c);else if(2===d)d=Math.floor(this.rawTextLength/2-b/2),c=this.getSubString(a,d,d+b);else if(3===d){var e=Math.floor(b/2);0<e?(c=this.rawTextLength,d=c-e,c=this.getSubString(a,d,c)):c="";b-=e;0<b?(d=0,a=this.getSubString(a,d,d+b)):a="";c=a+c}return c};e.SetText=function(a){null!=this.FnSetText&&this.FnSetText.call(this.inst,a)};e.getTimer=function(){var a=this.typingTimer;null==a&&(a=this.type.getTimeline().CreateTimer(d),
a.plugin=this);return a};e.startTyping=function(a,b,d){this.content=a;this.isLineBreak&&(a=this.lineBreakContent(a));this.rawTextLength=this.getRawTextLength(a);0!=b?(null==d&&(d=1),this.typingTimer=this.getTimer(),this.typingContent=a,this.typingSpeed=b,this.typingIndex=d,this.typingTimer.Start(0)):(this.typingIndex=this.rawTextLength,a=this.getTypingString(a,this.typingIndex,this.typeMode),this.SetText(a),this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTypingCompleted,this.inst))};
var d=function(){this.plugin.typing()};e.typing=function(){var a=this.getTypingString(this.typingContent,this.typingIndex,this.typeMode);this.SetText(a);this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTextTyping,this.inst);this.typingIndex+=1;this.typingIndex<=this.rawTextLength?this.typingTimer.Restart(this.typingSpeed):(this.typingIndex=this.rawTextLength,this.typingContent=null,this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTypingCompleted,this.inst))};e.isTyping=
function(){return this.typingTimer?this.typingTimer.IsActive():!1};e.getWebglCtx=function(){var a=this.inst,b=a.myctx;if(!b){a.mycanvas=document.createElement("canvas");b=Math.ceil(a.layer.getScale()*a.width);var d=Math.ceil(a.layer.getAngle()*a.height);a.mycanvas.width=b;a.mycanvas.height=d;a.lastwidth=b;a.lastheight=d;a.myctx=a.mycanvas.getContext("2d");b=a.myctx}return b};e.drawText=function(a){this.SetText(a);a=this.inst;var b=this.runtime.enableWebGL?this.getWebglCtx():this.runtime.ctx;a.draw(b)};
e.lineBreakContent=function(a){this.drawText(a);if(1===this.textType)var b=this.inst.lines.join("\n");else if(2===this.textType||4===this.textType){a=this.inst.lines.length;b=[];for(var c=0;c<a;c++)b.push(this.inst.lines[c].text);b=b.join("\n")}else if(10===this.textType||11===this.textType){var d=this.inst.copyPensMgr();a=d.getLines().length;var e=!1;b="";for(c=0;c<a;c++){e&&(b+="\n");e=d.getLineStartChartIndex(c);var f=d.getLineEndChartIndex(c);e=d.getSliceTagText(e,f+1);b+=e;e=-1===e.indexOf("\n")}}return b||
""};e.saveToJSON=function(){return{c:this.content,tc:this.typingContent,spd:this.typingSpeed,i:this.typingIndex,tim:null!=this.typingTimer?this.typingTimer.saveToJSON():null,tluid:null!=this.type.timeline?this.type.timeline.uid:-1}};e.loadFromJSON=function(a){this.content=a.c;this.typingContent=a.tc;this.typingSpeed=a.spd;this.typingIndex=a.i;this.timerSave=a.tim;this.type.timelineUid=a.tluid};e.afterLoad=function(){this.type.timeline=-1===this.type.timelineUid?null:this.runtime.getObjectByUID(this.type.timelineUid);
null==this.timerSave?this.typingTimer=null:(this.typingTimer=this.type.timeline.LoadTimer(this.timerSave,d),this.typingTimer.plugin=this);this.timers_save=null};g.cnds=new a;a.prototype.OnTextTyping=function(){return!0};a.prototype.OnTypingCompleted=function(){return!0};a.prototype.IsTextTyping=function(){return this.isTyping()};g.acts=new f;f.prototype.SetupTimer=function(a){a=a.instances[0];"TIMELINE"==a.check_name?this.type.timeline=a:alert("Text-typing should connect to a timeline object")};f.prototype.TypeText=
function(a,b){"number"===typeof a&&(a=Math.round(1E10*a)/1E10);this.startTyping(a.toString(),b)};f.prototype.SetTypingSpeed=function(a){if(this.typingSpeed!==a){this.typingSpeed=a;var b=this.typingTimer;null!=b&&b.IsActive()&&b.Restart(a)}};f.prototype.StopTyping=function(a){this.removeTypingTimer();a&&(this.SetText(this.content),this.runtime.trigger(cr.behaviors.Rex_text_typing.prototype.cnds.OnTypingCompleted,this.inst))};f.prototype.AppendText=function(a){var b=this.rawTextLength;"number"===typeof a&&
(a=Math.round(1E10*a)/1E10);this.isTyping()||this.startTyping(this.content+a.toString(),this.typingSpeed,b)};f.prototype.Pause=function(){null!=this.typingTimer&&this.typingTimer.Suspend()};f.prototype.Resume=function(){null!=this.typingTimer&&this.typingTimer.Resume()};g.exps=new h;h.prototype.TypingSpeed=function(a){a.set_float(this.typingSpeed)};h.prototype.TypingIndex=function(a){a.set_float(this.typingIndex-1)};h.prototype.Content=function(a){a.set_string(this.content)};h.prototype.LastTypingCharacter=
function(a){a.set_string(this.content.charAt(this.typingIndex-1))}})();cr.behaviors.Rotate=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.behaviors.Rotate.prototype;h.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.speed=cr.to_radians(this.properties[0]);this.acc=cr.to_radians(this.properties[1])};g.saveToJSON=function(){return{speed:this.speed,acc:this.acc}};g.loadFromJSON=
function(a){this.speed=a.speed;this.acc=a.acc};g.tick=function(){var a=this.runtime.getDt(this.inst);0!==a&&(0!==this.acc&&(this.speed+=this.acc*a),0!==this.speed&&(this.inst.angle=cr.clamp_angle(this.inst.angle+this.speed*a),this.inst.set_bbox_changed()))};h.cnds=new function(){};a.prototype.SetSpeed=function(a){this.speed=cr.to_radians(a)};a.prototype.SetAcceleration=function(a){this.acc=cr.to_radians(a)};h.acts=new a;f.prototype.Speed=function(a){a.set_float(cr.to_degrees(this.speed))};f.prototype.Acceleration=
function(a){a.set_float(cr.to_degrees(this.acc))};h.exps=new f})();cr.behaviors.Textbox_Plus=function(a){this.runtime=a};
(function(){function a(){}function f(){}function h(){}function g(){}var e=cr.behaviors.Textbox_Plus.prototype;e.Type=function(a,b){this.behavior=a;this.objtype=b;this.runtime=a.runtime};e.Type.prototype.onCreate=function(){};e.Instance=function(a,b){this.inst=b;this.type=a;this.behavior=a.behavior;this.runtime=a.runtime;this.trigger_once=!0;this.autoFontSize=0;this.class=""};var d=e.Instance.prototype;d.onCreate=function(){};d.Style=function(){var a=this.inst;this.inst.elem.addEventListener("focus",
function(b){setTimeout(function(){b.stopPropagation();a.runtime.trigger(cr.behaviors.Textbox_Plus.prototype.cnds.OnFocus,a)},0)},!1);this.inst.elem.addEventListener("blur",function(b){setTimeout(function(){b.stopPropagation();a.runtime.trigger(cr.behaviors.Textbox_Plus.prototype.cnds.OnBlur,a)},0)},!1);this.inst.elem.maxLength=0<this.properties[14]?this.properties[14]:1E6;this.inst.elem.style.textAlign=["left","center","right"][this.properties[5]];this.inst.elem.style.background=this.properties[7]?
this.properties[17]:"none";this.inst.elem.style.border=this.properties[8]?this.properties[18]:"none";this.inst.elem.style.textDecoration=["no","underline","line-through","overline"][this.properties[11]];this.inst.elem.style.textTransform=["no","capitalize","lowercase","uppercase"][this.properties[13]];this.inst.elem.style.borderRadius=this.properties[19];this.inst.elem.style.outline=this.properties[20];this.inst.elem.style.padding=this.properties[21];this.inst.elem.style.textShadow=this.properties[22];
this.inst.elem.style.boxShadow=this.properties[23];for(var b=this.properties[0].split(" "),d=0;d<b.length;d++)this.class.match(b[d])||(this.class+=this.class.length?" "+b[d]:b[d]);this.inst.elem.setAttribute("class",this.class);this.inst.elem.style.color="rgb("+(this.properties[4]&255)+","+(this.properties[4]>>8&255)+","+(this.properties[4]>>16&255)+")";this.properties[10]||(this.inst.elem.disabled=!0,$(this.inst.elem).css("user-select","none"),$(this.inst.elem).css("cursor","default"));this.properties[9]||
(this.inst.elem.disabled=!1,$(this.inst.elem).bind("contextmenu",function(a){a.preventDefault();return!1}));this.properties[12]&&this.inst.elem.setAttribute("onkeypress","return cr.behaviors.Textbox_Plus.prototype.fncs.OnKey(this, event, "+this.properties[12]+", '"+this.properties[24]+"')");"textarea"===this.inst.elem.type&&(d=[0,2,1.01][this.properties[6]])&&(b=this.inst.elem.offsetHeight,this.inst.elem.style.height=0,d=Math.max(0,b/d-this.inst.elem.scrollHeight/d),this.inst.elem.style.paddingTop=
d+"px",this.inst.elem.style.height=b-d+"px");this.properties[15]?(b=document.createElement("link"),b.href=this.properties[15],b.rel="stylesheet",b.type="text/css","undefined"!=typeof b&&(document.getElementsByTagName("head")[0].appendChild(b),this.inst.elem.style.fontFamily=this.properties[16]||"PlayLive")):(this.inst.elem.style.fontFamily=this.properties[2]||"Arial",this.inst.elem.style.fontWeight=1==this.properties[3]||3==this.properties[3]?"bold":"none",this.inst.elem.style.fontStyle=1<this.properties[3]?
"italic":"none");switch(this.properties[1]){case 0:this.autoFontSize=-1;break;case 1:this.autoFontSize=.2;break;case 2:this.autoFontSize=.4;break;case 3:this.autoFontSize=.1;break;case 4:this.autoFontSize=0;break;case 5:this.autoFontSize=.5}this.updatePosition()};d.onDestroy=function(){};d.saveToJSON=function(){return{}};d.loadFromJSON=function(a){};d.tick=function(){this.runtime.getDt(this.inst);this.trigger_once&&(this.trigger_once=!1,this.Style())};d.updatePosition=function(){.5==this.autoFontSize?
jQuery(this.inst.elem).css("font-size",this.inst.layer.getScale(!0)/this.runtime.devicePixelRatio+this.autoFontSize+"em"):-1!=this.autoFontSize&&jQuery(this.inst.elem).css("font-size",this.inst.layer.getScale(!0)/this.runtime.devicePixelRatio-this.autoFontSize+"em")};a.prototype.OnKey=function(a,b,d,e){a=b.which?b.which:b.keyCode;e=-1!=e.indexOf(String.fromCharCode(a))||13==a&&-1!=e.indexOf("  ")?!0:!1;if(1==d)return e||64<a&&91>a||96<a&&123>a?!0:!1;if(2==d)return e||47<a&&58>a?!0:!1;if(3==d)return e||
47<a&&58>a||64<a&&91>a||96<a&&123>a?!0:!1;if(4==d)return e?!0:!1};e.fncs=new a;f.prototype.OnFocus=function(){return!0};f.prototype.OnBlur=function(){return!0};e.cnds=new f;h.prototype.AddClass=function(a){if(this.runtime.isDomFree)return!1;a=a.split(" ");for(var b=0;b<a.length;b++)this.class.match(a[b])||(this.class+=this.class.length?" "+a[b]:a[b]);this.inst.elem.setAttribute("class",this.class)};h.prototype.RemClass=function(a){if(this.runtime.isDomFree)return!1;a=a.split(" ");for(var b=0;b<a.length;b++)this.class=
this.class.replace(a[b],"").replace("  "," ").trim();this.inst.elem.setAttribute("class",this.class)};h.prototype.AppendText=function(a){if(this.runtime.isDomFree)return!1;this.inst.elem.value+=a;this.inst.runtime.trigger(cr.plugins_.TextBox.prototype.cnds.OnTextChanged,this.inst)};h.prototype.Selectable=function(a){this.runtime.isDomFree||(this.inst.elem.disabled=a?!1:!0,$(this.frame).css("user-select",a?"auto":"none"),$(this.frame).css("cursor",a?"auto":"default"))};h.prototype.SelectAll=function(){this.runtime.isDomFree||
this.inst.elem.select()};h.prototype.ScrollTop=function(){this.runtime.isDomFree||(this.inst.elem.scrollTop=0)};h.prototype.ScrollBottom=function(){this.runtime.isDomFree||(this.inst.elem.scrollTop=this.elem.scrollHeight)};h.prototype.ScrollTo=function(a){this.runtime.isDomFree||(this.frame.scrollTop=this.frame.scrollHeight,this.frame.scrollTop*=a/100)};h.prototype.ScrollToPosition=function(a){this.runtime.isDomFree||(this.frame.scrollTop=a)};e.acts=new h;g.prototype.ID=function(a){a.set_string(this.inst.elem.id)};
g.prototype.Class=function(a){a.set_string(this.class)};g.prototype.ScrollHeight=function(a){a.set_float(this.inst.elem.scrollHeight)};g.prototype.ScrollPosition=function(a){a.set_float(this.inst.elem.scrollTop)};e.exps=new g})();cr.behaviors.bound=function(a){this.runtime=a};
(function(){var a=cr.behaviors.bound.prototype;a.Type=function(a,h){this.behavior=a;this.objtype=h;this.runtime=a.runtime};a.Type.prototype.onCreate=function(){};a.Instance=function(a,h){this.type=a;this.behavior=a.behavior;this.inst=h;this.runtime=a.runtime;this.mode=0};a=a.Instance.prototype;a.onCreate=function(){this.mode=this.properties[0]};a.tick=function(){};a.tick2=function(){this.inst.update_bbox();var a=this.inst.bbox,h=this.inst.layer.layout,g=!1;0===this.mode?(0>this.inst.x&&(this.inst.x=
0,g=!0),0>this.inst.y&&(this.inst.y=0,g=!0),this.inst.x>h.width&&(this.inst.x=h.width,g=!0),this.inst.y>h.height&&(this.inst.y=h.height,g=!0)):(0>a.left&&(this.inst.x-=a.left,g=!0),0>a.top&&(this.inst.y-=a.top,g=!0),a.right>h.width&&(this.inst.x-=a.right-h.width,g=!0),a.bottom>h.height&&(this.inst.y-=a.bottom-h.height,g=!0));g&&this.inst.set_bbox_changed()}})();cr.behaviors.solid=function(a){this.runtime=a};
(function(){function a(){}function f(){}var h=cr.behaviors.solid.prototype;h.Type=function(a,d){this.behavior=a;this.objtype=d;this.runtime=a.runtime};h.Type.prototype.onCreate=function(){};h.Instance=function(a,d){this.type=a;this.behavior=a.behavior;this.inst=d;this.runtime=a.runtime};var g=h.Instance.prototype;g.onCreate=function(){this.inst.extra.solidEnabled=0!==this.properties[0]};g.tick=function(){};a.prototype.IsEnabled=function(){return this.inst.extra.solidEnabled};h.cnds=new a;f.prototype.SetEnabled=
function(a){this.inst.extra.solidEnabled=!!a};h.acts=new f})();
cr.getObjectRefTable=function(){return[cr.plugins_.togglebutton,cr.plugins_.AJAX,cr.plugins_.filechooser,cr.plugins_.Function,cr.plugins_.CSS_import,cr.plugins_.Dictionary,cr.plugins_.c2canvas,cr.plugins_.Button,cr.plugins_.Browser,cr.plugins_.Mouse,cr.plugins_.Keyboard,cr.plugins_.pix_dialogs,cr.plugins_.List,cr.plugins_.Rex_canvas,cr.plugins_.progressbar,cr.plugins_.rex_bbcodeText,cr.plugins_.Rex_InstanceBank2,cr.plugins_.Rex_SysExt,cr.plugins_.Rex_TimeLine,cr.plugins_.Rex_TARP,cr.plugins_.rex_TouchWrap,
cr.plugins_.Text,cr.plugins_.Rex_UID2Prop,cr.plugins_.sliderbar,cr.plugins_.ValerypopoffJSPlugin,cr.plugins_.video,cr.plugins_.Rex_UndoRedo,cr.plugins_.sirg_fancyBox,cr.plugins_.Sprite,cr.plugins_.TextBox,cr.plugins_.TiledBg,cr.plugins_.Touch,cr.plugins_.TR_UltimateAds,cr.plugins_.UserMedia,cr.behaviors.Textbox_Plus,cr.behaviors.Flash,cr.behaviors.solid,cr.behaviors.Rex_pinOffsetXY,cr.behaviors.Pin,cr.behaviors.DragnDrop,cr.behaviors.Rotate,cr.behaviors.Rex_MoveTo,cr.behaviors.Rex_text_resize,cr.behaviors.Rex_text_properties,
cr.behaviors.Rex_layouter_text,cr.behaviors.Rex_CanvasExt,cr.behaviors.Fade,cr.behaviors.Rex_Rotate,cr.behaviors.Rex_text_typing,cr.behaviors.bound,cr.behaviors.Rex_TouchArea2,cr.system_object.prototype.cnds.IsGroupActive,cr.plugins_.Function.prototype.cnds.OnFunction,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.Call,cr.plugins_.Dictionary.prototype.exps.AsJSON,cr.system_object.prototype.acts.Wait,cr.plugins_.List.prototype.acts.AddItem,cr.plugins_.TextBox.prototype.exps.Text,cr.plugins_.List.prototype.exps.AsJSON,
cr.plugins_.List.prototype.acts.Remove,cr.plugins_.List.prototype.exps.SelectedIndex,cr.plugins_.List.prototype.acts.Select,cr.plugins_.Function.prototype.acts.CallFunction,cr.plugins_.Sprite.prototype.acts.SetOpacity,cr.system_object.prototype.acts.SetVar,cr.plugins_.List.prototype.exps.X,cr.plugins_.List.prototype.exps.Y,cr.plugins_.List.prototype.acts.Clear,cr.plugins_.List.prototype.acts.LoadFromJsonString,cr.plugins_.ValerypopoffJSPlugin.prototype.exps.StoredReturnValue,cr.plugins_.List.prototype.acts.SetPos,
cr.plugins_.List.prototype.acts.AddItemAt,cr.plugins_.List.prototype.acts.SetEnabled,cr.plugins_.Dictionary.prototype.acts.JSONLoad,cr.plugins_.List.prototype.exps.SelectedText,cr.system_object.prototype.exps.left,cr.system_object.prototype.cnds.Compare,cr.system_object.prototype.exps.layoutname,cr.behaviors.Rex_MoveTo.prototype.acts.SetTargetPos,cr.plugins_.Sprite.prototype.acts.SetVisible,cr.behaviors.DragnDrop.prototype.acts.SetEnabled,cr.plugins_.Sprite.prototype.acts.Destroy,cr.plugins_.Sprite.prototype.acts.SetSize,
cr.plugins_.Rex_TARP.prototype.acts.PlayerStop,cr.system_object.prototype.acts.RestartLayout,cr.system_object.prototype.cnds.CompareVar,cr.plugins_.Sprite.prototype.acts.SetPos,cr.plugins_.Sprite.prototype.exps.X,cr.plugins_.Sprite.prototype.exps.Y,cr.plugins_.Sprite.prototype.acts.SetAngle,cr.plugins_.TiledBg.prototype.acts.SetVisible,cr.system_object.prototype.acts.SetLayerVisible,cr.plugins_.TextBox.prototype.acts.SetText,cr.plugins_.Text.prototype.acts.SetVisible,cr.behaviors.Rotate.prototype.acts.SetSpeed,
cr.plugins_.Sprite.prototype.acts.RotateClockwise,cr.plugins_.TextBox.prototype.acts.SetPlaceholder,cr.plugins_.Text.prototype.acts.Destroy,cr.plugins_.c2canvas.prototype.acts.ClearCanvas,cr.plugins_.Sprite.prototype.acts.SetInstanceVar,cr.behaviors.Pin.prototype.acts.Pin,cr.behaviors.Pin.prototype.acts.Unpin,cr.plugins_.video.prototype.acts.SetSource,cr.plugins_.filechooser.prototype.exps.FileURLAt,cr.plugins_.filechooser.prototype.acts.ReleaseFile,cr.plugins_.filechooser.prototype.exps.Count,cr.plugins_.video.prototype.acts.SetVisible,
cr.plugins_.video.prototype.acts.SetPlaybackTime,cr.plugins_.sliderbar.prototype.acts.SetValue,cr.plugins_.Text.prototype.acts.SetText,cr.plugins_.filechooser.prototype.exps.FileNameAt,cr.plugins_.video.prototype.acts.Pause,cr.plugins_.Sprite.prototype.acts.SetX,cr.plugins_.List.prototype.exps.Count,cr.plugins_.List.prototype.exps.SelectedTextAt,cr.plugins_.Dictionary.prototype.cnds.ForEachKey,cr.system_object.prototype.exps.tokenat,cr.plugins_.Dictionary.prototype.exps.CurrentKey,cr.plugins_.List.prototype.acts.SetItemText,
cr.plugins_.TextBox.prototype.acts.SetVisible,cr.plugins_.filechooser.prototype.exps.FileTypeAt,cr.plugins_.togglebutton.prototype.cnds.CompareInstanceVar,cr.plugins_.List.prototype.cnds.CompareSelectedText,cr.plugins_.video.prototype.acts.Play,cr.plugins_.progressbar.prototype.acts.SetIndeterminate,cr.system_object.prototype.exps["int"],cr.system_object.prototype.exps.zeropad,cr.system_object.prototype.exps.abs,cr.plugins_.video.prototype.exps.PlaybackTime,cr.plugins_.Sprite.prototype.exps.Width,
cr.plugins_.progressbar.prototype.acts.SetMaximum,cr.plugins_.video.prototype.exps.Duration,cr.system_object.prototype.cnds.For,cr.plugins_.List.prototype.exps.ItemCount,cr.system_object.prototype.acts.AddVar,cr.plugins_.List.prototype.exps.ItemTextAt,cr.system_object.prototype.exps.replace,cr.system_object.prototype.exps.time,cr.plugins_.Rex_InstanceBank2.prototype.acts.CleanBank,cr.plugins_.Dictionary.prototype.acts.AddKey,cr.plugins_.c2canvas.prototype.exps.imageUrl,cr.plugins_.Rex_InstanceBank2.prototype.acts.SaveInstances,
cr.plugins_.Rex_InstanceBank2.prototype.exps.BankToString,cr.plugins_.Rex_TimeLine.prototype.acts.ResumeTimeLine,cr.plugins_.Rex_TimeLine.prototype.acts.PauseTimeLine,cr.plugins_.Rex_TARP.prototype.acts.PlayerResume,cr.plugins_.Rex_TARP.prototype.acts.PlayerPause,cr.plugins_.Dictionary.prototype.cnds.HasKey,cr.plugins_.Rex_TARP.prototype.acts.PlayerLoad,cr.plugins_.Dictionary.prototype.exps.Get,cr.plugins_.Rex_TARP.prototype.acts.PlayStart,cr.system_object.prototype.exps.urldecode,cr.behaviors.Rex_MoveTo.prototype.acts.Stop,
cr.plugins_.Rex_TARP.prototype.exps.RecorderList,cr.plugins_.Rex_TARP.prototype.acts.Setup,cr.plugins_.Rex_TARP.prototype.acts.RecorderStart,cr.plugins_.Rex_SysExt.prototype.exps.SubString,cr.system_object.prototype.acts.GoToLayoutByName,cr.behaviors.Rex_CanvasExt.prototype.acts.LoadURL,cr.plugins_.Rex_InstanceBank2.prototype.acts.LoadInstances,cr.plugins_.Rex_InstanceBank2.prototype.acts.StringToBank,cr.plugins_.Function.prototype.exps.Param,cr.plugins_.Browser.prototype.acts.ConsoleLog,cr.plugins_.Dictionary.prototype.acts.DeleteKey,
cr.plugins_.Sprite.prototype.acts.MoveToTop,cr.behaviors.Rex_MoveTo.prototype.acts.SetMaxSpeed,cr.behaviors.Rex_MoveTo.prototype.acts.SetEnabled,cr.system_object.prototype.acts.SetLayerOpacity,cr.plugins_.Rex_UndoRedo.prototype.acts.CleanAll,cr.behaviors.Rex_CanvasExt.prototype.acts.EraseObject,cr.plugins_.Touch.prototype.cnds.OnTouchObject,cr.plugins_.Rex_TARP.prototype.cnds.IsPlaying,cr.system_object.prototype.acts.CreateObject,cr.plugins_.Text.prototype.acts.MoveToTop,cr.plugins_.Dictionary.prototype.acts.Clear,
cr.system_object.prototype.acts.ResetPersisted,cr.plugins_.ValerypopoffJSPlugin.prototype.acts.ExecuteJSWithParams,cr.plugins_.Touch.prototype.cnds.IsTouchingObject,cr.plugins_.Sprite.prototype.cnds.PickByUID,cr.plugins_.Sprite.prototype.cnds.IsVisible,cr.behaviors.Rex_pinOffsetXY.prototype.acts.Unpin,cr.plugins_.Sprite.prototype.acts.SetCollisions,cr.plugins_.Touch.prototype.exps.X,cr.plugins_.Touch.prototype.exps.Y,cr.plugins_.Sprite.prototype.cnds.IsOverlapping,cr.behaviors.Rex_MoveTo.prototype.cnds.IsMoving,
cr.behaviors.DragnDrop.prototype.cnds.IsDragging,cr.behaviors.Rex_pinOffsetXY.prototype.acts.Pin,cr.behaviors.Rex_pinOffsetXY.prototype.cnds.IsPinned,cr.plugins_.Touch.prototype.cnds.OnTapGestureObject,cr.plugins_.Sprite.prototype.acts.SetTowardPosition,cr.plugins_.Touch.prototype.cnds.OnTouchEnd,cr.system_object.prototype.cnds.IsMobile,cr.plugins_.Browser.prototype.cnds.IsPortraitLandscape,cr.plugins_.Touch.prototype.cnds.OnDoubleTapGestureObject,cr.plugins_.Sprite.prototype.acts.SetPosToObject,
cr.plugins_.Sprite.prototype.exps.UID,cr.system_object.prototype.cnds.LayerVisible,cr.plugins_.Sprite.prototype.cnds.CompareOpacity,cr.plugins_.Text.prototype.exps.UID,cr.system_object.prototype.acts.SubVar,cr.plugins_.pix_dialogs.prototype.acts.openDialog,cr.plugins_.pix_dialogs.prototype.cnds.dialogConfirmed,cr.plugins_.Browser.prototype.cnds.IsOnline,cr.plugins_.Browser.prototype.exps.Domain,cr.plugins_.sirg_fancyBox.prototype.acts.ShowFancyBoxHtml,cr.plugins_.sirg_fancyBox.prototype.acts.ShowFancyBoxIframe,
cr.plugins_.Browser.prototype.acts.GoToURLWindow,cr.plugins_.List.prototype.acts.SetVisible,cr.plugins_.List.prototype.cnds.CompareTextAt,cr.system_object.prototype.exps.len,cr.behaviors.Rex_text_properties.prototype.acts.SetWrapping,cr.plugins_.Text.prototype.acts.SetFontSize,cr.plugins_.Text.prototype.acts.SetFontFace,cr.plugins_.Text.prototype.acts.SetFontColor,cr.plugins_.Text.prototype.cnds.PickByUID,cr.behaviors.Textbox_Plus.prototype.cnds.OnFocus,cr.plugins_.TextBox.prototype.acts.SetCSSStyle,
cr.plugins_.Text.prototype.exps.Text,cr.system_object.prototype.exps.rgb,cr.system_object.prototype.acts.SnapshotCanvas,cr.system_object.prototype.cnds.OnCanvasSnapshot,cr.plugins_.Browser.prototype.acts.InvokeDownload,cr.system_object.prototype.exps.canvassnapshot,cr.system_object.prototype.exps.random,cr.plugins_.c2canvas.prototype.acts.setLineDash,cr.plugins_.c2canvas.prototype.acts.setLineSettings,cr.plugins_.Sprite.prototype.acts.SetAnimFrame,cr.plugins_.Sprite.prototype.exps.AnimationFrame,
cr.plugins_.Sprite.prototype.acts.StopAnim,cr.plugins_.List.prototype.cnds.OnSelectionChanged,cr.system_object.prototype.acts.GoToLayout,cr.system_object.prototype.cnds.OnLayoutStart,cr.plugins_.sliderbar.prototype.acts.SetCSSStyle,cr.plugins_.progressbar.prototype.acts.SetCSSStyle,cr.plugins_.Rex_UndoRedo.prototype.acts.Push,cr.plugins_.UserMedia.prototype.cnds.SupportsCanvasRecording,cr.plugins_.filechooser.prototype.acts.SetVisible,cr.plugins_.video.prototype.acts.SetVolume,cr.plugins_.Dictionary.prototype.cnds.IsEmpty,
cr.plugins_.TextBox.prototype.acts.SetReadOnly,cr.system_object.prototype.cnds.OnLayoutEnd,cr.plugins_.AJAX.prototype.acts.SetHeader,cr.system_object.prototype.exps.str,cr.system_object.prototype.exps.tickcount,cr.plugins_.AJAX.prototype.acts.Request,cr.plugins_.AJAX.prototype.cnds.OnComplete,cr.plugins_.AJAX.prototype.exps.LastData,cr.plugins_.AJAX.prototype.cnds.OnError,cr.behaviors.Rex_Rotate.prototype.acts.SetActivated,cr.behaviors.Flash.prototype.acts.Flash,cr.plugins_.rex_bbcodeText.prototype.acts.SetText,
cr.behaviors.Rex_text_typing.prototype.acts.TypeText,cr.behaviors.Fade.prototype.acts.RestartFade,cr.plugins_.video.prototype.acts.Destroy,cr.plugins_.Touch.prototype.cnds.IsInTouch,cr.system_object.prototype.exps.distance,cr.plugins_.c2canvas.prototype.acts.beginPath,cr.plugins_.Touch.prototype.cnds.OnTouchStart,cr.plugins_.Sprite.prototype.acts.RotateTowardAngle,cr.system_object.prototype.exps.clamp,cr.system_object.prototype.exps.dt,cr.plugins_.Sprite.prototype.exps.Angle,cr.system_object.prototype.exps.angle,
cr.system_object.prototype.cnds.EveryTick,cr.plugins_.c2canvas.prototype.acts.DrawLine,cr.plugins_.c2canvas.prototype.acts.lineTo,cr.plugins_.c2canvas.prototype.acts.drawPath,cr.plugins_.c2canvas.prototype.acts.PasteObject,cr.plugins_.video.prototype.cnds.IsVisible,cr.plugins_.Sprite.prototype.cnds.CompareInstanceVar,cr.plugins_.Rex_UndoRedo.prototype.exps.Undo,cr.plugins_.Rex_UndoRedo.prototype.exps.Redo,cr.plugins_.Text.prototype.cnds.IsVisible,cr.system_object.prototype.exps.floor,cr.plugins_.progressbar.prototype.acts.SetProgress,
cr.behaviors.DragnDrop.prototype.cnds.OnDrop,cr.system_object.prototype.exps.round,cr.system_object.prototype.exps.unlerp,cr.plugins_.filechooser.prototype.exps.FileCount,cr.plugins_.video.prototype.acts.SetPos,cr.plugins_.UserMedia.prototype.acts.StartRecordingCanvas,cr.plugins_.UserMedia.prototype.acts.StopRecordingCanvas,cr.plugins_.UserMedia.prototype.cnds.OnCanvasRecordingReady,cr.plugins_.UserMedia.prototype.exps.CanvasRecordingURL,cr.plugins_.video.prototype.cnds.IsPaused,cr.plugins_.filechooser.prototype.cnds.OnChanged,
cr.plugins_.AJAX.prototype.cnds.OnProgress,cr.plugins_.Browser.prototype.acts.InvokeDownloadString,cr.behaviors.Fade.prototype.acts.StartFade,cr.plugins_.togglebutton.prototype.cnds.toggleStatus,cr.plugins_.togglebutton.prototype.acts.SetInstanceVar,cr.plugins_.video.prototype.cnds.OnPlaybackEvent,cr.plugins_.video.prototype.acts.SetMuted,cr.plugins_.video.prototype.cnds.IsPlaying,cr.plugins_.TextBox.prototype.cnds.OnTextChanged,cr.plugins_.TextBox.prototype.cnds.OnClicked,cr.system_object.prototype.acts.SetTimescale,
cr.plugins_.Rex_TARP.prototype.cnds.OnEnd,cr.plugins_.List.prototype.cnds.CompareSelection,cr.plugins_.TextBox.prototype.acts.SetEnabled,cr.plugins_.Rex_canvas.prototype.exps.X,cr.plugins_.Rex_canvas.prototype.exps.Y,cr.plugins_.Rex_TARP.prototype.acts.RecordAction]};
